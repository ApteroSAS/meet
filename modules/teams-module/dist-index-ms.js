/*!
 * 
 *   @aptero/axolotis-module-teams v1.0.0
 *
 *   Copyright (c) Aptero  and project contributors.
 *
 *   This source code is licensed under the undefined license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */
!function webpackUniversalModuleDefinition(c,y){"object"==typeof exports&&"object"==typeof module?module.exports=y(require("@aptero/axolotis-player")):"function"==typeof define&&define.amd?define("axolotis-module-teams",["@aptero/axolotis-player"],y):"object"==typeof exports?exports["axolotis-module-teams"]=y(require("@aptero/axolotis-player")):c["axolotis-module-teams"]=y(c["@aptero/axolotis-player"])}(self,(c=>(()=>{var y={789:(c,y,v)=>{"use strict";v.r(y),v.d(y,{AuthenticationHandler:()=>AuthenticationHandler,AuthenticationHandlerOptions:()=>AuthenticationHandlerOptions,BatchRequestContent:()=>BatchRequestContent,BatchResponseContent:()=>BatchResponseContent,ChaosHandler:()=>ChaosHandler,ChaosHandlerOptions:()=>ChaosHandlerOptions,ChaosStrategy:()=>T,Client:()=>Client,CustomAuthenticationProvider:()=>CustomAuthenticationProvider,FeatureUsageFlag:()=>S,FileUpload:()=>FileUpload,GraphClientError:()=>GraphClientError,GraphError:()=>GraphError,GraphRequest:()=>GraphRequest,HTTPMessageHandler:()=>HTTPMessageHandler,LargeFileUploadTask:()=>LargeFileUploadTask,MiddlewareFactory:()=>MiddlewareFactory,OneDriveLargeFileUploadTask:()=>OneDriveLargeFileUploadTask,PageIterator:()=>PageIterator,Range:()=>Range,RedirectHandler:()=>RedirectHandler,RedirectHandlerOptions:()=>RedirectHandlerOptions,ResponseType:()=>K,RetryHandler:()=>RetryHandler,RetryHandlerOptions:()=>RetryHandlerOptions,StreamUpload:()=>StreamUpload,TelemetryHandler:()=>TelemetryHandler,TelemetryHandlerOptions:()=>TelemetryHandlerOptions,UploadResult:()=>UploadResult,getValidRangeSize:()=>getValidRangeSize});function __awaiter(c,y,v,w){return new(v||(v=Promise))((function(C,b){function fulfilled(c){try{step(w.next(c))}catch(c){b(c)}}function rejected(c){try{step(w.throw(c))}catch(c){b(c)}}function step(c){c.done?C(c.value):function adopt(c){return c instanceof v?c:new v((function(y){y(c)}))}(c.value).then(fulfilled,rejected)}step((w=w.apply(c,y||[])).next())}))}Object.create;var w;Object.create;!function(c){c.GET="GET",c.PATCH="PATCH",c.POST="POST",c.PUT="PUT",c.DELETE="DELETE"}(w||(w={}));class BatchRequestContent{constructor(c){if(this.requests=new Map,void 0!==c){const y=BatchRequestContent.requestLimit;if(c.length>y){const c=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${y}`);throw c.name="Limit Exceeded Error",c}for(const y of c)this.addRequest(y)}}static validateDependencies(c){if(0===c.size){const c=new Error("Empty requests map, Please provide at least one request.");throw c.name="Empty Requests Error",c}return(c=>{const y=c.entries();let v=y.next();for(;!v.done;){const c=v.value[1];if(void 0!==c.dependsOn&&c.dependsOn.length>0)return!1;v=y.next()}return!0})(c)||(c=>{const y=c.entries();let v=y.next();const w=v.value[1];if(void 0!==w.dependsOn&&w.dependsOn.length>0)return!1;let C=v;for(v=y.next();!v.done;){const c=v.value[1];if(void 0===c.dependsOn||1!==c.dependsOn.length||c.dependsOn[0]!==C.value[1].id)return!1;C=v,v=y.next()}return!0})(c)||(c=>{const y=c.entries();let v=y.next();const w=v.value[1];let C;if(void 0===w.dependsOn||0===w.dependsOn.length)C=w.id;else{if(1!==w.dependsOn.length)return!1;{const y=w.dependsOn[0];if(y===w.id||!c.has(y))return!1;C=y}}for(v=y.next();!v.done;){const c=v.value[1];if((void 0===c.dependsOn||0===c.dependsOn.length)&&C!==c.id)return!1;if(void 0!==c.dependsOn&&0!==c.dependsOn.length){if(1===c.dependsOn.length&&(c.id===C||c.dependsOn[0]!==C))return!1;if(c.dependsOn.length>1)return!1}v=y.next()}return!0})(c)}static getRequestData(c){return __awaiter(this,void 0,void 0,(function*(){const y={url:""},v=new RegExp("^https?://");y.url=v.test(c.url)?"/"+c.url.split(/.*?\/\/.*?\//)[1]:c.url,y.method=c.method;const C={};return c.headers.forEach(((c,y)=>{C[y]=c})),Object.keys(C).length&&(y.headers=C),c.method!==w.PATCH&&c.method!==w.POST&&c.method!==w.PUT||(y.body=yield BatchRequestContent.getRequestBody(c)),y}))}static getRequestBody(c){return __awaiter(this,void 0,void 0,(function*(){let y,v=!1;try{const w=c.clone();y=yield w.json(),v=!0}catch(c){}if(!v)try{if("undefined"!=typeof Blob){const v=yield c.blob(),w=new FileReader;y=yield new Promise((c=>{w.addEventListener("load",(()=>{const y=w.result,v=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(y);c(v[4])}),!1),w.readAsDataURL(v)}))}else if("undefined"!=typeof Buffer){y=(yield c.buffer()).toString("base64")}v=!0}catch(c){}return y}))}addRequest(c){const y=BatchRequestContent.requestLimit;if(""===c.id){const c=new Error("Id for a request is empty, Please provide an unique id");throw c.name="Empty Id For Request",c}if(this.requests.size===y){const c=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${y}`);throw c.name="Limit Exceeded Error",c}if(this.requests.has(c.id)){const y=new Error(`Adding request with duplicate id ${c.id}, Make the id of the requests unique`);throw y.name="Duplicate RequestId Error",y}return this.requests.set(c.id,c),c.id}removeRequest(c){const y=this.requests.delete(c),v=this.requests.entries();let w=v.next();for(;!w.done;){const y=w.value[1].dependsOn;if(void 0!==y){const v=y.indexOf(c);-1!==v&&y.splice(v,1),0===y.length&&delete w.value[1].dependsOn}w=v.next()}return y}getContent(){return __awaiter(this,void 0,void 0,(function*(){const c=[],y={requests:c},v=this.requests.entries();let w=v.next();if(w.done){const c=new Error("No requests added yet, Please add at least one request.");throw c.name="Empty Payload",c}if(!BatchRequestContent.validateDependencies(this.requests)){const c=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw c.name="Invalid Dependency",c}for(;!w.done;){const y=w.value[1],C=yield BatchRequestContent.getRequestData(y.request);if(void 0!==C.body&&(void 0===C.headers||void 0===C.headers["content-type"])){const c=new Error(`Content-type header is not mentioned for request #${y.id}, For request having body, Content-type header should be mentioned`);throw c.name="Invalid Content-type header",c}C.id=y.id,void 0!==y.dependsOn&&y.dependsOn.length>0&&(C.dependsOn=y.dependsOn),c.push(C),w=v.next()}return y.requests=c,y}))}addDependency(c,y){if(!this.requests.has(c)){const y=new Error(`Dependent ${c} does not exists, Please check the id`);throw y.name="Invalid Dependent",y}if(void 0!==y&&!this.requests.has(y)){const c=new Error(`Dependency ${y} does not exists, Please check the id`);throw c.name="Invalid Dependency",c}if(void 0!==y){const v=this.requests.get(c);if(void 0===v.dependsOn&&(v.dependsOn=[]),-1!==v.dependsOn.indexOf(y)){const v=new Error(`Dependency ${y} is already added for the request ${c}`);throw v.name="Duplicate Dependency",v}v.dependsOn.push(y)}else{const v=this.requests.entries();let w,C=v.next();for(;!C.done&&C.value[1].id!==c;)w=C,C=v.next();if(void 0===w){const c=new Error(`Can't add dependency ${y}, There is only a dependent request in the batch`);throw c.name="Invalid Dependency Addition",c}{const y=w.value[0];if(void 0===C.value[1].dependsOn&&(C.value[1].dependsOn=[]),-1!==C.value[1].dependsOn.indexOf(y)){const v=new Error(`Dependency ${y} is already added for the request ${c}`);throw v.name="Duplicate Dependency",v}C.value[1].dependsOn.push(y)}}}removeDependency(c,y){const v=this.requests.get(c);if(void 0===v||void 0===v.dependsOn||0===v.dependsOn.length)return!1;if(void 0!==y){const c=v.dependsOn.indexOf(y);return-1!==c&&(v.dependsOn.splice(c,1),!0)}return delete v.dependsOn,!0}}BatchRequestContent.requestLimit=20;class BatchResponseContent{constructor(c){this.responses=new Map,this.update(c)}createResponseObject(c){const y=c.body,v={};if(v.status=c.status,void 0!==c.statusText&&(v.statusText=c.statusText),v.headers=c.headers,void 0!==v.headers&&void 0!==v.headers["Content-Type"]&&"application/json"===v.headers["Content-Type"].split(";")[0]){const c=JSON.stringify(y);return new Response(c,v)}return new Response(y,v)}update(c){this.nextLink=c["@odata.nextLink"];const y=c.responses;for(let c=0,v=y.length;c<v;c++)this.responses.set(y[c].id,this.createResponseObject(y[c]))}getResponseById(c){return this.responses.get(c)}getResponses(){return this.responses}*getResponsesIterator(){const c=this.responses.entries();let y=c.next();for(;!y.done;)yield y.value,y=c.next()}}const C=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class GraphClientError extends Error{constructor(c){super(c),Object.setPrototypeOf(this,GraphClientError.prototype)}static setGraphClientError(c){let y;return c instanceof Error?y=c:(y=new GraphClientError,y.customError=c),y}}const b=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],serializeContent=c=>{const y=c&&c.constructor&&c.constructor.name;if("Buffer"===y||"Blob"===y||"File"===y||"FormData"===y||"string"==typeof c)return c;if("ArrayBuffer"===y)c=Buffer.from(c);else if("Int8Array"===y||"Int16Array"===y||"Int32Array"===y||"Uint8Array"===y||"Uint16Array"===y||"Uint32Array"===y||"Uint8ClampedArray"===y||"Float32Array"===y||"Float64Array"===y||"DataView"===y)c=Buffer.from(c.buffer);else try{c=JSON.stringify(c)}catch(c){throw new Error("Unable to stringify the content")}return c},isGraphURL=c=>isValidEndpoint(c),isCustomHost=(c,y)=>(y.forEach((c=>isCustomHostValid(c))),isValidEndpoint(c,y)),isValidEndpoint=(c,y=C)=>{if(-1!==(c=c.toLowerCase()).indexOf("https://")){const v=(c=c.replace("https://","")).indexOf(":"),w=c.indexOf("/");let C="";if(-1!==w)return-1!==v&&v<w?(C=c.substring(0,v),y.has(C)):(C=c.substring(0,w),y.has(C))}return!1},isCustomHostValid=c=>{if(-1!==c.indexOf("/"))throw new GraphClientError("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class MiddlewareControl{constructor(c=[]){this.middlewareOptions=new Map;for(const y of c){const c=y.constructor;this.middlewareOptions.set(c,y)}}getMiddlewareOptions(c){return this.middlewareOptions.get(c)}setMiddlewareOptions(c,y){this.middlewareOptions.set(c,y)}}const generateUUID=()=>{let c="";for(let y=0;y<32;y++)8!==y&&12!==y&&16!==y&&20!==y||(c+="-"),c+=Math.floor(16*Math.random()).toString(16);return c},getRequestHeader=(c,y,v)=>{let w=null;if("undefined"!=typeof Request&&c instanceof Request)w=c.headers.get(v);else if(void 0!==y&&void 0!==y.headers)if("undefined"!=typeof Headers&&y.headers instanceof Headers)w=y.headers.get(v);else if(y.headers instanceof Array){const c=y.headers;for(let y=0,C=c.length;y<C;y++)if(c[y][0]===v){w=c[y][1];break}}else void 0!==y.headers[v]&&(w=y.headers[v]);return w},setRequestHeader=(c,y,v,w)=>{if("undefined"!=typeof Request&&c instanceof Request)c.headers.set(v,w);else if(void 0!==y)if(void 0===y.headers)y.headers=new Headers({[v]:w});else if("undefined"!=typeof Headers&&y.headers instanceof Headers)y.headers.set(v,w);else if(y.headers instanceof Array){let c=0;const C=y.headers.length;for(;c<C;c++){const C=y.headers[c];if(C[0]===v){C[1]=w;break}}c===C&&y.headers.push([v,w])}else Object.assign(y.headers,{[v]:w})},appendRequestHeader=(c,y,v,w)=>{"undefined"!=typeof Request&&c instanceof Request?c.headers.append(v,w):void 0!==y&&(void 0===y.headers?y.headers=new Headers({[v]:w}):"undefined"!=typeof Headers&&y.headers instanceof Headers?y.headers.append(v,w):y.headers instanceof Array?y.headers.push([v,w]):void 0===y.headers?y.headers={[v]:w}:void 0===y.headers[v]?y.headers[v]=w:y.headers[v]+=`, ${w}`)};class AuthenticationHandlerOptions{constructor(c,y){this.authenticationProvider=c,this.authenticationProviderOptions=y}}var S;!function(c){c[c.NONE=0]="NONE",c[c.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",c[c.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",c[c.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(S||(S={}));class TelemetryHandlerOptions{constructor(){this.featureUsage=S.NONE}static updateFeatureUsageFlag(c,y){let v;c.middlewareControl instanceof MiddlewareControl?v=c.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions):c.middlewareControl=new MiddlewareControl,void 0===v&&(v=new TelemetryHandlerOptions,c.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions,v)),v.setFeatureUsage(y)}setFeatureUsage(c){this.featureUsage=this.featureUsage|c}getFeatureUsage(){return this.featureUsage.toString(16)}}class AuthenticationHandler{constructor(c){this.authenticationProvider=c}execute(c){return __awaiter(this,void 0,void 0,(function*(){const y="string"==typeof c.request?c.request:c.request.url;if(isGraphURL(y)||c.customHosts&&isCustomHost(y,c.customHosts)){let y,v,w;c.middlewareControl instanceof MiddlewareControl&&(y=c.middlewareControl.getMiddlewareOptions(AuthenticationHandlerOptions)),y&&(v=y.authenticationProvider,w=y.authenticationProviderOptions),v||(v=this.authenticationProvider);const C=`Bearer ${yield v.getAccessToken(w)}`;appendRequestHeader(c.request,c.options,AuthenticationHandler.AUTHORIZATION_HEADER,C),TelemetryHandlerOptions.updateFeatureUsageFlag(c,S.AUTHENTICATION_HANDLER_ENABLED)}else c.options.headers&&delete c.options.headers[AuthenticationHandler.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(c)}))}setNext(c){this.nextMiddleware=c}}AuthenticationHandler.AUTHORIZATION_HEADER="Authorization";class HTTPMessageHandler{execute(c){return __awaiter(this,void 0,void 0,(function*(){c.response=yield fetch(c.request,c.options)}))}}class RetryHandlerOptions{constructor(c=RetryHandlerOptions.DEFAULT_DELAY,y=RetryHandlerOptions.DEFAULT_MAX_RETRIES,v=RetryHandlerOptions.defaultShouldRetry){if(c>RetryHandlerOptions.MAX_DELAY&&y>RetryHandlerOptions.MAX_MAX_RETRIES){const c=new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw c.name="MaxLimitExceeded",c}if(c>RetryHandlerOptions.MAX_DELAY){const c=new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);throw c.name="MaxLimitExceeded",c}if(y>RetryHandlerOptions.MAX_MAX_RETRIES){const c=new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw c.name="MaxLimitExceeded",c}if(c<0&&y<0){const c=new Error("Delay and MaxRetries should not be negative");throw c.name="MinExpectationNotMet",c}if(c<0){const c=new Error("Delay should not be negative");throw c.name="MinExpectationNotMet",c}if(y<0){const c=new Error("MaxRetries should not be negative");throw c.name="MinExpectationNotMet",c}this.delay=Math.min(c,RetryHandlerOptions.MAX_DELAY),this.maxRetries=Math.min(y,RetryHandlerOptions.MAX_MAX_RETRIES),this.shouldRetry=v}getMaxDelay(){return RetryHandlerOptions.MAX_DELAY}}RetryHandlerOptions.DEFAULT_DELAY=3,RetryHandlerOptions.DEFAULT_MAX_RETRIES=3,RetryHandlerOptions.MAX_DELAY=180,RetryHandlerOptions.MAX_MAX_RETRIES=10,RetryHandlerOptions.defaultShouldRetry=()=>!0;class RetryHandler{constructor(c=new RetryHandlerOptions){this.options=c}isRetry(c){return-1!==RetryHandler.RETRY_STATUS_CODES.indexOf(c.status)}isBuffered(c,y){const v="string"==typeof c?y.method:c.method;if(v===w.PUT||v===w.PATCH||v===w.POST){if("application/octet-stream"===getRequestHeader(c,y,"Content-Type"))return!1}return!0}getDelay(c,y,v){const getRandomness=()=>Number(Math.random().toFixed(3)),w=void 0!==c.headers?c.headers.get(RetryHandler.RETRY_AFTER_HEADER):null;let C;return C=null!==w?Number.isNaN(Number(w))?Math.round((new Date(w).getTime()-Date.now())/1e3):Number(w):y>=2?this.getExponentialBackOffTime(y)+v+getRandomness():v+getRandomness(),Math.min(C,this.options.getMaxDelay()+getRandomness())}getExponentialBackOffTime(c){return Math.round(.5*(Math.pow(2,c)-1))}sleep(c){return __awaiter(this,void 0,void 0,(function*(){const y=1e3*c;return new Promise((c=>setTimeout(c,y)))}))}getOptions(c){let y;return c.middlewareControl instanceof MiddlewareControl&&(y=c.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===y&&(y=Object.assign(new RetryHandlerOptions,this.options)),y}executeWithRetry(c,y,v){return __awaiter(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(c),y<v.maxRetries&&this.isRetry(c.response)&&this.isBuffered(c.request,c.options)&&v.shouldRetry(v.delay,y,c.request,c.options,c.response)){++y,setRequestHeader(c.request,c.options,RetryHandler.RETRY_ATTEMPT_HEADER,y.toString());const w=this.getDelay(c.response,y,v.delay);return yield this.sleep(w),yield this.executeWithRetry(c,y,v)}}))}execute(c){return __awaiter(this,void 0,void 0,(function*(){const y=this.getOptions(c);return TelemetryHandlerOptions.updateFeatureUsageFlag(c,S.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(c,0,y)}))}setNext(c){this.nextMiddleware=c}}RetryHandler.RETRY_STATUS_CODES=[429,503,504],RetryHandler.RETRY_ATTEMPT_HEADER="Retry-Attempt",RetryHandler.RETRY_AFTER_HEADER="Retry-After";class RedirectHandlerOptions{constructor(c=RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS,y=RedirectHandlerOptions.defaultShouldRedirect){if(c>RedirectHandlerOptions.MAX_MAX_REDIRECTS){const c=new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);throw c.name="MaxLimitExceeded",c}if(c<0){const c=new Error("MaxRedirects should not be negative");throw c.name="MinExpectationNotMet",c}this.maxRedirects=c,this.shouldRedirect=y}}RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS=5,RedirectHandlerOptions.MAX_MAX_REDIRECTS=20,RedirectHandlerOptions.defaultShouldRedirect=()=>!0;class RedirectHandler{constructor(c=new RedirectHandlerOptions){this.options=c}isRedirect(c){return-1!==RedirectHandler.REDIRECT_STATUS_CODES.indexOf(c.status)}hasLocationHeader(c){return c.headers.has(RedirectHandler.LOCATION_HEADER)}getLocationHeader(c){return c.headers.get(RedirectHandler.LOCATION_HEADER)}isRelativeURL(c){return-1===c.indexOf("://")}shouldDropAuthorizationHeader(c,y){const v=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,w=v.exec(c);let C,b;null!==w&&(C=w[0]);const S=v.exec(y);return null!==S&&(b=S[0]),void 0!==C&&void 0!==b&&C!==b}updateRequestUrl(c,y){return __awaiter(this,void 0,void 0,(function*(){var v,w;y.request="string"==typeof y.request?c:yield(v=c,w=y.request,__awaiter(void 0,void 0,void 0,(function*(){const c=w.headers.get("Content-Type")?yield w.blob():yield Promise.resolve(void 0),{method:y,headers:C,referrer:b,referrerPolicy:S,mode:T,credentials:I,cache:P,redirect:K,integrity:Q,keepalive:X,signal:te}=w;return new Request(v,{method:y,headers:C,body:c,referrer:b,referrerPolicy:S,mode:T,credentials:I,cache:P,redirect:K,integrity:Q,keepalive:X,signal:te})})))}))}getOptions(c){let y;return c.middlewareControl instanceof MiddlewareControl&&(y=c.middlewareControl.getMiddlewareOptions(RedirectHandlerOptions)),void 0===y&&(y=Object.assign(new RedirectHandlerOptions,this.options)),y}executeWithRedirect(c,y,v){return __awaiter(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(c);const C=c.response;if(y<v.maxRedirects&&this.isRedirect(C)&&this.hasLocationHeader(C)&&v.shouldRedirect(C)){if(++y,C.status===RedirectHandler.STATUS_CODE_SEE_OTHER)c.options.method=w.GET,delete c.options.body;else{const y=this.getLocationHeader(C);!this.isRelativeURL(y)&&this.shouldDropAuthorizationHeader(C.url,y)&&delete c.options.headers[RedirectHandler.AUTHORIZATION_HEADER],yield this.updateRequestUrl(y,c)}yield this.executeWithRedirect(c,y,v)}}))}execute(c){return __awaiter(this,void 0,void 0,(function*(){const y=this.getOptions(c);return c.options.redirect=RedirectHandler.MANUAL_REDIRECT,TelemetryHandlerOptions.updateFeatureUsageFlag(c,S.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(c,0,y)}))}setNext(c){this.nextMiddleware=c}}RedirectHandler.REDIRECT_STATUS_CODES=[301,302,303,307,308],RedirectHandler.STATUS_CODE_SEE_OTHER=303,RedirectHandler.LOCATION_HEADER="Location",RedirectHandler.AUTHORIZATION_HEADER="Authorization",RedirectHandler.MANUAL_REDIRECT="manual";class TelemetryHandler{execute(c){return __awaiter(this,void 0,void 0,(function*(){const y="string"==typeof c.request?c.request:c.request.url;if(isGraphURL(y)||c.customHosts&&isCustomHost(y,c.customHosts)){let y=getRequestHeader(c.request,c.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER);y||(y=generateUUID(),setRequestHeader(c.request,c.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER,y));let v,w=`${TelemetryHandler.PRODUCT_NAME}/3.0.2`;if(c.middlewareControl instanceof MiddlewareControl&&(v=c.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions)),v){const c=v.getFeatureUsage();w+=` (${TelemetryHandler.FEATURE_USAGE_STRING}=${c})`}appendRequestHeader(c.request,c.options,TelemetryHandler.SDK_VERSION_HEADER,w)}else delete c.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER],delete c.options.headers[TelemetryHandler.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(c)}))}setNext(c){this.nextMiddleware=c}}TelemetryHandler.CLIENT_REQUEST_ID_HEADER="client-request-id",TelemetryHandler.SDK_VERSION_HEADER="SdkVersion",TelemetryHandler.PRODUCT_NAME="graph-js",TelemetryHandler.FEATURE_USAGE_STRING="featureUsage";class MiddlewareFactory{static getDefaultMiddlewareChain(c){const y=[],v=new AuthenticationHandler(c),w=new RetryHandler(new RetryHandlerOptions),C=new TelemetryHandler,b=new HTTPMessageHandler;if(y.push(v),y.push(w),"object"==typeof process){const c=new RedirectHandler(new RedirectHandlerOptions);y.push(c)}return y.push(C),y.push(b),y}}var T;!function(c){c[c.MANUAL=0]="MANUAL",c[c.RANDOM=1]="RANDOM"}(T||(T={}));class ChaosHandlerOptions{constructor(c=T.RANDOM,y="Some error Happened",v,w,C,b){if(this.chaosStrategy=c,this.statusCode=v,this.statusMessage=y,this.chaosPercentage=void 0!==w?w:10,this.responseBody=C,this.headers=b,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const I={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},P={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class ChaosHandler{constructor(c=new ChaosHandlerOptions,y){this.options=c,this.manualMap=y}createResponseHeaders(c,y,v){const w=c.headers?new Headers(c.headers):new Headers;return w.append("Cache-Control","no-store"),w.append("request-id",y),w.append("client-request-id",y),w.append("x-ms-ags-diagnostic",""),w.append("Date",v),w.append("Strict-Transport-Security",""),429===c.statusCode&&w.append("retry-after","3"),w}createResponseBody(c,y,v){if(c.responseBody)return c.responseBody;let w;if(c.statusCode>=400){w={error:{code:P[c.statusCode],message:c.statusMessage,innerError:{"request-id":y,date:v}}}}else w={};return w}createResponse(c,y){const v=y.request,w=generateUUID(),C=new Date,b=this.createResponseHeaders(c,w,C.toString()),S=this.createResponseBody(c,w,C.toString()),T={url:v,status:c.statusCode,statusText:c.statusMessage,headers:b};y.response=new Response("string"==typeof S?S:JSON.stringify(S),T)}sendRequest(c,y){return __awaiter(this,void 0,void 0,(function*(){this.setStatusCode(c,y.request,y.options.method),c.chaosStrategy===T.MANUAL&&!this.nextMiddleware||Math.floor(100*Math.random())<c.chaosPercentage?this.createResponse(c,y):this.nextMiddleware&&(yield this.nextMiddleware.execute(y))}))}getRandomStatusCode(c){const y=I[c];return y[Math.floor(Math.random()*y.length)]}getRelativeURL(c){const y=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let v;return null!==y.exec(c)&&(v=y.exec(c)[1]),v}setStatusCode(c,y,v){if(c.chaosStrategy===T.MANUAL){if(void 0===c.statusCode){const w=this.getRelativeURL(y);void 0!==this.manualMap.get(w)?void 0!==this.manualMap.get(w).get(v)&&(c.statusCode=this.manualMap.get(w).get(v)):this.manualMap.forEach(((y,C)=>{new RegExp(C+"$").test(w)&&void 0!==this.manualMap.get(C).get(v)&&(c.statusCode=this.manualMap.get(C).get(v))}))}}else c.statusCode=this.getRandomStatusCode(v)}getOptions(c){let y;return c.middlewareControl instanceof MiddlewareControl&&(y=c.middlewareControl.getMiddlewareOptions(ChaosHandlerOptions)),void 0===y&&(y=Object.assign(new ChaosHandlerOptions,this.options)),y}execute(c){return __awaiter(this,void 0,void 0,(function*(){const y=this.getOptions(c);return yield this.sendRequest(y,c)}))}setNext(c){this.nextMiddleware=c}}var K,Q,X,te;!function(c){c.ARRAYBUFFER="arraybuffer",c.BLOB="blob",c.DOCUMENT="document",c.JSON="json",c.RAW="raw",c.STREAM="stream",c.TEXT="text"}(K||(K={})),function(c){c.TEXT_HTML="text/html",c.TEXT_XML="text/xml",c.APPLICATION_XML="application/xml",c.APPLICATION_XHTML="application/xhtml+xml"}(Q||(Q={})),function(c){c.TEXT_PLAIN="text/plain",c.APPLICATION_JSON="application/json"}(X||(X={})),function(c){c.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",c.IMAGE="^image\\/.+"}(te||(te={}));class GraphResponseHandler{static parseDocumentResponse(c,y){return"undefined"!=typeof DOMParser?new Promise(((v,w)=>{c.text().then((c=>{try{const w=(new DOMParser).parseFromString(c,y);v(w)}catch(c){w(c)}}))})):Promise.resolve(c.body)}static convertResponse(c,y){return __awaiter(this,void 0,void 0,(function*(){if(204===c.status)return Promise.resolve();let v;const w=c.headers.get("Content-type");switch(y){case K.ARRAYBUFFER:v=yield c.arrayBuffer();break;case K.BLOB:v=yield c.blob();break;case K.DOCUMENT:v=yield GraphResponseHandler.parseDocumentResponse(c,Q.TEXT_XML);break;case K.JSON:v=yield c.json();break;case K.STREAM:v=yield Promise.resolve(c.body);break;case K.TEXT:v=yield c.text();break;default:if(null!==w){const y=w.split(";")[0];v=new RegExp(te.DOCUMENT).test(y)?yield GraphResponseHandler.parseDocumentResponse(c,y):new RegExp(te.IMAGE).test(y)?c.blob():y===X.TEXT_PLAIN?yield c.text():y===X.APPLICATION_JSON?yield c.json():Promise.resolve(c.body)}else v=Promise.resolve(c.body)}return v}))}static getResponse(c,y,v){return __awaiter(this,void 0,void 0,(function*(){if(y===K.RAW)return Promise.resolve(c);{const w=yield GraphResponseHandler.convertResponse(c,y);if(!c.ok)throw w;if("function"!=typeof v)return w;v(null,w)}}))}}class Range{constructor(c=-1,y=-1){this.minValue=c,this.maxValue=y}}class UploadResult{constructor(c,y){this._location=y,this._responseBody=c}get location(){return this._location}set location(c){this._location=c}get responseBody(){return this._responseBody}set responseBody(c){this._responseBody=c}static CreateUploadResult(c,y){return new UploadResult(c,y.get("location"))}}class LargeFileUploadTask{constructor(c,y,v,w={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=c,!y.sliceFile)throw new GraphClientError("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=y,this.file=y,w.rangeSize||(w.rangeSize=this.DEFAULT_FILE_SIZE),this.options=w,this.uploadSession=v,this.nextRange=new Range(0,this.options.rangeSize-1)}static createUploadSession(c,y,v,w={}){return __awaiter(this,void 0,void 0,(function*(){const C=yield c.api(y).headers(w).post(v);return{url:C.uploadUrl,expiry:new Date(C.expirationDateTime),isCancelled:!1}}))}parseRange(c){const y=c[0];if(void 0===y||""===y)return new Range;const v=y.split("-"),w=parseInt(v[0],10);let C=parseInt(v[1],10);return Number.isNaN(C)&&(C=this.file.size-1),new Range(w,C)}updateTaskStatus(c){this.uploadSession.expiry=new Date(c.expirationDateTime),this.nextRange=this.parseRange(c.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const c=this.nextRange.minValue;let y=c+this.options.rangeSize-1;return y>=this.file.size&&(y=this.file.size-1),new Range(c,y)}sliceFile(c){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(c.minValue,c.maxValue+1);throw new GraphClientError("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return __awaiter(this,void 0,void 0,(function*(){const c=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const y=this.getNextRange();if(-1===y.maxValue){const c=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw c.name="Invalid Session",c}const v=yield this.file.sliceFile(y),w=yield this.uploadSliceGetRawResponse(v,y,this.file.size);if(!w)throw new GraphClientError("Something went wrong! Large file upload slice response is null.");const C=yield GraphResponseHandler.getResponse(w);if(201===w.status||200===w.status&&C.id){return UploadResult.CreateUploadResult(C,w.headers)}const b={expirationDateTime:C.expirationDateTime||C.ExpirationDateTime,nextExpectedRanges:C.NextExpectedRanges||C.nextExpectedRanges};this.updateTaskStatus(b),c&&c.progress&&c.progress(y,c.extraCallbackParam)}}))}uploadSlice(c,y,v){return __awaiter(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(y.maxValue-y.minValue+1),"Content-Range":`bytes ${y.minValue}-${y.maxValue}/${v}`,"Content-Type":"application/octet-stream"}).put(c)}))}uploadSliceGetRawResponse(c,y,v){return __awaiter(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(y.maxValue-y.minValue+1),"Content-Range":`bytes ${y.minValue}-${y.maxValue}/${v}`,"Content-Type":"application/octet-stream"}).responseType(K.RAW).put(c)}))}cancel(){return __awaiter(this,void 0,void 0,(function*(){const c=yield this.client.api(this.uploadSession.url).responseType(K.RAW).delete();return 204===c.status&&(this.uploadSession.isCancelled=!0),c}))}getStatus(){return __awaiter(this,void 0,void 0,(function*(){const c=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(c),c}))}resume(){return __awaiter(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class FileUpload{constructor(c,y,v){if(this.content=c,this.name=y,this.size=v,!c||!y||!v)throw new GraphClientError("Please provide the upload content, name of the file and size of the file")}sliceFile(c){return this.content.slice(c.minValue,c.maxValue+1)}}const getValidRangeSize=(c=5242880)=>{const y=62914560;return c>y&&(c=y),(v=c)>327680&&(v=320*Math.floor(v/327680)*1024),v;var v};class OneDriveLargeFileUploadTask extends LargeFileUploadTask{constructor(c,y,v,w){super(c,y,v,w)}static constructCreateSessionUrl(c,y=OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH){return c=c.trim(),""===(y=y.trim())&&(y="/"),"/"!==y[0]&&(y=`/${y}`),"/"!==y[y.length-1]&&(y=`${y}/`),`/me/drive/root:${y.split("/").map((c=>encodeURIComponent(c))).join("/")}${encodeURIComponent(c)}:/createUploadSession`}static getFileInfo(c,y){let v,w;if("undefined"!=typeof Blob&&c instanceof Blob)v=new File([c],y),w=v.size;else if("undefined"!=typeof File&&c instanceof File)v=c,w=v.size;else if("undefined"!=typeof Uint8Array&&c instanceof Uint8Array){const y=c;w=y.byteLength,v=y.buffer.slice(y.byteOffset,y.byteOffset+y.byteLength)}return{content:v,size:w}}static create(c,y,v){return __awaiter(this,void 0,void 0,(function*(){if(!c||!y||!v)throw new GraphClientError("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const w=v.fileName,C=OneDriveLargeFileUploadTask.getFileInfo(y,w),b=new FileUpload(C.content,w,C.size);return this.createTaskWithFileObject(c,b,v)}))}static createTaskWithFileObject(c,y,v){return __awaiter(this,void 0,void 0,(function*(){if(!c||!y||!v)throw new GraphClientError("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const w=OneDriveLargeFileUploadTask.constructCreateSessionUrl(v.fileName,v.path),C={fileName:v.fileName,fileDescription:v.fileDescription,conflictBehavior:v.conflictBehavior},b=yield OneDriveLargeFileUploadTask.createUploadSession(c,w,C),S=getValidRangeSize(v.rangeSize);return new OneDriveLargeFileUploadTask(c,y,b,{rangeSize:S,uploadEventHandlers:v.uploadEventHandlers})}))}static createUploadSession(c,y,v){const w=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return __awaiter(this,void 0,void 0,(function*(){const C={item:{"@microsoft.graph.conflictBehavior":(null==v?void 0:v.conflictBehavior)||"rename",name:null==v?void 0:v.fileName,description:null==v?void 0:v.fileDescription}};return w.createUploadSession.call(this,c,y,C)}))}commit(c,y="rename"){return __awaiter(this,void 0,void 0,(function*(){const v={name:this.file.name,"@microsoft.graph.conflictBehavior":y,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(c).put(v)}))}}OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH="/";class StreamUpload{constructor(c,y,v){if(this.content=c,this.name=y,this.size=v,!c||!y||!v)throw new GraphClientError("Please provide the Readable Stream content, name of the file and size of the file")}sliceFile(c){return __awaiter(this,void 0,void 0,(function*(){let y=c.maxValue-c.minValue+1;const v=[];if(this.previousSlice){if(c.minValue<this.previousSlice.range.minValue)throw new GraphClientError("An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.");if(c.minValue<this.previousSlice.range.maxValue){const w=this.previousSlice.range.minValue,C=this.previousSlice.range.maxValue;if(c.minValue===w&&c.maxValue===C)return this.previousSlice.fileSlice;if(c.maxValue===C)return this.previousSlice.fileSlice.slice(c.minValue,c.maxValue+1);v.push(this.previousSlice.fileSlice.slice(c.minValue,C+1)),y=c.maxValue-C}}if(!this.content||!this.content.readable)throw new GraphClientError("Stream is not readable.");this.content.readableLength>=y?v.push(this.content.read(y)):v.push(yield this.readNBytesFromStream(y));const w=Buffer.concat(v);return this.previousSlice={fileSlice:w,range:c},w}))}readNBytesFromStream(c){return new Promise(((y,v)=>{const w=[];let C=c,b=0;this.content.on("end",(()=>{if(C>0)return v(new GraphClientError("Stream ended before reading required range size"))})),this.content.on("readable",(()=>{let S;for(;b<c&&null!==(S=this.content.read(C));)b+=S.length,w.push(S),C>0&&(C=c-b);return b===c?y(Buffer.concat(w)):this.content&&this.content.readable?void 0:v(new GraphClientError("Error encountered while reading the stream during the upload"))}))}))}}class PageIterator{constructor(c,y,v,w){this.client=c,this.collection=y.value,this.nextLink=y["@odata.nextLink"],this.deltaLink=y["@odata.deltaLink"],this.callback=v,this.complete=!1,this.requestOptions=w}iterationHelper(){if(void 0===this.collection)return!1;let c=!0;for(;c&&0!==this.collection.length;){const y=this.collection.shift();c=this.callback(y)}return c}fetchAndUpdateNextPageData(){return __awaiter(this,void 0,void 0,(function*(){let c=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(c=c.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(c=c.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(c=c.options(this.requestOptions.options)));const y=yield c.get();this.collection=y.value,this.nextLink=y["@odata.nextLink"],this.deltaLink=y["@odata.deltaLink"]}))}getDeltaLink(){return this.deltaLink}iterate(){return __awaiter(this,void 0,void 0,(function*(){let c=this.iterationHelper();for(;c;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),c=this.iterationHelper()):c=!1;void 0===this.nextLink&&0===this.collection.length&&(this.complete=!0)}))}resume(){return __awaiter(this,void 0,void 0,(function*(){return this.iterate()}))}isComplete(){return this.complete}}class CustomAuthenticationProvider{constructor(c){this.provider=c}getAccessToken(){return __awaiter(this,void 0,void 0,(function*(){return new Promise(((c,y)=>{this.provider(((v,w)=>__awaiter(this,void 0,void 0,(function*(){if(w)c(w);else{if(!v){v=new GraphClientError("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")}const c=yield GraphClientError.setGraphClientError(v);y(c)}}))))}))}))}}class GraphError extends Error{constructor(c=-1,y,v){super(y||v&&v.message),Object.setPrototypeOf(this,GraphError.prototype),this.statusCode=c,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=v?v.stack:this.stack}}class GraphErrorHandler{static constructError(c,y){const v=new GraphError(y,"",c);return void 0!==c.name&&(v.code=c.name),v.body=c.toString(),v.date=new Date,v}static constructErrorFromResponse(c,y){const v=c.error,w=new GraphError(y,v.message);return w.code=v.code,void 0!==v.innerError&&(w.requestId=v.innerError["request-id"],w.date=new Date(v.innerError.date)),w.body=JSON.stringify(v),w}static getError(c=null,y=-1,v){return __awaiter(this,void 0,void 0,(function*(){let w;if(c&&c.error?w=GraphErrorHandler.constructErrorFromResponse(c,y):c instanceof Error?w=GraphErrorHandler.constructError(c,y):(w=new GraphError(y),w.body=c),"function"!=typeof v)return w;v(w,null)}))}}class GraphRequest{constructor(c,y,v){this.parsePath=c=>{if(-1!==c.indexOf("https://")){const y=(c=c.replace("https://","")).indexOf("/");-1!==y&&(this.urlComponents.host="https://"+c.substring(0,y),c=c.substring(y+1,c.length));const v=c.indexOf("/");-1!==v&&(this.urlComponents.version=c.substring(0,v),c=c.substring(v+1,c.length))}"/"===c.charAt(0)&&(c=c.substr(1));const y=c.indexOf("?");if(-1===y)this.urlComponents.path=c;else{this.urlComponents.path=c.substr(0,y);const v=c.substring(y+1,c.length).split("&");for(const c of v)this.parseQueryParameter(c)}},this.httpClient=c,this.config=y,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(v)}addCsvQueryParameter(c,y,v){this.urlComponents.oDataQueryParams[c]=this.urlComponents.oDataQueryParams[c]?this.urlComponents.oDataQueryParams[c]+",":"";let w=[];v.length>1&&"string"==typeof y?w=Array.prototype.slice.call(v):"string"==typeof y?w.push(y):w=w.concat(y),this.urlComponents.oDataQueryParams[c]+=w.join(",")}buildFullUrl(){const c=(c=>{const removePreSlash=c=>c.replace(/^\/+/,"");return Array.prototype.slice.call(c).reduce(((c,y)=>{return[(v=c,v.replace(/\/+$/,"")),removePreSlash(y)].join("/");var v}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(c),c}createQueryString(){const c=this.urlComponents,y=[];if(0!==Object.keys(c.oDataQueryParams).length)for(const v in c.oDataQueryParams)Object.prototype.hasOwnProperty.call(c.oDataQueryParams,v)&&y.push(v+"="+c.oDataQueryParams[v]);if(0!==Object.keys(c.otherURLQueryParams).length)for(const v in c.otherURLQueryParams)Object.prototype.hasOwnProperty.call(c.otherURLQueryParams,v)&&y.push(v+"="+c.otherURLQueryParams[v]);if(0!==c.otherURLQueryOptions.length)for(const v of c.otherURLQueryOptions)y.push(v);return y.length>0?"?"+y.join("&"):""}parseQueryParameter(c){if("string"==typeof c)if("?"===c.charAt(0)&&(c=c.substring(1)),-1!==c.indexOf("&")){const y=c.split("&");for(const c of y)this.parseQueryParamenterString(c)}else this.parseQueryParamenterString(c);else if(c.constructor===Object)for(const y in c)Object.prototype.hasOwnProperty.call(c,y)&&this.setURLComponentsQueryParamater(y,c[y]);return this}parseQueryParamenterString(c){if(this.isValidQueryKeyValuePair(c)){const y=c.indexOf("="),v=c.substring(0,y),w=c.substring(y+1);this.setURLComponentsQueryParamater(v,w)}else this.urlComponents.otherURLQueryOptions.push(c)}setURLComponentsQueryParamater(c,y){if(-1!==b.indexOf(c)){const v=this.urlComponents.oDataQueryParams[c],w=v&&("$expand"===c||"$select"===c||"$orderby"===c);this.urlComponents.oDataQueryParams[c]=w?v+","+y:y}else this.urlComponents.otherURLQueryParams[c]=y}isValidQueryKeyValuePair(c){const y=c.indexOf("=");if(-1===y)return!1;return!(-1!==c.indexOf("(")&&c.indexOf("(")<y)}updateRequestOptions(c){const y=Object.assign({},c.headers);if(void 0!==this.config.fetchOptions){const y=Object.assign({},this.config.fetchOptions);Object.assign(c,y),void 0!==typeof this.config.fetchOptions.headers&&(c.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(c,this._options),void 0!==c.headers&&Object.assign(y,c.headers),Object.assign(y,this._headers),c.headers=y}send(c,y,v){var w;return __awaiter(this,void 0,void 0,(function*(){let C;const b=new MiddlewareControl(this._middlewareOptions);this.updateRequestOptions(y);const S=null===(w=this.config)||void 0===w?void 0:w.customHosts;try{C=(yield this.httpClient.sendRequest({request:c,options:y,middlewareControl:b,customHosts:S})).response;return yield GraphResponseHandler.getResponse(C,this._responseType,v)}catch(c){if(c instanceof GraphClientError)throw c;let y;C&&(y=C.status);throw yield GraphErrorHandler.getError(c,y,v)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const c=Object.keys(this._headers);for(const y of c)if("content-type"===y.toLowerCase())return;this.header("Content-Type","application/json")}header(c,y){return this._headers[c]=y,this}headers(c){for(const y in c)Object.prototype.hasOwnProperty.call(c,y)&&(this._headers[y]=c[y]);return this}option(c,y){return this._options[c]=y,this}options(c){for(const y in c)Object.prototype.hasOwnProperty.call(c,y)&&(this._options[y]=c[y]);return this}middlewareOptions(c){return this._middlewareOptions=c,this}version(c){return this.urlComponents.version=c,this}responseType(c){return this._responseType=c,this}select(c){return this.addCsvQueryParameter("$select",c,arguments),this}expand(c){return this.addCsvQueryParameter("$expand",c,arguments),this}orderby(c){return this.addCsvQueryParameter("$orderby",c,arguments),this}filter(c){return this.urlComponents.oDataQueryParams.$filter=c,this}search(c){return this.urlComponents.oDataQueryParams.$search=c,this}top(c){return this.urlComponents.oDataQueryParams.$top=c,this}skip(c){return this.urlComponents.oDataQueryParams.$skip=c,this}skipToken(c){return this.urlComponents.oDataQueryParams.$skipToken=c,this}count(c=!0){return this.urlComponents.oDataQueryParams.$count=c.toString(),this}query(c){return this.parseQueryParameter(c)}get(c){return __awaiter(this,void 0,void 0,(function*(){const y=this.buildFullUrl(),v={method:w.GET};return yield this.send(y,v,c)}))}post(c,y){return __awaiter(this,void 0,void 0,(function*(){const v=this.buildFullUrl(),C={method:w.POST,body:serializeContent(c)};return"FormData"===(c&&c.constructor&&c.constructor.name)?C.headers={}:(this.setHeaderContentType(),C.headers=this._headers),yield this.send(v,C,y)}))}create(c,y){return __awaiter(this,void 0,void 0,(function*(){return yield this.post(c,y)}))}put(c,y){return __awaiter(this,void 0,void 0,(function*(){const v=this.buildFullUrl();this.setHeaderContentType();const C={method:w.PUT,body:serializeContent(c)};return yield this.send(v,C,y)}))}patch(c,y){return __awaiter(this,void 0,void 0,(function*(){const v=this.buildFullUrl();this.setHeaderContentType();const C={method:w.PATCH,body:serializeContent(c)};return yield this.send(v,C,y)}))}update(c,y){return __awaiter(this,void 0,void 0,(function*(){return yield this.patch(c,y)}))}delete(c){return __awaiter(this,void 0,void 0,(function*(){const y=this.buildFullUrl(),v={method:w.DELETE};return yield this.send(y,v,c)}))}del(c){return __awaiter(this,void 0,void 0,(function*(){return yield this.delete(c)}))}getStream(c){return __awaiter(this,void 0,void 0,(function*(){const y=this.buildFullUrl(),v={method:w.GET};return this.responseType(K.STREAM),yield this.send(y,v,c)}))}putStream(c,y){return __awaiter(this,void 0,void 0,(function*(){const v=this.buildFullUrl(),C={method:w.PUT,headers:{"Content-Type":"application/octet-stream"},body:c};return yield this.send(v,C,y)}))}}class HTTPClient{constructor(...c){if(!c||!c.length){const c=new Error;throw c.name="InvalidMiddlewareChain",c.message="Please provide a default middleware chain or custom middleware chain",c}this.setMiddleware(...c)}setMiddleware(...c){c.length>1?this.parseMiddleWareArray(c):this.middleware=c[0]}parseMiddleWareArray(c){c.forEach(((y,v)=>{v<c.length-1&&y.setNext(c[v+1])})),this.middleware=c[0]}sendRequest(c){return __awaiter(this,void 0,void 0,(function*(){if("string"==typeof c.request&&void 0===c.options){const c=new Error;throw c.name="InvalidRequestOptions",c.message="Unable to execute the middleware, Please provide valid options for a request",c}return yield this.middleware.execute(c),c}))}}class HTTPClientFactory{static createWithAuthenticationProvider(c){const y=new AuthenticationHandler(c),v=new RetryHandler(new RetryHandlerOptions),w=new TelemetryHandler,C=new HTTPMessageHandler;if(y.setNext(v),"object"==typeof process){const c=new RedirectHandler(new RedirectHandlerOptions);v.setNext(c),c.setNext(w)}else v.setNext(w);return w.setNext(C),HTTPClientFactory.createWithMiddleware(y)}static createWithMiddleware(...c){return new HTTPClient(...c)}}class Client{constructor(c){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const c=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw c.name="PolyFillNotAvailable",c}if("undefined"==typeof Promise){const c=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw c.name="PolyFillNotAvailable",c}if("undefined"==typeof fetch){const c=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw c.name="PolyFillNotAvailable",c}})();for(const y in c)Object.prototype.hasOwnProperty.call(c,y)&&(this.config[y]=c[y]);let y;if(void 0!==c.authProvider&&void 0!==c.middleware){const c=new Error;throw c.name="AmbiguityInInitialization",c.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",c}if(void 0!==c.authProvider)y=HTTPClientFactory.createWithAuthenticationProvider(c.authProvider);else{if(void 0===c.middleware){const c=new Error;throw c.name="InvalidMiddlewareChain",c.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",c}y=new HTTPClient(...[].concat(c.middleware))}this.httpClient=y}static init(c){const y={};for(const v in c)Object.prototype.hasOwnProperty.call(c,v)&&(y[v]="authProvider"===v?new CustomAuthenticationProvider(c[v]):c[v]);return Client.initWithMiddleware(y)}static initWithMiddleware(c){return new Client(c)}api(c){return new GraphRequest(this.httpClient,this.config,c)}}},303:c=>{self,c.exports=(()=>{var c={22:(c,y,v)=>{var w=v(481),C=v(426),b=C;b.v1=w,b.v4=C,c.exports=b},725:c=>{for(var y=[],v=0;v<256;++v)y[v]=(v+256).toString(16).substr(1);c.exports=function(c,v){var w=v||0,C=y;return[C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]]].join("")}},157:c=>{var y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(y){var v=new Uint8Array(16);c.exports=function(){return y(v),v}}else{var w=new Array(16);c.exports=function(){for(var c,y=0;y<16;y++)0==(3&y)&&(c=4294967296*Math.random()),w[y]=c>>>((3&y)<<3)&255;return w}}},481:(c,y,v)=>{var w,C,b=v(157),S=v(725),T=0,I=0;c.exports=function(c,y,v){var P=y&&v||0,K=y||[],Q=(c=c||{}).node||w,X=void 0!==c.clockseq?c.clockseq:C;if(null==Q||null==X){var te=b();null==Q&&(Q=w=[1|te[0],te[1],te[2],te[3],te[4],te[5]]),null==X&&(X=C=16383&(te[6]<<8|te[7]))}var re=void 0!==c.msecs?c.msecs:(new Date).getTime(),ne=void 0!==c.nsecs?c.nsecs:I+1,oe=re-T+(ne-I)/1e4;if(oe<0&&void 0===c.clockseq&&(X=X+1&16383),(oe<0||re>T)&&void 0===c.nsecs&&(ne=0),ne>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");T=re,I=ne,C=X;var ie=(1e4*(268435455&(re+=122192928e5))+ne)%4294967296;K[P++]=ie>>>24&255,K[P++]=ie>>>16&255,K[P++]=ie>>>8&255,K[P++]=255&ie;var se=re/4294967296*1e4&268435455;K[P++]=se>>>8&255,K[P++]=255&se,K[P++]=se>>>24&15|16,K[P++]=se>>>16&255,K[P++]=X>>>8|128,K[P++]=255&X;for(var ue=0;ue<6;++ue)K[P+ue]=Q[ue];return y||S(K)}},426:(c,y,v)=>{var w=v(157),C=v(725);c.exports=function(c,y,v){var b=y&&v||0;"string"==typeof c&&(y="binary"===c?new Array(16):null,c=null);var S=(c=c||{}).random||(c.rng||w)();if(S[6]=15&S[6]|64,S[8]=63&S[8]|128,y)for(var T=0;T<16;++T)y[b+T]=S[T];return y||C(S)}},227:(c,y,v)=>{y.formatArgs=function(y){if(y[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+y[0]+(this.useColors?"%c ":" ")+"+"+c.exports.humanize(this.diff),!this.useColors)return;const v="color: "+this.color;y.splice(1,0,v,"color: inherit");let w=0,C=0;y[0].replace(/%[a-zA-Z%]/g,(c=>{"%%"!==c&&(w++,"%c"===c&&(C=w))})),y.splice(C,0,v)},y.save=function(c){try{c?y.storage.setItem("debug",c):y.storage.removeItem("debug")}catch(c){}},y.load=function(){let c;try{c=y.storage.getItem("debug")}catch(c){}return!c&&"undefined"!=typeof process&&"env"in process&&(c=process.env.DEBUG),c},y.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},y.storage=function(){try{return localStorage}catch(c){}}(),y.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),y.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],y.log=console.debug||console.log||(()=>{}),c.exports=v(447)(y);const{formatters:w}=c.exports;w.j=function(c){try{return JSON.stringify(c)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}},447:(c,y,v)=>{c.exports=function(c){function n(c){let y,v,w,C=null;function s(...c){if(!s.enabled)return;const v=s,w=Number(new Date),C=w-(y||w);v.diff=C,v.prev=y,v.curr=w,y=w,c[0]=n.coerce(c[0]),"string"!=typeof c[0]&&c.unshift("%O");let b=0;c[0]=c[0].replace(/%([a-zA-Z%])/g,((y,w)=>{if("%%"===y)return"%";b++;const C=n.formatters[w];if("function"==typeof C){const w=c[b];y=C.call(v,w),c.splice(b,1),b--}return y})),n.formatArgs.call(v,c),(v.log||n.log).apply(v,c)}return s.namespace=c,s.useColors=n.useColors(),s.color=n.selectColor(c),s.extend=o,s.destroy=n.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==C?C:(v!==n.namespaces&&(v=n.namespaces,w=n.enabled(c)),w),set:c=>{C=c}}),"function"==typeof n.init&&n.init(s),s}function o(c,y){const v=n(this.namespace+(void 0===y?":":y)+c);return v.log=this.log,v}function i(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(c){return c instanceof Error?c.stack||c.message:c},n.disable=function(){const c=[...n.names.map(i),...n.skips.map(i).map((c=>"-"+c))].join(",");return n.enable(""),c},n.enable=function(c){let y;n.save(c),n.namespaces=c,n.names=[],n.skips=[];const v=("string"==typeof c?c:"").split(/[\s,]+/),w=v.length;for(y=0;y<w;y++)v[y]&&("-"===(c=v[y].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+c.substr(1)+"$")):n.names.push(new RegExp("^"+c+"$")))},n.enabled=function(c){if("*"===c[c.length-1])return!0;let y,v;for(y=0,v=n.skips.length;y<v;y++)if(n.skips[y].test(c))return!1;for(y=0,v=n.names.length;y<v;y++)if(n.names[y].test(c))return!0;return!1},n.humanize=v(824),n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(c).forEach((y=>{n[y]=c[y]})),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(c){let y=0;for(let v=0;v<c.length;v++)y=(y<<5)-y+c.charCodeAt(v),y|=0;return n.colors[Math.abs(y)%n.colors.length]},n.enable(n.load()),n}},824:c=>{var y=1e3,v=60*y,w=60*v,C=24*w;function r(c){if(!((c=String(c)).length>100)){var b=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(b){var S=parseFloat(b[1]);switch((b[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*S;case"weeks":case"week":case"w":return 6048e5*S;case"days":case"day":case"d":return S*C;case"hours":case"hour":case"hrs":case"hr":case"h":return S*w;case"minutes":case"minute":case"mins":case"min":case"m":return S*v;case"seconds":case"second":case"secs":case"sec":case"s":return S*y;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return S;default:return}}}}function a(c){var b=Math.abs(c);return b>=C?Math.round(c/C)+"d":b>=w?Math.round(c/w)+"h":b>=v?Math.round(c/v)+"m":b>=y?Math.round(c/y)+"s":c+"ms"}function s(c){var b=Math.abs(c);return b>=C?l(c,b,C,"day"):b>=w?l(c,b,w,"hour"):b>=v?l(c,b,v,"minute"):b>=y?l(c,b,y,"second"):c+" ms"}function l(c,y,v,w){var C=y>=1.5*v;return Math.round(c/v)+" "+w+(C?"s":"")}c.exports=function(c,y){y=y||{};var v=typeof c;if("string"===v&&c.length>0)return r(c);if("number"===v&&isFinite(c))return y.long?s(c):a(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))}}},y={};function t(v){var w=y[v];if(void 0!==w)return w.exports;var C=y[v]={exports:{}};return c[v](C,C.exports,t),C.exports}t.d=(c,y)=>{for(var v in y)t.o(y,v)&&!t.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:y[v]})},t.o=(c,y)=>Object.prototype.hasOwnProperty.call(c,y),t.r=c=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var v={};return(()=>{"use strict";t.r(v),t.d(v,{ActionObjectType:()=>y,ChannelType:()=>de,ChildAppWindow:()=>tr,DialogDimension:()=>Q,ErrorCode:()=>C,FileOpenPreference:()=>c,FrameContexts:()=>I,HostClientType:()=>S,HostName:()=>T,NotificationTypes:()=>kt,ParentAppWindow:()=>rr,SecondaryM365ContentIdName:()=>w,TaskModuleDimension:()=>pe,TeamType:()=>P,UserSettingTypes:()=>Nt,UserTeamRole:()=>K,ViewerActionTypes:()=>Ot,app:()=>Je,appEntity:()=>cr,appInitialization:()=>Xt,appInstallDialog:()=>xt,authentication:()=>Ee,barCode:()=>Ft,calendar:()=>zt,call:()=>Zt,chat:()=>Ht,conversations:()=>Mt,dialog:()=>Ke,enablePrintCapability:()=>Jn,executeDeepLink:()=>ut,files:()=>or,geoLocation:()=>Bt,getContext:()=>Qn,getMruTabInstances:()=>lt,getTabInstances:()=>st,initialize:()=>Zn,initializeWithFrameContext:()=>ft,location:()=>qt,logs:()=>Rt,mail:()=>Wt,media:()=>Lt,meeting:()=>jt,meetingRoom:()=>ir,menus:()=>Ve,monetization:()=>Gt,navigateBack:()=>Ct,navigateCrossDomain:()=>ht,navigateToTab:()=>mt,notifications:()=>ar,openFilePreview:()=>Z,pages:()=>Qe,people:()=>Kt,print:()=>Kn,profile:()=>Vt,registerAppButtonClickHandler:()=>Yn,registerAppButtonHoverEnterHandler:()=>et,registerAppButtonHoverLeaveHandler:()=>nt,registerBackButtonHandler:()=>tt,registerBeforeUnloadHandler:()=>it,registerChangeSettingsHandler:()=>at,registerCustomHandler:()=>G,registerFocusEnterHandler:()=>rt,registerFullScreenHandler:()=>$n,registerOnLoadHandler:()=>ot,registerOnThemeChangeHandler:()=>Xn,registerUserSettingsChangeHandler:()=>q,remoteCamera:()=>sr,returnFocus:()=>gt,sendCustomEvent:()=>j,sendCustomMessage:()=>z,setFrameContext:()=>dt,settings:()=>er,shareDeepLink:()=>ct,sharing:()=>Yt,stageView:()=>Jt,tasks:()=>nr,teams:()=>ur,teamsCore:()=>$e,uploadCustomApp:()=>B,video:()=>$t,webStorage:()=>Qt});var c,y,w,C,b,S,T,I,P,K,Q,X="2.2.0",te="2.0.1",re="2.0.3",ne="1.9.0",oe="1.8.0",ie=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","msft.spoppe.com","*.sharepoint.com","*.sharepoint-df.com","*.sharepointonline.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","*.teams.microsoft.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.office.com"],se=/^https:\/\//,ue=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}();!function(c){c.Inline="inline",c.Desktop="desktop",c.Web="web"}(c||(c={})),function(c){c.M365Content="m365content"}(y||(y={})),function(c){c.DriveId="driveId",c.GroupId="groupId",c.SiteId="siteId",c.UserId="userId"}(w||(w={})),function(c){c[c.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",c[c.INTERNAL_ERROR=500]="INTERNAL_ERROR",c[c.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",c[c.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",c[c.NETWORK_ERROR=2e3]="NETWORK_ERROR",c[c.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",c[c.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",c[c.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",c[c.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",c[c.THROTTLE=7e3]="THROTTLE",c[c.USER_ABORT=8e3]="USER_ABORT",c[c.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",c[c.OLD_PLATFORM=9e3]="OLD_PLATFORM",c[c.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",c[c.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(C||(C={})),function(c){c.GeoLocation="geolocation",c.Media="media"}(b||(b={})),function(c){c.desktop="desktop",c.web="web",c.android="android",c.ios="ios",c.ipados="ipados",c.rigel="rigel",c.surfaceHub="surfaceHub",c.teamsRoomsWindows="teamsRoomsWindows",c.teamsRoomsAndroid="teamsRoomsAndroid",c.teamsPhones="teamsPhones",c.teamsDisplays="teamsDisplays"}(S||(S={})),function(c){c.office="Office",c.outlook="Outlook",c.orange="Orange",c.teams="Teams"}(T||(T={})),function(c){c.settings="settings",c.content="content",c.authentication="authentication",c.remove="remove",c.task="task",c.sidePanel="sidePanel",c.stage="stage",c.meetingStage="meetingStage"}(I||(I={})),function(c){c[c.Standard=0]="Standard",c[c.Edu=1]="Edu",c[c.Class=2]="Class",c[c.Plc=3]="Plc",c[c.Staff=4]="Staff"}(P||(P={})),function(c){c[c.Admin=0]="Admin",c[c.User=1]="User",c[c.Guest=2]="Guest"}(K||(K={})),function(c){c.Large="large",c.Medium="medium",c.Small="small"}(Q||(Q={}));var de,pe=Q;!function(c){c.Regular="Regular",c.Private="Private",c.Shared="Shared"}(de||(de={}));var Ee,Ie={errorCode:C.NOT_SUPPORTED_ON_PLATFORM},Ue=t(22);function E(c,y){if("*."===c.substring(0,2)){var v=c.substring(1);if(y.length>v.length&&y.split(".").length===v.split(".").length&&y.substring(y.length-v.length)===v)return!0}else if(c===y)return!0;return!1}function F(c){if("https:"!==c.protocol)return!1;var y=c.host;if(ie.some((function(c){return E(c,y)})))return!0;for(var v=0,w=ue.additionalValidOrigins;v<w.length;v++){var C=w[v];if(E("https://"===C.substring(0,8)?C.substring(8):C,y))return!0}return!1}function k(c){return function(y,v){if(!y)throw new Error(c||v)}}function R(c,y){if("string"!=typeof c||"string"!=typeof y)return NaN;var v=c.split("."),w=y.split(".");function i(c){return/^\d+$/.test(c)}if(!v.every(i)||!w.every(i))return NaN;for(;v.length<w.length;)v.push("0");for(;w.length<v.length;)w.push("0");for(var C=0;C<v.length;++C)if(Number(v[C])!=Number(w[C]))return Number(v[C])>Number(w[C])?1:-1;return 0}function O(){return Ue.v4()}function A(c){return Object.keys(c).forEach((function(y){"object"==typeof c[y]&&A(c[y])})),Object.freeze(c)}function M(c,y){for(var v=[],w=2;w<arguments.length;w++)v[w-2]=arguments[w];var C=c.apply(void 0,v);return C.then((function(c){y&&y(void 0,c)})).catch((function(c){y&&y(c)})),C}function N(c,y){for(var v=[],w=2;w<arguments.length;w++)v[w-2]=arguments[w];var C=c.apply(void 0,v);return C.then((function(){y&&y(null)})).catch((function(c){y&&y(c)})),C}function D(c,y){for(var v=[],w=2;w<arguments.length;w++)v[w-2]=arguments[w];var C=c.apply(void 0,v);return C.then((function(c){y&&y(null,c)})).catch((function(c){y&&y(c,null)})),C}function L(c,y,v){return new Promise((function(w,C){var b=setTimeout(C,y,v);c().then((function(c){clearTimeout(b),w(c)})).catch((function(c){clearTimeout(b),C(c)}))}))}function U(c){var y=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(c.appId)+"/"+encodeURIComponent(c.pageId));return c.webUrl&&y.searchParams.append("webUrl",c.webUrl),(c.channelId||c.subPageId)&&y.searchParams.append("context",JSON.stringify({channelId:c.channelId,subEntityId:c.subPageId})),y.toString()}function H(){for(var c=[],y=0;y<arguments.length;y++)c[y]=arguments[y];if(!ue.initializeCalled)throw new Error("The library has not yet been initialized");if(ue.frameContext&&c&&c.length>0){for(var v=!1,w=0;w<c.length;w++)if(c[w]===ue.frameContext){v=!0;break}if(!v)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(c)+'. Current context: "'+ue.frameContext+'".')}}function W(c){void 0===c&&(c=te);var y=R(ue.clientSupportedSDKVersion,c);return!isNaN(y)&&y>=0}function _(){return ue.hostClientType==S.android||ue.hostClientType==S.ios}function x(c){if(void 0===c&&(c=te),!_())throw{errorCode:C.NOT_SUPPORTED_ON_PLATFORM};if(!W(c))throw{errorCode:C.OLD_PLATFORM}}function V(c){var y=ue.additionalValidOrigins.concat(c.filter((function(c){return"string"==typeof c&&se.test(c)}))),v={};y=y.filter((function(c){return!v[c]&&(v[c]=!0,!0)})),ue.additionalValidOrigins=y}function B(c,y){H(),Le("uploadCustomApp",[c],y||k())}function z(c,y,v){H(),Le(c,y,v)}function j(c,y){if(H(),!Pe.childWindow)throw new Error("The child window has not yet been initialized or is not present");tn(c,y)}function G(c,y){var v=this;H(),me(c,(function(){for(var c=[],w=0;w<arguments.length;w++)c[w]=arguments[w];return y.apply(v,c)}))}function q(c,y){H(),me("userSettingsChange",y,!0,[c])}function Z(c){H(I.content,I.task),Le("openFilePreview",[c.entityId,c.title,c.description,c.type,c.objectUrl,c.downloadUrl,c.webPreviewUrl,c.webEditUrl,c.baseUrl,c.editFile,c.subEntityId,c.viewerAction,c.fileOpenPreference,c.conversationId])}!function(c){var y,v,w;function i(c){return new Promise((function(v,w){if(ue.hostClientType===S.desktop||ue.hostClientType===S.android||ue.hostClientType===S.ios||ue.hostClientType===S.rigel||ue.hostClientType===S.teamsRoomsWindows||ue.hostClientType===S.teamsRoomsAndroid||ue.hostClientType===S.teamsPhones||ue.hostClientType===S.teamsDisplays){var C=document.createElement("a");C.href=c.url,v(Ne("authentication.authenticate",[C.href,c.width,c.height,c.isExternal]).then((function(c){var y=c[0],v=c[1];if(y)return v;throw new Error(v)})))}else y={success:v,fail:w},u(c)}))}function r(c){return new Promise((function(y){y(Ne("authentication.getAuthToken",[null==c?void 0:c.resources,null==c?void 0:c.claims,null==c?void 0:c.silent]))})).then((function(c){var y=c[0],v=c[1];if(y)return v;throw new Error(v)}))}function a(){return new Promise((function(c){c(Ne("authentication.getUser"))})).then((function(c){var y=c[0],v=c[1];if(y)return v;throw new Error(v)}))}function l(){d();try{Pe.childWindow&&Pe.childWindow.close()}finally{Pe.childWindow=null,Pe.childOrigin=null}}function u(c){l();var y=c.width||600,v=c.height||400;y=Math.min(y,Pe.currentWindow.outerWidth-400),v=Math.min(v,Pe.currentWindow.outerHeight-200);var w=document.createElement("a");w.href=c.url.replace("{oauthRedirectMethod}","web");var C=void 0!==Pe.currentWindow.screenLeft?Pe.currentWindow.screenLeft:Pe.currentWindow.screenX,b=void 0!==Pe.currentWindow.screenTop?Pe.currentWindow.screenTop:Pe.currentWindow.screenY;C+=Pe.currentWindow.outerWidth/2-y/2,b+=Pe.currentWindow.outerHeight/2-v/2,Pe.childWindow=Pe.currentWindow.open(w.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+b+", left="+C+", width="+y+", height="+v),Pe.childWindow?f():g("FailedToOpenWindow")}function d(){v&&(clearInterval(v),v=0),he("initialize"),he("navigateCrossDomain")}function f(){d(),v=Pe.currentWindow.setInterval((function(){if(!Pe.childWindow||Pe.childWindow.closed)g("CancelledByUser");else{var c=Pe.childOrigin;try{Pe.childOrigin="*",tn("ping")}finally{Pe.childOrigin=c}}}),100),me("initialize",(function(){return[I.authentication,ue.hostClientType]})),me("navigateCrossDomain",(function(){return!1}))}function p(c){try{y&&y.success(c)}finally{y=null,l()}}function g(c){try{y&&y.fail(new Error(c))}finally{y=null,l()}}function m(c,y,v){if(c){var w=document.createElement("a");w.href=decodeURIComponent(c),w.host&&w.host!==window.location.host&&"outlook.office.com"===w.host&&w.search.indexOf("client_type=Win32_Outlook")>-1&&(y&&"result"===y&&(v&&(w.href=h(w.href,"result",v)),Pe.currentWindow.location.assign(h(w.href,"authSuccess",""))),y&&"reason"===y&&(v&&(w.href=h(w.href,"reason",v)),Pe.currentWindow.location.assign(h(w.href,"authFailure",""))))}}function h(c,y,v){var w=c.indexOf("#"),C=-1===w?"#":c.substr(w);return C=C+"&"+y+(""!==v?"="+v:""),(c=-1===w?c:c.substr(0,w))+C}c.initialize=function(){me("authentication.authenticate.success",p,!1),me("authentication.authenticate.failure",g,!1)},c.registerAuthenticationHandlers=function(c){w=c},c.authenticate=function(c){var y=void 0!==c,v=y?c:w;if(!v)throw new Error("No parameters are provided for authentication");return H(I.content,I.sidePanel,I.settings,I.remove,I.task,I.stage,I.meetingStage),i(v).then((function(c){try{return v&&v.successCallback?(v.successCallback(c),""):c}finally{y||(w=null)}})).catch((function(c){try{if(v&&v.failureCallback)return v.failureCallback(c.message),"";throw c}finally{y||(w=null)}}))},c.getAuthToken=function(c){return H(),r(c).then((function(y){return c&&c.successCallback?(c.successCallback(y),""):y})).catch((function(y){if(c&&c.failureCallback)return c.failureCallback(y.message),"";throw y}))},c.getUser=function(c){return H(),a().then((function(y){return c&&c.successCallback?(c.successCallback(y),null):y})).catch((function(y){if(c&&c.failureCallback)return c.failureCallback(y.message),null;throw y}))},c.notifySuccess=function(c,y){m(y,"result",c),H(I.authentication),Le("authentication.authenticate.success",[c]),en(Pe.parentWindow,(function(){return setTimeout((function(){return Pe.currentWindow.close()}),200)}))},c.notifyFailure=function(c,y){m(y,"reason",c),H(I.authentication),Le("authentication.authenticate.failure",[c]),en(Pe.parentWindow,(function(){return setTimeout((function(){return Pe.currentWindow.close()}),200)}))}}(Ee||(Ee={}));var Ke,Ve,$e,Je,Qe,J=function(){return J=Object.assign||function(c){for(var y,v=1,w=arguments.length;v<w;v++)for(var C in y=arguments[v])Object.prototype.hasOwnProperty.call(y,C)&&(c[C]=y[C]);return c},J.apply(this,arguments)},Ze={apiVersion:1,supports:{appInstallDialog:void 0,barCode:void 0,calendar:void 0,call:void 0,chat:void 0,webStorage:void 0,conversations:void 0,dialog:{bot:void 0,update:void 0},geoLocation:{map:void 0},location:void 0,logs:void 0,mail:void 0,meetingRoom:void 0,menus:void 0,monetization:void 0,notifications:void 0,pages:{appButton:void 0,tabs:void 0,config:void 0,backStack:void 0,fullTrust:void 0},people:void 0,permissions:void 0,profile:void 0,remoteCamera:void 0,sharing:void 0,stageView:void 0,teams:{fullTrust:{joinedTeams:void 0}},teamsCore:void 0,video:void 0}},Xe={appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{bot:{},update:{}},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{appButton:{},tabs:{},config:{},backStack:{},fullTrust:{}},remoteCamera:{},sharing:{},stageView:{},teams:{fullTrust:{}},teamsCore:{},video:{}},yt=[S.desktop,S.web,S.android,S.ios,S.rigel,S.surfaceHub,S.teamsRoomsWindows,S.teamsRoomsAndroid,S.teamsPhones,S.teamsDisplays],vt={"1.9.0":[{capability:{location:{}},hostClientTypes:yt}],"2.0.0":[{capability:{people:{}},hostClientTypes:yt}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[S.android,S.teamsRoomsAndroid,S.teamsPhones,S.teamsDisplays]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[S.android,S.ios]}]};function Y(c){var y=J({},Xe);return Object.keys(vt).forEach((function(v){R(c,v)>=0&&vt[v].forEach((function(c){c.hostClientTypes.includes(ue.hostClientType)&&(y=J(J({},y),c.capability))}))})),{apiVersion:1,isLegacyTeams:!0,supports:y}}function ee(c){Ze=A(c)}function ae(c){return{actionInfo:c.actionInfo,app:{locale:c.locale,sessionId:c.appSessionId?c.appSessionId:"",theme:c.theme?c.theme:"default",iconPositionVertical:c.appIconPosition,osLocaleInfo:c.osLocaleInfo,parentMessageId:c.parentMessageId,userClickTime:c.userClickTime,userFileOpenPreference:c.userFileOpenPreference,host:{name:c.hostName?c.hostName:T.teams,clientType:c.hostClientType?c.hostClientType:S.web,sessionId:c.sessionId?c.sessionId:"",ringId:c.ringId},appLaunchId:c.appLaunchId},page:{id:c.entityId,frameContext:c.frameContext?c.frameContext:ue.frameContext,subPageId:c.subEntityId,isFullScreen:c.isFullScreen,isMultiWindow:c.isMultiWindow,sourceOrigin:c.sourceOrigin},user:{id:c.userObjectId,displayName:c.userDisplayName,isCallingAllowed:c.isCallingAllowed,isPSTNCallingAllowed:c.isPSTNCallingAllowed,licenseType:c.userLicenseType,loginHint:c.loginHint,userPrincipalName:c.userPrincipalName,tenant:c.tid?{id:c.tid,teamsSku:c.tenantSKU}:void 0},channel:c.channelId?{id:c.channelId,displayName:c.channelName,relativeUrl:c.channelRelativeUrl,membershipType:c.channelType,defaultOneNoteSectionId:c.defaultOneNoteSectionId,ownerGroupId:c.hostTeamGroupId,ownerTenantId:c.hostTeamTenantId}:void 0,chat:c.chatId?{id:c.chatId}:void 0,meeting:c.meetingId?{id:c.meetingId}:void 0,sharepoint:c.sharepoint,team:c.teamId?{internalId:c.teamId,displayName:c.teamName,type:c.teamType,groupId:c.groupId,templateId:c.teamTemplateId,isArchived:c.isTeamArchived,userRole:c.userTeamRole}:void 0,sharePointSite:c.teamSiteUrl||c.teamSiteDomain||c.teamSitePath||c.mySitePath||c.mySiteDomain?{teamSiteUrl:c.teamSiteUrl,teamSiteDomain:c.teamSiteDomain,teamSitePath:c.teamSitePath,teamSiteId:c.teamSiteId,mySitePath:c.mySitePath,mySiteDomain:c.mySiteDomain}:void 0}}!function(c){var y=[];function t(c){ue.frameContext&&(ue.frameContext===I.task?y.push(c):he("messageForChild"))}function o(){return!!Ze.supports.dialog}function i(c){return{url:c.url,height:c.size?c.size.height:Q.Small,width:c.size?c.size.width:Q.Small,title:c.title,fallbackUrl:c.fallbackUrl}}function r(c){return{url:c.url,height:c.size?c.size.height:Q.Small,width:c.size?c.size.width:Q.Small,title:c.title,fallbackUrl:c.fallbackUrl,completionBotId:c.completionBotId}}c.initialize=function(){me("messageForChild",t,!1)},c.open=function(c,y,v){if(H(I.content,I.sidePanel,I.meetingStage),!o())throw Ie;v&&me("messageForParent",v),Le("tasks.startTask",[i(c)],(function(c,v){null==y||y({err:c,result:v}),he("messageForParent")}))},c.submit=function(c,y){if(H(I.content,I.sidePanel,I.task,I.meetingStage),!o())throw Ie;Le("tasks.completeTask",[c,y?Array.isArray(y)?y:[y]:[]])},c.sendMessageToParentFromDialog=function(c){if(H(I.task),!o())throw Ie;Le("messageForParent",[c])},c.sendMessageToDialog=function(c){if(H(I.content,I.sidePanel,I.meetingStage),!o())throw Ie;Le("messageForChild",[c])},c.registerOnMessageFromParent=function(c){if(H(I.task),!o())throw Ie;for(he("messageForChild"),me("messageForChild",c),y.reverse();y.length>0;)c(y.pop())},c.isSupported=o,function(c){function n(){return!!Ze.supports.dialog&&!!Ze.supports.dialog.update}c.resize=function(c){if(H(I.content,I.sidePanel,I.task,I.meetingStage),!n())throw Ie;Le("tasks.updateTask",[c])},c.isSupported=n}(c.update||(c.update={})),function(c){function n(){return!!Ze.supports.dialog&&!!Ze.supports.dialog.bot}c.open=function(c,y,v){if(H(I.content,I.sidePanel,I.meetingStage),!n())throw Ie;v&&me("messageForParent",v),Le("tasks.startTask",[r(c)],(function(c,v){null==y||y({err:c,result:v}),he("messageForParent")}))},c.isSupported=n}(c.bot||(c.bot={})),c.getDialogInfoFromUrlDialogInfo=i,c.getDialogInfoFromBotUrlDialogInfo=r}(Ke||(Ke={})),function(c){!function(c){c[c.ifRoom=0]="ifRoom",c[c.overflowOnly=1]="overflowOnly"}(c.DisplayMode||(c.DisplayMode={}));var y,v,w,i=function(){this.enabled=!0,this.selected=!1};function r(c){w&&w(c)||(H(),Le("viewConfigItemPress",[c]))}function a(c){y&&y(c)||(H(),Le("handleNavBarMenuItemPress",[c]))}function s(c){v&&v(c)||(H(),Le("handleActionMenuItemPress",[c]))}function l(){return!!Ze.supports.menus}c.MenuItem=i,function(c){c.dropDown="dropDown",c.popOver="popOver"}(c.MenuListType||(c.MenuListType={})),c.initialize=function(){me("navBarMenuItemPress",a,!1),me("actionMenuItemPress",s,!1),me("setModuleView",r,!1)},c.setUpViews=function(c,y){if(H(),!l())throw Ie;w=y,Le("setUpViews",[c])},c.setNavBarMenu=function(c,v){if(H(),!l())throw Ie;y=v,Le("setNavBarMenu",[c])},c.showActionMenu=function(c,y){if(H(),!l())throw Ie;v=y,Le("showActionMenu",[c])},c.isSupported=l}(Ve||(Ve={})),function(c){function n(){window.print()}function t(){return!!Ze.supports.teamsCore}c.enablePrintCapability=function(){if(!ue.printCapabilityEnabled){if(H(),!t())throw Ie;ue.printCapabilityEnabled=!0,document.addEventListener("keydown",(function(c){(c.ctrlKey||c.metaKey)&&80===c.keyCode&&(n(),c.cancelBubble=!0,c.preventDefault(),c.stopImmediatePropagation())}))}},c.print=n,c.registerOnLoadHandler=function(c){if(H(),!t())throw Ie;ve(c)},c.registerBeforeUnloadHandler=function(c){if(H(),!t())throw Ie;Se(c)},c.isSupported=t}($e||($e={})),function(c){function n(c){return new Promise((function(y){ue.initializeCalled||(ue.initializeCalled=!0,fe(),ue.initializePromise=Fe(c).then((function(c){var y=c.context,v=c.clientType,w=c.runtimeConfig,C=c.clientSupportedSDKVersion,b=void 0===C?te:C;ue.frameContext=y,ue.hostClientType=v,ue.clientSupportedSDKVersion=b;try{if(!(S=JSON.parse(w))||!S.apiVersion)throw new Error("Received runtime config is invalid");w&&ee(S)}catch(c){if(!(c instanceof SyntaxError))throw c;try{isNaN(R(w,te))||(ue.clientSupportedSDKVersion=w);var S=JSON.parse(b);b&&ee(S)}catch(c){if(!(c instanceof SyntaxError))throw c;ee(Y(ue.clientSupportedSDKVersion))}}ue.initializeCompleted=!0})),Ee.initialize(),Ve.initialize(),Qe.config.initialize(),Ke.initialize()),Array.isArray(c)&&V(c),y(ue.initializePromise)}))}function t(c){H(),Ce(c)}c.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(c){c.AuthFailed="AuthFailed",c.Timeout="Timeout",c.Other="Other"}(c.FailedReason||(c.FailedReason={})),function(c){c.PermissionError="PermissionError",c.NotFound="NotFound",c.Throttling="Throttling",c.Offline="Offline",c.Other="Other"}(c.ExpectedFailureReason||(c.ExpectedFailureReason={})),c.isInitialized=function(){return ue.initializeCalled},c.getFrameContext=function(){return ue.frameContext},c.initialize=function(c){return L((function(){return n(c)}),5e3,new Error("SDK initialization timed out."))},c._initialize=function(c){Pe.currentWindow=c},c._uninitialize=function(){ue.initializeCalled&&(ue.frameContext&&(t(null),Qe.backStack.registerBackButtonHandler(null),Qe.registerFullScreenHandler(null),$e.registerBeforeUnloadHandler(null),$e.registerOnLoadHandler(null),Rt.registerGetLogHandler(null)),ue.frameContext===I.settings&&Qe.config.registerOnSaveHandler(null),ue.frameContext===I.remove&&Qe.config.registerOnRemoveHandler(null),ue.initializeCalled=!1,ue.initializeCompleted=!1,ue.initializePromise=null,ue.additionalValidOrigins=[],ue.frameContext=null,ue.hostClientType=null,ue.isFramelessWindow=!1,ke())},c.getContext=function(){return new Promise((function(c){H(),c(Re("getContext"))})).then((function(c){return ae(c)}))},c.notifyAppLoaded=function(){H(),Le(c.Messages.AppLoaded,[X])},c.notifySuccess=function(){H(),Le(c.Messages.Success,[X])},c.notifyFailure=function(y){H(),Le(c.Messages.Failure,[y.reason,y.message])},c.notifyExpectedFailure=function(y){H(),Le(c.Messages.ExpectedFailure,[y.reason,y.message])},c.registerOnThemeChangeHandler=t,c.openLink=function(c){return new Promise((function(y){H(I.content,I.sidePanel,I.settings,I.task,I.stage,I.meetingStage),y(Oe("executeDeepLink",c))}))}}(Je||(Je={})),function(c){function n(c){if(H(I.content),!t())throw Ie;Le("setFrameContext",[c])}function t(){return!!Ze.supports.pages}c.returnFocus=function(c){if(H(),!t())throw Ie;Le("returnFocus",[c])},c.registerFocusEnterHandler=function(c){if(H(),!t())throw Ie;me("focusEnter",c)},c.setCurrentFrame=n,c.initializeWithFrameContext=function(c,y,v){Je.initialize(v).then((function(){return y&&y()})),n(c)},c.getConfig=function(){return new Promise((function(c){if(H(I.content,I.settings,I.remove,I.sidePanel),!t())throw Ie;c(Re("settings.getSettings"))}))},c.navigateCrossDomain=function(c){return new Promise((function(y){if(H(I.content,I.sidePanel,I.settings,I.remove,I.task,I.stage,I.meetingStage),!t())throw Ie;y(Ae("navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",c))}))},c.navigateToApp=function(c){return new Promise((function(y){if(H(I.content,I.sidePanel,I.settings,I.task,I.stage,I.meetingStage),!t())throw Ie;Ze.isLegacyTeams?y(Oe("executeDeepLink",U(c))):y(Oe("pages.navigateToApp",c))}))},c.shareDeepLink=function(c){if(H(I.content,I.sidePanel,I.meetingStage),!t())throw Ie;Le("shareDeepLink",[c.subPageId,c.subPageLabel,c.subPageWebUrl])},c.registerFullScreenHandler=function(c){if(H(),!t())throw Ie;me("fullScreenChange",c)},c.isSupported=t,function(c){function n(){return!!Ze.supports.pages&&!!Ze.supports.pages.tabs}c.navigateToTab=function(c){return new Promise((function(y){if(H(),!n())throw Ie;y(Ae("navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",c))}))},c.getTabInstances=function(c){return new Promise((function(y){if(H(),!n())throw Ie;y(Re("getTabInstances",c))}))},c.getMruTabInstances=function(c){return new Promise((function(y){if(H(),!n())throw Ie;y(Re("getMruTabInstances",c))}))},c.isSupported=n}(c.tabs||(c.tabs={})),function(c){var y,v;function o(c){var v=new w(c);y?y(v):v.notifySuccess()}c.initialize=function(){me("settings.save",o,!1),me("settings.remove",r,!1)},c.setValidityState=function(c){if(H(I.settings,I.remove),!s())throw Ie;Le("settings.setValidityState",[c])},c.setConfig=function(c){return new Promise((function(y){if(H(I.content,I.settings,I.sidePanel),!s())throw Ie;y(Oe("settings.setSettings",c))}))},c.registerOnSaveHandler=function(c){if(H(I.settings),!s())throw Ie;y=c,c&&Le("registerHandler",["save"])},c.registerOnRemoveHandler=function(c){if(H(I.remove,I.settings),!s())throw Ie;v=c,c&&Le("registerHandler",["remove"])},c.registerChangeConfigHandler=function(c){if(H(I.content),!s())throw Ie;me("changeSettings",c)};var w=function(){function e(c){this.notified=!1,this.result=c||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),Le("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(c){this.ensureNotNotified(),Le("settings.save.failure",[c]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function r(){var c=new C;v?v(c):c.notifySuccess()}var C=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),Le("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(c){this.ensureNotNotified(),Le("settings.remove.failure",[c]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}();function s(){return!!Ze.supports.pages&&!!Ze.supports.pages.config}c.isSupported=s}(c.config||(c.config={})),function(c){var y;function t(){return new Promise((function(c){if(H(),!i())throw Ie;c(Ae("navigateBack","Back navigation is not supported in the current client or context."))}))}function o(){y&&y()||t()}function i(){return!!Ze.supports.pages&&!!Ze.supports.pages.backStack}c._initialize=function(){me("backButtonPress",o,!1)},c.navigateBack=t,c.registerBackButtonHandler=function(c){if(H(),!i())throw Ie;y=c,c&&Le("registerHandler",["backButton"])},c.isSupported=i}(c.backStack||(c.backStack={})),function(c){function n(){return!!Ze.supports.pages&&!!Ze.supports.pages.fullTrust}c.enterFullscreen=function(){if(H(I.content),!n())throw Ie;Le("enterFullscreen",[])},c.exitFullscreen=function(){if(H(I.content),!n())throw Ie;Le("exitFullscreen",[])},c.isSupported=n}(c.fullTrust||(c.fullTrust={})),function(c){function n(){return!!Ze.supports.pages&&!!Ze.supports.pages.appButton}c.onClick=function(c){if(H(I.content),!n())throw Ie;me("appButtonClick",c)},c.onHoverEnter=function(c){if(H(I.content),!n())throw Ie;me("appButtonHoverEnter",c)},c.onHoverLeave=function(c){if(H(I.content),!n())throw Ie;me("appButtonHoverLeave",c)},c.isSupported=n}(c.appButton||(c.appButton={}))}(Qe||(Qe={}));var wt=(0,t(227).debug)("teamsJs");function le(c){return wt.extend(c)}var ce=function(c,y,v){if(v||2===arguments.length)for(var w,C=0,b=y.length;C<b;C++)!w&&C in y||(w||(w=Array.prototype.slice.call(y,0,C)),w[C]=y[C]);return c.concat(w||Array.prototype.slice.call(y))},Et=le("handlers"),_t=function(){function e(){}return e.handlers={},e}();function fe(){_t.handlers.themeChange=we,_t.handlers.load=ye,_t.handlers.beforeUnload=be,Qe.backStack._initialize()}var bt=Et.extend("callHandler");function ge(c,y){var v=_t.handlers[c];return v?(bt("Invoking the registered handler for message %s with arguments %o",c,y),[!0,v.apply(this,y)]):(bt("Handler for action message %s not found.",c),[!1,void 0])}function me(c,y,v,w){void 0===v&&(v=!0),void 0===w&&(w=[]),y?(_t.handlers[c]=y,v&&Le("registerHandler",ce([c],w,!0))):delete _t.handlers[c]}function he(c){delete _t.handlers[c]}function Ce(c){_t.themeChangeHandler=c,c&&Le("registerHandler",["themeChange"])}function we(c){_t.themeChangeHandler&&_t.themeChangeHandler(c),Pe.childWindow&&tn("themeChange",[c])}function ve(c){_t.loadHandler=c,c&&Le("registerHandler",["load"])}function ye(c){_t.loadHandler&&_t.loadHandler(c),Pe.childWindow&&tn("load",[c])}function Se(c){_t.beforeUnloadHandler=c,c&&Le("registerHandler",["beforeUnload"])}function be(){var e=function(){Le("readyToUnload",[])};_t.beforeUnloadHandler&&_t.beforeUnloadHandler(e)||e()}var Te=function(c,y,v){if(v||2===arguments.length)for(var w,C=0,b=y.length;C<b;C++)!w&&C in y||(w||(w=Array.prototype.slice.call(y,0,C)),w[C]=y[C]);return c.concat(w||Array.prototype.slice.call(y))},St=le("communication"),Pe=function(){},Tt=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e.promiseCallbacks={},e}();function Fe(c){if(Tt.messageListener=function(c){return We(c)},Pe.currentWindow=Pe.currentWindow||window,Pe.parentWindow=Pe.currentWindow.parent!==Pe.currentWindow.self?Pe.currentWindow.parent:Pe.currentWindow.opener,(Pe.parentWindow||c)&&Pe.currentWindow.addEventListener("message",Tt.messageListener,!1),!Pe.parentWindow){var y=Pe.currentWindow;if(!y.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));ue.isFramelessWindow=!0,y.onNativeMessage=Be}try{return Pe.parentOrigin="*",Ne("initialize",[X]).then((function(c){return{context:c[0],clientType:c[1],runtimeConfig:c[2],clientSupportedSDKVersion:c[3]}}))}finally{Pe.parentOrigin=null}}function ke(){Pe.currentWindow.removeEventListener("message",Tt.messageListener,!1),Pe.parentWindow=null,Pe.parentOrigin=null,Pe.childWindow=null,Pe.childOrigin=null,Tt.parentMessageQueue=[],Tt.childMessageQueue=[],Tt.nextMessageId=0,Tt.callbacks={}}function Re(c){for(var y=[],v=1;v<arguments.length;v++)y[v-1]=arguments[v];return Ne(c,y).then((function(c){return c[0]}))}function Oe(c){for(var y=[],v=1;v<arguments.length;v++)y[v-1]=arguments[v];return Ne(c,y).then((function(c){var y=c[0],v=c[1];if(!y)throw new Error(v)}))}function Ae(c,y){for(var v=[],w=2;w<arguments.length;w++)v[w-2]=arguments[w];return Ne(c,v).then((function(c){var v=c[0],w=c[1];if(!v)throw new Error(w||y)}))}function Me(c){for(var y=[],v=1;v<arguments.length;v++)y[v-1]=arguments[v];return Ne(c,y).then((function(c){var y=c[0],v=c[1];if(y)throw y;return v}))}function Ne(c,y){return void 0===y&&(y=void 0),new Promise((function(v){v(De(He(c,y).id))}))}function De(c){return new Promise((function(y){Tt.promiseCallbacks[c]=y}))}function Le(c,y,v){var w;y instanceof Function?v=y:y instanceof Array&&(w=y);var C=He(c,w);v&&(Tt.callbacks[C.id]=v)}var At=St.extend("sendMessageToParentHelper");function He(c,y){var v=At,w=Pe.parentWindow,C=on(c,y);if(v("Message %i information: %o",C.id,{actionName:c,args:y}),ue.isFramelessWindow)Pe.currentWindow&&Pe.currentWindow.nativeInterface&&(v("Sending message %i to parent via framelessPostMessage interface",C.id),Pe.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(C)));else{var b=qe(w);w&&b?(v("Sending message %i to parent via postMessage",C.id),w.postMessage(C,b)):(v("Adding message %i to parent message queue",C.id),Ge(w).push(C))}return C}function We(c){if(c&&c.data&&"object"==typeof c.data){var y=c.source||c.originalEvent&&c.originalEvent.source,v=c.origin||c.originalEvent&&c.originalEvent.origin;_e(y,v)&&(xe(y,v),y===Pe.parentWindow?Be(c):y===Pe.childWindow&&je(c))}}function _e(c,y){return(!Pe.currentWindow||c!==Pe.currentWindow)&&(!!(Pe.currentWindow&&Pe.currentWindow.location&&y&&y===Pe.currentWindow.location.origin)||F(new URL(y)))}function xe(c,y){ue.isFramelessWindow||Pe.parentWindow&&!Pe.parentWindow.closed&&c!==Pe.parentWindow?Pe.childWindow&&!Pe.childWindow.closed&&c!==Pe.childWindow||(Pe.childWindow=c,Pe.childOrigin=y):(Pe.parentWindow=c,Pe.parentOrigin=y),Pe.parentWindow&&Pe.parentWindow.closed&&(Pe.parentWindow=null,Pe.parentOrigin=null),Pe.childWindow&&Pe.childWindow.closed&&(Pe.childWindow=null,Pe.childOrigin=null),Ye(Pe.parentWindow),Ye(Pe.childWindow)}var It=St.extend("handleParentMessage");function Be(c){var y=It;if("id"in c.data&&"number"==typeof c.data.id){var v=c.data,w=Tt.callbacks[v.id];y("Received a response from parent for message %i",v.id),w&&(y("Invoking the registered callback for message %i with arguments %o",v.id,v.args),w.apply(null,Te(Te([],v.args,!0),[v.isPartialResponse],!1)),ze(c)||(y("Removing registered callback for message %i",v.id),delete Tt.callbacks[v.id]));var C=Tt.promiseCallbacks[v.id];C&&(y("Invoking the registered promise callback for message %i with arguments %o",v.id,v.args),C(v.args),y("Removing registered promise callback for message %i",v.id),delete Tt.promiseCallbacks[v.id])}else"func"in c.data&&"string"==typeof c.data.func?(y("Received an action message %s from parent",(v=c.data).func),ge(v.func,v.args)):y("Received an unknown message: %O",c)}function ze(c){return!0===c.data.isPartialResponse}function je(c){if("id"in c.data&&"func"in c.data){var y=c.data,v=ge(y.func,y.args),w=v[0],C=v[1];w&&void 0!==C?nn(y.id,Array.isArray(C)?C:[C]):Le(y.func,y.args,(function(){for(var c=[],v=0;v<arguments.length;v++)c[v]=arguments[v];if(Pe.childWindow){var w=c.pop();nn(y.id,c,w)}}))}}function Ge(c){return c===Pe.parentWindow?Tt.parentMessageQueue:c===Pe.childWindow?Tt.childMessageQueue:[]}function qe(c){return c===Pe.parentWindow?Pe.parentOrigin:c===Pe.childWindow?Pe.childOrigin:null}var Rt,kt,Ot,Nt,Mt,xt,Ut=St.extend("flushMessageQueue");function Ye(c){for(var y=qe(c),v=Ge(c),w=c==Pe.parentWindow?"parent":"child";c&&y&&v.length>0;){var C=v.shift();Ut("Flushing message %i from "+w+" message queue via postMessage.",C.id),c.postMessage(C,y)}}function en(c,y){var v=Pe.currentWindow.setInterval((function(){0===Ge(c).length&&(clearInterval(v),y())}),100)}function nn(c,y,v){var w=Pe.childWindow,C=rn(c,y,v),b=qe(w);w&&b&&w.postMessage(C,b)}function tn(c,y){var v=Pe.childWindow,w=an(c,y),C=qe(v);v&&C?v.postMessage(w,C):Ge(v).push(w)}function on(c,y){return{id:Tt.nextMessageId++,func:c,timestamp:Date.now(),args:y||[]}}function rn(c,y,v){return{id:c,args:y||[],isPartialResponse:v}}function an(c,y){return{func:c,args:y||[]}}function ln(c,y,v){if(0===c.length)throw new Error("Must have at least one user when creating a chat deep link");return"https://teams.microsoft.com/l/chat/0/0?users="+c.map((function(c){return encodeURIComponent(c)})).join(",")+(void 0===y?"":"&topicName="+encodeURIComponent(y))+(void 0===v?"":"&message="+encodeURIComponent(v))}function cn(c,y,v){if(0===c.length)throw new Error("Must have at least one target when creating a call deep link");return"https://teams.microsoft.com/l/call/0/0?users="+c.map((function(c){return encodeURIComponent(c)})).join(",")+(void 0===y?"":"&withVideo="+encodeURIComponent(y))+(void 0===v?"":"&source="+encodeURIComponent(v))}function un(c,y,v,w,C){return"https://teams.microsoft.com/l/meeting/new?"+(void 0===c?"":"attendees="+c.map((function(c){return encodeURIComponent(c)})).join(","))+(void 0===y?"":"&startTime="+encodeURIComponent(y))+(void 0===v?"":"&endTime="+encodeURIComponent(v))+(void 0===w?"":"&subject="+encodeURIComponent(w))+(void 0===C?"":"&content="+encodeURIComponent(C))}function dn(c){if(!c)throw new Error("App ID must be set when creating an app install dialog deep link");return"https://teams.microsoft.com/l/app/"+encodeURIComponent(c)}!function(c){function n(){return!!Ze.supports.logs}c.registerGetLogHandler=function(c){if(H(),!n())throw Ie;c?me("log.request",(function(){Le("log.receive",[c()])})):he("log.request")},c.isSupported=n}(Rt||(Rt={})),function(c){c.fileDownloadStart="fileDownloadStart",c.fileDownloadComplete="fileDownloadComplete"}(kt||(kt={})),function(c){c.view="view",c.edit="edit",c.editNew="editNew"}(Ot||(Ot={})),function(c){c.fileOpenPreference="fileOpenPreference",c.theme="theme"}(Nt||(Nt={})),function(c){function n(){return!!Ze.supports.conversations}c.openConversation=function(c){return new Promise((function(y){if(H(I.content),!n())throw Ie;var v=Oe("conversations.openConversation",{title:c.title,subEntityId:c.subEntityId,conversationId:c.conversationId,channelId:c.channelId,entityId:c.entityId});c.onStartConversation&&me("startConversation",(function(y,v,w,C){return c.onStartConversation({subEntityId:y,conversationId:v,channelId:w,entityId:C})})),c.onCloseConversation&&me("closeConversation",(function(y,v,w,C){return c.onCloseConversation({subEntityId:y,conversationId:v,channelId:w,entityId:C})})),y(v)}))},c.closeConversation=function(){if(H(I.content),!n())throw Ie;Le("conversations.closeConversation"),he("startConversation"),he("closeConversation")},c.getChatMembers=function(){return new Promise((function(c){if(H(),!n())throw Ie;c(Re("getChatMembers"))}))},c.isSupported=n}(Mt||(Mt={})),function(c){function n(){return!!Ze.supports.appInstallDialog}c.openAppInstallDialog=function(c){return new Promise((function(y){if(H(I.content,I.sidePanel,I.settings,I.task,I.stage,I.meetingStage),!n())throw new Error("Not supported");Ze.isLegacyTeams?y(Oe("executeDeepLink",dn(c.appId))):(Le("appInstallDialog.openAppInstallDialog",[c]),y())}))},c.isSupported=n}(xt||(xt={}));var Lt,Ft,Ht,Bt,Dt=function(){var e=function(c,y){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,y){c.__proto__=y}||function(c,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(c[v]=y[v])},e(c,y)};return function(c,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function o(){this.constructor=c}e(c,y),c.prototype=null===y?Object.create(y):(o.prototype=y.prototype,new o)}}();function Cn(c,y){if(null==c||null==y||c.length<=0)return null;var v,w=1;return c.sort((function(c,y){return c.sequence>y.sequence?1:-1})),c.forEach((function(c){c.sequence==w&&(v=v?new Blob([v,c.file],{type:y}):new Blob([c.file],{type:y}),w++)})),v}function wn(c,y){if(null==c||null==y)return null;for(var v=atob(c.chunk),w=new Array(v.length),C=0;C<v.length;C++)w[C]=v.charCodeAt(C);var b=new Uint8Array(w),S=new Blob([b],{type:y});return{sequence:c.chunkSequence,file:S}}function vn(c){Tn(c)?x("2.0.2"):In(c)?x(re):bn(c)&&x("2.0.4")}function yn(c){return!(c.mediaType!=Lt.MediaType.Video||!c.videoProps||!c.videoProps.videoController)}function Sn(c){return!(null==c||c.maxMediaCount>10)}function bn(c){var y;return!((null==c?void 0:c.mediaType)!=Lt.MediaType.Image||!(null===(y=null==c?void 0:c.imageProps)||void 0===y?void 0:y.imageOutputFormats))}function Tn(c){return!(!c||c.mediaType!=Lt.MediaType.VideoAndImage&&!c.videoAndImageProps)}function In(c){return!(!c||c.mediaType!=Lt.MediaType.Video||!c.videoProps||c.videoProps.isFullScreenMode)}function Pn(c,y,v){return null!=c&&null!=y&&y==Lt.FileFormat.ID&&null!=v}function En(c){return!(null==c||c.length<=0||c.length>10)}function Fn(c){return!c||!(null===c.timeOutIntervalInSec||c.timeOutIntervalInSec<=0||c.timeOutIntervalInSec>60)}function kn(c){if(c){if(c.title&&"string"!=typeof c.title)return!1;if(c.setSelected&&"object"!=typeof c.setSelected)return!1;if(c.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof c.openOrgWideSearchInChatOrChannel)return!1;if(c.singleSelect&&"boolean"!=typeof c.singleSelect)return!1}return!0}!function(c){!function(c){c.Base64="base64",c.ID="id"}(c.FileFormat||(c.FileFormat={}));var n=function(){};c.File=n,c.captureImage=function(c){if(!c)throw new Error("[captureImage] Callback cannot be null");H(I.content,I.task),ue.isFramelessWindow?W("1.7.0")?Le("captureImage",c):c({errorCode:C.OLD_PLATFORM},void 0):c({errorCode:C.NOT_SUPPORTED_ON_PLATFORM},void 0)};var y=function(c){function n(y){void 0===y&&(y=null);var v=c.call(this)||this;return y&&(v.content=y.content,v.format=y.format,v.mimeType=y.mimeType,v.name=y.name,v.preview=y.preview,v.size=y.size),v}return Dt(n,c),n.prototype.getMedia=function(c){if(!c)throw new Error("[get Media] Callback cannot be null");H(I.content,I.task),W(oe)?Pn(this.mimeType,this.format,this.content)?W("2.0.0")?this.getMediaViaCallback(c):this.getMediaViaHandler(c):c({errorCode:C.INVALID_ARGUMENTS},null):c({errorCode:C.OLD_PLATFORM},null)},n.prototype.getMediaViaCallback=function(c){var y={mediaMimeType:this.mimeType,assembleAttachment:[]};Le("getMedia",[this.content],(function(v){if(c)if(v&&v.error)c(v.error,null);else if(v&&v.mediaChunk)if(v.mediaChunk.chunkSequence<=0){var w=Cn(y.assembleAttachment,y.mediaMimeType);c(v.error,w)}else{var b=wn(v.mediaChunk,y.mediaMimeType);y.assembleAttachment.push(b)}else c({errorCode:C.INTERNAL_ERROR,message:"data received is null"},null)}))},n.prototype.getMediaViaHandler=function(c){var y=O(),v={mediaMimeType:this.mimeType,assembleAttachment:[]},w=[y,this.content];this.content&&c&&Le("getMedia",w),me("getMedia"+y,(function(w){if(c){var b=JSON.parse(w);if(b.error)c(b.error,null),he("getMedia"+y);else if(b.mediaChunk)if(b.mediaChunk.chunkSequence<=0){var S=Cn(v.assembleAttachment,v.mediaMimeType);c(b.error,S),he("getMedia"+y)}else{var T=wn(b.mediaChunk,v.mediaMimeType);v.assembleAttachment.push(T)}else c({errorCode:C.INTERNAL_ERROR,message:"data received is null"},null),he("getMedia"+y)}}))},n}(n);c.Media=y;var v,w,b=function(c){function n(){return null!==c&&c.apply(this,arguments)||this}return Dt(n,c),n.prototype.getMediaType=function(){return w.Video},n.prototype.notifyEventToApp=function(c){if(this.controllerCallback)switch(c){case v.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},n}(function(){function e(c){this.controllerCallback=c}return e.prototype.notifyEventToHost=function(c,y){H(I.content,I.task);try{x(re)}catch(c){return void(y&&y(c))}Le("media.controller",[{mediaType:this.getMediaType(),mediaControllerEvent:c}],(function(c){y&&y(c)}))},e.prototype.stop=function(c){this.notifyEventToHost(v.StopRecording,c)},e}());c.VideoController=b,function(c){c[c.StartRecording=1]="StartRecording",c[c.StopRecording=2]="StopRecording"}(v=c.MediaControllerEvent||(c.MediaControllerEvent={})),function(c){c[c.Photo=1]="Photo",c[c.Document=2]="Document",c[c.Whiteboard=3]="Whiteboard",c[c.BusinessCard=4]="BusinessCard"}(c.CameraStartMode||(c.CameraStartMode={})),function(c){c[c.Camera=1]="Camera",c[c.Gallery=2]="Gallery"}(c.Source||(c.Source={})),function(c){c[c.Image=1]="Image",c[c.Video=2]="Video",c[c.VideoAndImage=3]="VideoAndImage",c[c.Audio=4]="Audio"}(w=c.MediaType||(c.MediaType={})),function(c){c[c.ID=1]="ID",c[c.URL=2]="URL"}(c.ImageUriType||(c.ImageUriType={})),function(c){c[c.IMAGE=1]="IMAGE",c[c.PDF=2]="PDF"}(c.ImageOutputFormats||(c.ImageOutputFormats={})),c.selectMedia=function(c,v){if(!v)throw new Error("[select Media] Callback cannot be null");if(H(I.content,I.task),W(oe)){try{vn(c)}catch(c){return void v(c,null)}if(Sn(c))Le("selectMedia",[c],(function(w,C,b){if(b)yn(c)&&c.videoProps.videoController.notifyEventToApp(b);else if(C){for(var S=[],T=0,I=C;T<I.length;T++){var P=I[T];S.push(new y(P))}v(w,S)}else v(w,null)}));else{var w={errorCode:C.INVALID_ARGUMENTS};v(w,null)}}else{var b={errorCode:C.OLD_PLATFORM};v(b,null)}},c.viewImages=function(c,y){if(!y)throw new Error("[view images] Callback cannot be null");H(I.content,I.task),W(oe)?En(c)?Le("viewImages",[c],y):y({errorCode:C.INVALID_ARGUMENTS}):y({errorCode:C.OLD_PLATFORM})},c.scanBarCode=function(c,y){if(!c)throw new Error("[media.scanBarCode] Callback cannot be null");H(I.content,I.task),ue.hostClientType!==S.desktop&&ue.hostClientType!==S.web&&ue.hostClientType!==S.rigel&&ue.hostClientType!==S.teamsRoomsWindows&&ue.hostClientType!==S.teamsRoomsAndroid&&ue.hostClientType!==S.teamsPhones&&ue.hostClientType!==S.teamsDisplays?W("1.9.0")?Fn(y)?Le("media.scanBarCode",[y],c):c({errorCode:C.INVALID_ARGUMENTS},null):c({errorCode:C.OLD_PLATFORM},null):c({errorCode:C.NOT_SUPPORTED_ON_PLATFORM},null)}}(Lt||(Lt={})),function(c){function n(){return!(!Ze.supports.barCode||!Ze.supports.permissions)}c.scanBarCode=function(c){return new Promise((function(y){if(H(I.content,I.task),!n())throw Ie;if(!Fn(c))throw{errorCode:C.INVALID_ARGUMENTS};y(Me("media.scanBarCode",c))}))},c.hasPermission=function(){if(H(I.content,I.task),!n())throw Ie;var c=b.Media;return new Promise((function(y){y(Me("permissions.has",c))}))},c.requestPermission=function(){if(H(I.content,I.task),!n())throw Ie;var c=b.Media;return new Promise((function(y){y(Me("permissions.request",c))}))},c.isSupported=n}(Ft||(Ft={})),function(c){function n(c){return new Promise((function(y){if(H(I.content,I.task),!t())throw Ie;Ze.isLegacyTeams?y(Oe("executeDeepLink",ln([c.user],void 0,c.message))):y(Oe("chat.openChat",{members:c.user,message:c.message}))}))}function t(){return!!Ze.supports.chat}c.openChat=n,c.openGroupChat=function(c){return new Promise((function(y){if(c.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===c.users.length)n({user:c.users[0],message:c.message});else{if(H(I.content,I.task),!t())throw Ie;Ze.isLegacyTeams?y(Oe("executeDeepLink",ln(c.users,c.topic,c.message))):y(Oe("chat.openChat",{members:c.users,message:c.message,topic:c.topic}))}}))},c.isSupported=t}(Ht||(Ht={})),function(c){function n(){return!(!Ze.supports.geoLocation||!Ze.supports.permissions)}c.getCurrentLocation=function(){if(H(I.content,I.task),!n())throw Ie;return Me("location.getLocation",{allowChooseLocation:!1,showMap:!1})},c.hasPermission=function(){if(H(I.content,I.task),!n())throw Ie;var c=b.GeoLocation;return new Promise((function(y){y(Me("permissions.has",c))}))},c.requestPermission=function(){if(H(I.content,I.task),!n())throw Ie;var c=b.GeoLocation;return new Promise((function(y){y(Me("permissions.request",c))}))},c.isSupported=n,function(c){function n(){return!!(Ze.supports.geoLocation&&Ze.supports.geoLocation.map&&Ze.supports.permissions)}c.chooseLocation=function(){if(H(I.content,I.task),!n())throw Ie;return Me("location.getLocation",{allowChooseLocation:!0,showMap:!0})},c.showLocation=function(c){if(H(I.content,I.task),!n())throw Ie;if(!c)throw{errorCode:C.INVALID_ARGUMENTS};return Me("location.showLocation",c)},c.isSupported=n}(c.map||(c.map={}))}(Bt||(Bt={}));var qt,jt,Gt,zt,Wt,Kt,Vt,$t,Yt,Jt,Qt,Zt,Xt,er,tr=function(){function e(){}return e.prototype.postMessage=function(c,y){H(),Le("messageForChild",[c],y||k())},e.prototype.addEventListener=function(c,y){H(),"message"===c&&me("messageForParent",y)},e}(),rr=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(c,y){H(I.task),Le("messageForParent",[c],y||k())},e.prototype.addEventListener=function(c,y){H(I.task),"message"===c&&me("messageForChild",y)},e}();function Gn(c){return c?c.modality&&"string"!=typeof c.modality?[!1,"modality must be a string"]:c.targetElementBoundingRect&&"object"==typeof c.targetElementBoundingRect?c.triggerType&&"string"==typeof c.triggerType?qn(c.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function qn(c){return c?c.displayName&&"string"!=typeof c.displayName?[!1,"displayName must be a string"]:c.identifiers&&"object"==typeof c.identifiers?c.identifiers.AadObjectId||c.identifiers.Smtp||c.identifiers.Upn?c.identifiers.AadObjectId&&"string"!=typeof c.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:c.identifiers.Smtp&&"string"!=typeof c.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:c.identifiers.Upn&&"string"!=typeof c.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}function Zn(c,y){Je.initialize(y).then((function(){c&&c()}))}function Jn(){$e.enablePrintCapability()}function Kn(){$e.print()}function Qn(c){H(),Je.getContext().then((function(y){c&&c(pt(y))}))}function Xn(c){Je.registerOnThemeChangeHandler(c)}function $n(c){Qe.registerFullScreenHandler(c)}function Yn(c){Qe.appButton.onClick(c)}function et(c){Qe.appButton.onHoverEnter(c)}function nt(c){Qe.appButton.onHoverLeave(c)}function tt(c){Qe.backStack.registerBackButtonHandler(c)}function ot(c){$e.registerOnLoadHandler(c)}function it(c){$e.registerBeforeUnloadHandler(c)}function rt(c){Qe.registerFocusEnterHandler(c)}function at(c){Qe.config.registerChangeConfigHandler(c)}function st(c,y){H(),Qe.tabs.getTabInstances(y).then((function(y){c(y)}))}function lt(c,y){H(),Qe.tabs.getMruTabInstances(y).then((function(y){c(y)}))}function ct(c){Qe.shareDeepLink({subPageId:c.subEntityId,subPageLabel:c.subEntityLabel,subPageWebUrl:c.subEntityWebUrl})}function ut(c,y){H(I.content,I.sidePanel,I.settings,I.task,I.stage,I.meetingStage),y=y||k(),Je.openLink(c).then((function(){y(!0)})).catch((function(c){y(!1,c.message)}))}function dt(c){Qe.setCurrentFrame(c)}function ft(c,y,v){Qe.initializeWithFrameContext(c,y,v)}function pt(c){return{actionInfo:c.actionInfo,locale:c.app.locale,appSessionId:c.app.sessionId,theme:c.app.theme,appIconPosition:c.app.iconPositionVertical,osLocaleInfo:c.app.osLocaleInfo,parentMessageId:c.app.parentMessageId,userClickTime:c.app.userClickTime,userFileOpenPreference:c.app.userFileOpenPreference,appLaunchId:c.app.appLaunchId,hostClientType:c.app.host.clientType,sessionId:c.app.host.sessionId,ringId:c.app.host.ringId,entityId:c.page.id,frameContext:c.page.frameContext,subEntityId:c.page.subPageId,isFullScreen:c.page.isFullScreen,isMultiWindow:c.page.isMultiWindow,sourceOrigin:c.page.sourceOrigin,userObjectId:void 0!==c.user?c.user.id:void 0,isCallingAllowed:void 0!==c.user?c.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==c.user?c.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==c.user?c.user.licenseType:void 0,loginHint:void 0!==c.user?c.user.loginHint:void 0,userPrincipalName:void 0!==c.user?c.user.userPrincipalName:void 0,tid:void 0!==c.user&&void 0!==c.user.tenant?c.user.tenant.id:void 0,tenantSKU:void 0!==c.user&&void 0!==c.user.tenant?c.user.tenant.teamsSku:void 0,channelId:void 0!==c.channel?c.channel.id:void 0,channelName:void 0!==c.channel?c.channel.displayName:void 0,channelRelativeUrl:void 0!==c.channel?c.channel.relativeUrl:void 0,channelType:void 0!==c.channel?c.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==c.channel?c.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==c.channel?c.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==c.channel?c.channel.ownerTenantId:void 0,chatId:void 0!==c.chat?c.chat.id:void 0,meetingId:void 0!==c.meeting?c.meeting.id:void 0,sharepoint:c.sharepoint,teamId:void 0!==c.team?c.team.internalId:void 0,teamName:void 0!==c.team?c.team.displayName:void 0,teamType:void 0!==c.team?c.team.type:void 0,groupId:void 0!==c.team?c.team.groupId:void 0,teamTemplateId:void 0!==c.team?c.team.templateId:void 0,isTeamArchived:void 0!==c.team?c.team.isArchived:void 0,userTeamRole:void 0!==c.team?c.team.userRole:void 0,teamSiteUrl:void 0!==c.sharePointSite?c.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:void 0!==c.sharePointSite?c.sharePointSite.teamSiteDomain:void 0,teamSitePath:void 0!==c.sharePointSite?c.sharePointSite.teamSitePath:void 0,teamSiteId:void 0!==c.sharePointSite?c.sharePointSite.teamSiteId:void 0,mySitePath:void 0!==c.sharePointSite?c.sharePointSite.mySitePath:void 0,mySiteDomain:void 0!==c.sharePointSite?c.sharePointSite.mySiteDomain:void 0}}function gt(c){Qe.returnFocus(c)}function mt(c,y){H(),y=y||k(),Qe.tabs.navigateToTab(c).then((function(){y(!0)})).catch((function(c){y(!1,c.message)}))}function ht(c,y){H(I.content,I.sidePanel,I.settings,I.remove,I.task,I.stage,I.meetingStage),y=y||k(),Qe.navigateCrossDomain(c).then((function(){y(!0)})).catch((function(c){y(!1,c.message)}))}function Ct(c){H(),c=c||k(),Qe.backStack.navigateBack().then((function(){c(!0)})).catch((function(y){c(!1,y.message)}))}!function(c){function n(){return!!Ze.supports.location}c.getLocation=function(c,y){if(!y)throw new Error("[location.getLocation] Callback cannot be null");if(H(I.content,I.task),!W(ne))throw{errorCode:C.OLD_PLATFORM};if(!c)throw{errorCode:C.INVALID_ARGUMENTS};if(!n())throw Ie;Le("location.getLocation",[c],y)},c.showLocation=function(c,y){if(!y)throw new Error("[location.showLocation] Callback cannot be null");if(H(I.content,I.task),!W(ne))throw{errorCode:C.OLD_PLATFORM};if(!c)throw{errorCode:C.INVALID_ARGUMENTS};if(!n())throw Ie;Le("location.showLocation",[c],y)},c.isSupported=n}(qt||(qt={})),function(c){!function(c){c.like="like",c.heart="heart",c.laugh="laugh",c.surprised="surprised",c.applause="applause"}(c.MeetingReactionType||(c.MeetingReactionType={})),function(c){c.Unknown="Unknown",c.Adhoc="Adhoc",c.Scheduled="Scheduled",c.Recurring="Recurring",c.Broadcast="Broadcast",c.MeetNow="MeetNow"}(c.MeetingType||(c.MeetingType={})),function(c){c.OneOnOneCall="oneOnOneCall",c.GroupCall="groupCall"}(c.CallType||(c.CallType={})),c.getIncomingClientAudioState=function(c){if(!c)throw new Error("[get incoming client audio state] Callback cannot be null");H(I.sidePanel,I.meetingStage),Le("getIncomingClientAudioState",c)},c.toggleIncomingClientAudio=function(c){if(!c)throw new Error("[toggle incoming client audio] Callback cannot be null");H(I.sidePanel,I.meetingStage),Le("toggleIncomingClientAudio",c)},c.getMeetingDetails=function(c){if(!c)throw new Error("[get meeting details] Callback cannot be null");H(I.sidePanel,I.meetingStage,I.settings,I.content),Le("meeting.getMeetingDetails",c)},c.getAuthenticationTokenForAnonymousUser=function(c){if(!c)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");H(I.sidePanel,I.meetingStage),Le("meeting.getAuthenticationTokenForAnonymousUser",c)},c.getLiveStreamState=function(c){if(!c)throw new Error("[get live stream state] Callback cannot be null");H(I.sidePanel),Le("meeting.getLiveStreamState",c)},c.requestStartLiveStreaming=function(c,y,v){if(!c)throw new Error("[request start live streaming] Callback cannot be null");H(I.sidePanel),Le("meeting.requestStartLiveStreaming",[y,v],c)},c.requestStopLiveStreaming=function(c){if(!c)throw new Error("[request stop live streaming] Callback cannot be null");H(I.sidePanel),Le("meeting.requestStopLiveStreaming",c)},c.registerLiveStreamChangedHandler=function(c){if(!c)throw new Error("[register live stream changed handler] Handler cannot be null");H(I.sidePanel),me("meeting.liveStreamChanged",c)},c.shareAppContentToStage=function(c,y){if(!c)throw new Error("[share app content to stage] Callback cannot be null");H(I.sidePanel,I.meetingStage),Le("meeting.shareAppContentToStage",[y],c)},c.getAppContentStageSharingCapabilities=function(c){if(!c)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");H(I.sidePanel,I.meetingStage),Le("meeting.getAppContentStageSharingCapabilities",c)},c.stopSharingAppContentToStage=function(c){if(!c)throw new Error("[stop sharing app content to stage] Callback cannot be null");H(I.sidePanel,I.meetingStage),Le("meeting.stopSharingAppContentToStage",c)},c.getAppContentStageSharingState=function(c){if(!c)throw new Error("[get app content stage sharing state] Callback cannot be null");H(I.sidePanel,I.meetingStage),Le("meeting.getAppContentStageSharingState",c)},c.registerSpeakingStateChangeHandler=function(c){if(!c)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");H(I.sidePanel,I.meetingStage),me("meeting.speakingStateChanged",c)},c.registerRaiseHandStateChangedHandler=function(c){if(!c)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");H(I.sidePanel,I.meetingStage),me("meeting.raiseHandStateChanged",c)},c.registerMeetingReactionReceivedHandler=function(c){if(!c)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");H(I.sidePanel,I.meetingStage),me("meeting.meetingReactionReceived",c)}}(jt||(jt={})),function(c){function n(){return!!Ze.supports.monetization}c.openPurchaseExperience=function(c,y){var v,w;return"function"==typeof c?(v=c,w=y):w=c,H(I.content),D((function(){return new Promise((function(c){if(!n())throw Ie;c(Me("monetization.openPurchaseExperience",w))}))}),v)},c.isSupported=n}(Gt||(Gt={})),function(c){function n(){return!!Ze.supports.calendar}c.openCalendarItem=function(c){return new Promise((function(y){if(H(I.content),!n())throw new Error("Not supported");if(!c.itemId||!c.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");y(Oe("calendar.openCalendarItem",c))}))},c.composeMeeting=function(c){return new Promise((function(y){if(H(I.content),!n())throw new Error("Not supported");Ze.isLegacyTeams?y(Oe("executeDeepLink",un(c.attendees,c.startTime,c.endTime,c.subject,c.content))):y(Oe("calendar.composeMeeting",c))}))},c.isSupported=n}(zt||(zt={})),function(c){function n(){return!!Ze.supports.mail}c.openMailItem=function(c){return new Promise((function(y){if(H(I.content),!n())throw new Error("Not supported");if(!c.itemId||!c.itemId.trim())throw new Error("Must supply an itemId to openMailItem");y(Oe("mail.openMailItem",c))}))},c.composeMail=function(c){return new Promise((function(y){if(H(I.content),!n())throw new Error("Not supported");y(Oe("mail.composeMail",c))}))},c.isSupported=n,function(c){c.New="new",c.Reply="reply",c.ReplyAll="replyAll",c.Forward="forward"}(c.ComposeMailType||(c.ComposeMailType={}))}(Wt||(Wt={})),function(c){function n(c){return new Promise((function(y){if(!W("2.0.0"))throw{errorCode:C.OLD_PLATFORM};if(!kn(c))throw{errorCode:C.INVALID_ARGUMENTS};if(!t())throw Ie;y(Me("people.selectPeople",c))}))}function t(){return!!Ze.supports.people}c.selectPeople=function(c,y){var v,w,C;return H(I.content,I.task,I.settings),"function"==typeof c?(w=(v=[c,y])[0],C=v[1]):C=c,M(n,w,C)},c.isSupported=t}(Kt||(Kt={})),function(c){c.showProfile=function(c){return H(I.content),new Promise((function(y){var v=Gn(c),w=v[0],b=v[1];if(!w)throw{errorCode:C.INVALID_ARGUMENTS,message:b};y(Me("profile.showProfile",{modality:c.modality,persona:c.persona,triggerType:c.triggerType,targetRectangle:{x:c.targetElementBoundingRect.x,y:c.targetElementBoundingRect.y,width:c.targetElementBoundingRect.width,height:c.targetElementBoundingRect.height}}))}))},c.isSupported=function(){return!!Ze.supports.profile}}(Vt||(Vt={})),function(c){function n(){Le("video.videoFrameProcessed")}function t(c){Le("video.notifyError",[c])}function o(){return!!Ze.supports.video}!function(c){c[c.NV12=0]="NV12"}(c.VideoFrameFormat||(c.VideoFrameFormat={})),function(c){c[c.EffectChanged=0]="EffectChanged",c[c.EffectDisabled=1]="EffectDisabled"}(c.EffectChangeType||(c.EffectChangeType={})),c.registerForVideoFrame=function(c,y){if(H(I.sidePanel),!o())throw Ie;me("video.newVideoFrame",(function(y){void 0!==y&&c(y,n,t)})),Le("video.registerForVideoFrame",[y])},c.notifySelectedVideoEffectChanged=function(c,y){if(H(I.sidePanel),!o())throw Ie;Le("video.videoEffectChanged",[c,y])},c.registerForVideoEffect=function(c){if(H(I.sidePanel),!o())throw Ie;me("video.effectParameterChange",c)},c.isSupported=o}($t||($t={})),function(c){function n(y){return new Promise((function(v){if(!a())throw Ie;v(Me(c.SharingAPIMessages.shareWebContent,y))}))}function t(c){if(!(c&&c.content&&c.content.length))throw{errorCode:C.INVALID_ARGUMENTS,message:"Shared content is missing"}}function o(c){if(c.content.some((function(c){return!c.type})))throw{errorCode:C.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(c.content.some((function(y){return y.type!==c.content[0].type})))throw{errorCode:C.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}function i(c){if("URL"!==c.content[0].type)throw{errorCode:C.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(c.content.some((function(c){return!c.url})))throw{errorCode:C.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}function a(){return!!Ze.supports.sharing}c.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},c.shareWebContent=function(c,y){try{t(c),o(c),i(c)}catch(c){return N((function(){return Promise.reject(c)}),y)}return H(I.content,I.sidePanel,I.task,I.stage,I.meetingStage),N(n,y,c)},c.isSupported=a}(Yt||(Yt={})),function(c){function n(){return!!Ze.supports.stageView}c.open=function(c){return new Promise((function(y){if(H(I.content),!n())throw Ie;if(!c)throw new Error("[stageView.open] Stage view params cannot be null");y(Me("stageView.open",c))}))},c.isSupported=n}(Jt||(Jt={})),function(c){function n(){return!!Ze.supports.webStorage}c.isWebStorageClearedOnUserLogOut=function(){return H(),ue.hostClientType===S.desktop||n()},c.isSupported=n}(Qt||(Qt={})),function(c){var y;function t(){return!!Ze.supports.call}!function(c){c.Unknown="unknown",c.Audio="audio",c.Video="video",c.VideoBasedScreenSharing="videoBasedScreenSharing",c.Data="data"}(y=c.CallModalities||(c.CallModalities={})),c.startCall=function(c){return new Promise((function(v){var w;if(H(I.content,I.task),!t())throw Ie;if(!Ze.isLegacyTeams)return Le("call.startCall",[c],v);v(Me("executeDeepLink",cn(c.targets,null===(w=c.requestedModalities)||void 0===w?void 0:w.includes(y.Video),c.source)))}))},c.isSupported=t}(Zt||(Zt={})),function(c){c.Messages=Je.Messages,c.FailedReason=Je.FailedReason,c.ExpectedFailureReason=Je.ExpectedFailureReason,c.notifyAppLoaded=function(){Je.notifyAppLoaded()},c.notifySuccess=function(){Je.notifySuccess()},c.notifyFailure=function(c){Je.notifyFailure(c)},c.notifyExpectedFailure=function(c){Je.notifyExpectedFailure(c)}}(Xt||(Xt={})),function(c){c.setValidityState=function(c){Qe.config.setValidityState(c)},c.getSettings=function(c){H(I.content,I.settings,I.remove,I.sidePanel),Qe.getConfig().then((function(y){c(y)}))},c.setSettings=function(c,y){H(I.content,I.settings,I.sidePanel),y=y||k(),Qe.config.setConfig(c).then((function(){y(!0)})).catch((function(c){y(!1,c.message)}))},c.registerOnSaveHandler=function(c){Qe.config.registerOnSaveHandler(c)},c.registerOnRemoveHandler=function(c){Qe.config.registerOnRemoveHandler(c)}}(er||(er={}));var nr,or,ir,ar,sr,cr,ur,Pt=function(c,y){var v={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&y.indexOf(w)<0&&(v[w]=c[w]);if(null!=c&&"function"==typeof Object.getOwnPropertySymbols){var C=0;for(w=Object.getOwnPropertySymbols(c);C<w.length;C++)y.indexOf(w[C])<0&&Object.prototype.propertyIsEnumerable.call(c,w[C])&&(v[w[C]]=c[w[C]])}return v};!function(c){function n(c){return{url:c.url,size:{height:c.height?c.height:pe.Small,width:c.width?c.width:pe.Small},title:c.title,fallbackUrl:c.fallbackUrl}}function t(c){return{url:c.url,size:{height:c.height?c.height:pe.Small,width:c.width?c.width:pe.Small},title:c.title,fallbackUrl:c.fallbackUrl,completionBotId:c.completionBotId}}function o(c){return c.height=c.height?c.height:pe.Small,c.width=c.width?c.width:pe.Small,c}c.startTask=function(c,y){var v=y?function(c){return y(c.err,c.result)}:void 0;return void 0!==c.card||void 0===c.url?(H(I.content,I.sidePanel,I.meetingStage),Le("tasks.startTask",[c],y)):void 0!==c.completionBotId?Ke.bot.open(t(c),v):Ke.open(n(c),v),new tr},c.updateTask=function(c){(c=o(c)).width,c.height;var y=Pt(c,["width","height"]);if(Object.keys(y).length)throw new Error("resize requires a TaskInfo argument containing only width and height");Ke.update.resize(c)},c.submitTask=function(c,y){Ke.submit(c,y)},c.getUrlDialogInfoFromTaskInfo=n,c.getBotUrlDialogInfoFromTaskInfo=t,c.getDefaultSizeIfNotProvided=o}(nr||(nr={})),function(c){var y;function t(c,y){return{errorCode:c,message:y}}!function(c){c.Dropbox="DROPBOX",c.Box="BOX",c.Sharefile="SHAREFILE",c.GoogleDrive="GOOGLEDRIVE",c.Egnyte="EGNYTE",c.SharePoint="SharePoint"}(y=c.CloudStorageProvider||(c.CloudStorageProvider={})),function(c){c[c.Sharepoint=0]="Sharepoint",c[c.WopiIntegration=1]="WopiIntegration",c[c.Google=2]="Google",c[c.OneDrive=3]="OneDrive",c[c.Recent=4]="Recent",c[c.Aggregate=5]="Aggregate",c[c.FileSystem=6]="FileSystem",c[c.Search=7]="Search",c[c.AllFiles=8]="AllFiles",c[c.SharedWithMe=9]="SharedWithMe"}(c.CloudStorageProviderType||(c.CloudStorageProviderType={})),function(c){c.ClassMaterials="classMaterials"}(c.SpecialDocumentLibraryType||(c.SpecialDocumentLibraryType={})),function(c){c.Readonly="readonly"}(c.DocumentLibraryAccessType||(c.DocumentLibraryAccessType={})),function(c){c.Downloaded="Downloaded",c.Downloading="Downloading",c.Failed="Failed"}(c.FileDownloadStatus||(c.FileDownloadStatus={})),function(c){c.Download="DOWNLOAD",c.Upload="UPLOAD",c.Delete="DELETE"}(c.CloudStorageProviderFileAction||(c.CloudStorageProviderFileAction={})),c.getCloudStorageFolders=function(c,y){if(H(I.content),!c||0===c.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!y)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");Le("files.getCloudStorageFolders",[c],y)},c.addCloudStorageFolder=function(c,y){if(H(I.content),!c||0===c.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!y)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");Le("files.addCloudStorageFolder",[c],y)},c.deleteCloudStorageFolder=function(c,y,v){if(H(I.content),!c)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!y)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!v)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");Le("files.deleteCloudStorageFolder",[c,y],v)},c.getCloudStorageFolderContents=function(c,y,v){if(H(I.content),!c||!y)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!v)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in c&&!c.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");Le("files.getCloudStorageFolderContents",[c,y],v)},c.openCloudStorageFile=function(c,y,v){if(H(I.content),!c||!y)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(c.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");Le("files.openCloudStorageFile",[c,y,v])},c.getExternalProviders=function(c,y){if(void 0===c&&(c=!1),H(I.content),!y)throw new Error("[files.getExternalProviders] Callback cannot be null");Le("files.getExternalProviders",[c],y)},c.copyMoveFiles=function(c,y,v,w,C,b){if(void 0===C&&(C=!1),H(I.content),!c||0===c.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!y)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!v)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!w)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!b)throw new Error("[files.copyMoveFiles] callback cannot be null");Le("files.copyMoveFiles",[c,y,v,w,C],b)},c.getFileDownloads=function(c){if(H(I.content),!c)throw new Error("[files.getFileDownloads] Callback cannot be null");Le("files.getFileDownloads",[],c)},c.openDownloadFolder=function(c,y){if(void 0===c&&(c=void 0),H(I.content),!y)throw new Error("[files.openDownloadFolder] Callback cannot be null");Le("files.openDownloadFolder",[c],y)},c.addCloudStorageProvider=function(c){if(H(I.content),!c)throw t(C.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");Le("files.addCloudStorageProvider",[],c)},c.removeCloudStorageProvider=function(c,y){if(H(I.content),!y)throw t(C.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!c||!c.content)throw t(C.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");Le("files.removeCloudStorageProvider",[c],y)},c.addCloudStorageProviderFile=function(c,y){if(H(I.content),!y)throw t(C.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!c||!c.content)throw t(C.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");Le("files.addCloudStorageProviderFile",[c],y)},c.renameCloudStorageProviderFile=function(c,y){if(H(I.content),!y)throw t(C.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!c||!c.content)throw t(C.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");Le("files.renameCloudStorageProviderFile",[c],y)},c.deleteCloudStorageProviderFile=function(c,y){if(H(I.content),!y)throw t(C.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(c&&c.content&&c.content.itemList&&c.content.itemList.length>0))throw t(C.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Le("files.deleteCloudStorageProviderFile",[c],y)},c.downloadCloudStorageProviderFile=function(c,y){if(H(I.content),!y)throw t(C.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(c&&c.content&&c.content.itemList&&c.content.itemList.length>0))throw t(C.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Le("files.downloadCloudStorageProviderFile",[c],y)},c.uploadCloudStorageProviderFile=function(c,v){if(H(I.content),!v)throw t(C.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(c&&c.content&&c.content.itemList&&c.content.itemList.length>0))throw t(C.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!(c.content.destinationFolder&&(c.content.providerCode===y.SharePoint?c.content.destinationFolder.isFolder:c.content.destinationFolder.isSubdirectory)&&c.content.destinationFolder.objectUrl))throw t(C.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");Le("files.uploadCloudStorageProviderFile",[c],v)},c.registerCloudStorageProviderListChangeHandler=function(c){if(H(),!c)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");me("files.cloudStorageProviderListChange",c)},c.registerCloudStorageProviderContentChangeHandler=function(c){if(H(),!c)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");me("files.cloudStorageProviderContentChange",c)}}(or||(or={})),function(c){function n(){return!!Ze.supports.meetingRoom}c.getPairedMeetingRoomInfo=function(){return new Promise((function(c){if(H(),!n())throw Ie;c(Me("meetingRoom.getPairedMeetingRoomInfo"))}))},c.sendCommandToPairedMeetingRoom=function(c){return new Promise((function(y){if(!c||0==c.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(H(),!n())throw Ie;y(Me("meetingRoom.sendCommandToPairedMeetingRoom",c))}))},c.registerMeetingRoomCapabilitiesUpdateHandler=function(c){if(!c)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(H(),!n())throw Ie;me("meetingRoom.meetingRoomCapabilitiesUpdate",(function(y){H(),c(y)}))},c.registerMeetingRoomStatesUpdateHandler=function(c){if(!c)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(H(),!n())throw Ie;me("meetingRoom.meetingRoomStatesUpdate",(function(y){H(),c(y)}))},c.isSupported=n}(ir||(ir={})),function(c){function n(){return!!Ze.supports.notifications}c.showNotification=function(c){if(H(I.content),!n())throw Ie;Le("notifications.showNotification",[c])},c.isSupported=n}(ar||(ar={})),function(c){function n(){return!!Ze.supports.remoteCamera}!function(c){c.Reset="Reset",c.ZoomIn="ZoomIn",c.ZoomOut="ZoomOut",c.PanLeft="PanLeft",c.PanRight="PanRight",c.TiltUp="TiltUp",c.TiltDown="TiltDown"}(c.ControlCommand||(c.ControlCommand={})),function(c){c[c.CommandResetError=0]="CommandResetError",c[c.CommandZoomInError=1]="CommandZoomInError",c[c.CommandZoomOutError=2]="CommandZoomOutError",c[c.CommandPanLeftError=3]="CommandPanLeftError",c[c.CommandPanRightError=4]="CommandPanRightError",c[c.CommandTiltUpError=5]="CommandTiltUpError",c[c.CommandTiltDownError=6]="CommandTiltDownError",c[c.SendDataError=7]="SendDataError"}(c.ErrorReason||(c.ErrorReason={})),function(c){c[c.None=0]="None",c[c.ControlDenied=1]="ControlDenied",c[c.ControlNoResponse=2]="ControlNoResponse",c[c.ControlBusy=3]="ControlBusy",c[c.AckTimeout=4]="AckTimeout",c[c.ControlTerminated=5]="ControlTerminated",c[c.ControllerTerminated=6]="ControllerTerminated",c[c.DataChannelError=7]="DataChannelError",c[c.ControllerCancelled=8]="ControllerCancelled",c[c.ControlDisabled=9]="ControlDisabled",c[c.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(c.SessionTerminatedReason||(c.SessionTerminatedReason={})),c.getCapableParticipants=function(c){if(!c)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(H(I.sidePanel),!n())throw Ie;Le("remoteCamera.getCapableParticipants",c)},c.requestControl=function(c,y){if(!c)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!y)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(H(I.sidePanel),!n())throw Ie;Le("remoteCamera.requestControl",[c],y)},c.sendControlCommand=function(c,y){if(!c)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!y)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(H(I.sidePanel),!n())throw Ie;Le("remoteCamera.sendControlCommand",[c],y)},c.terminateSession=function(c){if(!c)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(H(I.sidePanel),!n())throw Ie;Le("remoteCamera.terminateSession",c)},c.registerOnCapableParticipantsChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(H(I.sidePanel),!n())throw Ie;me("remoteCamera.capableParticipantsChange",c)},c.registerOnErrorHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(H(I.sidePanel),!n())throw Ie;me("remoteCamera.handlerError",c)},c.registerOnDeviceStateChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(H(I.sidePanel),!n())throw Ie;me("remoteCamera.deviceStateChange",c)},c.registerOnSessionStatusChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(H(I.sidePanel),!n())throw Ie;me("remoteCamera.sessionStatusChange",c)},c.isSupported=n}(sr||(sr={})),function(c){function n(){return!!Ze.supports.appEntity}c.selectAppEntity=function(c,y,v,w){if(H(I.content),!n())throw Ie;if(!c||0==c.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!w)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");Le("appEntity.selectAppEntity",[c,y,v],w)},c.isSupported=n}(cr||(cr={})),function(c){function n(){return!!Ze.supports.teams}!function(c){c[c.Regular=0]="Regular",c[c.Private=1]="Private",c[c.Shared=2]="Shared"}(c.ChannelType||(c.ChannelType={})),c.getTeamChannels=function(c,y){if(H(I.content),!n())throw Ie;if(!c)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!y)throw new Error("[teams.getTeamChannels] Callback cannot be null");Le("teams.getTeamChannels",[c],y)},c.refreshSiteUrl=function(c,y){if(H(),!n())throw Ie;if(!c)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!y)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");Le("teams.refreshSiteUrl",[c],y)},c.isSupported=n,function(c){function n(){return!!Ze.supports.teams&&!!Ze.supports.teams.fullTrust}!function(c){function n(){return!!Ze.supports.teams&&!!Ze.supports.teams.fullTrust&&!!Ze.supports.teams.fullTrust.joinedTeams}c.getUserJoinedTeams=function(c){return new Promise((function(y){if(H(),!n())throw Ie;if((ue.hostClientType===S.android||ue.hostClientType===S.teamsRoomsAndroid||ue.hostClientType===S.teamsPhones||ue.hostClientType===S.teamsDisplays)&&!W("2.0.1")){var v={errorCode:C.OLD_PLATFORM};throw new Error(JSON.stringify(v))}y(Re("getUserJoinedTeams",c))}))},c.isSupported=n}(c.joinedTeams||(c.joinedTeams={})),c.getConfigSetting=function(c){return new Promise((function(y){if(H(),!n())throw Ie;y(Re("getConfigSetting",c))}))},c.isSupported=n}(c.fullTrust||(c.fullTrust={}))}(ur||(ur={}))})(),v})()},917:(c,y,v)=>{v(545)},662:(c,y,v)=>{"use strict";var w=v(562),C=v(250),b=v(639),S=v(882),T=v(277),I=v(999),P=v(563),K=v(230),Q=v(584),X=v(194),te=v(582);c.exports=function xhrAdapter(c){return new Promise((function dispatchXhrRequest(y,v){var re,ne=c.data,oe=c.headers,ie=c.responseType;function done(){c.cancelToken&&c.cancelToken.unsubscribe(re),c.signal&&c.signal.removeEventListener("abort",re)}w.isFormData(ne)&&w.isStandardBrowserEnv()&&delete oe["Content-Type"];var se=new XMLHttpRequest;if(c.auth){var ue=c.auth.username||"",de=c.auth.password?unescape(encodeURIComponent(c.auth.password)):"";oe.Authorization="Basic "+btoa(ue+":"+de)}var pe=T(c.baseURL,c.url);function onloadend(){if(se){var w="getAllResponseHeaders"in se?I(se.getAllResponseHeaders()):null,b={data:ie&&"text"!==ie&&"json"!==ie?se.response:se.responseText,status:se.status,statusText:se.statusText,headers:w,config:c,request:se};C((function _resolve(c){y(c),done()}),(function _reject(c){v(c),done()}),b),se=null}}if(se.open(c.method.toUpperCase(),S(pe,c.params,c.paramsSerializer),!0),se.timeout=c.timeout,"onloadend"in se?se.onloadend=onloadend:se.onreadystatechange=function handleLoad(){se&&4===se.readyState&&(0!==se.status||se.responseURL&&0===se.responseURL.indexOf("file:"))&&setTimeout(onloadend)},se.onabort=function handleAbort(){se&&(v(new Q("Request aborted",Q.ECONNABORTED,c,se)),se=null)},se.onerror=function handleError(){v(new Q("Network Error",Q.ERR_NETWORK,c,se,se)),se=null},se.ontimeout=function handleTimeout(){var y=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded",w=c.transitional||K;c.timeoutErrorMessage&&(y=c.timeoutErrorMessage),v(new Q(y,w.clarifyTimeoutError?Q.ETIMEDOUT:Q.ECONNABORTED,c,se)),se=null},w.isStandardBrowserEnv()){var Ee=(c.withCredentials||P(pe))&&c.xsrfCookieName?b.read(c.xsrfCookieName):void 0;Ee&&(oe[c.xsrfHeaderName]=Ee)}"setRequestHeader"in se&&w.forEach(oe,(function setRequestHeader(c,y){void 0===ne&&"content-type"===y.toLowerCase()?delete oe[y]:se.setRequestHeader(y,c)})),w.isUndefined(c.withCredentials)||(se.withCredentials=!!c.withCredentials),ie&&"json"!==ie&&(se.responseType=c.responseType),"function"==typeof c.onDownloadProgress&&se.addEventListener("progress",c.onDownloadProgress),"function"==typeof c.onUploadProgress&&se.upload&&se.upload.addEventListener("progress",c.onUploadProgress),(c.cancelToken||c.signal)&&(re=function(c){se&&(v(!c||c&&c.type?new X:c),se.abort(),se=null)},c.cancelToken&&c.cancelToken.subscribe(re),c.signal&&(c.signal.aborted?re():c.signal.addEventListener("abort",re))),ne||(ne=null);var Ie=te(pe);Ie&&-1===["http","https","file"].indexOf(Ie)?v(new Q("Unsupported protocol "+Ie+":",Q.ERR_BAD_REQUEST,c)):se.send(ne)}))}},545:(c,y,v)=>{"use strict";var w=v(562),C=v(294),b=v(453),S=v(667);var T=function createInstance(c){var y=new b(c),v=C(b.prototype.request,y);return w.extend(v,b.prototype,y),w.extend(v,y),v.create=function create(y){return createInstance(S(c,y))},v}(v(351));T.Axios=b,T.CanceledError=v(194),T.CancelToken=v(798),T.isCancel=v(417),T.VERSION=v(695).version,T.toFormData=v(304),T.AxiosError=v(584),T.Cancel=T.CanceledError,T.all=function all(c){return Promise.all(c)},T.spread=v(348),T.isAxiosError=v(184),c.exports=T,c.exports.default=T},798:(c,y,v)=>{"use strict";var w=v(194);function CancelToken(c){if("function"!=typeof c)throw new TypeError("executor must be a function.");var y;this.promise=new Promise((function promiseExecutor(c){y=c}));var v=this;this.promise.then((function(c){if(v._listeners){var y,w=v._listeners.length;for(y=0;y<w;y++)v._listeners[y](c);v._listeners=null}})),this.promise.then=function(c){var y,w=new Promise((function(c){v.subscribe(c),y=c})).then(c);return w.cancel=function reject(){v.unsubscribe(y)},w},c((function cancel(c){v.reason||(v.reason=new w(c),y(v.reason))}))}CancelToken.prototype.throwIfRequested=function throwIfRequested(){if(this.reason)throw this.reason},CancelToken.prototype.subscribe=function subscribe(c){this.reason?c(this.reason):this._listeners?this._listeners.push(c):this._listeners=[c]},CancelToken.prototype.unsubscribe=function unsubscribe(c){if(this._listeners){var y=this._listeners.indexOf(c);-1!==y&&this._listeners.splice(y,1)}},CancelToken.source=function source(){var c;return{token:new CancelToken((function executor(y){c=y})),cancel:c}},c.exports=CancelToken},194:(c,y,v)=>{"use strict";var w=v(584);function CanceledError(c){w.call(this,null==c?"canceled":c,w.ERR_CANCELED),this.name="CanceledError"}v(562).inherits(CanceledError,w,{__CANCEL__:!0}),c.exports=CanceledError},417:c=>{"use strict";c.exports=function isCancel(c){return!(!c||!c.__CANCEL__)}},453:(c,y,v)=>{"use strict";var w=v(562),C=v(882),b=v(569),S=v(623),T=v(667),I=v(277),P=v(385),K=P.validators;function Axios(c){this.defaults=c,this.interceptors={request:new b,response:new b}}Axios.prototype.request=function request(c,y){"string"==typeof c?(y=y||{}).url=c:y=c||{},(y=T(this.defaults,y)).method?y.method=y.method.toLowerCase():this.defaults.method?y.method=this.defaults.method.toLowerCase():y.method="get";var v=y.transitional;void 0!==v&&P.assertOptions(v,{silentJSONParsing:K.transitional(K.boolean),forcedJSONParsing:K.transitional(K.boolean),clarifyTimeoutError:K.transitional(K.boolean)},!1);var w=[],C=!0;this.interceptors.request.forEach((function unshiftRequestInterceptors(c){"function"==typeof c.runWhen&&!1===c.runWhen(y)||(C=C&&c.synchronous,w.unshift(c.fulfilled,c.rejected))}));var b,I=[];if(this.interceptors.response.forEach((function pushResponseInterceptors(c){I.push(c.fulfilled,c.rejected)})),!C){var Q=[S,void 0];for(Array.prototype.unshift.apply(Q,w),Q=Q.concat(I),b=Promise.resolve(y);Q.length;)b=b.then(Q.shift(),Q.shift());return b}for(var X=y;w.length;){var te=w.shift(),re=w.shift();try{X=te(X)}catch(c){re(c);break}}try{b=S(X)}catch(c){return Promise.reject(c)}for(;I.length;)b=b.then(I.shift(),I.shift());return b},Axios.prototype.getUri=function getUri(c){c=T(this.defaults,c);var y=I(c.baseURL,c.url);return C(y,c.params,c.paramsSerializer)},w.forEach(["delete","get","head","options"],(function forEachMethodNoData(c){Axios.prototype[c]=function(y,v){return this.request(T(v||{},{method:c,url:y,data:(v||{}).data}))}})),w.forEach(["post","put","patch"],(function forEachMethodWithData(c){function generateHTTPMethod(y){return function httpMethod(v,w,C){return this.request(T(C||{},{method:c,headers:y?{"Content-Type":"multipart/form-data"}:{},url:v,data:w}))}}Axios.prototype[c]=generateHTTPMethod(),Axios.prototype[c+"Form"]=generateHTTPMethod(!0)})),c.exports=Axios},584:(c,y,v)=>{"use strict";var w=v(562);function AxiosError(c,y,v,w,C){Error.call(this),this.message=c,this.name="AxiosError",y&&(this.code=y),v&&(this.config=v),w&&(this.request=w),C&&(this.response=C)}w.inherits(AxiosError,Error,{toJSON:function toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var C=AxiosError.prototype,b={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(c){b[c]={value:c}})),Object.defineProperties(AxiosError,b),Object.defineProperty(C,"isAxiosError",{value:!0}),AxiosError.from=function(c,y,v,b,S,T){var I=Object.create(C);return w.toFlatObject(c,I,(function filter(c){return c!==Error.prototype})),AxiosError.call(I,c.message,y,v,b,S),I.name=c.name,T&&Object.assign(I,T),I},c.exports=AxiosError},569:(c,y,v)=>{"use strict";var w=v(562);function InterceptorManager(){this.handlers=[]}InterceptorManager.prototype.use=function use(c,y,v){return this.handlers.push({fulfilled:c,rejected:y,synchronous:!!v&&v.synchronous,runWhen:v?v.runWhen:null}),this.handlers.length-1},InterceptorManager.prototype.eject=function eject(c){this.handlers[c]&&(this.handlers[c]=null)},InterceptorManager.prototype.forEach=function forEach(c){w.forEach(this.handlers,(function forEachHandler(y){null!==y&&c(y)}))},c.exports=InterceptorManager},277:(c,y,v)=>{"use strict";var w=v(204),C=v(904);c.exports=function buildFullPath(c,y){return c&&!w(y)?C(c,y):y}},623:(c,y,v)=>{"use strict";var w=v(562),C=v(244),b=v(417),S=v(351),T=v(194);function throwIfCancellationRequested(c){if(c.cancelToken&&c.cancelToken.throwIfRequested(),c.signal&&c.signal.aborted)throw new T}c.exports=function dispatchRequest(c){return throwIfCancellationRequested(c),c.headers=c.headers||{},c.data=C.call(c,c.data,c.headers,c.transformRequest),c.headers=w.merge(c.headers.common||{},c.headers[c.method]||{},c.headers),w.forEach(["delete","get","head","post","put","patch","common"],(function cleanHeaderConfig(y){delete c.headers[y]})),(c.adapter||S.adapter)(c).then((function onAdapterResolution(y){return throwIfCancellationRequested(c),y.data=C.call(c,y.data,y.headers,c.transformResponse),y}),(function onAdapterRejection(y){return b(y)||(throwIfCancellationRequested(c),y&&y.response&&(y.response.data=C.call(c,y.response.data,y.response.headers,c.transformResponse))),Promise.reject(y)}))}},667:(c,y,v)=>{"use strict";var w=v(562);c.exports=function mergeConfig(c,y){y=y||{};var v={};function getMergedValue(c,y){return w.isPlainObject(c)&&w.isPlainObject(y)?w.merge(c,y):w.isPlainObject(y)?w.merge({},y):w.isArray(y)?y.slice():y}function mergeDeepProperties(v){return w.isUndefined(y[v])?w.isUndefined(c[v])?void 0:getMergedValue(void 0,c[v]):getMergedValue(c[v],y[v])}function valueFromConfig2(c){if(!w.isUndefined(y[c]))return getMergedValue(void 0,y[c])}function defaultToConfig2(v){return w.isUndefined(y[v])?w.isUndefined(c[v])?void 0:getMergedValue(void 0,c[v]):getMergedValue(void 0,y[v])}function mergeDirectKeys(v){return v in y?getMergedValue(c[v],y[v]):v in c?getMergedValue(void 0,c[v]):void 0}var C={url:valueFromConfig2,method:valueFromConfig2,data:valueFromConfig2,baseURL:defaultToConfig2,transformRequest:defaultToConfig2,transformResponse:defaultToConfig2,paramsSerializer:defaultToConfig2,timeout:defaultToConfig2,timeoutMessage:defaultToConfig2,withCredentials:defaultToConfig2,adapter:defaultToConfig2,responseType:defaultToConfig2,xsrfCookieName:defaultToConfig2,xsrfHeaderName:defaultToConfig2,onUploadProgress:defaultToConfig2,onDownloadProgress:defaultToConfig2,decompress:defaultToConfig2,maxContentLength:defaultToConfig2,maxBodyLength:defaultToConfig2,beforeRedirect:defaultToConfig2,transport:defaultToConfig2,httpAgent:defaultToConfig2,httpsAgent:defaultToConfig2,cancelToken:defaultToConfig2,socketPath:defaultToConfig2,responseEncoding:defaultToConfig2,validateStatus:mergeDirectKeys};return w.forEach(Object.keys(c).concat(Object.keys(y)),(function computeConfigValue(c){var y=C[c]||mergeDeepProperties,b=y(c);w.isUndefined(b)&&y!==mergeDirectKeys||(v[c]=b)})),v}},250:(c,y,v)=>{"use strict";var w=v(584);c.exports=function settle(c,y,v){var C=v.config.validateStatus;v.status&&C&&!C(v.status)?y(new w("Request failed with status code "+v.status,[w.ERR_BAD_REQUEST,w.ERR_BAD_RESPONSE][Math.floor(v.status/100)-4],v.config,v.request,v)):c(v)}},244:(c,y,v)=>{"use strict";var w=v(562),C=v(351);c.exports=function transformData(c,y,v){var b=this||C;return w.forEach(v,(function transform(v){c=v.call(b,c,y)})),c}},351:(c,y,v)=>{"use strict";var w=v(562),C=v(593),b=v(584),S=v(230),T=v(304),I={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(c,y){!w.isUndefined(c)&&w.isUndefined(c["Content-Type"])&&(c["Content-Type"]=y)}var P={transitional:S,adapter:function getDefaultAdapter(){var c;return("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(c=v(662)),c}(),transformRequest:[function transformRequest(c,y){if(C(y,"Accept"),C(y,"Content-Type"),w.isFormData(c)||w.isArrayBuffer(c)||w.isBuffer(c)||w.isStream(c)||w.isFile(c)||w.isBlob(c))return c;if(w.isArrayBufferView(c))return c.buffer;if(w.isURLSearchParams(c))return setContentTypeIfUnset(y,"application/x-www-form-urlencoded;charset=utf-8"),c.toString();var v,b=w.isObject(c),S=y&&y["Content-Type"];if((v=w.isFileList(c))||b&&"multipart/form-data"===S){var I=this.env&&this.env.FormData;return T(v?{"files[]":c}:c,I&&new I)}return b||"application/json"===S?(setContentTypeIfUnset(y,"application/json"),function stringifySafely(c,y,v){if(w.isString(c))try{return(y||JSON.parse)(c),w.trim(c)}catch(c){if("SyntaxError"!==c.name)throw c}return(v||JSON.stringify)(c)}(c)):c}],transformResponse:[function transformResponse(c){var y=this.transitional||P.transitional,v=y&&y.silentJSONParsing,C=y&&y.forcedJSONParsing,S=!v&&"json"===this.responseType;if(S||C&&w.isString(c)&&c.length)try{return JSON.parse(c)}catch(c){if(S){if("SyntaxError"===c.name)throw b.from(c,b.ERR_BAD_RESPONSE,this,null,this.response);throw c}}return c}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:v(841)},validateStatus:function validateStatus(c){return c>=200&&c<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};w.forEach(["delete","get","head"],(function forEachMethodNoData(c){P.headers[c]={}})),w.forEach(["post","put","patch"],(function forEachMethodWithData(c){P.headers[c]=w.merge(I)})),c.exports=P},230:c=>{"use strict";c.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},695:c=>{c.exports={version:"0.27.2"}},294:c=>{"use strict";c.exports=function bind(c,y){return function wrap(){for(var v=new Array(arguments.length),w=0;w<v.length;w++)v[w]=arguments[w];return c.apply(y,v)}}},882:(c,y,v)=>{"use strict";var w=v(562);function encode(c){return encodeURIComponent(c).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}c.exports=function buildURL(c,y,v){if(!y)return c;var C;if(v)C=v(y);else if(w.isURLSearchParams(y))C=y.toString();else{var b=[];w.forEach(y,(function serialize(c,y){null!=c&&(w.isArray(c)?y+="[]":c=[c],w.forEach(c,(function parseValue(c){w.isDate(c)?c=c.toISOString():w.isObject(c)&&(c=JSON.stringify(c)),b.push(encode(y)+"="+encode(c))})))})),C=b.join("&")}if(C){var S=c.indexOf("#");-1!==S&&(c=c.slice(0,S)),c+=(-1===c.indexOf("?")?"?":"&")+C}return c}},904:c=>{"use strict";c.exports=function combineURLs(c,y){return y?c.replace(/\/+$/,"")+"/"+y.replace(/^\/+/,""):c}},639:(c,y,v)=>{"use strict";var w=v(562);c.exports=w.isStandardBrowserEnv()?function standardBrowserEnv(){return{write:function write(c,y,v,C,b,S){var T=[];T.push(c+"="+encodeURIComponent(y)),w.isNumber(v)&&T.push("expires="+new Date(v).toGMTString()),w.isString(C)&&T.push("path="+C),w.isString(b)&&T.push("domain="+b),!0===S&&T.push("secure"),document.cookie=T.join("; ")},read:function read(c){var y=document.cookie.match(new RegExp("(^|;\\s*)("+c+")=([^;]*)"));return y?decodeURIComponent(y[3]):null},remove:function remove(c){this.write(c,"",Date.now()-864e5)}}}():{write:function write(){},read:function read(){return null},remove:function remove(){}}},204:c=>{"use strict";c.exports=function isAbsoluteURL(c){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(c)}},184:(c,y,v)=>{"use strict";var w=v(562);c.exports=function isAxiosError(c){return w.isObject(c)&&!0===c.isAxiosError}},563:(c,y,v)=>{"use strict";var w=v(562);c.exports=w.isStandardBrowserEnv()?function standardBrowserEnv(){var c,y=/(msie|trident)/i.test(navigator.userAgent),v=document.createElement("a");function resolveURL(c){var w=c;return y&&(v.setAttribute("href",w),w=v.href),v.setAttribute("href",w),{href:v.href,protocol:v.protocol?v.protocol.replace(/:$/,""):"",host:v.host,search:v.search?v.search.replace(/^\?/,""):"",hash:v.hash?v.hash.replace(/^#/,""):"",hostname:v.hostname,port:v.port,pathname:"/"===v.pathname.charAt(0)?v.pathname:"/"+v.pathname}}return c=resolveURL(window.location.href),function isURLSameOrigin(y){var v=w.isString(y)?resolveURL(y):y;return v.protocol===c.protocol&&v.host===c.host}}():function isURLSameOrigin(){return!0}},593:(c,y,v)=>{"use strict";var w=v(562);c.exports=function normalizeHeaderName(c,y){w.forEach(c,(function processHeader(v,w){w!==y&&w.toUpperCase()===y.toUpperCase()&&(c[y]=v,delete c[w])}))}},841:c=>{c.exports=null},999:(c,y,v)=>{"use strict";var w=v(562),C=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];c.exports=function parseHeaders(c){var y,v,b,S={};return c?(w.forEach(c.split("\n"),(function parser(c){if(b=c.indexOf(":"),y=w.trim(c.substr(0,b)).toLowerCase(),v=w.trim(c.substr(b+1)),y){if(S[y]&&C.indexOf(y)>=0)return;S[y]="set-cookie"===y?(S[y]?S[y]:[]).concat([v]):S[y]?S[y]+", "+v:v}})),S):S}},582:c=>{"use strict";c.exports=function parseProtocol(c){var y=/^([-+\w]{1,25})(:?\/\/|:)/.exec(c);return y&&y[1]||""}},348:c=>{"use strict";c.exports=function spread(c){return function wrap(y){return c.apply(null,y)}}},304:(c,y,v)=>{"use strict";var w=v(562);c.exports=function toFormData(c,y){y=y||new FormData;var v=[];function convertValue(c){return null===c?"":w.isDate(c)?c.toISOString():w.isArrayBuffer(c)||w.isTypedArray(c)?"function"==typeof Blob?new Blob([c]):Buffer.from(c):c}return function build(c,C){if(w.isPlainObject(c)||w.isArray(c)){if(-1!==v.indexOf(c))throw Error("Circular reference detected in "+C);v.push(c),w.forEach(c,(function each(c,v){if(!w.isUndefined(c)){var b,S=C?C+"."+v:v;if(c&&!C&&"object"==typeof c)if(w.endsWith(v,"{}"))c=JSON.stringify(c);else if(w.endsWith(v,"[]")&&(b=w.toArray(c)))return void b.forEach((function(c){!w.isUndefined(c)&&y.append(S,convertValue(c))}));build(c,S)}})),v.pop()}else y.append(C,convertValue(c))}(c),y}},385:(c,y,v)=>{"use strict";var w=v(695).version,C=v(584),b={};["object","boolean","number","function","string","symbol"].forEach((function(c,y){b[c]=function validator(v){return typeof v===c||"a"+(y<1?"n ":" ")+c}}));var S={};b.transitional=function transitional(c,y,v){function formatMessage(c,y){return"[Axios v"+w+"] Transitional option '"+c+"'"+y+(v?". "+v:"")}return function(v,w,b){if(!1===c)throw new C(formatMessage(w," has been removed"+(y?" in "+y:"")),C.ERR_DEPRECATED);return y&&!S[w]&&(S[w]=!0,console.warn(formatMessage(w," has been deprecated since v"+y+" and will be removed in the near future"))),!c||c(v,w,b)}},c.exports={assertOptions:function assertOptions(c,y,v){if("object"!=typeof c)throw new C("options must be an object",C.ERR_BAD_OPTION_VALUE);for(var w=Object.keys(c),b=w.length;b-- >0;){var S=w[b],T=y[S];if(T){var I=c[S],P=void 0===I||T(I,S,c);if(!0!==P)throw new C("option "+S+" must be "+P,C.ERR_BAD_OPTION_VALUE)}else if(!0!==v)throw new C("Unknown option "+S,C.ERR_BAD_OPTION)}},validators:b}},562:(c,y,v)=>{"use strict";var w,C=v(294),b=Object.prototype.toString,S=(w=Object.create(null),function(c){var y=b.call(c);return w[y]||(w[y]=y.slice(8,-1).toLowerCase())});function kindOfTest(c){return c=c.toLowerCase(),function isKindOf(y){return S(y)===c}}function isArray(c){return Array.isArray(c)}function isUndefined(c){return void 0===c}var T=kindOfTest("ArrayBuffer");function isObject(c){return null!==c&&"object"==typeof c}function isPlainObject(c){if("object"!==S(c))return!1;var y=Object.getPrototypeOf(c);return null===y||y===Object.prototype}var I=kindOfTest("Date"),P=kindOfTest("File"),K=kindOfTest("Blob"),Q=kindOfTest("FileList");function isFunction(c){return"[object Function]"===b.call(c)}var X=kindOfTest("URLSearchParams");function forEach(c,y){if(null!=c)if("object"!=typeof c&&(c=[c]),isArray(c))for(var v=0,w=c.length;v<w;v++)y.call(null,c[v],v,c);else for(var C in c)Object.prototype.hasOwnProperty.call(c,C)&&y.call(null,c[C],C,c)}var te,re=(te="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(c){return te&&c instanceof te});c.exports={isArray,isArrayBuffer:T,isBuffer:function isBuffer(c){return null!==c&&!isUndefined(c)&&null!==c.constructor&&!isUndefined(c.constructor)&&"function"==typeof c.constructor.isBuffer&&c.constructor.isBuffer(c)},isFormData:function isFormData(c){var y="[object FormData]";return c&&("function"==typeof FormData&&c instanceof FormData||b.call(c)===y||isFunction(c.toString)&&c.toString()===y)},isArrayBufferView:function isArrayBufferView(c){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(c):c&&c.buffer&&T(c.buffer)},isString:function isString(c){return"string"==typeof c},isNumber:function isNumber(c){return"number"==typeof c},isObject,isPlainObject,isUndefined,isDate:I,isFile:P,isBlob:K,isFunction,isStream:function isStream(c){return isObject(c)&&isFunction(c.pipe)},isURLSearchParams:X,isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach,merge:function merge(){var c={};function assignValue(y,v){isPlainObject(c[v])&&isPlainObject(y)?c[v]=merge(c[v],y):isPlainObject(y)?c[v]=merge({},y):isArray(y)?c[v]=y.slice():c[v]=y}for(var y=0,v=arguments.length;y<v;y++)forEach(arguments[y],assignValue);return c},extend:function extend(c,y,v){return forEach(y,(function assignValue(y,w){c[w]=v&&"function"==typeof y?C(y,v):y})),c},trim:function trim(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")},stripBOM:function stripBOM(c){return 65279===c.charCodeAt(0)&&(c=c.slice(1)),c},inherits:function inherits(c,y,v,w){c.prototype=Object.create(y.prototype,w),c.prototype.constructor=c,v&&Object.assign(c.prototype,v)},toFlatObject:function toFlatObject(c,y,v){var w,C,b,S={};y=y||{};do{for(C=(w=Object.getOwnPropertyNames(c)).length;C-- >0;)S[b=w[C]]||(y[b]=c[b],S[b]=!0);c=Object.getPrototypeOf(c)}while(c&&(!v||v(c,y))&&c!==Object.prototype);return y},kindOf:S,kindOfTest,endsWith:function endsWith(c,y,v){c=String(c),(void 0===v||v>c.length)&&(v=c.length),v-=y.length;var w=c.indexOf(y,v);return-1!==w&&w===v},toArray:function toArray(c){if(!c)return null;var y=c.length;if(isUndefined(y))return null;for(var v=new Array(y);y-- >0;)v[y]=c[y];return v},isTypedArray:re,isFileList:Q}},373:(c,y,v)=>{
/*!
 *
 *   @aptero/axolotis-module-basic v1.0.0
 *
 *   Copyright (c) Aptero  and project contributors.
 *
 *   This source code is licensed under the undefined license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */
!function webpackUniversalModuleDefinition(y,w){c.exports=w(v(12))}(self,(c=>(()=>{var y={9669:(c,y,v)=>{c.exports=v(1609)},5448:(c,y,v)=>{"use strict";var w=v(4867),C=v(6026),b=v(4372),S=v(1246),T=v(4097),I=v(4109),P=v(7985),K=v(5061);c.exports=function xhrAdapter(c){return new Promise((function dispatchXhrRequest(y,v){var Q=c.data,X=c.headers,te=c.responseType;w.isFormData(Q)&&delete X["Content-Type"];var re=new XMLHttpRequest;if(c.auth){var ne=c.auth.username||"",oe=c.auth.password?unescape(encodeURIComponent(c.auth.password)):"";X.Authorization="Basic "+btoa(ne+":"+oe)}var ie=T(c.baseURL,c.url);function onloadend(){if(re){var w="getAllResponseHeaders"in re?I(re.getAllResponseHeaders()):null,b={data:te&&"text"!==te&&"json"!==te?re.response:re.responseText,status:re.status,statusText:re.statusText,headers:w,config:c,request:re};C(y,v,b),re=null}}if(re.open(c.method.toUpperCase(),S(ie,c.params,c.paramsSerializer),!0),re.timeout=c.timeout,"onloadend"in re?re.onloadend=onloadend:re.onreadystatechange=function handleLoad(){re&&4===re.readyState&&(0!==re.status||re.responseURL&&0===re.responseURL.indexOf("file:"))&&setTimeout(onloadend)},re.onabort=function handleAbort(){re&&(v(K("Request aborted",c,"ECONNABORTED",re)),re=null)},re.onerror=function handleError(){v(K("Network Error",c,null,re)),re=null},re.ontimeout=function handleTimeout(){var y="timeout of "+c.timeout+"ms exceeded";c.timeoutErrorMessage&&(y=c.timeoutErrorMessage),v(K(y,c,c.transitional&&c.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",re)),re=null},w.isStandardBrowserEnv()){var se=(c.withCredentials||P(ie))&&c.xsrfCookieName?b.read(c.xsrfCookieName):void 0;se&&(X[c.xsrfHeaderName]=se)}"setRequestHeader"in re&&w.forEach(X,(function setRequestHeader(c,y){void 0===Q&&"content-type"===y.toLowerCase()?delete X[y]:re.setRequestHeader(y,c)})),w.isUndefined(c.withCredentials)||(re.withCredentials=!!c.withCredentials),te&&"json"!==te&&(re.responseType=c.responseType),"function"==typeof c.onDownloadProgress&&re.addEventListener("progress",c.onDownloadProgress),"function"==typeof c.onUploadProgress&&re.upload&&re.upload.addEventListener("progress",c.onUploadProgress),c.cancelToken&&c.cancelToken.promise.then((function onCanceled(c){re&&(re.abort(),v(c),re=null)})),Q||(Q=null),re.send(Q)}))}},1609:(c,y,v)=>{"use strict";var w=v(4867),C=v(1849),b=v(321),S=v(7185);function createInstance(c){var y=new b(c),v=C(b.prototype.request,y);return w.extend(v,b.prototype,y),w.extend(v,y),v}var T=createInstance(v(5655));T.Axios=b,T.create=function create(c){return createInstance(S(T.defaults,c))},T.Cancel=v(5263),T.CancelToken=v(4972),T.isCancel=v(6502),T.all=function all(c){return Promise.all(c)},T.spread=v(8713),T.isAxiosError=v(6268),c.exports=T,c.exports.default=T},5263:c=>{"use strict";function Cancel(c){this.message=c}Cancel.prototype.toString=function toString(){return"Cancel"+(this.message?": "+this.message:"")},Cancel.prototype.__CANCEL__=!0,c.exports=Cancel},4972:(c,y,v)=>{"use strict";var w=v(5263);function CancelToken(c){if("function"!=typeof c)throw new TypeError("executor must be a function.");var y;this.promise=new Promise((function promiseExecutor(c){y=c}));var v=this;c((function cancel(c){v.reason||(v.reason=new w(c),y(v.reason))}))}CancelToken.prototype.throwIfRequested=function throwIfRequested(){if(this.reason)throw this.reason},CancelToken.source=function source(){var c;return{token:new CancelToken((function executor(y){c=y})),cancel:c}},c.exports=CancelToken},6502:c=>{"use strict";c.exports=function isCancel(c){return!(!c||!c.__CANCEL__)}},321:(c,y,v)=>{"use strict";var w=v(4867),C=v(1246),b=v(782),S=v(3572),T=v(7185),I=v(4875),P=I.validators;function Axios(c){this.defaults=c,this.interceptors={request:new b,response:new b}}Axios.prototype.request=function request(c){"string"==typeof c?(c=arguments[1]||{}).url=arguments[0]:c=c||{},(c=T(this.defaults,c)).method?c.method=c.method.toLowerCase():this.defaults.method?c.method=this.defaults.method.toLowerCase():c.method="get";var y=c.transitional;void 0!==y&&I.assertOptions(y,{silentJSONParsing:P.transitional(P.boolean,"1.0.0"),forcedJSONParsing:P.transitional(P.boolean,"1.0.0"),clarifyTimeoutError:P.transitional(P.boolean,"1.0.0")},!1);var v=[],w=!0;this.interceptors.request.forEach((function unshiftRequestInterceptors(y){"function"==typeof y.runWhen&&!1===y.runWhen(c)||(w=w&&y.synchronous,v.unshift(y.fulfilled,y.rejected))}));var C,b=[];if(this.interceptors.response.forEach((function pushResponseInterceptors(c){b.push(c.fulfilled,c.rejected)})),!w){var K=[S,void 0];for(Array.prototype.unshift.apply(K,v),K=K.concat(b),C=Promise.resolve(c);K.length;)C=C.then(K.shift(),K.shift());return C}for(var Q=c;v.length;){var X=v.shift(),te=v.shift();try{Q=X(Q)}catch(c){te(c);break}}try{C=S(Q)}catch(c){return Promise.reject(c)}for(;b.length;)C=C.then(b.shift(),b.shift());return C},Axios.prototype.getUri=function getUri(c){return c=T(this.defaults,c),C(c.url,c.params,c.paramsSerializer).replace(/^\?/,"")},w.forEach(["delete","get","head","options"],(function forEachMethodNoData(c){Axios.prototype[c]=function(y,v){return this.request(T(v||{},{method:c,url:y,data:(v||{}).data}))}})),w.forEach(["post","put","patch"],(function forEachMethodWithData(c){Axios.prototype[c]=function(y,v,w){return this.request(T(w||{},{method:c,url:y,data:v}))}})),c.exports=Axios},782:(c,y,v)=>{"use strict";var w=v(4867);function InterceptorManager(){this.handlers=[]}InterceptorManager.prototype.use=function use(c,y,v){return this.handlers.push({fulfilled:c,rejected:y,synchronous:!!v&&v.synchronous,runWhen:v?v.runWhen:null}),this.handlers.length-1},InterceptorManager.prototype.eject=function eject(c){this.handlers[c]&&(this.handlers[c]=null)},InterceptorManager.prototype.forEach=function forEach(c){w.forEach(this.handlers,(function forEachHandler(y){null!==y&&c(y)}))},c.exports=InterceptorManager},4097:(c,y,v)=>{"use strict";var w=v(1793),C=v(7303);c.exports=function buildFullPath(c,y){return c&&!w(y)?C(c,y):y}},5061:(c,y,v)=>{"use strict";var w=v(481);c.exports=function createError(c,y,v,C,b){var S=new Error(c);return w(S,y,v,C,b)}},3572:(c,y,v)=>{"use strict";var w=v(4867),C=v(8527),b=v(6502),S=v(5655);function throwIfCancellationRequested(c){c.cancelToken&&c.cancelToken.throwIfRequested()}c.exports=function dispatchRequest(c){return throwIfCancellationRequested(c),c.headers=c.headers||{},c.data=C.call(c,c.data,c.headers,c.transformRequest),c.headers=w.merge(c.headers.common||{},c.headers[c.method]||{},c.headers),w.forEach(["delete","get","head","post","put","patch","common"],(function cleanHeaderConfig(y){delete c.headers[y]})),(c.adapter||S.adapter)(c).then((function onAdapterResolution(y){return throwIfCancellationRequested(c),y.data=C.call(c,y.data,y.headers,c.transformResponse),y}),(function onAdapterRejection(y){return b(y)||(throwIfCancellationRequested(c),y&&y.response&&(y.response.data=C.call(c,y.response.data,y.response.headers,c.transformResponse))),Promise.reject(y)}))}},481:c=>{"use strict";c.exports=function enhanceError(c,y,v,w,C){return c.config=y,v&&(c.code=v),c.request=w,c.response=C,c.isAxiosError=!0,c.toJSON=function toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},c}},7185:(c,y,v)=>{"use strict";var w=v(4867);c.exports=function mergeConfig(c,y){y=y||{};var v={},C=["url","method","data"],b=["headers","auth","proxy","params"],S=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],T=["validateStatus"];function getMergedValue(c,y){return w.isPlainObject(c)&&w.isPlainObject(y)?w.merge(c,y):w.isPlainObject(y)?w.merge({},y):w.isArray(y)?y.slice():y}function mergeDeepProperties(C){w.isUndefined(y[C])?w.isUndefined(c[C])||(v[C]=getMergedValue(void 0,c[C])):v[C]=getMergedValue(c[C],y[C])}w.forEach(C,(function valueFromConfig2(c){w.isUndefined(y[c])||(v[c]=getMergedValue(void 0,y[c]))})),w.forEach(b,mergeDeepProperties),w.forEach(S,(function defaultToConfig2(C){w.isUndefined(y[C])?w.isUndefined(c[C])||(v[C]=getMergedValue(void 0,c[C])):v[C]=getMergedValue(void 0,y[C])})),w.forEach(T,(function merge(w){w in y?v[w]=getMergedValue(c[w],y[w]):w in c&&(v[w]=getMergedValue(void 0,c[w]))}));var I=C.concat(b).concat(S).concat(T),P=Object.keys(c).concat(Object.keys(y)).filter((function filterAxiosKeys(c){return-1===I.indexOf(c)}));return w.forEach(P,mergeDeepProperties),v}},6026:(c,y,v)=>{"use strict";var w=v(5061);c.exports=function settle(c,y,v){var C=v.config.validateStatus;v.status&&C&&!C(v.status)?y(w("Request failed with status code "+v.status,v.config,null,v.request,v)):c(v)}},8527:(c,y,v)=>{"use strict";var w=v(4867),C=v(5655);c.exports=function transformData(c,y,v){var b=this||C;return w.forEach(v,(function transform(v){c=v.call(b,c,y)})),c}},5655:(c,y,v)=>{"use strict";var w=v(4867),C=v(6016),b=v(481),S={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(c,y){!w.isUndefined(c)&&w.isUndefined(c["Content-Type"])&&(c["Content-Type"]=y)}var T={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function getDefaultAdapter(){var c;return("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(c=v(5448)),c}(),transformRequest:[function transformRequest(c,y){return C(y,"Accept"),C(y,"Content-Type"),w.isFormData(c)||w.isArrayBuffer(c)||w.isBuffer(c)||w.isStream(c)||w.isFile(c)||w.isBlob(c)?c:w.isArrayBufferView(c)?c.buffer:w.isURLSearchParams(c)?(setContentTypeIfUnset(y,"application/x-www-form-urlencoded;charset=utf-8"),c.toString()):w.isObject(c)||y&&"application/json"===y["Content-Type"]?(setContentTypeIfUnset(y,"application/json"),function stringifySafely(c,y,v){if(w.isString(c))try{return(y||JSON.parse)(c),w.trim(c)}catch(c){if("SyntaxError"!==c.name)throw c}return(v||JSON.stringify)(c)}(c)):c}],transformResponse:[function transformResponse(c){var y=this.transitional,v=y&&y.silentJSONParsing,C=y&&y.forcedJSONParsing,S=!v&&"json"===this.responseType;if(S||C&&w.isString(c)&&c.length)try{return JSON.parse(c)}catch(c){if(S){if("SyntaxError"===c.name)throw b(c,this,"E_JSON_PARSE");throw c}}return c}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function validateStatus(c){return c>=200&&c<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};w.forEach(["delete","get","head"],(function forEachMethodNoData(c){T.headers[c]={}})),w.forEach(["post","put","patch"],(function forEachMethodWithData(c){T.headers[c]=w.merge(S)})),c.exports=T},1849:c=>{"use strict";c.exports=function bind(c,y){return function wrap(){for(var v=new Array(arguments.length),w=0;w<v.length;w++)v[w]=arguments[w];return c.apply(y,v)}}},1246:(c,y,v)=>{"use strict";var w=v(4867);function encode(c){return encodeURIComponent(c).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}c.exports=function buildURL(c,y,v){if(!y)return c;var C;if(v)C=v(y);else if(w.isURLSearchParams(y))C=y.toString();else{var b=[];w.forEach(y,(function serialize(c,y){null!=c&&(w.isArray(c)?y+="[]":c=[c],w.forEach(c,(function parseValue(c){w.isDate(c)?c=c.toISOString():w.isObject(c)&&(c=JSON.stringify(c)),b.push(encode(y)+"="+encode(c))})))})),C=b.join("&")}if(C){var S=c.indexOf("#");-1!==S&&(c=c.slice(0,S)),c+=(-1===c.indexOf("?")?"?":"&")+C}return c}},7303:c=>{"use strict";c.exports=function combineURLs(c,y){return y?c.replace(/\/+$/,"")+"/"+y.replace(/^\/+/,""):c}},4372:(c,y,v)=>{"use strict";var w=v(4867);c.exports=w.isStandardBrowserEnv()?function standardBrowserEnv(){return{write:function write(c,y,v,C,b,S){var T=[];T.push(c+"="+encodeURIComponent(y)),w.isNumber(v)&&T.push("expires="+new Date(v).toGMTString()),w.isString(C)&&T.push("path="+C),w.isString(b)&&T.push("domain="+b),!0===S&&T.push("secure"),document.cookie=T.join("; ")},read:function read(c){var y=document.cookie.match(new RegExp("(^|;\\s*)("+c+")=([^;]*)"));return y?decodeURIComponent(y[3]):null},remove:function remove(c){this.write(c,"",Date.now()-864e5)}}}():{write:function write(){},read:function read(){return null},remove:function remove(){}}},1793:c=>{"use strict";c.exports=function isAbsoluteURL(c){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(c)}},6268:c=>{"use strict";c.exports=function isAxiosError(c){return"object"==typeof c&&!0===c.isAxiosError}},7985:(c,y,v)=>{"use strict";var w=v(4867);c.exports=w.isStandardBrowserEnv()?function standardBrowserEnv(){var c,y=/(msie|trident)/i.test(navigator.userAgent),v=document.createElement("a");function resolveURL(c){var w=c;return y&&(v.setAttribute("href",w),w=v.href),v.setAttribute("href",w),{href:v.href,protocol:v.protocol?v.protocol.replace(/:$/,""):"",host:v.host,search:v.search?v.search.replace(/^\?/,""):"",hash:v.hash?v.hash.replace(/^#/,""):"",hostname:v.hostname,port:v.port,pathname:"/"===v.pathname.charAt(0)?v.pathname:"/"+v.pathname}}return c=resolveURL(window.location.href),function isURLSameOrigin(y){var v=w.isString(y)?resolveURL(y):y;return v.protocol===c.protocol&&v.host===c.host}}():function isURLSameOrigin(){return!0}},6016:(c,y,v)=>{"use strict";var w=v(4867);c.exports=function normalizeHeaderName(c,y){w.forEach(c,(function processHeader(v,w){w!==y&&w.toUpperCase()===y.toUpperCase()&&(c[y]=v,delete c[w])}))}},4109:(c,y,v)=>{"use strict";var w=v(4867),C=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];c.exports=function parseHeaders(c){var y,v,b,S={};return c?(w.forEach(c.split("\n"),(function parser(c){if(b=c.indexOf(":"),y=w.trim(c.substr(0,b)).toLowerCase(),v=w.trim(c.substr(b+1)),y){if(S[y]&&C.indexOf(y)>=0)return;S[y]="set-cookie"===y?(S[y]?S[y]:[]).concat([v]):S[y]?S[y]+", "+v:v}})),S):S}},8713:c=>{"use strict";c.exports=function spread(c){return function wrap(y){return c.apply(null,y)}}},4875:(c,y,v)=>{"use strict";var w=v(8593),C={};["object","boolean","number","function","string","symbol"].forEach((function(c,y){C[c]=function validator(v){return typeof v===c||"a"+(y<1?"n ":" ")+c}}));var b={},S=w.version.split(".");function isOlderVersion(c,y){for(var v=y?y.split("."):S,w=c.split("."),C=0;C<3;C++){if(v[C]>w[C])return!0;if(v[C]<w[C])return!1}return!1}C.transitional=function transitional(c,y,v){var C=y&&isOlderVersion(y);function formatMessage(c,y){return"[Axios v"+w.version+"] Transitional option '"+c+"'"+y+(v?". "+v:"")}return function(v,w,S){if(!1===c)throw new Error(formatMessage(w," has been removed in "+y));return C&&!b[w]&&(b[w]=!0,console.warn(formatMessage(w," has been deprecated since v"+y+" and will be removed in the near future"))),!c||c(v,w,S)}},c.exports={isOlderVersion,assertOptions:function assertOptions(c,y,v){if("object"!=typeof c)throw new TypeError("options must be an object");for(var w=Object.keys(c),C=w.length;C-- >0;){var b=w[C],S=y[b];if(S){var T=c[b],I=void 0===T||S(T,b,c);if(!0!==I)throw new TypeError("option "+b+" must be "+I)}else if(!0!==v)throw Error("Unknown option "+b)}},validators:C}},4867:(c,y,v)=>{"use strict";var w=v(1849),C=Object.prototype.toString;function isArray(c){return"[object Array]"===C.call(c)}function isUndefined(c){return void 0===c}function isObject(c){return null!==c&&"object"==typeof c}function isPlainObject(c){if("[object Object]"!==C.call(c))return!1;var y=Object.getPrototypeOf(c);return null===y||y===Object.prototype}function isFunction(c){return"[object Function]"===C.call(c)}function forEach(c,y){if(null!=c)if("object"!=typeof c&&(c=[c]),isArray(c))for(var v=0,w=c.length;v<w;v++)y.call(null,c[v],v,c);else for(var C in c)Object.prototype.hasOwnProperty.call(c,C)&&y.call(null,c[C],C,c)}c.exports={isArray,isArrayBuffer:function isArrayBuffer(c){return"[object ArrayBuffer]"===C.call(c)},isBuffer:function isBuffer(c){return null!==c&&!isUndefined(c)&&null!==c.constructor&&!isUndefined(c.constructor)&&"function"==typeof c.constructor.isBuffer&&c.constructor.isBuffer(c)},isFormData:function isFormData(c){return"undefined"!=typeof FormData&&c instanceof FormData},isArrayBufferView:function isArrayBufferView(c){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(c):c&&c.buffer&&c.buffer instanceof ArrayBuffer},isString:function isString(c){return"string"==typeof c},isNumber:function isNumber(c){return"number"==typeof c},isObject,isPlainObject,isUndefined,isDate:function isDate(c){return"[object Date]"===C.call(c)},isFile:function isFile(c){return"[object File]"===C.call(c)},isBlob:function isBlob(c){return"[object Blob]"===C.call(c)},isFunction,isStream:function isStream(c){return isObject(c)&&isFunction(c.pipe)},isURLSearchParams:function isURLSearchParams(c){return"undefined"!=typeof URLSearchParams&&c instanceof URLSearchParams},isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach,merge:function merge(){var c={};function assignValue(y,v){isPlainObject(c[v])&&isPlainObject(y)?c[v]=merge(c[v],y):isPlainObject(y)?c[v]=merge({},y):isArray(y)?c[v]=y.slice():c[v]=y}for(var y=0,v=arguments.length;y<v;y++)forEach(arguments[y],assignValue);return c},extend:function extend(c,y,v){return forEach(y,(function assignValue(y,C){c[C]=v&&"function"==typeof y?w(y,v):y})),c},trim:function trim(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")},stripBOM:function stripBOM(c){return 65279===c.charCodeAt(0)&&(c=c.slice(1)),c}}},6091:(c,y,v)=>{"use strict";v.r(y),v.d(y,{COOKIE_STORE_SERVICE:()=>X,CookieStore:()=>I.CookieStore,MsToNativeLoginBridge:()=>S._,NAME_SERVICE:()=>re,NameGenerationService:()=>C.NameGenerationService,PHX_AUTH_SERVICE:()=>te,PROPERTIES_SERVICE:()=>K,PhoenixAuthService:()=>b.PhoenixAuthService,PhoenixAuthServiceFactory:()=>b.PhoenixAuthServiceFactory,Properties:()=>w.Properties,ROOM_SERVICE:()=>ne,RoomService:()=>T.RoomService,RoomServiceFactory:()=>T.RoomServiceFactory,SCHEMA:()=>P.SCHEMA,STORE_SERVICE:()=>Q,Store:()=>P.Store});var w=v(1655),C=v(7566),b=v(8145),S=v(6199),T=v(3641),I=v(3926),P=v(8084),K="@aptero/axolotis-module-properties/Properties",Q="@aptero/axolotis-module-storage/Store",X="@aptero/axolotis-module-storage/CookieStore",te="@aptero/axolotis-module-phx-auth/PhoenixAuthService",re="@aptero/axolotis-module-name/NameService",ne="@aptero/axolotis-module-room/RoomService"},7566:(c,y,v)=>{"use strict";v.d(y,{NameGenerationService:()=>C});var w=v(9920);function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}var C=function(){function NameGenerationService(){!function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}(this,NameGenerationService)}return function _createClass(c,y,v){y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1})}(NameGenerationService,[{key:"getType",value:function getType(){return NameGenerationService.name}},{key:"generateHubName",value:function generateHubName(){return(0,w.A)()}}]),NameGenerationService}()},9920:(c,y,v)=>{"use strict";v.d(y,{A:()=>generateHubName});var w=["able","absolute","acceptable","acclaimed","accomplished","accurate","aching","acrobatic","adorable","adventurous","basic","belated","beloved","calm","candid","capital","carefree","caring","cautious","celebrated","charming","daring","darling","dearest","each","eager","early","earnest","easy","easygoing","ecstatic","edible","fabulous","fair","faithful","familiar","famous","fancy","fantastic","far","generous","gentle","genuine","giant","handmade","handsome","handy","happy","icy","ideal","identical","keen","lasting","lavish","magnificent","majestic","mammoth","marvelous","natural","obedient","palatable","parched","passionate","pastel","peaceful","perfect","perfumed","quaint","qualified","radiant","rapid","rare","safe","sandy","satisfied","scaly","scarce","scared","scary","scented","scientific","secret","sentimental","talkative","tangible","tart","tasty","tattered","teeming","ultimate","uncommon","unconscious","understated","warm","active","adept","admirable","admired","adorable","adored","advanced","affectionate","beneficial","best","better","big","cheerful","cheery","chief","chilly","classic","clean","clear","clever","decent","decisive","deep","defiant","definitive","delectable","delicious","elaborate","elastic","elated","elegant","elementary","elliptical","fast","favorable","favorite","fearless","gifted","glamorous","gleaming","glittering","harmonious","imaginative","immense","jealous","kind","leafy","legal","mature","mean","nautical","neat","necessary","needy","oddball","offbeat","periodic","perky","personal","pertinent","petty","quarterly","ready","real","realistic","reasonable","regal","serene","shabby","sharp","shiny","showy","shy","silky","tempting","tense","terrific","testy","thankful","uniform","unique","vast","weary","wee","welcome","agile","alarmed","alert","alive","bleak","blissful","blushing","coarse","colorful","colossal","comfortable","compassionate","complete","delightful","dense","dependable","dependent","descriptive","detailed","determined","devoted","different","eminent","emotional","enchanted","enchanting","energetic","enormous","fine","finished","firm","firsthand","fixed","flashy","flawless","glorious","glossy","golden","good","gorgeous","graceful","healthy","heartfelt","hearty","helpful","impartial","impressive","jolly","jovial","lighthearted","likable","lined","mellow","melodic","memorable","mild","new","opulent","playful","pleasant","pleasing","plump","plush","polished","polite","reliable","relieved","remarkable","remote","respectful","responsible","simple","simplistic","sizzling","sleepy","slight","slim","smart","smooth","snappy","snoopy","thirsty","this","thorough","those","thoughtful","united","vibrant","vicious","wellmade","whimsical","whirlwind","zesty","amazing","ambitious","ample","amused","amusing","ancient","angelic","antique","bold","bossy","both","bouncy","bountiful","complex","conscious","considerate","constant","content","conventional","cooked","cool","cooperative","diligent","dimwitted","direct","discrete","envious","essential","ethical","euphoric","flippant","fluffy","flustered","focused","fond","gracious","grand","grandiose","granular","grateful","grave","great","hidden","high","hilarious","homely","incomparable","incredible","infamous","joyful","lively","loathsome","lonely","long","mindless","miniature","minor","misty","next","nice","nifty","nimble","orderly","organic","ornate","popular","posh","positive","potable","powerful","powerless","precious","present","prestigious","quick","rewarding","rich","right","sociable","soft","solid","some","sophisticated","soulful","sparkling","spectacular","speedy","spicy","spiffy","spirited","spiteful","splendid","spotless","spry","thrifty","tidy","tight","timely","tinted","unruly","untimely","violet","wicked","wide","wild","willing","winding","windy","zigzag","apprehensive","appropriate","artistic","assured","astonishing","bright","brilliant","bronze","coordinated","courageous","courteous","crafty","crazy","creamy","creative","crisp","distant","distinct","downright","evergreen","everlasting","every","evil","excellent","excitable","exemplary","exhausted","forthright","fortunate","fragrant","frank","free","frequent","fresh","friendly","frightened","frigid","gripping","grounded","honest","honorable","honored","hopeful","hospitable","hot","huge","infatuated","infinite","informal","insistent","instructive","juicy","jumbo","knowing","knowledgeable","longterm","loud","lovable","loving","modern","modest","monumental","normal","notable","outgoing","precious","pretty","prickly","primary","pristine","private","prize","productive","profitable","quiet","quintessential","roasted","robust","square","squiggly","stable","staid","starry","steel","stimulating","striking","striped","strong","studious","stunning","tough","trained","treasured","tremendous","triangular","tricky","unused","unusual","upbeat","virtual","witty","wonderful","wooden","worldly","youthful","attached","attentive","attractive","austere","authentic","automatic","aware","awesome","bubbly","bustling","busy","buttery","cuddly","cultured","curly","curvy","cute","cylindrical","downright","dramatic","excited","exciting","exotic","experienced","expert","frosty","fruitful","full","fumbling","funny","fussy","growing","grown","gummy","humble","humongous","hungry","intelligent","interesting","known","kooky","loyal","lucky","luminous","lustrous","luxurious","multicolored","mysterious","noteworthy","numb","nutritious","outstanding","overjoyed","proper","proud","prudent","punctual","puny","pure","puzzled","puzzling","quirky","stupendous","sturdy","stylish","subdued","subtle","sunny","super","superb","supportive","surprised","sweet","swift","sympathetic","trivial","trusting","trustworthy","trusty","truthful","twin","usable","used","useful","utilized","vital","vivid","worried","worthwhile","worthy","writhing","wry","yummy","chocolate","crimson","cyan","fuchsia","gold","honeydew","lime","linen","magenta","olive","peru","salmon","seashell","sienna","snow","thistle","tomato","transparent","turquoise","violet"],C=["space","land","world","universe","plane","room","nation","plaza","gathering","meetup","get together","conclave","party","domain","dominion","realm","square","commons","park","cosmos","sphere","terrain","spot","zone","area","tract","turf","place","territory","volume","camp","picnic","outing","vacation","adventure","exploration","outing","walkabout","safari","venture","roundtable","barbecue","celebration","festivity","gala","shindig","social","convention","assembly","congregation","rendezvous","huddle","meet","soiree"];function generateHubName(){var c=function randItem(c){var y=c[Math.floor(Math.random()*c.length)];return y.charAt(0).toUpperCase()+y.slice(1)};return"".concat(c(w)," ").concat(c(w)," ").concat(c(C))}},9980:(c,y,v)=>{"use strict";function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}v.d(y,{t:()=>w});var w=function(){function AdminRole(){!function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}(this,AdminRole),function _defineProperty(c,y,v){y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v}(this,"admin",void 0)}return function _createClass(c,y,v){y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1})}(AdminRole,[{key:"setIsAdmin",value:function setIsAdmin(c){this.admin=c}},{key:"isAdmin",value:function isAdmin(){return this.admin}}]),AdminRole}()},6199:(c,y,v)=>{"use strict";v.d(y,{_:()=>T});var w=v(1171),C=v.n(w),b=v(5532),S=v(4976);function _typeof(c){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},_typeof(c)}function _regeneratorRuntime(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
_regeneratorRuntime=function _regeneratorRuntime(){return c};var c={},y=Object.prototype,v=y.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},C=w.iterator||"@@iterator",b=w.asyncIterator||"@@asyncIterator",S=w.toStringTag||"@@toStringTag";function define(c,y,v){return Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}),c[y]}try{define({},"")}catch(c){define=function define(c,y,v){return c[y]=v}}function wrap(c,y,v,w){var C=y&&y.prototype instanceof Generator?y:Generator,b=Object.create(C.prototype),S=new Context(w||[]);return b._invoke=function(c,y,v){var w="suspendedStart";return function(C,b){if("executing"===w)throw new Error("Generator is already running");if("completed"===w){if("throw"===C)throw b;return{value:void 0,done:!0}}for(v.method=C,v.arg=b;;){var S=v.delegate;if(S){var I=maybeInvokeDelegate(S,v);if(I){if(I===T)continue;return I}}if("next"===v.method)v.sent=v._sent=v.arg;else if("throw"===v.method){if("suspendedStart"===w)throw w="completed",v.arg;v.dispatchException(v.arg)}else"return"===v.method&&v.abrupt("return",v.arg);w="executing";var P=tryCatch(c,y,v);if("normal"===P.type){if(w=v.done?"completed":"suspendedYield",P.arg===T)continue;return{value:P.arg,done:v.done}}"throw"===P.type&&(w="completed",v.method="throw",v.arg=P.arg)}}}(c,v,S),b}function tryCatch(c,y,v){try{return{type:"normal",arg:c.call(y,v)}}catch(c){return{type:"throw",arg:c}}}c.wrap=wrap;var T={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var I={};define(I,C,(function(){return this}));var P=Object.getPrototypeOf,K=P&&P(P(values([])));K&&K!==y&&v.call(K,C)&&(I=K);var Q=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(I);function defineIteratorMethods(c){["next","throw","return"].forEach((function(y){define(c,y,(function(c){return this._invoke(y,c)}))}))}function AsyncIterator(c,y){function invoke(w,C,b,S){var T=tryCatch(c[w],c,C);if("throw"!==T.type){var I=T.arg,P=I.value;return P&&"object"==_typeof(P)&&v.call(P,"__await")?y.resolve(P.__await).then((function(c){invoke("next",c,b,S)}),(function(c){invoke("throw",c,b,S)})):y.resolve(P).then((function(c){I.value=c,b(I)}),(function(c){return invoke("throw",c,b,S)}))}S(T.arg)}var w;this._invoke=function(c,v){function callInvokeWithMethodAndArg(){return new y((function(y,w){invoke(c,v,y,w)}))}return w=w?w.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(c,y){var v=c.iterator[y.method];if(void 0===v){if(y.delegate=null,"throw"===y.method){if(c.iterator.return&&(y.method="return",y.arg=void 0,maybeInvokeDelegate(c,y),"throw"===y.method))return T;y.method="throw",y.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var w=tryCatch(v,c.iterator,y.arg);if("throw"===w.type)return y.method="throw",y.arg=w.arg,y.delegate=null,T;var C=w.arg;return C?C.done?(y[c.resultName]=C.value,y.next=c.nextLoc,"return"!==y.method&&(y.method="next",y.arg=void 0),y.delegate=null,T):C:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,T)}function pushTryEntry(c){var y={tryLoc:c[0]};1 in c&&(y.catchLoc=c[1]),2 in c&&(y.finallyLoc=c[2],y.afterLoc=c[3]),this.tryEntries.push(y)}function resetTryEntry(c){var y=c.completion||{};y.type="normal",delete y.arg,c.completion=y}function Context(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(pushTryEntry,this),this.reset(!0)}function values(c){if(c){var y=c[C];if(y)return y.call(c);if("function"==typeof c.next)return c;if(!isNaN(c.length)){var w=-1,b=function next(){for(;++w<c.length;)if(v.call(c,w))return next.value=c[w],next.done=!1,next;return next.value=void 0,next.done=!0,next};return b.next=b}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Q,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,S,"GeneratorFunction"),c.isGeneratorFunction=function(c){var y="function"==typeof c&&c.constructor;return!!y&&(y===GeneratorFunction||"GeneratorFunction"===(y.displayName||y.name))},c.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,GeneratorFunctionPrototype):(c.__proto__=GeneratorFunctionPrototype,define(c,S,"GeneratorFunction")),c.prototype=Object.create(Q),c},c.awrap=function(c){return{__await:c}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,b,(function(){return this})),c.AsyncIterator=AsyncIterator,c.async=function(y,v,w,C,b){void 0===b&&(b=Promise);var S=new AsyncIterator(wrap(y,v,w,C),b);return c.isGeneratorFunction(v)?S:S.next().then((function(c){return c.done?c.value:S.next()}))},defineIteratorMethods(Q),define(Q,S,"Generator"),define(Q,C,(function(){return this})),define(Q,"toString",(function(){return"[object Generator]"})),c.keys=function(c){var y=[];for(var v in c)y.push(v);return y.reverse(),function next(){for(;y.length;){var v=y.pop();if(v in c)return next.value=v,next.done=!1,next}return next.done=!0,next}},c.values=values,Context.prototype={constructor:Context,reset:function reset(c){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!c)for(var y in this)"t"===y.charAt(0)&&v.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=void 0)},stop:function stop(){this.done=!0;var c=this.tryEntries[0].completion;if("throw"===c.type)throw c.arg;return this.rval},dispatchException:function dispatchException(c){if(this.done)throw c;var y=this;function handle(v,w){return b.type="throw",b.arg=c,y.next=v,w&&(y.method="next",y.arg=void 0),!!w}for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w],b=C.completion;if("root"===C.tryLoc)return handle("end");if(C.tryLoc<=this.prev){var S=v.call(C,"catchLoc"),T=v.call(C,"finallyLoc");if(S&&T){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0);if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}else if(S){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0)}else{if(!T)throw new Error("try statement without catch or finally");if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}}}},abrupt:function abrupt(c,y){for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w];if(C.tryLoc<=this.prev&&v.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var b=C;break}}b&&("break"===c||"continue"===c)&&b.tryLoc<=y&&y<=b.finallyLoc&&(b=null);var S=b?b.completion:{};return S.type=c,S.arg=y,b?(this.method="next",this.next=b.finallyLoc,T):this.complete(S)},complete:function complete(c,y){if("throw"===c.type)throw c.arg;return"break"===c.type||"continue"===c.type?this.next=c.arg:"return"===c.type?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):"normal"===c.type&&y&&(this.next=y),T},finish:function finish(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.finallyLoc===c)return this.complete(v.completion,v.afterLoc),resetTryEntry(v),T}},catch:function _catch(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.tryLoc===c){var w=v.completion;if("throw"===w.type){var C=w.arg;resetTryEntry(v)}return C}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(c,y,v){return this.delegate={iterator:values(c),resultName:y,nextLoc:v},"next"===this.method&&(this.arg=void 0),T}},c}function asyncGeneratorStep(c,y,v,w,C,b,S){try{var T=c[b](S),I=T.value}catch(c){return void v(c)}T.done?y(I):Promise.resolve(I).then(w,C)}function _asyncToGenerator(c){return function(){var y=this,v=arguments;return new Promise((function(w,C){var b=c.apply(y,v);function _next(c){asyncGeneratorStep(b,w,C,_next,_throw,"next",c)}function _throw(c){asyncGeneratorStep(b,w,C,_next,_throw,"throw",c)}_next(void 0)}))}}function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}var T=function(){function MsToNativeLoginBridge(){!function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}(this,MsToNativeLoginBridge)}var c,y,v,w;return function _createClass(c,y,v){y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1})}(MsToNativeLoginBridge,[{key:"isLogged",value:function isLogged(){try{return!!window.APP.store.state.credentials.token}catch(c){return!1}}},{key:"clearProfile",value:function clearProfile(){window.APP.store.update({profile:{phoneNumber:null,displayName:"Teams Guest",email:null,jobTitle:null,companyName:null,microsoftUserprofilePicture:null,microsoftUser:null},activity:{hasChangedName:!1,hasChangedPicture:!1}})}},{key:"logout",value:(w=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){return _regeneratorRuntime().wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(!window.APP.hubChannel){c.next=4;break}return c.next=3,window.APP.hubChannel.signOut(window.APP.hubChannel);case 3:console.log("Native signOut");case 4:return window.APP.store.update({credentials:{token:null,email:null}}),c.next=7,this.clearProfile();case 7:case"end":return c.stop()}}),_callee,this)}))),function logout(){return w.apply(this,arguments)})},{key:"setProfile",value:(v=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(c){return _regeneratorRuntime().wrap((function _callee2$(y){for(;;)switch(y.prev=y.next){case 0:return window.APP.store.update({profile:c,activity:{hasChangedName:!0,hasChangedPicture:!0}}),y.next=3,new Promise((function(c){setTimeout(c,0)}));case 3:case"end":return y.stop()}}),_callee2)}))),function setProfile(c){return v.apply(this,arguments)})},{key:"setCredential",value:(y=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(c,y){return _regeneratorRuntime().wrap((function _callee3$(v){for(;;)switch(v.prev=v.next){case 0:return window.APP.store.update({credentials:{email:c,token:y},activity:{hasChangedName:!1,hasChangedPicture:!1}}),v.next=3,new Promise((function(c){setTimeout(c,0)}));case 3:if(!window.APP.hubChannel){v.next=7;break}return v.next=6,window.APP.hubChannel.signIn(y);case 6:console.log("Native Sign In : "+y);case 7:case"end":return v.stop()}}),_callee3)}))),function setCredential(c,v){return y.apply(this,arguments)})},{key:"getUserAccount",value:function getUserAccount(){return this.getProfile()}},{key:"getName",value:function getName(){return window.APP.store.profile.displayName}},{key:"displayProfilePhoto",value:function displayProfilePhoto(){return this.getProfile().microsoftUserprofilePicture}},{key:"getProfile",value:function getProfile(){return window.APP.store.state.profile||{}}},{key:"nativeLogin",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(c,y){var v,w,T=this;return _regeneratorRuntime().wrap((function _callee6$(I){for(;;)switch(I.prev=I.next){case 0:if(!window.APP.store.state.credentials.token){I.next=2;break}return I.abrupt("return");case 2:return v=new b.Z(window.APP.store),I.next=5,(0,S.iC)();case 5:return w=I.sent,v.setSocket(w),I.next=9,new Promise((function(w,b){var S=v.socket.channel("auth:".concat(C()()));S.onError((function(){S.leave(),b()})),S.join().receive("ok",(function(){S.on("auth_token_resp",function(){var c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(c){var y,v;return _regeneratorRuntime().wrap((function _callee5$(C){for(;;)switch(C.prev=C.next){case 0:y=c.auth_token,v=c.auth_payload,S.on("auth_credentials",function(){var c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(c){var y,v;return _regeneratorRuntime().wrap((function _callee4$(C){for(;;)switch(C.prev=C.next){case 0:return y=c.credentials,v=c.payload,C.next=3,T.setCredential(v.email,y);case 3:w(!0);case 4:case"end":return C.stop()}}),_callee4)})));return function(y){return c.apply(this,arguments)}}()),S.push("auth_verified",{token:y,payload:v});case 3:case"end":return C.stop()}}),_callee5)})));return function(y){return c.apply(this,arguments)}}()),y&&c||b(new Error),S.push("auth_token_request",{email:c,authtoken:y,origin:"hubs"})})).receive("error",b)}));case 9:case"end":return I.stop()}}),_callee6)}))),function nativeLogin(y,v){return c.apply(this,arguments)})}]),MsToNativeLoginBridge}()},8145:(c,y,v)=>{"use strict";v.d(y,{PhoenixAuthService:()=>I,PhoenixAuthServiceFactory:()=>T});var w=v(9980),C=v(4976),b=v(5532),S=v(6199);function _typeof(c){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},_typeof(c)}function _defineProperty(c,y,v){return y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v,c}function _regeneratorRuntime(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
_regeneratorRuntime=function _regeneratorRuntime(){return c};var c={},y=Object.prototype,v=y.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},C=w.iterator||"@@iterator",b=w.asyncIterator||"@@asyncIterator",S=w.toStringTag||"@@toStringTag";function define(c,y,v){return Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}),c[y]}try{define({},"")}catch(c){define=function define(c,y,v){return c[y]=v}}function wrap(c,y,v,w){var C=y&&y.prototype instanceof Generator?y:Generator,b=Object.create(C.prototype),S=new Context(w||[]);return b._invoke=function(c,y,v){var w="suspendedStart";return function(C,b){if("executing"===w)throw new Error("Generator is already running");if("completed"===w){if("throw"===C)throw b;return{value:void 0,done:!0}}for(v.method=C,v.arg=b;;){var S=v.delegate;if(S){var I=maybeInvokeDelegate(S,v);if(I){if(I===T)continue;return I}}if("next"===v.method)v.sent=v._sent=v.arg;else if("throw"===v.method){if("suspendedStart"===w)throw w="completed",v.arg;v.dispatchException(v.arg)}else"return"===v.method&&v.abrupt("return",v.arg);w="executing";var P=tryCatch(c,y,v);if("normal"===P.type){if(w=v.done?"completed":"suspendedYield",P.arg===T)continue;return{value:P.arg,done:v.done}}"throw"===P.type&&(w="completed",v.method="throw",v.arg=P.arg)}}}(c,v,S),b}function tryCatch(c,y,v){try{return{type:"normal",arg:c.call(y,v)}}catch(c){return{type:"throw",arg:c}}}c.wrap=wrap;var T={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var I={};define(I,C,(function(){return this}));var P=Object.getPrototypeOf,K=P&&P(P(values([])));K&&K!==y&&v.call(K,C)&&(I=K);var Q=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(I);function defineIteratorMethods(c){["next","throw","return"].forEach((function(y){define(c,y,(function(c){return this._invoke(y,c)}))}))}function AsyncIterator(c,y){function invoke(w,C,b,S){var T=tryCatch(c[w],c,C);if("throw"!==T.type){var I=T.arg,P=I.value;return P&&"object"==_typeof(P)&&v.call(P,"__await")?y.resolve(P.__await).then((function(c){invoke("next",c,b,S)}),(function(c){invoke("throw",c,b,S)})):y.resolve(P).then((function(c){I.value=c,b(I)}),(function(c){return invoke("throw",c,b,S)}))}S(T.arg)}var w;this._invoke=function(c,v){function callInvokeWithMethodAndArg(){return new y((function(y,w){invoke(c,v,y,w)}))}return w=w?w.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(c,y){var v=c.iterator[y.method];if(void 0===v){if(y.delegate=null,"throw"===y.method){if(c.iterator.return&&(y.method="return",y.arg=void 0,maybeInvokeDelegate(c,y),"throw"===y.method))return T;y.method="throw",y.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var w=tryCatch(v,c.iterator,y.arg);if("throw"===w.type)return y.method="throw",y.arg=w.arg,y.delegate=null,T;var C=w.arg;return C?C.done?(y[c.resultName]=C.value,y.next=c.nextLoc,"return"!==y.method&&(y.method="next",y.arg=void 0),y.delegate=null,T):C:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,T)}function pushTryEntry(c){var y={tryLoc:c[0]};1 in c&&(y.catchLoc=c[1]),2 in c&&(y.finallyLoc=c[2],y.afterLoc=c[3]),this.tryEntries.push(y)}function resetTryEntry(c){var y=c.completion||{};y.type="normal",delete y.arg,c.completion=y}function Context(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(pushTryEntry,this),this.reset(!0)}function values(c){if(c){var y=c[C];if(y)return y.call(c);if("function"==typeof c.next)return c;if(!isNaN(c.length)){var w=-1,b=function next(){for(;++w<c.length;)if(v.call(c,w))return next.value=c[w],next.done=!1,next;return next.value=void 0,next.done=!0,next};return b.next=b}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Q,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,S,"GeneratorFunction"),c.isGeneratorFunction=function(c){var y="function"==typeof c&&c.constructor;return!!y&&(y===GeneratorFunction||"GeneratorFunction"===(y.displayName||y.name))},c.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,GeneratorFunctionPrototype):(c.__proto__=GeneratorFunctionPrototype,define(c,S,"GeneratorFunction")),c.prototype=Object.create(Q),c},c.awrap=function(c){return{__await:c}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,b,(function(){return this})),c.AsyncIterator=AsyncIterator,c.async=function(y,v,w,C,b){void 0===b&&(b=Promise);var S=new AsyncIterator(wrap(y,v,w,C),b);return c.isGeneratorFunction(v)?S:S.next().then((function(c){return c.done?c.value:S.next()}))},defineIteratorMethods(Q),define(Q,S,"Generator"),define(Q,C,(function(){return this})),define(Q,"toString",(function(){return"[object Generator]"})),c.keys=function(c){var y=[];for(var v in c)y.push(v);return y.reverse(),function next(){for(;y.length;){var v=y.pop();if(v in c)return next.value=v,next.done=!1,next}return next.done=!0,next}},c.values=values,Context.prototype={constructor:Context,reset:function reset(c){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!c)for(var y in this)"t"===y.charAt(0)&&v.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=void 0)},stop:function stop(){this.done=!0;var c=this.tryEntries[0].completion;if("throw"===c.type)throw c.arg;return this.rval},dispatchException:function dispatchException(c){if(this.done)throw c;var y=this;function handle(v,w){return b.type="throw",b.arg=c,y.next=v,w&&(y.method="next",y.arg=void 0),!!w}for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w],b=C.completion;if("root"===C.tryLoc)return handle("end");if(C.tryLoc<=this.prev){var S=v.call(C,"catchLoc"),T=v.call(C,"finallyLoc");if(S&&T){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0);if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}else if(S){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0)}else{if(!T)throw new Error("try statement without catch or finally");if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}}}},abrupt:function abrupt(c,y){for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w];if(C.tryLoc<=this.prev&&v.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var b=C;break}}b&&("break"===c||"continue"===c)&&b.tryLoc<=y&&y<=b.finallyLoc&&(b=null);var S=b?b.completion:{};return S.type=c,S.arg=y,b?(this.method="next",this.next=b.finallyLoc,T):this.complete(S)},complete:function complete(c,y){if("throw"===c.type)throw c.arg;return"break"===c.type||"continue"===c.type?this.next=c.arg:"return"===c.type?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):"normal"===c.type&&y&&(this.next=y),T},finish:function finish(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.finallyLoc===c)return this.complete(v.completion,v.afterLoc),resetTryEntry(v),T}},catch:function _catch(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.tryLoc===c){var w=v.completion;if("throw"===w.type){var C=w.arg;resetTryEntry(v)}return C}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(c,y,v){return this.delegate={iterator:values(c),resultName:y,nextLoc:v},"next"===this.method&&(this.arg=void 0),T}},c}function asyncGeneratorStep(c,y,v,w,C,b,S){try{var T=c[b](S),I=T.value}catch(c){return void v(c)}T.done?y(I):Promise.resolve(I).then(w,C)}function _asyncToGenerator(c){return function(){var y=this,v=arguments;return new Promise((function(w,C){var b=c.apply(y,v);function _next(c){asyncGeneratorStep(b,w,C,_next,_throw,"next",c)}function _throw(c){asyncGeneratorStep(b,w,C,_next,_throw,"throw",c)}_next(void 0)}))}}function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}function _createClass(c,y,v){return y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1}),c}var T=function(){function PhoenixAuthServiceFactory(){_classCallCheck(this,PhoenixAuthServiceFactory)}var c;return _createClass(PhoenixAuthServiceFactory,[{key:"createService",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(c){return _regeneratorRuntime().wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return console.log("PhoenixAuthServiceFactory"),c.abrupt("return",new I);case 2:case"end":return c.stop()}}),_callee)}))),function createService(y){return c.apply(this,arguments)})}]),PhoenixAuthServiceFactory}(),I=function(){function PhoenixAuthService(){_classCallCheck(this,PhoenixAuthService),_defineProperty(this,"adminRole",new w.t),_defineProperty(this,"nativeBridge",new S._),_defineProperty(this,"ret",void 0)}var c,y;return _createClass(PhoenixAuthService,[{key:"getNativeInterface",value:function getNativeInterface(){return this.nativeBridge}},{key:"setGlobalReticulumChannel",value:function setGlobalReticulumChannel(c){this.ret=c}},{key:"getGlobalReticulumChannel",value:function getGlobalReticulumChannel(c){return c}},{key:"registerAuth",value:function registerAuth(c){throw new Error}},{key:"getAdmin",value:function getAdmin(){return this.adminRole}},{key:"connectToReticulum",value:(y=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){var c,y,v,w=arguments;return _regeneratorRuntime().wrap((function _callee2$(b){for(;;)switch(b.prev=b.next){case 0:return c=w.length>0&&void 0!==w[0]&&w[0],y=w.length>1&&void 0!==w[1]?w[1]:null,v=w.length>2&&void 0!==w[2]?w[2]:null,b.abrupt("return",(0,C.iC)(c,y,v));case 4:case"end":return b.stop()}}),_callee2)}))),function connectToReticulum(){return y.apply(this,arguments)})},{key:"createAuthChannel",value:function createAuthChannel(c){return new b.Z(c)}},{key:"getType",value:function getType(){return PhoenixAuthService.name}},{key:"createAndRedirectToNewHub",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(c,y,v){return _regeneratorRuntime().wrap((function _callee3$(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",(0,C.Mm)(c,y,v));case 1:case"end":return w.stop()}}),_callee3)}))),function createAndRedirectToNewHub(y,v,w){return c.apply(this,arguments)})},{key:"getReticulumFetchUrl",value:function getReticulumFetchUrl(c){var y=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,C.F4)(c,y,v,w)}},{key:"fetchReticulumAuthenticated",value:function fetchReticulumAuthenticated(c){var y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,C.J6)(c,y,v)}},{key:"isLocalClient",value:function isLocalClient(){return(0,C.H8)()}}]),PhoenixAuthService}()},5532:(c,y,v)=>{"use strict";v.d(y,{Z:()=>b});var w=v(1171),C=v.n(w);function _typeof(c){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},_typeof(c)}function _regeneratorRuntime(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
_regeneratorRuntime=function _regeneratorRuntime(){return c};var c={},y=Object.prototype,v=y.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},C=w.iterator||"@@iterator",b=w.asyncIterator||"@@asyncIterator",S=w.toStringTag||"@@toStringTag";function define(c,y,v){return Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}),c[y]}try{define({},"")}catch(c){define=function define(c,y,v){return c[y]=v}}function wrap(c,y,v,w){var C=y&&y.prototype instanceof Generator?y:Generator,b=Object.create(C.prototype),S=new Context(w||[]);return b._invoke=function(c,y,v){var w="suspendedStart";return function(C,b){if("executing"===w)throw new Error("Generator is already running");if("completed"===w){if("throw"===C)throw b;return{value:void 0,done:!0}}for(v.method=C,v.arg=b;;){var S=v.delegate;if(S){var I=maybeInvokeDelegate(S,v);if(I){if(I===T)continue;return I}}if("next"===v.method)v.sent=v._sent=v.arg;else if("throw"===v.method){if("suspendedStart"===w)throw w="completed",v.arg;v.dispatchException(v.arg)}else"return"===v.method&&v.abrupt("return",v.arg);w="executing";var P=tryCatch(c,y,v);if("normal"===P.type){if(w=v.done?"completed":"suspendedYield",P.arg===T)continue;return{value:P.arg,done:v.done}}"throw"===P.type&&(w="completed",v.method="throw",v.arg=P.arg)}}}(c,v,S),b}function tryCatch(c,y,v){try{return{type:"normal",arg:c.call(y,v)}}catch(c){return{type:"throw",arg:c}}}c.wrap=wrap;var T={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var I={};define(I,C,(function(){return this}));var P=Object.getPrototypeOf,K=P&&P(P(values([])));K&&K!==y&&v.call(K,C)&&(I=K);var Q=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(I);function defineIteratorMethods(c){["next","throw","return"].forEach((function(y){define(c,y,(function(c){return this._invoke(y,c)}))}))}function AsyncIterator(c,y){function invoke(w,C,b,S){var T=tryCatch(c[w],c,C);if("throw"!==T.type){var I=T.arg,P=I.value;return P&&"object"==_typeof(P)&&v.call(P,"__await")?y.resolve(P.__await).then((function(c){invoke("next",c,b,S)}),(function(c){invoke("throw",c,b,S)})):y.resolve(P).then((function(c){I.value=c,b(I)}),(function(c){return invoke("throw",c,b,S)}))}S(T.arg)}var w;this._invoke=function(c,v){function callInvokeWithMethodAndArg(){return new y((function(y,w){invoke(c,v,y,w)}))}return w=w?w.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(c,y){var v=c.iterator[y.method];if(void 0===v){if(y.delegate=null,"throw"===y.method){if(c.iterator.return&&(y.method="return",y.arg=void 0,maybeInvokeDelegate(c,y),"throw"===y.method))return T;y.method="throw",y.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var w=tryCatch(v,c.iterator,y.arg);if("throw"===w.type)return y.method="throw",y.arg=w.arg,y.delegate=null,T;var C=w.arg;return C?C.done?(y[c.resultName]=C.value,y.next=c.nextLoc,"return"!==y.method&&(y.method="next",y.arg=void 0),y.delegate=null,T):C:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,T)}function pushTryEntry(c){var y={tryLoc:c[0]};1 in c&&(y.catchLoc=c[1]),2 in c&&(y.finallyLoc=c[2],y.afterLoc=c[3]),this.tryEntries.push(y)}function resetTryEntry(c){var y=c.completion||{};y.type="normal",delete y.arg,c.completion=y}function Context(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(pushTryEntry,this),this.reset(!0)}function values(c){if(c){var y=c[C];if(y)return y.call(c);if("function"==typeof c.next)return c;if(!isNaN(c.length)){var w=-1,b=function next(){for(;++w<c.length;)if(v.call(c,w))return next.value=c[w],next.done=!1,next;return next.value=void 0,next.done=!0,next};return b.next=b}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Q,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,S,"GeneratorFunction"),c.isGeneratorFunction=function(c){var y="function"==typeof c&&c.constructor;return!!y&&(y===GeneratorFunction||"GeneratorFunction"===(y.displayName||y.name))},c.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,GeneratorFunctionPrototype):(c.__proto__=GeneratorFunctionPrototype,define(c,S,"GeneratorFunction")),c.prototype=Object.create(Q),c},c.awrap=function(c){return{__await:c}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,b,(function(){return this})),c.AsyncIterator=AsyncIterator,c.async=function(y,v,w,C,b){void 0===b&&(b=Promise);var S=new AsyncIterator(wrap(y,v,w,C),b);return c.isGeneratorFunction(v)?S:S.next().then((function(c){return c.done?c.value:S.next()}))},defineIteratorMethods(Q),define(Q,S,"Generator"),define(Q,C,(function(){return this})),define(Q,"toString",(function(){return"[object Generator]"})),c.keys=function(c){var y=[];for(var v in c)y.push(v);return y.reverse(),function next(){for(;y.length;){var v=y.pop();if(v in c)return next.value=v,next.done=!1,next}return next.done=!0,next}},c.values=values,Context.prototype={constructor:Context,reset:function reset(c){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!c)for(var y in this)"t"===y.charAt(0)&&v.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=void 0)},stop:function stop(){this.done=!0;var c=this.tryEntries[0].completion;if("throw"===c.type)throw c.arg;return this.rval},dispatchException:function dispatchException(c){if(this.done)throw c;var y=this;function handle(v,w){return b.type="throw",b.arg=c,y.next=v,w&&(y.method="next",y.arg=void 0),!!w}for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w],b=C.completion;if("root"===C.tryLoc)return handle("end");if(C.tryLoc<=this.prev){var S=v.call(C,"catchLoc"),T=v.call(C,"finallyLoc");if(S&&T){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0);if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}else if(S){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0)}else{if(!T)throw new Error("try statement without catch or finally");if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}}}},abrupt:function abrupt(c,y){for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w];if(C.tryLoc<=this.prev&&v.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var b=C;break}}b&&("break"===c||"continue"===c)&&b.tryLoc<=y&&y<=b.finallyLoc&&(b=null);var S=b?b.completion:{};return S.type=c,S.arg=y,b?(this.method="next",this.next=b.finallyLoc,T):this.complete(S)},complete:function complete(c,y){if("throw"===c.type)throw c.arg;return"break"===c.type||"continue"===c.type?this.next=c.arg:"return"===c.type?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):"normal"===c.type&&y&&(this.next=y),T},finish:function finish(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.finallyLoc===c)return this.complete(v.completion,v.afterLoc),resetTryEntry(v),T}},catch:function _catch(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.tryLoc===c){var w=v.completion;if("throw"===w.type){var C=w.arg;resetTryEntry(v)}return C}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(c,y,v){return this.delegate={iterator:values(c),resultName:y,nextLoc:v},"next"===this.method&&(this.arg=void 0),T}},c}function asyncGeneratorStep(c,y,v,w,C,b,S){try{var T=c[b](S),I=T.value}catch(c){return void v(c)}T.done?y(I):Promise.resolve(I).then(w,C)}function _asyncToGenerator(c){return function(){var y=this,v=arguments;return new Promise((function(w,C){var b=c.apply(y,v);function _next(c){asyncGeneratorStep(b,w,C,_next,_throw,"next",c)}function _throw(c){asyncGeneratorStep(b,w,C,_next,_throw,"throw",c)}_next(void 0)}))}}function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}function _defineProperty(c,y,v){return y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v,c}var b=function(){function AuthChannel(c){var y=this;!function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}(this,AuthChannel),_defineProperty(this,"store",void 0),_defineProperty(this,"socket",void 0),_defineProperty(this,"_signedIn",void 0),_defineProperty(this,"setSocket",(function(c){y.socket=c})),_defineProperty(this,"signOut",function(){var c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(c){return _regeneratorRuntime().wrap((function _callee$(v){for(;;)switch(v.prev=v.next){case 0:if(!c){v.next=3;break}return v.next=3,c.signOut();case 3:return y.store.update({credentials:{token:null,email:null}}),v.next=6,y.store.resetToRandomDefaultAvatar();case 6:y._signedIn=!1;case 7:case"end":return v.stop()}}),_callee)})));return function(y){return c.apply(this,arguments)}}()),this.store=c,this.socket=null,this._signedIn=!!this.store.state.credentials.token}var c,y;return function _createClass(c,y,v){y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1})}(AuthChannel,[{key:"email",get:function get(){return this.store.state.credentials.email}},{key:"signedIn",get:function get(){return this._signedIn}},{key:"verifyAuthentication",value:function verifyAuthentication(c,y,v){var w=this,C=this.socket.channel(c);return new Promise((function(c,b){C.onError((function(){C.leave(),b()})),C.join().receive("ok",(function(){C.on("auth_credentials",function(){var y=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(y){var v,C;return _regeneratorRuntime().wrap((function _callee2$(b){for(;;)switch(b.prev=b.next){case 0:return v=y.credentials,C=y.payload,b.next=3,w.handleAuthCredentials(C.email,v,null);case 3:c(!0);case 4:case"end":return b.stop()}}),_callee2)})));return function(c){return y.apply(this,arguments)}}()),C.push("auth_verified",{token:y,payload:v})})).receive("error",b)}))}},{key:"startAuthentication",value:(y=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(c,y){var v,w,b=this;return _regeneratorRuntime().wrap((function _callee4$(S){for(;;)switch(S.prev=S.next){case 0:return v=this.socket.channel("auth:".concat(C()())),S.next=3,new Promise((function(c,y){return v.join().receive("ok",c).receive("error",y)}));case 3:return w=new Promise((function(w){return v.on("auth_credentials",function(){var v=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(v){var C;return _regeneratorRuntime().wrap((function _callee3$(S){for(;;)switch(S.prev=S.next){case 0:return C=v.credentials,S.next=3,b.handleAuthCredentials(c,C,y);case 3:w(!0);case 4:case"end":return S.stop()}}),_callee3)})));return function(c){return v.apply(this,arguments)}}())})),v.push("auth_request",{email:c,origin:"hubs"}),S.abrupt("return",{authComplete:w});case 6:case"end":return S.stop()}}),_callee4,this)}))),function startAuthentication(c,v){return y.apply(this,arguments)})},{key:"handleAuthCredentials",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(c,y,v){return _regeneratorRuntime().wrap((function _callee5$(w){for(;;)switch(w.prev=w.next){case 0:if(this.store.update({credentials:{email:c,token:y}}),!v){w.next=4;break}return w.next=4,v.signIn(y);case 4:this._signedIn=!0;case 5:case"end":return w.stop()}}),_callee5,this)}))),function handleAuthCredentials(y,v,w){return c.apply(this,arguments)})}]),AuthChannel}()},4976:(c,y,v)=>{"use strict";v.d(y,{F4:()=>getReticulumFetchUrl,H8:()=>isLocalClient,J6:()=>fetchReticulumAuthenticated,Mm:()=>createAndRedirectToNewHub,iC:()=>connectToReticulum,vc:()=>config});var w=v(3887),C=v(9920),b=v(6091),S=v(12);function _typeof(c){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},_typeof(c)}function _regeneratorRuntime(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
_regeneratorRuntime=function _regeneratorRuntime(){return c};var c={},y=Object.prototype,v=y.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},C=w.iterator||"@@iterator",b=w.asyncIterator||"@@asyncIterator",S=w.toStringTag||"@@toStringTag";function define(c,y,v){return Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}),c[y]}try{define({},"")}catch(c){define=function define(c,y,v){return c[y]=v}}function wrap(c,y,v,w){var C=y&&y.prototype instanceof Generator?y:Generator,b=Object.create(C.prototype),S=new Context(w||[]);return b._invoke=function(c,y,v){var w="suspendedStart";return function(C,b){if("executing"===w)throw new Error("Generator is already running");if("completed"===w){if("throw"===C)throw b;return{value:void 0,done:!0}}for(v.method=C,v.arg=b;;){var S=v.delegate;if(S){var I=maybeInvokeDelegate(S,v);if(I){if(I===T)continue;return I}}if("next"===v.method)v.sent=v._sent=v.arg;else if("throw"===v.method){if("suspendedStart"===w)throw w="completed",v.arg;v.dispatchException(v.arg)}else"return"===v.method&&v.abrupt("return",v.arg);w="executing";var P=tryCatch(c,y,v);if("normal"===P.type){if(w=v.done?"completed":"suspendedYield",P.arg===T)continue;return{value:P.arg,done:v.done}}"throw"===P.type&&(w="completed",v.method="throw",v.arg=P.arg)}}}(c,v,S),b}function tryCatch(c,y,v){try{return{type:"normal",arg:c.call(y,v)}}catch(c){return{type:"throw",arg:c}}}c.wrap=wrap;var T={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var I={};define(I,C,(function(){return this}));var P=Object.getPrototypeOf,K=P&&P(P(values([])));K&&K!==y&&v.call(K,C)&&(I=K);var Q=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(I);function defineIteratorMethods(c){["next","throw","return"].forEach((function(y){define(c,y,(function(c){return this._invoke(y,c)}))}))}function AsyncIterator(c,y){function invoke(w,C,b,S){var T=tryCatch(c[w],c,C);if("throw"!==T.type){var I=T.arg,P=I.value;return P&&"object"==_typeof(P)&&v.call(P,"__await")?y.resolve(P.__await).then((function(c){invoke("next",c,b,S)}),(function(c){invoke("throw",c,b,S)})):y.resolve(P).then((function(c){I.value=c,b(I)}),(function(c){return invoke("throw",c,b,S)}))}S(T.arg)}var w;this._invoke=function(c,v){function callInvokeWithMethodAndArg(){return new y((function(y,w){invoke(c,v,y,w)}))}return w=w?w.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(c,y){var v=c.iterator[y.method];if(void 0===v){if(y.delegate=null,"throw"===y.method){if(c.iterator.return&&(y.method="return",y.arg=void 0,maybeInvokeDelegate(c,y),"throw"===y.method))return T;y.method="throw",y.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var w=tryCatch(v,c.iterator,y.arg);if("throw"===w.type)return y.method="throw",y.arg=w.arg,y.delegate=null,T;var C=w.arg;return C?C.done?(y[c.resultName]=C.value,y.next=c.nextLoc,"return"!==y.method&&(y.method="next",y.arg=void 0),y.delegate=null,T):C:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,T)}function pushTryEntry(c){var y={tryLoc:c[0]};1 in c&&(y.catchLoc=c[1]),2 in c&&(y.finallyLoc=c[2],y.afterLoc=c[3]),this.tryEntries.push(y)}function resetTryEntry(c){var y=c.completion||{};y.type="normal",delete y.arg,c.completion=y}function Context(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(pushTryEntry,this),this.reset(!0)}function values(c){if(c){var y=c[C];if(y)return y.call(c);if("function"==typeof c.next)return c;if(!isNaN(c.length)){var w=-1,b=function next(){for(;++w<c.length;)if(v.call(c,w))return next.value=c[w],next.done=!1,next;return next.value=void 0,next.done=!0,next};return b.next=b}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Q,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,S,"GeneratorFunction"),c.isGeneratorFunction=function(c){var y="function"==typeof c&&c.constructor;return!!y&&(y===GeneratorFunction||"GeneratorFunction"===(y.displayName||y.name))},c.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,GeneratorFunctionPrototype):(c.__proto__=GeneratorFunctionPrototype,define(c,S,"GeneratorFunction")),c.prototype=Object.create(Q),c},c.awrap=function(c){return{__await:c}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,b,(function(){return this})),c.AsyncIterator=AsyncIterator,c.async=function(y,v,w,C,b){void 0===b&&(b=Promise);var S=new AsyncIterator(wrap(y,v,w,C),b);return c.isGeneratorFunction(v)?S:S.next().then((function(c){return c.done?c.value:S.next()}))},defineIteratorMethods(Q),define(Q,S,"Generator"),define(Q,C,(function(){return this})),define(Q,"toString",(function(){return"[object Generator]"})),c.keys=function(c){var y=[];for(var v in c)y.push(v);return y.reverse(),function next(){for(;y.length;){var v=y.pop();if(v in c)return next.value=v,next.done=!1,next}return next.done=!0,next}},c.values=values,Context.prototype={constructor:Context,reset:function reset(c){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!c)for(var y in this)"t"===y.charAt(0)&&v.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=void 0)},stop:function stop(){this.done=!0;var c=this.tryEntries[0].completion;if("throw"===c.type)throw c.arg;return this.rval},dispatchException:function dispatchException(c){if(this.done)throw c;var y=this;function handle(v,w){return b.type="throw",b.arg=c,y.next=v,w&&(y.method="next",y.arg=void 0),!!w}for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w],b=C.completion;if("root"===C.tryLoc)return handle("end");if(C.tryLoc<=this.prev){var S=v.call(C,"catchLoc"),T=v.call(C,"finallyLoc");if(S&&T){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0);if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}else if(S){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0)}else{if(!T)throw new Error("try statement without catch or finally");if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}}}},abrupt:function abrupt(c,y){for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w];if(C.tryLoc<=this.prev&&v.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var b=C;break}}b&&("break"===c||"continue"===c)&&b.tryLoc<=y&&y<=b.finallyLoc&&(b=null);var S=b?b.completion:{};return S.type=c,S.arg=y,b?(this.method="next",this.next=b.finallyLoc,T):this.complete(S)},complete:function complete(c,y){if("throw"===c.type)throw c.arg;return"break"===c.type||"continue"===c.type?this.next=c.arg:"return"===c.type?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):"normal"===c.type&&y&&(this.next=y),T},finish:function finish(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.finallyLoc===c)return this.complete(v.completion,v.afterLoc),resetTryEntry(v),T}},catch:function _catch(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.tryLoc===c){var w=v.completion;if("throw"===w.type){var C=w.arg;resetTryEntry(v)}return C}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(c,y,v){return this.delegate={iterator:values(c),resultName:y,nextLoc:v},"next"===this.method&&(this.arg=void 0),T}},c}function asyncGeneratorStep(c,y,v,w,C,b,S){try{var T=c[b](S),I=T.value}catch(c){return void v(c)}T.done?y(I):Promise.resolve(I).then(w,C)}function _asyncToGenerator(c){return function(){var y=this,v=arguments;return new Promise((function(w,C){var b=c.apply(y,v);function _next(c){asyncGeneratorStep(b,w,C,_next,_throw,"next",c)}function _throw(c){asyncGeneratorStep(b,w,C,_next,_throw,"throw",c)}_next(void 0)}))}}function config(){return(0,S.getServiceSync)(b.PROPERTIES_SERVICE).getGlobalProperties()}function hasReticulumServer(){return!!config().RETICULUM_SERVER}function isLocalClient(){return hasReticulumServer()&&document.location.host!==config().RETICULUM_SERVER}var T,I=document.createElement("a"),P=null,K=!1;function getReticulumFetchUrl(c){var y=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return v||hasReticulumServer()?"https://".concat(v||config().RETICULUM_SERVER).concat(w?":".concat(w):"").concat(c):y?(I.href=c,I.href):c}function getReticulumMeta(){return _getReticulumMeta.apply(this,arguments)}function _getReticulumMeta(){return _getReticulumMeta=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(){var c,y;return _regeneratorRuntime().wrap((function _callee4$(v){for(;;)switch(v.prev=v.next){case 0:if(P){v.next=7;break}if(K||!document.querySelector("meta[name='ret:version']")){v.next=5;break}P={version:document.querySelector("meta[name='ret:version']").getAttribute("value"),pool:document.querySelector("meta[name='ret:pool']").getAttribute("value"),phx_host:document.querySelector("meta[name='ret:phx_host']").getAttribute("value")},v.next=7;break;case 5:return v.next=7,fetch(getReticulumFetchUrl("/api/v1/meta")).then(function(){var c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(c){return _regeneratorRuntime().wrap((function _callee3$(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,c.json();case 2:P=y.sent;case 3:case"end":return y.stop()}}),_callee3)})));return function(y){return c.apply(this,arguments)}}());case 7:return c=new URLSearchParams(location.search),(y=c.get("phx_host"))&&(P.phx_host=y),v.abrupt("return",P);case 11:case"end":return v.stop()}}),_callee4)}))),_getReticulumMeta.apply(this,arguments)}function refreshDirectReticulumHostAndPort(){return _refreshDirectReticulumHostAndPort.apply(this,arguments)}function _refreshDirectReticulumHostAndPort(){return _refreshDirectReticulumHostAndPort=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(){var c,y,v,w;return _regeneratorRuntime().wrap((function _callee5$(C){for(;;)switch(C.prev=C.next){case 0:return c=new URLSearchParams(location.search),y=c.get("phx_host"),C.next=4,getReticulumMeta();case 4:v=C.sent,y=y||config().RETICULUM_SOCKET_SERVER||v.phx_host,w=c.get("phx_port")||(hasReticulumServer()?new URL("".concat(document.location.protocol,"//").concat(config().RETICULUM_SERVER)).port:"443"),T={host:y,port:w};case 8:case"end":return C.stop()}}),_callee5)}))),_refreshDirectReticulumHostAndPort.apply(this,arguments)}function invalidateReticulumMeta(){return _invalidateReticulumMeta.apply(this,arguments)}function _invalidateReticulumMeta(){return(_invalidateReticulumMeta=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(){return _regeneratorRuntime().wrap((function _callee6$(c){for(;;)switch(c.prev=c.next){case 0:K=!0,P=null;case 2:case"end":return c.stop()}}),_callee6)})))).apply(this,arguments)}function connectToReticulum(){return _connectToReticulum.apply(this,arguments)}function _connectToReticulum(){return _connectToReticulum=_asyncToGenerator(_regeneratorRuntime().mark((function _callee9(){var c,y,v,C,b,S,I,P,K=arguments;return _regeneratorRuntime().wrap((function _callee9$(Q){for(;;)switch(Q.prev=Q.next){case 0:return c=K.length>0&&void 0!==K[0]&&K[0],y=K.length>1&&void 0!==K[1]?K[1]:null,v=K.length>2&&void 0!==K[2]?K[2]:w.sk,C=new URLSearchParams(location.search),b=function(){var c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee7(){var c,y,v,w;return _regeneratorRuntime().wrap((function _callee7$(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,refreshDirectReticulumHostAndPort();case 2:return y=(c=T).host,v=c.port,w=C.get("phx_protocol")||config().RETICULUM_SOCKET_PROTOCOL||("https:"===document.location.protocol?"wss:":"ws:"),b.abrupt("return","".concat(w,"//").concat(y).concat(v?":".concat(v):""));case 5:case"end":return b.stop()}}),_callee7)})));return function getNewSocketUrl(){return c.apply(this,arguments)}}(),Q.next=7,b();case 7:return S=Q.sent,console.log("Phoenix Socket URL: ".concat(S)),I={},c&&(I.logger=function(c,y,v){console.log("".concat(c,": ").concat(y),v)}),y&&(I.params=y),(P=new v("".concat(S,"/socket"),I)).connect(),P.onError(_asyncToGenerator(_regeneratorRuntime().mark((function _callee8(){var c,y,v;return _regeneratorRuntime().wrap((function _callee8$(w){for(;;)switch(w.prev=w.next){case 0:return invalidateReticulumMeta(),c=new URL(P.endPoint).pathname,w.next=4,b();case 4:y=w.sent,v="".concat(y).concat(c),console.log("Socket error, changed endpoint to ".concat(v)),P.endPoint=v;case 8:case"end":return w.stop()}}),_callee8)})))),Q.abrupt("return",P);case 16:case"end":return Q.stop()}}),_callee9)}))),_connectToReticulum.apply(this,arguments)}function fetchReticulumAuthenticated(c){var y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",v=arguments.length>2?arguments[2]:void 0,w=(0,S.getServiceSync)(b.STORE_SERVICE).state.credentials.token,C=getReticulumFetchUrl(c),T={headers:{"content-type":"application/json"},method:y};return w&&(T.headers.authorization="bearer ".concat(w)),v&&(T.body=JSON.stringify(v)),fetch(C,T).then(function(){var c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(c){var y;return _regeneratorRuntime().wrap((function _callee$(v){for(;;)switch(v.prev=v.next){case 0:if(c.ok){v.next=2;break}throw new Error("API error");case 2:return v.next=4,c.text();case 4:return y=v.sent,v.prev=5,v.abrupt("return",JSON.parse(y));case 9:return v.prev=9,v.t0=v.catch(5),v.abrupt("return",y);case 12:case"end":return v.stop()}}),_callee,null,[[5,9]])})));return function(y){return c.apply(this,arguments)}}()).catch((function(){return{entries:[]}}))}function createAndRedirectToNewHub(c,y,v){return _createAndRedirectToNewHub.apply(this,arguments)}function _createAndRedirectToNewHub(){return(_createAndRedirectToNewHub=_asyncToGenerator(_regeneratorRuntime().mark((function _callee10(c,y,v){var w,T,I,P,K,Q,X,te,re;return _regeneratorRuntime().wrap((function _callee10$(ne){for(;;)switch(ne.prev=ne.next){case 0:return w=getReticulumFetchUrl("/api/v1/hubs"),T={hub:{name:c||(0,C.A)()}},y&&(T.hub.scene_id=y),I={"content-type":"application/json"},ne.next=6,(0,S.getService)(b.STORE_SERVICE);case 6:return(P=ne.sent).state&&P.state.credentials.token&&(I.authorization="bearer ".concat(P.state.credentials.token)),ne.next=10,fetch(w,{body:JSON.stringify(T),headers:I,method:"POST"}).then((function(c){return c.json()}));case 10:if("invalid_token"!==(K=ne.sent).error){ne.next=18;break}return console.log("created anonymously"),P.update({credentials:{token:null,email:null}}),delete I.authorization,ne.next=17,fetch(w,{body:JSON.stringify(T),headers:I,method:"POST"}).then((function(c){return c.json()}));case 17:K=ne.sent;case 18:X=(Q=K).url,(te=Q.creator_assignment_token)&&(P.update({creatorAssignmentTokens:[{hubId:Q.hub_id,creatorAssignmentToken:te}]}),(re=Q.embed_token)&&P.update({embedTokens:[{hubId:Q.hub_id,embedToken:re}]})),isLocalClient()&&(X="/hub.html?hub_id=".concat(Q.hub_id)),v?document.location.replace(X):document.location=X;case 24:case"end":return ne.stop()}}),_callee10)})))).apply(this,arguments)}},1655:(c,y,v)=>{"use strict";function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}v.d(y,{Properties:()=>w});var w=function(){function Properties(){!function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}(this,Properties)}return function _createClass(c,y,v){y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1})}(Properties,[{key:"getType",value:function getType(){return Properties.name}},{key:"getGlobalProperties",value:function getGlobalProperties(){return"undefined"!=typeof window&&window.APP_PROPS||{}}},{key:"get",value:function get(c){return this.getGlobalProperties()[c]}}]),Properties}()},3641:(c,y,v)=>{"use strict";v.d(y,{RoomService:()=>I,RoomServiceFactory:()=>T});var w=v(9669),C=v.n(w),b=v(6091);function createHubChannelParams(c){var y=c.permsToken,v=c.profile,w=c.pushSubscriptionEndpoint,C=c.isMobile,b=c.isMobileVR,S=c.isEmbed,T=c.hubInviteId;return{profile:v,push_subscription_endpoint:w,auth_token:c.authToken||null,perms_token:y||null,context:{mobile:C||b,embed:S,hmd:b},hub_invite_id:T}}var S=v(4976);function _typeof(c){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},_typeof(c)}function _regeneratorRuntime(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
_regeneratorRuntime=function _regeneratorRuntime(){return c};var c={},y=Object.prototype,v=y.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},C=w.iterator||"@@iterator",b=w.asyncIterator||"@@asyncIterator",S=w.toStringTag||"@@toStringTag";function define(c,y,v){return Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}),c[y]}try{define({},"")}catch(c){define=function define(c,y,v){return c[y]=v}}function wrap(c,y,v,w){var C=y&&y.prototype instanceof Generator?y:Generator,b=Object.create(C.prototype),S=new Context(w||[]);return b._invoke=function(c,y,v){var w="suspendedStart";return function(C,b){if("executing"===w)throw new Error("Generator is already running");if("completed"===w){if("throw"===C)throw b;return{value:void 0,done:!0}}for(v.method=C,v.arg=b;;){var S=v.delegate;if(S){var I=maybeInvokeDelegate(S,v);if(I){if(I===T)continue;return I}}if("next"===v.method)v.sent=v._sent=v.arg;else if("throw"===v.method){if("suspendedStart"===w)throw w="completed",v.arg;v.dispatchException(v.arg)}else"return"===v.method&&v.abrupt("return",v.arg);w="executing";var P=tryCatch(c,y,v);if("normal"===P.type){if(w=v.done?"completed":"suspendedYield",P.arg===T)continue;return{value:P.arg,done:v.done}}"throw"===P.type&&(w="completed",v.method="throw",v.arg=P.arg)}}}(c,v,S),b}function tryCatch(c,y,v){try{return{type:"normal",arg:c.call(y,v)}}catch(c){return{type:"throw",arg:c}}}c.wrap=wrap;var T={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var I={};define(I,C,(function(){return this}));var P=Object.getPrototypeOf,K=P&&P(P(values([])));K&&K!==y&&v.call(K,C)&&(I=K);var Q=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(I);function defineIteratorMethods(c){["next","throw","return"].forEach((function(y){define(c,y,(function(c){return this._invoke(y,c)}))}))}function AsyncIterator(c,y){function invoke(w,C,b,S){var T=tryCatch(c[w],c,C);if("throw"!==T.type){var I=T.arg,P=I.value;return P&&"object"==_typeof(P)&&v.call(P,"__await")?y.resolve(P.__await).then((function(c){invoke("next",c,b,S)}),(function(c){invoke("throw",c,b,S)})):y.resolve(P).then((function(c){I.value=c,b(I)}),(function(c){return invoke("throw",c,b,S)}))}S(T.arg)}var w;this._invoke=function(c,v){function callInvokeWithMethodAndArg(){return new y((function(y,w){invoke(c,v,y,w)}))}return w=w?w.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(c,y){var v=c.iterator[y.method];if(void 0===v){if(y.delegate=null,"throw"===y.method){if(c.iterator.return&&(y.method="return",y.arg=void 0,maybeInvokeDelegate(c,y),"throw"===y.method))return T;y.method="throw",y.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var w=tryCatch(v,c.iterator,y.arg);if("throw"===w.type)return y.method="throw",y.arg=w.arg,y.delegate=null,T;var C=w.arg;return C?C.done?(y[c.resultName]=C.value,y.next=c.nextLoc,"return"!==y.method&&(y.method="next",y.arg=void 0),y.delegate=null,T):C:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,T)}function pushTryEntry(c){var y={tryLoc:c[0]};1 in c&&(y.catchLoc=c[1]),2 in c&&(y.finallyLoc=c[2],y.afterLoc=c[3]),this.tryEntries.push(y)}function resetTryEntry(c){var y=c.completion||{};y.type="normal",delete y.arg,c.completion=y}function Context(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(pushTryEntry,this),this.reset(!0)}function values(c){if(c){var y=c[C];if(y)return y.call(c);if("function"==typeof c.next)return c;if(!isNaN(c.length)){var w=-1,b=function next(){for(;++w<c.length;)if(v.call(c,w))return next.value=c[w],next.done=!1,next;return next.value=void 0,next.done=!0,next};return b.next=b}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Q,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,S,"GeneratorFunction"),c.isGeneratorFunction=function(c){var y="function"==typeof c&&c.constructor;return!!y&&(y===GeneratorFunction||"GeneratorFunction"===(y.displayName||y.name))},c.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,GeneratorFunctionPrototype):(c.__proto__=GeneratorFunctionPrototype,define(c,S,"GeneratorFunction")),c.prototype=Object.create(Q),c},c.awrap=function(c){return{__await:c}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,b,(function(){return this})),c.AsyncIterator=AsyncIterator,c.async=function(y,v,w,C,b){void 0===b&&(b=Promise);var S=new AsyncIterator(wrap(y,v,w,C),b);return c.isGeneratorFunction(v)?S:S.next().then((function(c){return c.done?c.value:S.next()}))},defineIteratorMethods(Q),define(Q,S,"Generator"),define(Q,C,(function(){return this})),define(Q,"toString",(function(){return"[object Generator]"})),c.keys=function(c){var y=[];for(var v in c)y.push(v);return y.reverse(),function next(){for(;y.length;){var v=y.pop();if(v in c)return next.value=v,next.done=!1,next}return next.done=!0,next}},c.values=values,Context.prototype={constructor:Context,reset:function reset(c){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!c)for(var y in this)"t"===y.charAt(0)&&v.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=void 0)},stop:function stop(){this.done=!0;var c=this.tryEntries[0].completion;if("throw"===c.type)throw c.arg;return this.rval},dispatchException:function dispatchException(c){if(this.done)throw c;var y=this;function handle(v,w){return b.type="throw",b.arg=c,y.next=v,w&&(y.method="next",y.arg=void 0),!!w}for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w],b=C.completion;if("root"===C.tryLoc)return handle("end");if(C.tryLoc<=this.prev){var S=v.call(C,"catchLoc"),T=v.call(C,"finallyLoc");if(S&&T){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0);if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}else if(S){if(this.prev<C.catchLoc)return handle(C.catchLoc,!0)}else{if(!T)throw new Error("try statement without catch or finally");if(this.prev<C.finallyLoc)return handle(C.finallyLoc)}}}},abrupt:function abrupt(c,y){for(var w=this.tryEntries.length-1;w>=0;--w){var C=this.tryEntries[w];if(C.tryLoc<=this.prev&&v.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var b=C;break}}b&&("break"===c||"continue"===c)&&b.tryLoc<=y&&y<=b.finallyLoc&&(b=null);var S=b?b.completion:{};return S.type=c,S.arg=y,b?(this.method="next",this.next=b.finallyLoc,T):this.complete(S)},complete:function complete(c,y){if("throw"===c.type)throw c.arg;return"break"===c.type||"continue"===c.type?this.next=c.arg:"return"===c.type?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):"normal"===c.type&&y&&(this.next=y),T},finish:function finish(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.finallyLoc===c)return this.complete(v.completion,v.afterLoc),resetTryEntry(v),T}},catch:function _catch(c){for(var y=this.tryEntries.length-1;y>=0;--y){var v=this.tryEntries[y];if(v.tryLoc===c){var w=v.completion;if("throw"===w.type){var C=w.arg;resetTryEntry(v)}return C}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(c,y,v){return this.delegate={iterator:values(c),resultName:y,nextLoc:v},"next"===this.method&&(this.arg=void 0),T}},c}function asyncGeneratorStep(c,y,v,w,C,b,S){try{var T=c[b](S),I=T.value}catch(c){return void v(c)}T.done?y(I):Promise.resolve(I).then(w,C)}function _asyncToGenerator(c){return function(){var y=this,v=arguments;return new Promise((function(w,C){var b=c.apply(y,v);function _next(c){asyncGeneratorStep(b,w,C,_next,_throw,"next",c)}function _throw(c){asyncGeneratorStep(b,w,C,_next,_throw,"throw",c)}_next(void 0)}))}}function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}function _createClass(c,y,v){return y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1}),c}var T=function(){function RoomServiceFactory(){_classCallCheck(this,RoomServiceFactory)}var c;return _createClass(RoomServiceFactory,[{key:"createService",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(c){return _regeneratorRuntime().wrap((function _callee$(y){for(;;)switch(y.prev=y.next){case 0:return y.t0=I,y.next=3,c.getService(b.PHX_AUTH_SERVICE);case 3:return y.t1=y.sent,y.next=6,c.getService(b.STORE_SERVICE);case 6:return y.t2=y.sent,y.next=9,c.getService(b.PROPERTIES_SERVICE);case 9:return y.t3=y.sent,y.next=12,c.getService(b.NAME_SERVICE);case 12:return y.t4=y.sent,y.next=15,c.getService(b.COOKIE_STORE_SERVICE);case 15:return y.t5=y.sent,y.abrupt("return",new y.t0(y.t1,y.t2,y.t3,y.t4,y.t5));case 17:case"end":return y.stop()}}),_callee)}))),function createService(y){return c.apply(this,arguments)})}]),RoomServiceFactory}(),I=function(){function RoomService(c,y,v,w,C){_classCallCheck(this,RoomService),this.phoenixAuthService=c,this.store=y,this.properties=v,this.nameService=w,this.cookie=C}var c,y,v,w;return _createClass(RoomService,[{key:"getType",value:function getType(){return RoomService.name}},{key:"parseUrl",value:function parseUrl(c){var y=new URL(c);return y.origin.startsWith("https://localhost")?{origin:y.origin,roomSID:y.searchParams.get("hub_id")}:{origin:y.origin,roomSID:y.pathname.split("/")[1]}}},{key:"createAndRedirectToNewHub",value:function createAndRedirectToNewHub(c,y,v){return this.phoenixAuthService.createAndRedirectToNewHub(c,y,v)}},{key:"getLinkFromCode",value:(w=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(c){var y,v;return _regeneratorRuntime().wrap((function _callee2$(w){for(;;)switch(w.prev=w.next){case 0:return y="https://"+(0,S.vc)().RETICULUM_SERVER+"/link/"+c,w.next=3,fetch(y);case 3:if(v=w.sent,console.log(v),console.log(v.headers.get("location")),!(v.status>=400)){w.next=11;break}throw console.error(v),new Error("wrong status");case 11:return w.abrupt("return",v.headers.get("location"));case 12:case"end":return w.stop()}}),_callee2)}))),function getLinkFromCode(c){return w.apply(this,arguments)})},{key:"getEmbedToken",value:(v=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(c,y){var v,w;return _regeneratorRuntime().wrap((function _callee3$(b){for(;;)switch(b.prev=b.next){case 0:return window.location.origin.startsWith("https://localhost")&&(v=this.properties.get("@aptero/axolotis-module-room"),y=v.ROOM_TOKEN_SERVICE||window.location.origin),b.next=3,C().get(y+"/service/room/room/"+c+"/embed/token");case 3:return w=b.sent,b.abrupt("return",w.data);case 5:case"end":return b.stop()}}),_callee3,this)}))),function getEmbedToken(c,y){return v.apply(this,arguments)})},{key:"fetchSpokeProject",value:function fetchSpokeProject(c){var y=this;return function(v){return c?y.phoenixAuthService.fetchReticulumAuthenticated("/api/v1/media/search?filter=my-scenes&source=scenes&user=".concat(c,"&cursor=").concat(v)):Promise.reject(new Error("Not signed in"))}}},{key:"fetchFavoriteRoom",value:function fetchFavoriteRoom(c){var y=this;return function(v){return c?y.phoenixAuthService.fetchReticulumAuthenticated("/api/v1/media/search?source=favorites&type=rooms&user=".concat(c,"&cursor=").concat(v)):Promise.reject(new Error("Not signed in"))}}},{key:"setFavorite",value:(y=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(c){var y,v=this;return _regeneratorRuntime().wrap((function _callee5$(w){for(;;)switch(w.prev=w.next){case 0:if(this.store.state.credentials.token){w.next=2;break}return w.abrupt("return");case 2:return w.next=4,this.phoenixAuthService.connectToReticulum(!1);case 4:(y=w.sent).onClose((function(){})),window.APP.retChannel=y.channel("ret",{hub_id:c}),this.phoenixAuthService.setGlobalReticulumChannel(window.APP.retChannel),window.APP.retChannel.join().receive("ok",(function(){var w="ret-oauth-flow-perms-token",C=v.cookie.get(w);C&&v.cookie.remove(w);var b=y.channel("hub:".concat(c),function hubChannelParamsForPermsToken(c){return createHubChannelParams({profile:v.store.state.profile,pushSubscriptionEndpoint:null,permsToken:c,isMobile:!1,isMobileVR:!1,isEmbed:!1,hubInviteId:null,authToken:v.store.state.credentials&&v.store.state.credentials.token})}(C));b.join().receive("ok",_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(){return _regeneratorRuntime().wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:b.push("favorite",{});case 1:case"end":return c.stop()}}),_callee4)})))).receive("error",(function(c){console.error(c)}))})).receive("error",(function(c){console.error(c)}));case 9:case"end":return w.stop()}}),_callee5,this)}))),function setFavorite(c){return y.apply(this,arguments)})},{key:"createAndSelect",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(c){var y,v,w,C,b,S,T,I,P=arguments;return _regeneratorRuntime().wrap((function _callee6$(K){for(;;)switch(K.prev=K.next){case 0:return y=P.length>1&&void 0!==P[1]?P[1]:void 0,v=this.phoenixAuthService.getReticulumFetchUrl("/api/v1/hubs"),w={hub:{name:y||this.nameService.generateHubName()}},c&&(w.hub.scene_id=c),C={"content-type":"application/json"},(b=this.store).state&&b.state.credentials.token&&(C.authorization="bearer ".concat(b.state.credentials.token)),K.next=9,fetch(v,{body:JSON.stringify(w),headers:C,method:"POST"}).then((function(c){return c.json()}));case 9:if("invalid_token"!==(S=K.sent).error){K.next=16;break}return b.update({credentials:{token:null,email:null}}),delete C.authorization,K.next=15,fetch(v,{body:JSON.stringify(w),headers:C,method:"POST"}).then((function(c){return c.json()}));case 15:S=K.sent;case 16:return I=(T=S).url,this.phoenixAuthService.isLocalClient()&&(I=window.location.origin+"/hub.html?hub_id=".concat(T.hub_id)),this.setFavorite(T.hub_id),K.abrupt("return",I);case 21:case"end":return K.stop()}}),_callee6,this)}))),function createAndSelect(y){return c.apply(this,arguments)})},{key:"createRoomEntry",value:function createRoomEntry(c,y,v){return{allow_remixing:!1,attributions:{content:[{title:"Salle"},{title:"Image"},{title:"Image 1"},{title:"Video"}],creator:""},description:null,id:y,images:{preview:{url:v}},name:c,project_id:"XXXXX",type:"scene",url:window.location.origin+"/"+y}}}]),RoomService}();!function _defineProperty(c,y,v){y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v}(I,"dependencies",[b.PHX_AUTH_SERVICE,b.STORE_SERVICE,b.PROPERTIES_SERVICE,b.NAME_SERVICE,b.COOKIE_STORE_SERVICE])},3926:(c,y,v)=>{"use strict";function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}v.d(y,{CookieStore:()=>w});var w=function(){function CookieStore(){!function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}(this,CookieStore)}return function _createClass(c,y,v){y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1})}(CookieStore,[{key:"getType",value:function getType(){return CookieStore.name}},{key:"get",value:function get(c){return localStorage.getItem(c)}},{key:"set",value:function set(c,y){localStorage.setItem(c,y)}},{key:"remove",value:function remove(c){return localStorage.removeItem(c)}}]),CookieStore}()},8084:(c,y,v)=>{"use strict";v.d(y,{SCHEMA:()=>K,Store:()=>Q});var w=v(660),C=v(9996),b=v.n(C),S=v(6535);function _typeof(c){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},_typeof(c)}function _defineProperties(c,y){for(var v=0;v<y.length;v++){var w=y[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}function _setPrototypeOf(c,y){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(c,y){return c.__proto__=y,c},_setPrototypeOf(c,y)}function _possibleConstructorReturn(c,y){if(y&&("object"===_typeof(y)||"function"==typeof y))return y;if(void 0!==y)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(c){if(void 0===c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(c)}function _getPrototypeOf(c){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(c){return c.__proto__||Object.getPrototypeOf(c)},_getPrototypeOf(c)}var T="___hubs_store",I=Symbol(),P=new w.Validator,K={id:"/HubsStore",definitions:{profile:{type:"object",additionalProperties:!1,properties:{displayName:{type:"string",pattern:"^[A-Za-z0-9_~ -]{3,32}$"},avatarId:{type:"string"},companyName:{type:"string"},jobTitleName:{type:"string"},phoneNumber:{type:"string"},description:{type:"string"},profilePicture:{type:"string"},microsoftUserprofilePicture:{type:"string"},microsoftUser:{type:"string"},personalAvatarId:{type:"string"}}},credentials:{type:"object",additionalProperties:!1,properties:{token:{type:["null","string"]},email:{type:["null","string"]}}},activity:{type:"object",additionalProperties:!1,properties:{hasFoundFreeze:{type:"boolean"},hasChangedName:{type:"boolean"},hasAcceptedProfile:{type:"boolean"},hasChangedPicture:{type:"boolean"},hasChangedAvatar:{type:"boolean"},lastEnteredAt:{type:"string"},hasPinned:{type:"boolean"},hasRotated:{type:"boolean"},hasRecentered:{type:"boolean"},hasScaled:{type:"boolean"},hasHoveredInWorldHud:{type:"boolean"},hasOpenedShare:{type:"boolean"},entryCount:{type:"number"}}},settings:{type:"object",additionalProperties:!1,properties:{lastUsedMicDeviceId:{type:"string"},micMuted:{type:"bool"}}},preferences:{type:"object",additionalProperties:!0,properties:{shouldPromptForRefresh:{type:"bool"},preferredMic:{type:"string"},preferredCamera:{type:"string"},muteMicOnEntry:{type:"bool"},audioOutputMode:{type:"string"},audioNormalization:{type:"bool"},invertTouchscreenCameraMove:{type:"bool"},enableOnScreenJoystickLeft:{type:"bool"},enableOnScreenJoystickRight:{type:"bool"},enableGyro:{type:"bool"},onlyShowNametagsInFreeze:{type:"bool"},animateWaypointTransitions:{type:"bool"},showFPSCounter:{type:"bool"},allowMultipleHubsInstances:{type:"bool"},disableIdleDetection:{type:"bool"},fastRoomSwitching:{type:"bool"},preferMobileObjectInfoPanel:{type:"bool"},maxResolutionWidth:{type:"number"},maxResolutionHeight:{type:"number"},globalVoiceVolume:{type:"number"},globalMediaVolume:{type:"number"},snapRotationDegrees:{type:"number"},materialQualitySetting:{type:"string"},enableDynamicShadows:{type:"bool"},disableSoundEffects:{type:"bool"},disableMovement:{type:"bool"},disableBackwardsMovement:{type:"bool"},disableStrafing:{type:"bool"},disableTeleporter:{type:"bool"},disableAutoPixelRatio:{type:"bool"},movementSpeedModifier:{type:"number"},disableEchoCancellation:{type:"bool"},disableNoiseSuppression:{type:"bool"},disableAutoGainControl:{type:"bool"},locale:{type:"string"},showRtcDebugPanel:{type:"bool"},showAudioDebugPanel:{type:"bool"},enableAudioClipping:{type:"bool"},audioClippingThreshold:{type:"number"},theme:{type:"string"},thirdPersonMode:{type:"bool"}}},confirmedDiscordRooms:{type:"array",items:{type:"string"}},confirmedBroadcastedRooms:{type:"array",items:{type:"string"}},uploadPromotionTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{fileId:{type:"string"},promotionToken:{type:"string"}}}},creatorAssignmentTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{hubId:{type:"string"},creatorAssignmentToken:{type:"string"}}}},embedTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{hubId:{type:"string"},embedToken:{type:"string"}}}},onLoadActions:{type:"array",items:{type:"object",additionalProperties:!1,properties:{action:{type:"string"},args:{type:"object"}}}}},type:"object",properties:{profile:{$ref:"#/definitions/profile"},credentials:{$ref:"#/definitions/credentials"},activity:{$ref:"#/definitions/activity"},settings:{$ref:"#/definitions/settings"},preferences:{$ref:"#/definitions/preferences"},confirmedDiscordRooms:{$ref:"#/definitions/confirmedDiscordRooms"},confirmedBroadcastedRooms:{$ref:"#/definitions/confirmedBroadcastedRooms"},uploadPromotionTokens:{$ref:"#/definitions/uploadPromotionTokens"},creatorAssignmentTokens:{$ref:"#/definitions/creatorAssignmentTokens"},embedTokens:{$ref:"#/definitions/embedTokens"},onLoadActions:{$ref:"#/definitions/onLoadActions"}},additionalProperties:!1},Q=function(c){!function _inherits(c,y){if("function"!=typeof y&&null!==y)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(y&&y.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),Object.defineProperty(c,"prototype",{writable:!1}),y&&_setPrototypeOf(c,y)}(Store,c);var y=function _createSuper(c){var y=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(c){return!1}}();return function _createSuperInternal(){var v,w=_getPrototypeOf(c);if(y){var C=_getPrototypeOf(this).constructor;v=Reflect.construct(w,arguments,C)}else v=w.apply(this,arguments);return _possibleConstructorReturn(this,v)}}(Store);function Store(){var c;return function _classCallCheck(c,y){if(!(c instanceof y))throw new TypeError("Cannot call a class as a function")}(this,Store),c=y.call(this),"undefined"!=typeof localStorage&&null===localStorage.getItem(T)&&localStorage.setItem(T,JSON.stringify({})),window.addEventListener("storage",(function(y){y.key===T&&(delete c[I],c.dispatchEvent(new CustomEvent("statechanged")))})),c}return function _createClass(c,y,v){y&&_defineProperties(c.prototype,y),v&&_defineProperties(c,v),Object.defineProperty(c,"prototype",{writable:!1})}(Store,[{key:"getType",value:function getType(){return Store.name}},{key:"state",get:function get(){return this[I]||"undefined"==typeof localStorage||(this[I]=JSON.parse(localStorage.getItem(T))),this[I]}},{key:"clearStoredArray",value:function clearStoredArray(c){var y={};y[c]=[],this.update(y,{arrayMerge:function overwriteMerge(c,y){return y}})}},{key:"update",value:function update(c){var y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,v=b()(this.state,c,y),w=P.validate(v,K),C=w.valid;return C||console.log("Write to store failed schema validation."),"undefined"!=typeof localStorage&&localStorage.setItem(T,JSON.stringify(v)),delete this[I],this.dispatchEvent(new CustomEvent("statechanged")),v}}]),Store}(S.Rf)},9996:c=>{"use strict";var y=function isMergeableObject(c){return function isNonNullObject(c){return!!c&&"object"==typeof c}(c)&&!function isSpecial(c){var y=Object.prototype.toString.call(c);return"[object RegExp]"===y||"[object Date]"===y||function isReactElement(c){return c.$$typeof===v}(c)}(c)},v="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function cloneUnlessOtherwiseSpecified(c,y){return!1!==y.clone&&y.isMergeableObject(c)?deepmerge(function emptyTarget(c){return Array.isArray(c)?[]:{}}(c),c,y):c}function defaultArrayMerge(c,y,v){return c.concat(y).map((function(c){return cloneUnlessOtherwiseSpecified(c,v)}))}function getKeys(c){return Object.keys(c).concat(function getEnumerableOwnPropertySymbols(c){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(c).filter((function(y){return c.propertyIsEnumerable(y)})):[]}(c))}function propertyIsOnObject(c,y){try{return y in c}catch(c){return!1}}function deepmerge(c,v,w){(w=w||{}).arrayMerge=w.arrayMerge||defaultArrayMerge,w.isMergeableObject=w.isMergeableObject||y,w.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var C=Array.isArray(v);return C===Array.isArray(c)?C?w.arrayMerge(c,v,w):function mergeObject(c,y,v){var w={};return v.isMergeableObject(c)&&getKeys(c).forEach((function(y){w[y]=cloneUnlessOtherwiseSpecified(c[y],v)})),getKeys(y).forEach((function(C){(function propertyIsUnsafe(c,y){return propertyIsOnObject(c,y)&&!(Object.hasOwnProperty.call(c,y)&&Object.propertyIsEnumerable.call(c,y))})(c,C)||(propertyIsOnObject(c,C)&&v.isMergeableObject(y[C])?w[C]=function getMergeFunction(c,y){if(!y.customMerge)return deepmerge;var v=y.customMerge(c);return"function"==typeof v?v:deepmerge}(C,v)(c[C],y[C],v):w[C]=cloneUnlessOtherwiseSpecified(y[C],v))})),w}(c,v,w):cloneUnlessOtherwiseSpecified(v,w)}deepmerge.all=function deepmergeAll(c,y){if(!Array.isArray(c))throw new Error("first argument should be an array");return c.reduce((function(c,v){return deepmerge(c,v,y)}),{})};var w=deepmerge;c.exports=w},6481:(c,y,v)=>{"use strict";var w=v(9177),C=w.ValidatorResult,b=w.SchemaError,S={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},T=S.validators={};function testSchemaNoThrow(c,y,v,w,C){var b=y.throwError,S=y.throwAll;y.throwError=!1,y.throwAll=!1;var T=this.validateSchema(c,C,y,v);return y.throwError=b,y.throwAll=S,!T.valid&&w instanceof Function&&w(T),T.valid}function getEnumerableProperty(c,y){if(Object.hasOwnProperty.call(c,y))return c[y];if(y in c)for(;c=Object.getPrototypeOf(c);)if(Object.propertyIsEnumerable.call(c,y))return c[y]}function testAdditionalProperty(c,y,v,w,C,b){if(this.types.object(c)&&(!y.properties||void 0===y.properties[C]))if(!1===y.additionalProperties)b.addError({name:"additionalProperties",argument:C,message:"is not allowed to have the additional property "+JSON.stringify(C)});else{var S=y.additionalProperties||{};"function"==typeof v.preValidateProperty&&v.preValidateProperty(c,C,S,v,w);var T=this.validateSchema(c[C],S,v,w.makeChild(S,C));T.instance!==b.instance[C]&&(b.instance[C]=T.instance),b.importErrors(T)}}T.type=function validateType(c,y,v,w){if(void 0===c)return null;var b=new C(c,y,v,w),S=Array.isArray(y.type)?y.type:[y.type];if(!S.some(this.testType.bind(this,c,y,v,w))){var T=S.map((function(c){if(c){var y=c.$id||c.id;return y?"<"+y+">":c+""}}));b.addError({name:"type",argument:T,message:"is not of a type(s) "+T})}return b},T.anyOf=function validateAnyOf(c,y,v,w){if(void 0===c)return null;var S=new C(c,y,v,w),T=new C(c,y,v,w);if(!Array.isArray(y.anyOf))throw new b("anyOf must be an array");if(!y.anyOf.some(testSchemaNoThrow.bind(this,c,v,w,(function(c){T.importErrors(c)})))){var I=y.anyOf.map((function(c,y){var v=c.$id||c.id;return v?"<"+v+">":c.title&&JSON.stringify(c.title)||c.$ref&&"<"+c.$ref+">"||"[subschema "+y+"]"}));v.nestedErrors&&S.importErrors(T),S.addError({name:"anyOf",argument:I,message:"is not any of "+I.join(",")})}return S},T.allOf=function validateAllOf(c,y,v,w){if(void 0===c)return null;if(!Array.isArray(y.allOf))throw new b("allOf must be an array");var S=new C(c,y,v,w),T=this;return y.allOf.forEach((function(y,C){var b=T.validateSchema(c,y,v,w);if(!b.valid){var I=y.$id||y.id||y.title&&JSON.stringify(y.title)||y.$ref&&"<"+y.$ref+">"||"[subschema "+C+"]";S.addError({name:"allOf",argument:{id:I,length:b.errors.length,valid:b},message:"does not match allOf schema "+I+" with "+b.errors.length+" error[s]:"}),S.importErrors(b)}})),S},T.oneOf=function validateOneOf(c,y,v,w){if(void 0===c)return null;if(!Array.isArray(y.oneOf))throw new b("oneOf must be an array");var S=new C(c,y,v,w),T=new C(c,y,v,w),I=y.oneOf.filter(testSchemaNoThrow.bind(this,c,v,w,(function(c){T.importErrors(c)}))).length,P=y.oneOf.map((function(c,y){return c.$id||c.id||c.title&&JSON.stringify(c.title)||c.$ref&&"<"+c.$ref+">"||"[subschema "+y+"]"}));return 1!==I&&(v.nestedErrors&&S.importErrors(T),S.addError({name:"oneOf",argument:P,message:"is not exactly one from "+P.join(",")})),S},T.if=function validateIf(c,y,v,b){if(void 0===c)return null;if(!w.isSchema(y.if))throw new Error('Expected "if" keyword to be a schema');var S,T=testSchemaNoThrow.call(this,c,v,b,null,y.if),I=new C(c,y,v,b);if(T){if(void 0===y.then)return;if(!w.isSchema(y.then))throw new Error('Expected "then" keyword to be a schema');S=this.validateSchema(c,y.then,v,b.makeChild(y.then)),I.importErrors(S)}else{if(void 0===y.else)return;if(!w.isSchema(y.else))throw new Error('Expected "else" keyword to be a schema');S=this.validateSchema(c,y.else,v,b.makeChild(y.else)),I.importErrors(S)}return I},T.propertyNames=function validatePropertyNames(c,y,v,S){if(this.types.object(c)){var T=new C(c,y,v,S),I=void 0!==y.propertyNames?y.propertyNames:{};if(!w.isSchema(I))throw new b('Expected "propertyNames" to be a schema (object or boolean)');for(var P in c)if(void 0!==getEnumerableProperty(c,P)){var K=this.validateSchema(P,I,v,S.makeChild(I));T.importErrors(K)}return T}},T.properties=function validateProperties(c,y,v,w){if(this.types.object(c)){var S=new C(c,y,v,w),T=y.properties||{};for(var I in T){var P=T[I];if(void 0!==P){if(null===P)throw new b('Unexpected null, expected schema in "properties"');"function"==typeof v.preValidateProperty&&v.preValidateProperty(c,I,P,v,w);var K=getEnumerableProperty(c,I),Q=this.validateSchema(K,P,v,w.makeChild(P,I));Q.instance!==S.instance[I]&&(S.instance[I]=Q.instance),S.importErrors(Q)}}return S}},T.patternProperties=function validatePatternProperties(c,y,v,w){if(this.types.object(c)){var S=new C(c,y,v,w),T=y.patternProperties||{};for(var I in c){var P=!0;for(var K in T){var Q=T[K];if(void 0!==Q){if(null===Q)throw new b('Unexpected null, expected schema in "patternProperties"');try{var X=new RegExp(K,"u")}catch(c){X=new RegExp(K)}if(X.test(I)){P=!1,"function"==typeof v.preValidateProperty&&v.preValidateProperty(c,I,Q,v,w);var te=this.validateSchema(c[I],Q,v,w.makeChild(Q,I));te.instance!==S.instance[I]&&(S.instance[I]=te.instance),S.importErrors(te)}}}P&&testAdditionalProperty.call(this,c,y,v,w,I,S)}return S}},T.additionalProperties=function validateAdditionalProperties(c,y,v,w){if(this.types.object(c)){if(y.patternProperties)return null;var b=new C(c,y,v,w);for(var S in c)testAdditionalProperty.call(this,c,y,v,w,S,b);return b}},T.minProperties=function validateMinProperties(c,y,v,w){if(this.types.object(c)){var b=new C(c,y,v,w);return Object.keys(c).length>=y.minProperties||b.addError({name:"minProperties",argument:y.minProperties,message:"does not meet minimum property length of "+y.minProperties}),b}},T.maxProperties=function validateMaxProperties(c,y,v,w){if(this.types.object(c)){var b=new C(c,y,v,w);return Object.keys(c).length<=y.maxProperties||b.addError({name:"maxProperties",argument:y.maxProperties,message:"does not meet maximum property length of "+y.maxProperties}),b}},T.items=function validateItems(c,y,v,w){var b=this;if(this.types.array(c)&&void 0!==y.items){var S=new C(c,y,v,w);return c.every((function(c,C){if(Array.isArray(y.items))var T=void 0===y.items[C]?y.additionalItems:y.items[C];else T=y.items;if(void 0===T)return!0;if(!1===T)return S.addError({name:"items",message:"additionalItems not permitted"}),!1;var I=b.validateSchema(c,T,v,w.makeChild(T,C));return I.instance!==S.instance[C]&&(S.instance[C]=I.instance),S.importErrors(I),!0})),S}},T.contains=function validateContains(c,y,v,b){var S=this;if(this.types.array(c)&&void 0!==y.contains){if(!w.isSchema(y.contains))throw new Error('Expected "contains" keyword to be a schema');var T=new C(c,y,v,b);return!1===c.some((function(c,w){return 0===S.validateSchema(c,y.contains,v,b.makeChild(y.contains,w)).errors.length}))&&T.addError({name:"contains",argument:y.contains,message:"must contain an item matching given schema"}),T}},T.minimum=function validateMinimum(c,y,v,w){if(this.types.number(c)){var b=new C(c,y,v,w);return y.exclusiveMinimum&&!0===y.exclusiveMinimum?c>y.minimum||b.addError({name:"minimum",argument:y.minimum,message:"must be greater than "+y.minimum}):c>=y.minimum||b.addError({name:"minimum",argument:y.minimum,message:"must be greater than or equal to "+y.minimum}),b}},T.maximum=function validateMaximum(c,y,v,w){if(this.types.number(c)){var b=new C(c,y,v,w);return y.exclusiveMaximum&&!0===y.exclusiveMaximum?c<y.maximum||b.addError({name:"maximum",argument:y.maximum,message:"must be less than "+y.maximum}):c<=y.maximum||b.addError({name:"maximum",argument:y.maximum,message:"must be less than or equal to "+y.maximum}),b}},T.exclusiveMinimum=function validateExclusiveMinimum(c,y,v,w){if("boolean"!=typeof y.exclusiveMinimum&&this.types.number(c)){var b=new C(c,y,v,w);return c>y.exclusiveMinimum||b.addError({name:"exclusiveMinimum",argument:y.exclusiveMinimum,message:"must be strictly greater than "+y.exclusiveMinimum}),b}},T.exclusiveMaximum=function validateExclusiveMaximum(c,y,v,w){if("boolean"!=typeof y.exclusiveMaximum&&this.types.number(c)){var b=new C(c,y,v,w);return c<y.exclusiveMaximum||b.addError({name:"exclusiveMaximum",argument:y.exclusiveMaximum,message:"must be strictly less than "+y.exclusiveMaximum}),b}};var I=function validateMultipleOfOrDivisbleBy(c,y,v,S,T,I){if(this.types.number(c)){var P=y[T];if(0==P)throw new b(T+" cannot be zero");var K=new C(c,y,v,S),Q=w.getDecimalPlaces(c),X=w.getDecimalPlaces(P),te=Math.max(Q,X),re=Math.pow(10,te);return Math.round(c*re)%Math.round(P*re)!=0&&K.addError({name:T,argument:P,message:I+JSON.stringify(P)}),K}};function testArrays(c,y,v){var C,b=v.length;for(C=y+1;C<b;C++)if(w.deepCompareStrict(c,v[C]))return!1;return!0}T.multipleOf=function validateMultipleOf(c,y,v,w){return I.call(this,c,y,v,w,"multipleOf","is not a multiple of (divisible by) ")},T.divisibleBy=function validateDivisibleBy(c,y,v,w){return I.call(this,c,y,v,w,"divisibleBy","is not divisible by (multiple of) ")},T.required=function validateRequired(c,y,v,w){var b=new C(c,y,v,w);return void 0===c&&!0===y.required?b.addError({name:"required",message:"is required"}):this.types.object(c)&&Array.isArray(y.required)&&y.required.forEach((function(y){void 0===getEnumerableProperty(c,y)&&b.addError({name:"required",argument:y,message:"requires property "+JSON.stringify(y)})})),b},T.pattern=function validatePattern(c,y,v,w){if(this.types.string(c)){var b=new C(c,y,v,w),S=y.pattern;try{var T=new RegExp(S,"u")}catch(c){T=new RegExp(S)}return c.match(T)||b.addError({name:"pattern",argument:y.pattern,message:"does not match pattern "+JSON.stringify(y.pattern.toString())}),b}},T.format=function validateFormat(c,y,v,b){if(void 0!==c){var S=new C(c,y,v,b);return S.disableFormat||w.isFormat(c,y.format,this)||S.addError({name:"format",argument:y.format,message:"does not conform to the "+JSON.stringify(y.format)+" format"}),S}},T.minLength=function validateMinLength(c,y,v,w){if(this.types.string(c)){var b=new C(c,y,v,w),S=c.match(/[\uDC00-\uDFFF]/g);return c.length-(S?S.length:0)>=y.minLength||b.addError({name:"minLength",argument:y.minLength,message:"does not meet minimum length of "+y.minLength}),b}},T.maxLength=function validateMaxLength(c,y,v,w){if(this.types.string(c)){var b=new C(c,y,v,w),S=c.match(/[\uDC00-\uDFFF]/g);return c.length-(S?S.length:0)<=y.maxLength||b.addError({name:"maxLength",argument:y.maxLength,message:"does not meet maximum length of "+y.maxLength}),b}},T.minItems=function validateMinItems(c,y,v,w){if(this.types.array(c)){var b=new C(c,y,v,w);return c.length>=y.minItems||b.addError({name:"minItems",argument:y.minItems,message:"does not meet minimum length of "+y.minItems}),b}},T.maxItems=function validateMaxItems(c,y,v,w){if(this.types.array(c)){var b=new C(c,y,v,w);return c.length<=y.maxItems||b.addError({name:"maxItems",argument:y.maxItems,message:"does not meet maximum length of "+y.maxItems}),b}},T.uniqueItems=function validateUniqueItems(c,y,v,w){if(!0===y.uniqueItems&&this.types.array(c)){var b=new C(c,y,v,w);return c.every(testArrays)||b.addError({name:"uniqueItems",message:"contains duplicate item"}),b}},T.dependencies=function validateDependencies(c,y,v,w){if(this.types.object(c)){var b=new C(c,y,v,w);for(var S in y.dependencies)if(void 0!==c[S]){var T=y.dependencies[S],I=w.makeChild(T,S);if("string"==typeof T&&(T=[T]),Array.isArray(T))T.forEach((function(y){void 0===c[y]&&b.addError({name:"dependencies",argument:I.propertyPath,message:"property "+y+" not found, required by "+I.propertyPath})}));else{var P=this.validateSchema(c,T,v,I);b.instance!==P.instance&&(b.instance=P.instance),P&&P.errors.length&&(b.addError({name:"dependencies",argument:I.propertyPath,message:"does not meet dependency required by "+I.propertyPath}),b.importErrors(P))}}return b}},T.enum=function validateEnum(c,y,v,S){if(void 0===c)return null;if(!Array.isArray(y.enum))throw new b("enum expects an array",y);var T=new C(c,y,v,S);return y.enum.some(w.deepCompareStrict.bind(null,c))||T.addError({name:"enum",argument:y.enum,message:"is not one of enum values: "+y.enum.map(String).join(",")}),T},T.const=function validateEnum(c,y,v,b){if(void 0===c)return null;var S=new C(c,y,v,b);return w.deepCompareStrict(y.const,c)||S.addError({name:"const",argument:y.const,message:"does not exactly match expected constant: "+y.const}),S},T.not=T.disallow=function validateNot(c,y,v,w){var b=this;if(void 0===c)return null;var S=new C(c,y,v,w),T=y.not||y.disallow;return T?(Array.isArray(T)||(T=[T]),T.forEach((function(C){if(b.testType(c,y,v,w,C)){var T=C&&(C.$id||C.id)||C;S.addError({name:"not",argument:T,message:"is of prohibited type "+T})}})),S):null},c.exports=S},9177:(c,y,v)=>{"use strict";var w=v(883),C=y.ValidationError=function ValidationError(c,y,v,w,C,b){if(Array.isArray(w)?(this.path=w,this.property=w.reduce((function(c,y){return c+P(y)}),"instance")):void 0!==w&&(this.property=w),c&&(this.message=c),v){var S=v.$id||v.id;this.schema=S||v}void 0!==y&&(this.instance=y),this.name=C,this.argument=b,this.stack=this.toString()};C.prototype.toString=function toString(){return this.property+" "+this.message};var b=y.ValidatorResult=function ValidatorResult(c,y,v,w){this.instance=c,this.schema=y,this.options=v,this.path=w.path,this.propertyPath=w.propertyPath,this.errors=[],this.throwError=v&&v.throwError,this.throwFirst=v&&v.throwFirst,this.throwAll=v&&v.throwAll,this.disableFormat=v&&!0===v.disableFormat};function stringizer(c,y){return y+": "+c.toString()+"\n"}function ValidatorResultError(c){Error.captureStackTrace&&Error.captureStackTrace(this,ValidatorResultError),this.instance=c.instance,this.schema=c.schema,this.options=c.options,this.errors=c.errors}b.prototype.addError=function addError(c){var y;if("string"==typeof c)y=new C(c,this.instance,this.schema,this.path);else{if(!c)throw new Error("Missing error detail");if(!c.message)throw new Error("Missing error message");if(!c.name)throw new Error("Missing validator type");y=new C(c.message,this.instance,this.schema,this.path,c.name,c.argument)}if(this.errors.push(y),this.throwFirst)throw new ValidatorResultError(this);if(this.throwError)throw y;return y},b.prototype.importErrors=function importErrors(c){"string"==typeof c||c&&c.validatorType?this.addError(c):c&&c.errors&&(this.errors=this.errors.concat(c.errors))},b.prototype.toString=function toString(c){return this.errors.map(stringizer).join("")},Object.defineProperty(b.prototype,"valid",{get:function(){return!this.errors.length}}),c.exports.ValidatorResultError=ValidatorResultError,ValidatorResultError.prototype=new Error,ValidatorResultError.prototype.constructor=ValidatorResultError,ValidatorResultError.prototype.name="Validation Error";var S=y.SchemaError=function SchemaError(c,y){this.message=c,this.schema=y,Error.call(this,c),Error.captureStackTrace(this,SchemaError)};S.prototype=Object.create(Error.prototype,{constructor:{value:S,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var T=y.SchemaContext=function SchemaContext(c,y,v,w,C){this.schema=c,this.options=y,Array.isArray(v)?(this.path=v,this.propertyPath=v.reduce((function(c,y){return c+P(y)}),"instance")):this.propertyPath=v,this.base=w,this.schemas=C};T.prototype.resolve=function resolve(c){return w.resolve(this.base,c)},T.prototype.makeChild=function makeChild(c,y){var v=void 0===y?this.path:this.path.concat([y]),C=c.$id||c.id,b=w.resolve(this.base,C||""),S=new T(c,this.options,v,b,Object.create(this.schemas));return C&&!S.schemas[b]&&(S.schemas[b]=c),S};var I=y.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:[!#-\[\]-\u{10FFFF}]|\\[\t -\u{10FFFF}])*"|[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*)@([!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*|\[[!-Z\^-\u{10FFFF}]*\])$/u,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~-\u{10FFFF}]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~-\u{10FFFF}])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/u,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#$&(-;=?@\[\]_a-z~]|\{[!#&+,./;=?@|]?(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?)*\})*/iu,"json-pointer":/^(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*$/iu,"relative-json-pointer":/^\d+(#|(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*)$/iu,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(c){return"string"==typeof c&&parseFloat(c)===parseInt(c,10)&&!isNaN(c)},regex:function(c){var y=!0;try{new RegExp(c)}catch(c){y=!1}return y},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};I.regexp=I.regex,I.pattern=I.regex,I.ipv4=I["ip-address"],y.isFormat=function isFormat(c,y,v){if("string"==typeof c&&void 0!==I[y]){if(I[y]instanceof RegExp)return I[y].test(c);if("function"==typeof I[y])return I[y](c)}else if(v&&v.customFormats&&"function"==typeof v.customFormats[y])return v.customFormats[y](c);return!0};var P=y.makeSuffix=function makeSuffix(c){return(c=c.toString()).match(/[.\s\[\]]/)||c.match(/^[\d]/)?c.match(/^\d+$/)?"["+c+"]":"["+JSON.stringify(c)+"]":"."+c};function deepMerger(c,y,v,w){"object"==typeof v?y[w]=deepMerge(c[w],v):-1===c.indexOf(v)&&y.push(v)}function copyist(c,y,v){y[v]=c[v]}function copyistWithDeepMerge(c,y,v,w){"object"==typeof y[w]&&y[w]&&c[w]?v[w]=deepMerge(c[w],y[w]):v[w]=y[w]}function deepMerge(c,y){var v=Array.isArray(y),w=v&&[]||{};return v?(c=c||[],w=w.concat(c),y.forEach(deepMerger.bind(null,c,w))):(c&&"object"==typeof c&&Object.keys(c).forEach(copyist.bind(null,c,w)),Object.keys(y).forEach(copyistWithDeepMerge.bind(null,c,y,w))),w}function pathEncoder(c){return"/"+encodeURIComponent(c).replace(/~/g,"%7E")}y.deepCompareStrict=function deepCompareStrict(c,y){if(typeof c!=typeof y)return!1;if(Array.isArray(c))return!!Array.isArray(y)&&c.length===y.length&&c.every((function(v,w){return deepCompareStrict(c[w],y[w])}));if("object"==typeof c){if(!c||!y)return c===y;var v=Object.keys(c),w=Object.keys(y);return v.length===w.length&&v.every((function(v){return deepCompareStrict(c[v],y[v])}))}return c===y},c.exports.deepMerge=deepMerge,y.objectGetPath=function objectGetPath(c,y){for(var v,w=y.split("/").slice(1);"string"==typeof(v=w.shift());){var C=decodeURIComponent(v.replace(/~0/,"~").replace(/~1/g,"/"));if(!(C in c))return;c=c[C]}return c},y.encodePath=function encodePointer(c){return c.map(pathEncoder).join("")},y.getDecimalPlaces=function getDecimalPlaces(c){var y=0;if(isNaN(c))return y;"number"!=typeof c&&(c=Number(c));var v=c.toString().split("e");if(2===v.length){if("-"!==v[1][0])return y;y=Number(v[1].slice(1))}var w=v[0].split(".");return 2===w.length&&(y+=w[1].length),y},y.isSchema=function isSchema(c){return"object"==typeof c&&c||"boolean"==typeof c}},660:(c,y,v)=>{"use strict";c.exports.Validator=v(3058);v(9177).ValidatorResult,v(9177).ValidatorResultError,v(9177).ValidationError,v(9177).SchemaError,v(1287),v(1287).R},1287:(c,y,v)=>{"use strict";var w=v(883),C=v(9177);function SchemaScanResult(c,y){this.id=c,this.ref=y}c.exports.R=function scan(c,y){function scanSchema(c,y){if(y&&"object"==typeof y)if(y.$ref){var S=w.resolve(c,y.$ref);b[S]=b[S]?b[S]+1:0}else{var T=y.$id||y.id,I=T?w.resolve(c,T):c;if(I){if(I.indexOf("#")<0&&(I+="#"),v[I]){if(!C.deepCompareStrict(v[I],y))throw new Error("Schema <"+I+"> already exists with different definition");return v[I]}v[I]=y,"#"==I[I.length-1]&&(v[I.substring(0,I.length-1)]=y)}scanArray(I+"/items",Array.isArray(y.items)?y.items:[y.items]),scanArray(I+"/extends",Array.isArray(y.extends)?y.extends:[y.extends]),scanSchema(I+"/additionalItems",y.additionalItems),scanObject(I+"/properties",y.properties),scanSchema(I+"/additionalProperties",y.additionalProperties),scanObject(I+"/definitions",y.definitions),scanObject(I+"/patternProperties",y.patternProperties),scanObject(I+"/dependencies",y.dependencies),scanArray(I+"/disallow",y.disallow),scanArray(I+"/allOf",y.allOf),scanArray(I+"/anyOf",y.anyOf),scanArray(I+"/oneOf",y.oneOf),scanSchema(I+"/not",y.not)}}function scanArray(c,y){if(Array.isArray(y))for(var v=0;v<y.length;v++)scanSchema(c+"/"+v,y[v])}function scanObject(c,y){if(y&&"object"==typeof y)for(var v in y)scanSchema(c+"/"+v,y[v])}var v={},b={};return scanSchema(c,y),new SchemaScanResult(v,b)}},3058:(c,y,v)=>{"use strict";var w=v(883),C=v(6481),b=v(9177),S=v(1287).R,T=b.ValidatorResult,I=b.ValidatorResultError,P=b.SchemaError,K=b.SchemaContext,Q=function Validator(){this.customFormats=Object.create(Validator.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(X),this.attributes=Object.create(C.validators)};function shouldResolve(c){var y="string"==typeof c?c:c.$ref;return"string"==typeof y&&y}Q.prototype.customFormats={},Q.prototype.schemas=null,Q.prototype.types=null,Q.prototype.attributes=null,Q.prototype.unresolvedRefs=null,Q.prototype.addSchema=function addSchema(c,y){var v=this;if(!c)return null;var w=S(y||"/",c),C=y||c.$id||c.id;for(var b in w.id)this.schemas[b]=w.id[b];for(var b in w.ref)this.unresolvedRefs.push(b);return this.unresolvedRefs=this.unresolvedRefs.filter((function(c){return void 0===v.schemas[c]})),this.schemas[C]},Q.prototype.addSubSchemaArray=function addSubSchemaArray(c,y){if(Array.isArray(y))for(var v=0;v<y.length;v++)this.addSubSchema(c,y[v])},Q.prototype.addSubSchemaObject=function addSubSchemaArray(c,y){if(y&&"object"==typeof y)for(var v in y)this.addSubSchema(c,y[v])},Q.prototype.setSchemas=function setSchemas(c){this.schemas=c},Q.prototype.getSchema=function getSchema(c){return this.schemas[c]},Q.prototype.validate=function validate(c,y,v,C){if("boolean"!=typeof y&&"object"!=typeof y||null===y)throw new P("Expected `schema` to be an object or boolean");v||(v={});var b,Q=y.$id||y.id,X=w.resolve(v.base||"/",Q||"");if(!C){(C=new K(y,v,[],X,Object.create(this.schemas))).schemas[X]||(C.schemas[X]=y);var te=S(X,y);for(var re in te.id){var ne=te.id[re];C.schemas[re]=ne}}if(v.required&&void 0===c)return(b=new T(c,y,v,C)).addError("is required, but is undefined"),b;if(!(b=this.validateSchema(c,y,v,C)))throw new Error("Result undefined");if(v.throwAll&&b.errors.length)throw new I(b);return b},Q.prototype.validateSchema=function validateSchema(c,y,v,w){var S=new T(c,y,v,w);if("boolean"==typeof y)!0===y?y={}:!1===y&&(y={type:[]});else if(!y)throw new Error("schema is undefined");if(y.extends)if(Array.isArray(y.extends)){var I={schema:y,ctx:w};y.extends.forEach(this.schemaTraverser.bind(this,I)),y=I.schema,I.schema=null,I.ctx=null,I=null}else y=b.deepMerge(y,this.superResolve(y.extends,w));var Q=shouldResolve(y);if(Q){var X=this.resolve(y,Q,w),te=new K(X.subschema,v,w.path,X.switchSchema,w.schemas);return this.validateSchema(c,X.subschema,v,te)}var re=v&&v.skipAttributes||[];for(var ne in y)if(!C.ignoreProperties[ne]&&re.indexOf(ne)<0){var oe=null,ie=this.attributes[ne];if(ie)oe=ie.call(this,c,y,v,w);else if(!1===v.allowUnknownAttributes)throw new P("Unsupported attribute: "+ne,y);oe&&S.importErrors(oe)}if("function"==typeof v.rewrite){var se=v.rewrite.call(this,c,y,v,w);S.instance=se}return S},Q.prototype.schemaTraverser=function schemaTraverser(c,y){c.schema=b.deepMerge(c.schema,this.superResolve(y,c.ctx))},Q.prototype.superResolve=function superResolve(c,y){var v=shouldResolve(c);return v?this.resolve(c,v,y).subschema:c},Q.prototype.resolve=function resolve(c,y,v){if(y=v.resolve(y),v.schemas[y])return{subschema:v.schemas[y],switchSchema:y};var C=w.parse(y),S=C&&C.hash,T=S&&S.length&&y.substr(0,y.length-S.length);if(!T||!v.schemas[T])throw new P("no such schema <"+y+">",c);var I=b.objectGetPath(v.schemas[T],S.substr(1));if(void 0===I)throw new P("no such schema "+S+" located in <"+T+">",c);return{subschema:I,switchSchema:y}},Q.prototype.testType=function validateType(c,y,v,w,C){if(void 0!==C){if(null===C)throw new P('Unexpected null in "type" keyword');if("function"==typeof this.types[C])return this.types[C].call(this,c);if(C&&"object"==typeof C){var b=this.validateSchema(c,C,v,w);return void 0===b||!(b&&b.errors.length)}return!0}};var X=Q.prototype.types={};X.string=function testString(c){return"string"==typeof c},X.number=function testNumber(c){return"number"==typeof c&&isFinite(c)},X.integer=function testInteger(c){return"number"==typeof c&&c%1==0},X.boolean=function testBoolean(c){return"boolean"==typeof c},X.array=function testArray(c){return Array.isArray(c)},X.null=function testNull(c){return null===c},X.date=function testDate(c){return c instanceof Date},X.any=function testAny(c){return!0},X.object=function testObject(c){return c&&"object"==typeof c&&!Array.isArray(c)&&!(c instanceof Date)},c.exports=Q},3887:(c,y,v)=>{"use strict";v.d(y,{sk:()=>Socket});const w="undefined"!=typeof self?self:null,C="undefined"!=typeof window?window:null,b=w||C||void 0,S="closed",T="errored",I="joined",P="joining",K="leaving",Q="phx_close",X="phx_error",te="phx_join",re="phx_reply",ne="phx_leave",oe=[Q,X,te,re,ne],ie="websocket";let closure=c=>"function"==typeof c?c:function(){return c};class Push{constructor(c,y,v,w){this.channel=c,this.event=y,this.payload=v||function(){return{}},this.receivedResp=null,this.timeout=w,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(c){this.timeout=c,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(c,y){return this.hasReceived(c)&&y(this.receivedResp.response),this.recHooks.push({status:c,callback:y}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:c,response:y,ref:v}){this.recHooks.filter((y=>y.status===c)).forEach((c=>c.callback(y)))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,(c=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=c,this.matchReceive(c)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}hasReceived(c){return this.receivedResp&&this.receivedResp.status===c}trigger(c,y){this.channel.trigger(this.refEvent,{status:c,response:y})}}class Channel{constructor(c,y,v){this.state=S,this.topic=c,this.params=closure(y||{}),this.socket=v,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new Push(this,te,this.params,this.timeout),this.pushBuffer=[],this.rejoinTimer=new Timer((()=>{this.socket.isConnected()&&this.rejoin()}),this.socket.rejoinAfterMs),this.socket.onError((()=>this.rejoinTimer.reset())),this.socket.onOpen((()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",(()=>{this.state=I,this.rejoinTimer.reset(),this.pushBuffer.forEach((c=>c.send())),this.pushBuffer=[]})),this.joinPush.receive("error",(()=>{this.state=T,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()})),this.onClose((()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=S,this.socket.remove(this)})),this.onError((c=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,c),this.isJoining()&&this.joinPush.reset(),this.state=T,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()})),this.joinPush.receive("timeout",(()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new Push(this,ne,closure({}),this.timeout).send(),this.state=T,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()})),this.on(re,((c,y)=>{this.trigger(this.replyEventName(y),c)}))}join(c=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=c,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(c){this.on(Q,c)}onError(c){return this.on(X,(y=>c(y)))}on(c,y){let v=this.bindingRef++;return this.bindings.push({event:c,ref:v,callback:y}),v}off(c,y){this.bindings=this.bindings.filter((v=>!(v.event===c&&(void 0===y||y===v.ref))))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(c,y,v=this.timeout){if(!this.joinedOnce)throw new Error(`tried to push '${c}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let w=new Push(this,c,(function(){return y}),v);return this.canPush()?w.send():(w.startTimeout(),this.pushBuffer.push(w)),w}pushUnreliable(c,y){if(!this.joinedOnce)throw`tried to push '${c}' to '${this.topic}' before joining. Use channel.join() before pushing events`;this.socket.push({topic:this.topic,event:c,payload:y,ref:null,join_ref:this.joinRef()},!1)}leave(c=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=K;let onClose=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(Q,"leave")},y=new Push(this,ne,closure({}),c);return y.receive("ok",(()=>onClose())).receive("timeout",(()=>onClose())),y.send(),this.canPush()||y.trigger("ok",{}),y}onMessage(c,y,v){return y}isLifecycleEvent(c){return oe.indexOf(c)>=0}isMember(c,y,v,w){return!(this.topic!==c||w&&w!==this.joinRef()&&this.isLifecycleEvent(y)&&(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:c,event:y,payload:v,joinRef:w}),1))}joinRef(){return this.joinPush.ref}sendJoin(c){this.state=P,this.joinPush.resend(c)}rejoin(c=this.timeout){this.isLeaving()||this.sendJoin(c)}trigger(c,y,v,w){let C=this.onMessage(c,y,v,w);if(y&&!C)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");for(let y=0;y<this.bindings.length;y++){const b=this.bindings[y];b.event===c&&b.callback(C,v,w||this.joinRef())}}replyEventName(c){return`chan_reply_${c}`}isClosed(){return this.state===S}isErrored(){return this.state===T}isJoined(){return this.state===I}isJoining(){return this.state===P}isLeaving(){return this.state===K}}let se={encode(c,y){let v=[c.join_ref,c.ref,c.topic,c.event,c.payload];return y(JSON.stringify(v))},decode(c,y){let[v,w,C,b,S]=JSON.parse(c);return y({join_ref:v,ref:w,topic:C,event:b,payload:S})}};class Socket{constructor(c,y={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=y.timeout||1e4,this.transport=y.transport||b.WebSocket||LongPoll,this.defaultEncoder=se.encode,this.defaultDecoder=se.decode,this.closeWasClean=!1,this.unloaded=!1,this.binaryType=y.binaryType||"arraybuffer",this.transport!==LongPoll?(this.encode=y.encode||this.defaultEncoder,this.decode=y.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),C&&C.addEventListener&&C.addEventListener("beforeunload",(c=>{this.conn&&(this.unloaded=!0,this.abnormalClose("unloaded"))})),this.heartbeatIntervalMs=y.heartbeatIntervalMs||3e4,this.rejoinAfterMs=c=>y.rejoinAfterMs?y.rejoinAfterMs(c):[1e3,2e3,5e3][c-1]||1e4,this.reconnectAfterMs=c=>this.unloaded?100:y.reconnectAfterMs?y.reconnectAfterMs(c):[10,50,100,150,200,250,500,1e3,2e3][c-1]||5e3,this.logger=y.logger||null,this.longpollerTimeout=y.longpollerTimeout||2e4,this.params=closure(y.params||{}),this.endPoint=`${c}/${ie}`,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new Timer((()=>{this.teardown((()=>this.connect()))}),this.reconnectAfterMs)}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let c=Ajax.appendParams(Ajax.appendParams(this.endPoint,this.params()),{vsn:"2.0.0"});return"/"!==c.charAt(0)?c:"/"===c.charAt(1)?`${this.protocol()}:${c}`:`${this.protocol()}://${location.host}${c}`}disconnect(c,y,v){this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(c,y,v)}connect(c){c&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=closure(c)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=c=>this.onConnError(c),this.conn.onmessage=c=>this.onConnMessage(c),this.conn.onclose=c=>this.onConnClose(c))}log(c,y,v){this.logger(c,y,v)}hasLogger(){return null!==this.logger}onOpen(c){this.stateChangeCallbacks.open.push(c)}onClose(c){this.stateChangeCallbacks.close.push(c)}onError(c){this.stateChangeCallbacks.error.push(c)}onMessage(c){this.stateChangeCallbacks.message.push(c)}onConnOpen(){this.hasLogger()&&this.log("transport",`connected to ${this.endPointURL()}`),this.unloaded=!1,this.closeWasClean=!1,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach((c=>c()))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs))}teardown(c,y,v){this.conn&&(this.conn.onclose=function(){},y?this.conn.close(y,v||""):this.conn.close(),this.conn=null),c&&c()}onConnClose(c){this.hasLogger()&&this.log("transport","close",c),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((y=>y(c)))}onConnError(c){this.hasLogger()&&this.log("transport",c),this.triggerChanError(),this.stateChangeCallbacks.error.forEach((y=>y(c)))}triggerChanError(){this.channels.forEach((c=>{c.isErrored()||c.isLeaving()||c.isClosed()||c.trigger(X)}))}connectionState(){switch(this.conn&&this.conn.readyState){case 0:return"connecting";case 1:return"open";case 2:return"closing";default:return"closed"}}isConnected(){return"open"===this.connectionState()}remove(c){this.channels=this.channels.filter((y=>y.joinRef()!==c.joinRef()))}channel(c,y={}){let v=new Channel(c,y,this);return this.channels.push(v),v}push(c,y=!0){if(this.hasLogger()){let{topic:y,event:v,payload:w,ref:C,join_ref:b}=c;this.log("push",`${y} ${v} (${b}, ${C})`,w)}this.isConnected()?this.encode(c,(c=>this.conn.send(c))):y&&this.sendBuffer.push((()=>this.encode(c,(c=>this.conn.send(c)))))}makeRef(){let c=this.ref+1;return c===this.ref?this.ref=0:this.ref=c,this.ref.toString()}sendHeartbeat(){if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void this.abnormalClose("heartbeat timeout");this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}abnormalClose(c){this.closeWasClean=!1,this.conn.close(1e3,c)}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((c=>c())),this.sendBuffer=[])}onConnMessage(c){this.decode(c.data,(c=>{let{topic:y,event:v,payload:w,ref:C,join_ref:b}=c;C&&C===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.hasLogger()&&this.log("receive",`${w.status||""} ${y} ${v} ${C&&"("+C+")"||""}`,w);for(let c=0;c<this.channels.length;c++){const S=this.channels[c];S.isMember(y,v,w,b)&&S.trigger(v,w,C,b)}for(let y=0;y<this.stateChangeCallbacks.message.length;y++)this.stateChangeCallbacks.message[y](c)}))}}class LongPoll{constructor(c){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(c),this.readyState=0,this.poll()}normalizeEndpoint(c){return c.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+ie),"$1/longpoll")}endpointURL(){return Ajax.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(){this.close(),this.readyState=0}ontimeout(){this.onerror("timeout"),this.closeAndRetry()}poll(){1!==this.readyState&&0!==this.readyState||Ajax.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),(c=>{if(c){var{status:y,token:v,messages:w}=c;this.token=v}else var y=0;switch(y){case 200:w.forEach((c=>this.onmessage({data:c}))),this.poll();break;case 204:this.poll();break;case 410:this.readyState=1,this.onopen(),this.poll();break;case 0:case 500:this.onerror(),this.closeAndRetry();break;default:throw new Error(`unhandled poll status ${y}`)}}))}send(c){Ajax.request("POST",this.endpointURL(),"application/json",c,this.timeout,this.onerror.bind(this,"timeout"),(c=>{c&&200===c.status||(this.onerror(c&&c.status),this.closeAndRetry())}))}close(c,y){this.readyState=3,this.onclose()}}class Ajax{static request(c,y,v,w,C,S,T){if(b.XDomainRequest){let v=new XDomainRequest;this.xdomainRequest(v,c,y,w,C,S,T)}else{let I=b.XMLHttpRequest?new b.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhrRequest(I,c,y,v,w,C,S,T)}}static xdomainRequest(c,y,v,w,C,b,S){c.timeout=C,c.open(y,v),c.onload=()=>{let y=this.parseJSON(c.responseText);S&&S(y)},b&&(c.ontimeout=b),c.onprogress=()=>{},c.send(w)}static xhrRequest(c,y,v,w,C,b,S,T){c.open(y,v,!0),c.timeout=b,c.setRequestHeader("Content-Type",w),c.onerror=()=>{T&&T(null)},c.onreadystatechange=()=>{if(c.readyState===this.states.complete&&T){let y=this.parseJSON(c.responseText);T(y)}},S&&(c.ontimeout=S),c.send(C)}static parseJSON(c){if(!c||""===c)return null;try{return JSON.parse(c)}catch(y){return console&&console.log("failed to parse JSON response",c),null}}static serialize(c,y){let v=[];for(var w in c){if(!c.hasOwnProperty(w))continue;let C=y?`${y}[${w}]`:w,b=c[w];"object"==typeof b?v.push(this.serialize(b,C)):v.push(encodeURIComponent(C)+"="+encodeURIComponent(b))}return v.join("&")}static appendParams(c,y){if(0===Object.keys(y).length)return c;let v=c.match(/\?/)?"&":"?";return`${c}${v}${this.serialize(y)}`}}Ajax.states={complete:4};class Timer{constructor(c,y){this.callback=c,this.timerCalc=y,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}},5327:c=>{for(var y=[],v=0;v<256;++v)y[v]=(v+256).toString(16).substr(1);c.exports=function bytesToUuid(c,v){var w=v||0,C=y;return[C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],"-",C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]],C[c[w++]]].join("")}},5217:c=>{var y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(y){var v=new Uint8Array(16);c.exports=function whatwgRNG(){return y(v),v}}else{var w=new Array(16);c.exports=function mathRNG(){for(var c,y=0;y<16;y++)0==(3&y)&&(c=4294967296*Math.random()),w[y]=c>>>((3&y)<<3)&255;return w}}},1171:(c,y,v)=>{var w=v(5217),C=v(5327);c.exports=function v4(c,y,v){var b=y&&v||0;"string"==typeof c&&(y="binary"===c?new Array(16):null,c=null);var S=(c=c||{}).random||(c.rng||w)();if(S[6]=15&S[6]|64,S[8]=63&S[8]|128,y)for(var T=0;T<16;++T)y[b+T]=S[T];return y||C(S)}},2808:c=>{"use strict";function hasOwnProperty(c,y){return Object.prototype.hasOwnProperty.call(c,y)}c.exports=function(c,y,v,w){y=y||"&",v=v||"=";var C={};if("string"!=typeof c||0===c.length)return C;var b=/\+/g;c=c.split(y);var S=1e3;w&&"number"==typeof w.maxKeys&&(S=w.maxKeys);var T=c.length;S>0&&T>S&&(T=S);for(var I=0;I<T;++I){var P,K,Q,X,te=c[I].replace(b,"%20"),re=te.indexOf(v);re>=0?(P=te.substr(0,re),K=te.substr(re+1)):(P=te,K=""),Q=decodeURIComponent(P),X=decodeURIComponent(K),hasOwnProperty(C,Q)?Array.isArray(C[Q])?C[Q].push(X):C[Q]=[C[Q],X]:C[Q]=X}return C}},1368:c=>{"use strict";var stringifyPrimitive=function(c){switch(typeof c){case"string":return c;case"boolean":return c?"true":"false";case"number":return isFinite(c)?c:"";default:return""}};c.exports=function(c,y,v,w){return y=y||"&",v=v||"=",null===c&&(c=void 0),"object"==typeof c?Object.keys(c).map((function(w){var C=encodeURIComponent(stringifyPrimitive(w))+v;return Array.isArray(c[w])?c[w].map((function(c){return C+encodeURIComponent(stringifyPrimitive(c))})).join(y):C+encodeURIComponent(stringifyPrimitive(c[w]))})).join(y):w?encodeURIComponent(stringifyPrimitive(w))+v+encodeURIComponent(stringifyPrimitive(c)):""}},6642:(c,y,v)=>{"use strict";y.decode=y.parse=v(2808),y.encode=y.stringify=v(1368)},9639:function(c,y,v){var w;
/*! https://mths.be/punycode v1.3.2 by @mathias */c=v.nmd(c),function(C){y&&y.nodeType,c&&c.nodeType;var b="object"==typeof v.g&&v.g;b.global!==b&&b.window!==b&&b.self;var S,T=2147483647,I=36,P=/^xn--/,K=/[^\x20-\x7E]/,Q=/[\x2E\u3002\uFF0E\uFF61]/g,X={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},te=Math.floor,re=String.fromCharCode;function error(c){throw RangeError(X[c])}function map(c,y){for(var v=c.length,w=[];v--;)w[v]=y(c[v]);return w}function mapDomain(c,y){var v=c.split("@"),w="";return v.length>1&&(w=v[0]+"@",c=v[1]),w+map((c=c.replace(Q,".")).split("."),y).join(".")}function ucs2decode(c){for(var y,v,w=[],C=0,b=c.length;C<b;)(y=c.charCodeAt(C++))>=55296&&y<=56319&&C<b?56320==(64512&(v=c.charCodeAt(C++)))?w.push(((1023&y)<<10)+(1023&v)+65536):(w.push(y),C--):w.push(y);return w}function ucs2encode(c){return map(c,(function(c){var y="";return c>65535&&(y+=re((c-=65536)>>>10&1023|55296),c=56320|1023&c),y+re(c)})).join("")}function digitToBasic(c,y){return c+22+75*(c<26)-((0!=y)<<5)}function adapt(c,y,v){var w=0;for(c=v?te(c/700):c>>1,c+=te(c/y);c>455;w+=I)c=te(c/35);return te(w+36*c/(c+38))}function decode(c){var y,v,w,C,b,S,P,K,Q,X,re,ne=[],oe=c.length,ie=0,se=128,ue=72;for((v=c.lastIndexOf("-"))<0&&(v=0),w=0;w<v;++w)c.charCodeAt(w)>=128&&error("not-basic"),ne.push(c.charCodeAt(w));for(C=v>0?v+1:0;C<oe;){for(b=ie,S=1,P=I;C>=oe&&error("invalid-input"),((K=(re=c.charCodeAt(C++))-48<10?re-22:re-65<26?re-65:re-97<26?re-97:I)>=I||K>te((T-ie)/S))&&error("overflow"),ie+=K*S,!(K<(Q=P<=ue?1:P>=ue+26?26:P-ue));P+=I)S>te(T/(X=I-Q))&&error("overflow"),S*=X;ue=adapt(ie-b,y=ne.length+1,0==b),te(ie/y)>T-se&&error("overflow"),se+=te(ie/y),ie%=y,ne.splice(ie++,0,se)}return ucs2encode(ne)}function encode(c){var y,v,w,C,b,S,P,K,Q,X,ne,oe,ie,se,ue,de=[];for(oe=(c=ucs2decode(c)).length,y=128,v=0,b=72,S=0;S<oe;++S)(ne=c[S])<128&&de.push(re(ne));for(w=C=de.length,C&&de.push("-");w<oe;){for(P=T,S=0;S<oe;++S)(ne=c[S])>=y&&ne<P&&(P=ne);for(P-y>te((T-v)/(ie=w+1))&&error("overflow"),v+=(P-y)*ie,y=P,S=0;S<oe;++S)if((ne=c[S])<y&&++v>T&&error("overflow"),ne==y){for(K=v,Q=I;!(K<(X=Q<=b?1:Q>=b+26?26:Q-b));Q+=I)ue=K-X,se=I-X,de.push(re(digitToBasic(X+ue%se,0))),K=te(ue/se);de.push(re(digitToBasic(K,0))),b=adapt(v,ie,w==C),v=0,++w}++v,++y}return de.join("")}S={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode,encode,toASCII:function toASCII(c){return mapDomain(c,(function(c){return K.test(c)?"xn--"+encode(c):c}))},toUnicode:function toUnicode(c){return mapDomain(c,(function(c){return P.test(c)?decode(c.slice(4).toLowerCase()):c}))}},void 0===(w=function(){return S}.call(y,v,y,c))||(c.exports=w)}()},883:(c,y,v)=>{"use strict";var w=v(9639),C=v(5225);function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}y.parse=urlParse,y.resolve=function urlResolve(c,y){return urlParse(c,!1,!0).resolve(y)},y.resolveObject=function urlResolveObject(c,y){return c?urlParse(c,!1,!0).resolveObject(y):y},y.format=function urlFormat(c){return C.isString(c)&&(c=urlParse(c)),c instanceof Url?c.format():Url.prototype.format.call(c)},y.Url=Url;var b=/^([a-z0-9.+-]+:)/i,S=/:[0-9]*$/,T=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,I=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),P=["'"].concat(I),K=["%","/","?",";","#"].concat(P),Q=["/","?","#"],X=/^[+a-z0-9A-Z_-]{0,63}$/,te=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,re={javascript:!0,"javascript:":!0},ne={javascript:!0,"javascript:":!0},oe={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},ie=v(6642);function urlParse(c,y,v){if(c&&C.isObject(c)&&c instanceof Url)return c;var w=new Url;return w.parse(c,y,v),w}Url.prototype.parse=function(c,y,v){if(!C.isString(c))throw new TypeError("Parameter 'url' must be a string, not "+typeof c);var S=c.indexOf("?"),I=-1!==S&&S<c.indexOf("#")?"?":"#",se=c.split(I);se[0]=se[0].replace(/\\/g,"/");var ue=c=se.join(I);if(ue=ue.trim(),!v&&1===c.split("#").length){var de=T.exec(ue);if(de)return this.path=ue,this.href=ue,this.pathname=de[1],de[2]?(this.search=de[2],this.query=y?ie.parse(this.search.substr(1)):this.search.substr(1)):y&&(this.search="",this.query={}),this}var pe=b.exec(ue);if(pe){var Ee=(pe=pe[0]).toLowerCase();this.protocol=Ee,ue=ue.substr(pe.length)}if(v||pe||ue.match(/^\/\/[^@\/]+@[^@\/]+/)){var Ie="//"===ue.substr(0,2);!Ie||pe&&ne[pe]||(ue=ue.substr(2),this.slashes=!0)}if(!ne[pe]&&(Ie||pe&&!oe[pe])){for(var Ue,Ke,Ve=-1,$e=0;$e<Q.length;$e++)-1!==(Je=ue.indexOf(Q[$e]))&&(-1===Ve||Je<Ve)&&(Ve=Je);for(-1!==(Ke=-1===Ve?ue.lastIndexOf("@"):ue.lastIndexOf("@",Ve))&&(Ue=ue.slice(0,Ke),ue=ue.slice(Ke+1),this.auth=decodeURIComponent(Ue)),Ve=-1,$e=0;$e<K.length;$e++){var Je;-1!==(Je=ue.indexOf(K[$e]))&&(-1===Ve||Je<Ve)&&(Ve=Je)}-1===Ve&&(Ve=ue.length),this.host=ue.slice(0,Ve),ue=ue.slice(Ve),this.parseHost(),this.hostname=this.hostname||"";var Qe="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!Qe)for(var Ze=this.hostname.split(/\./),Xe=($e=0,Ze.length);$e<Xe;$e++){var yt=Ze[$e];if(yt&&!yt.match(X)){for(var vt="",wt=0,Et=yt.length;wt<Et;wt++)yt.charCodeAt(wt)>127?vt+="x":vt+=yt[wt];if(!vt.match(X)){var _t=Ze.slice(0,$e),bt=Ze.slice($e+1),St=yt.match(te);St&&(_t.push(St[1]),bt.unshift(St[2])),bt.length&&(ue="/"+bt.join(".")+ue),this.hostname=_t.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),Qe||(this.hostname=w.toASCII(this.hostname));var Tt=this.port?":"+this.port:"",At=this.hostname||"";this.host=At+Tt,this.href+=this.host,Qe&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==ue[0]&&(ue="/"+ue))}if(!re[Ee])for($e=0,Xe=P.length;$e<Xe;$e++){var It=P[$e];if(-1!==ue.indexOf(It)){var Rt=encodeURIComponent(It);Rt===It&&(Rt=escape(It)),ue=ue.split(It).join(Rt)}}var kt=ue.indexOf("#");-1!==kt&&(this.hash=ue.substr(kt),ue=ue.slice(0,kt));var Ot=ue.indexOf("?");if(-1!==Ot?(this.search=ue.substr(Ot),this.query=ue.substr(Ot+1),y&&(this.query=ie.parse(this.query)),ue=ue.slice(0,Ot)):y&&(this.search="",this.query={}),ue&&(this.pathname=ue),oe[Ee]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){Tt=this.pathname||"";var Nt=this.search||"";this.path=Tt+Nt}return this.href=this.format(),this},Url.prototype.format=function(){var c=this.auth||"";c&&(c=(c=encodeURIComponent(c)).replace(/%3A/i,":"),c+="@");var y=this.protocol||"",v=this.pathname||"",w=this.hash||"",b=!1,S="";this.host?b=c+this.host:this.hostname&&(b=c+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(b+=":"+this.port)),this.query&&C.isObject(this.query)&&Object.keys(this.query).length&&(S=ie.stringify(this.query));var T=this.search||S&&"?"+S||"";return y&&":"!==y.substr(-1)&&(y+=":"),this.slashes||(!y||oe[y])&&!1!==b?(b="//"+(b||""),v&&"/"!==v.charAt(0)&&(v="/"+v)):b||(b=""),w&&"#"!==w.charAt(0)&&(w="#"+w),T&&"?"!==T.charAt(0)&&(T="?"+T),y+b+(v=v.replace(/[?#]/g,(function(c){return encodeURIComponent(c)})))+(T=T.replace("#","%23"))+w},Url.prototype.resolve=function(c){return this.resolveObject(urlParse(c,!1,!0)).format()},Url.prototype.resolveObject=function(c){if(C.isString(c)){var y=new Url;y.parse(c,!1,!0),c=y}for(var v=new Url,w=Object.keys(this),b=0;b<w.length;b++){var S=w[b];v[S]=this[S]}if(v.hash=c.hash,""===c.href)return v.href=v.format(),v;if(c.slashes&&!c.protocol){for(var T=Object.keys(c),I=0;I<T.length;I++){var P=T[I];"protocol"!==P&&(v[P]=c[P])}return oe[v.protocol]&&v.hostname&&!v.pathname&&(v.path=v.pathname="/"),v.href=v.format(),v}if(c.protocol&&c.protocol!==v.protocol){if(!oe[c.protocol]){for(var K=Object.keys(c),Q=0;Q<K.length;Q++){var X=K[Q];v[X]=c[X]}return v.href=v.format(),v}if(v.protocol=c.protocol,c.host||ne[c.protocol])v.pathname=c.pathname;else{for(var te=(c.pathname||"").split("/");te.length&&!(c.host=te.shift()););c.host||(c.host=""),c.hostname||(c.hostname=""),""!==te[0]&&te.unshift(""),te.length<2&&te.unshift(""),v.pathname=te.join("/")}if(v.search=c.search,v.query=c.query,v.host=c.host||"",v.auth=c.auth,v.hostname=c.hostname||c.host,v.port=c.port,v.pathname||v.search){var re=v.pathname||"",ie=v.search||"";v.path=re+ie}return v.slashes=v.slashes||c.slashes,v.href=v.format(),v}var se=v.pathname&&"/"===v.pathname.charAt(0),ue=c.host||c.pathname&&"/"===c.pathname.charAt(0),de=ue||se||v.host&&c.pathname,pe=de,Ee=v.pathname&&v.pathname.split("/")||[],Ie=(te=c.pathname&&c.pathname.split("/")||[],v.protocol&&!oe[v.protocol]);if(Ie&&(v.hostname="",v.port=null,v.host&&(""===Ee[0]?Ee[0]=v.host:Ee.unshift(v.host)),v.host="",c.protocol&&(c.hostname=null,c.port=null,c.host&&(""===te[0]?te[0]=c.host:te.unshift(c.host)),c.host=null),de=de&&(""===te[0]||""===Ee[0])),ue)v.host=c.host||""===c.host?c.host:v.host,v.hostname=c.hostname||""===c.hostname?c.hostname:v.hostname,v.search=c.search,v.query=c.query,Ee=te;else if(te.length)Ee||(Ee=[]),Ee.pop(),Ee=Ee.concat(te),v.search=c.search,v.query=c.query;else if(!C.isNullOrUndefined(c.search))return Ie&&(v.hostname=v.host=Ee.shift(),(Je=!!(v.host&&v.host.indexOf("@")>0)&&v.host.split("@"))&&(v.auth=Je.shift(),v.host=v.hostname=Je.shift())),v.search=c.search,v.query=c.query,C.isNull(v.pathname)&&C.isNull(v.search)||(v.path=(v.pathname?v.pathname:"")+(v.search?v.search:"")),v.href=v.format(),v;if(!Ee.length)return v.pathname=null,v.search?v.path="/"+v.search:v.path=null,v.href=v.format(),v;for(var Ue=Ee.slice(-1)[0],Ke=(v.host||c.host||Ee.length>1)&&("."===Ue||".."===Ue)||""===Ue,Ve=0,$e=Ee.length;$e>=0;$e--)"."===(Ue=Ee[$e])?Ee.splice($e,1):".."===Ue?(Ee.splice($e,1),Ve++):Ve&&(Ee.splice($e,1),Ve--);if(!de&&!pe)for(;Ve--;Ve)Ee.unshift("..");!de||""===Ee[0]||Ee[0]&&"/"===Ee[0].charAt(0)||Ee.unshift(""),Ke&&"/"!==Ee.join("/").substr(-1)&&Ee.push("");var Je,Qe=""===Ee[0]||Ee[0]&&"/"===Ee[0].charAt(0);return Ie&&(v.hostname=v.host=Qe?"":Ee.length?Ee.shift():"",(Je=!!(v.host&&v.host.indexOf("@")>0)&&v.host.split("@"))&&(v.auth=Je.shift(),v.host=v.hostname=Je.shift())),(de=de||v.host&&Ee.length)&&!Qe&&Ee.unshift(""),Ee.length?v.pathname=Ee.join("/"):(v.pathname=null,v.path=null),C.isNull(v.pathname)&&C.isNull(v.search)||(v.path=(v.pathname?v.pathname:"")+(v.search?v.search:"")),v.auth=c.auth||v.auth,v.slashes=v.slashes||c.slashes,v.href=v.format(),v},Url.prototype.parseHost=function(){var c=this.host,y=S.exec(c);y&&(":"!==(y=y[0])&&(this.port=y.substr(1)),c=c.substr(0,c.length-y.length)),c&&(this.hostname=c)}},5225:c=>{"use strict";c.exports={isString:function(c){return"string"==typeof c},isObject:function(c){return"object"==typeof c&&null!==c},isNull:function(c){return null===c},isNullOrUndefined:function(c){return null==c}}},12:y=>{"use strict";y.exports=c},6535:(c,y,w)=>{"use strict";function assertType(c,y,...v){if(!c)throw new TypeError(format(y,v))}function format(c,y){let v=0;return c.replace(/%[os]/gu,(()=>anyToString(y[v++])))}function anyToString(c){return"object"!=typeof c||null===c?String(c):Object.prototype.toString.call(c)}w.d(y,{Rf:()=>EventTarget});const C="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==v.g?v.g:"undefined"!=typeof globalThis?globalThis:void 0;let b;class Warning{constructor(c,y){this.code=c,this.message=y}warn(...c){var y;try{b;const v=(null!==(y=(new Error).stack)&&void 0!==y?y:"").replace(/^(?:.+?\n){2}/gu,"\n");console.warn(this.message,...c,v)}catch(c){}}}const S=new Warning("W01","Unable to initialize event under dispatching."),T=new Warning("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),I=new Warning("W03","Assigning any truthy value to 'returnValue' property has no effect."),P=new Warning("W04","Unable to preventDefault on non-cancelable events."),K=new Warning("W05","Unable to preventDefault inside passive event listener invocation."),Q=new Warning("W06","An event listener wasn't added because it has been added already: %o, %o"),X=new Warning("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),te=new Warning("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o");new Warning("W09","Event attribute handler must be a function: %o");class Event{static get NONE(){return re}static get CAPTURING_PHASE(){return ne}static get AT_TARGET(){return oe}static get BUBBLING_PHASE(){return ie}constructor(c,y){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const v=null!=y?y:{};se.set(this,{type:String(c),bubbles:Boolean(v.bubbles),cancelable:Boolean(v.cancelable),composed:Boolean(v.composed),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return $(this).type}get target(){return $(this).target}get srcElement(){return $(this).target}get currentTarget(){return $(this).currentTarget}composedPath(){const c=$(this).currentTarget;return c?[c]:[]}get NONE(){return re}get CAPTURING_PHASE(){return ne}get AT_TARGET(){return oe}get BUBBLING_PHASE(){return ie}get eventPhase(){return $(this).dispatchFlag?2:0}stopPropagation(){$(this).stopPropagationFlag=!0}get cancelBubble(){return $(this).stopPropagationFlag}set cancelBubble(c){c?$(this).stopPropagationFlag=!0:T.warn()}stopImmediatePropagation(){const c=$(this);c.stopPropagationFlag=c.stopImmediatePropagationFlag=!0}get bubbles(){return $(this).bubbles}get cancelable(){return $(this).cancelable}get returnValue(){return!$(this).canceledFlag}set returnValue(c){c?I.warn():setCancelFlag($(this))}preventDefault(){setCancelFlag($(this))}get defaultPrevented(){return $(this).canceledFlag}get composed(){return $(this).composed}get isTrusted(){return!1}get timeStamp(){return $(this).timeStamp}initEvent(c,y=!1,v=!1){const w=$(this);w.dispatchFlag?S.warn():se.set(this,{...w,type:String(c),bubbles:Boolean(y),cancelable:Boolean(v),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1})}}const re=0,ne=1,oe=2,ie=3,se=new WeakMap;function $(c,y="this"){const v=se.get(c);return assertType(null!=v,"'%s' must be an object that Event constructor created, but got another one: %o",y,c),v}function setCancelFlag(c){c.inPassiveListenerFlag?K.warn():c.cancelable?c.canceledFlag=!0:P.warn()}Object.defineProperty(Event,"NONE",{enumerable:!0}),Object.defineProperty(Event,"CAPTURING_PHASE",{enumerable:!0}),Object.defineProperty(Event,"AT_TARGET",{enumerable:!0}),Object.defineProperty(Event,"BUBBLING_PHASE",{enumerable:!0});const ue=Object.getOwnPropertyNames(Event.prototype);for(let c=0;c<ue.length;++c)"constructor"!==ue[c]&&Object.defineProperty(Event.prototype,ue[c],{enumerable:!0});let de;void 0!==C&&void 0!==C.Event&&Object.setPrototypeOf(Event.prototype,C.Event.prototype);const pe={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function defineErrorCodeProperties(c){const y=Object.keys(pe);for(let v=0;v<y.length;++v){const w=y[v],C=pe[w];Object.defineProperty(c,w,{get:()=>C,configurable:!0,enumerable:!0})}}class EventWrapper extends Event{static wrap(c){return new(getWrapperClassOf(c))(c)}constructor(c){super(c.type,{bubbles:c.bubbles,cancelable:c.cancelable,composed:c.composed}),c.cancelBubble&&super.stopPropagation(),c.defaultPrevented&&super.preventDefault(),Ee.set(this,{original:c});const y=Object.keys(c);for(let v=0;v<y.length;++v){const w=y[v];w in this||Object.defineProperty(this,w,defineRedirectDescriptor(c,w))}}stopPropagation(){super.stopPropagation();const{original:c}=$$1(this);"stopPropagation"in c&&c.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(c){super.cancelBubble=c;const{original:y}=$$1(this);"cancelBubble"in y&&(y.cancelBubble=c)}stopImmediatePropagation(){super.stopImmediatePropagation();const{original:c}=$$1(this);"stopImmediatePropagation"in c&&c.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(c){super.returnValue=c;const{original:y}=$$1(this);"returnValue"in y&&(y.returnValue=c)}preventDefault(){super.preventDefault();const{original:c}=$$1(this);"preventDefault"in c&&c.preventDefault()}get timeStamp(){const{original:c}=$$1(this);return"timeStamp"in c?c.timeStamp:super.timeStamp}}const Ee=new WeakMap;function $$1(c){const y=Ee.get(c);return assertType(null!=y,"'this' is expected an Event object, but got",c),y}const Ie=new WeakMap;function getWrapperClassOf(c){const y=Object.getPrototypeOf(c);if(null==y)return EventWrapper;let v=Ie.get(y);return null==v&&(v=function defineWrapper(c,y){class CustomEventWrapper extends c{}const v=Object.keys(y);for(let c=0;c<v.length;++c)Object.defineProperty(CustomEventWrapper.prototype,v[c],defineRedirectDescriptor(y,v[c]));return CustomEventWrapper}(getWrapperClassOf(y),y),Ie.set(y,v)),v}function defineRedirectDescriptor(c,y){const v=Object.getOwnPropertyDescriptor(c,y);return{get(){const c=$$1(this).original,v=c[y];return"function"==typeof v?v.bind(c):v},set(c){$$1(this).original[y]=c},configurable:v.configurable,enumerable:v.enumerable}}function isCapture(c){return 1==(1&c.flags)}function isPassive(c){return 2==(2&c.flags)}function isOnce(c){return 4==(4&c.flags)}function isRemoved(c){return 8==(8&c.flags)}function invokeCallback({callback:c},y,v){try{"function"==typeof c?c.call(y,v):"function"==typeof c.handleEvent&&c.handleEvent(v)}catch(c){!function reportError(c){try{const y=c instanceof Error?c:new Error(anyToString(c));if("function"==typeof dispatchEvent&&"function"==typeof ErrorEvent)dispatchEvent(new ErrorEvent("error",{error:y,message:y.message}));else if("undefined"!=typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",y);console.error(y)}catch(c){}}(c)}}function findIndexOfListener({listeners:c},y,v){for(let w=0;w<c.length;++w)if(c[w].callback===y&&isCapture(c[w])===v)return w;return-1}function removeListener(c,y,v){const w=findIndexOfListener(c,y,v);return-1!==w&&removeListenerAt(c,w)}function removeListenerAt(c,y,v=!1){const w=c.listeners[y];return function setRemoved(c){c.flags|=8}(w),w.signal&&w.signal.removeEventListener("abort",w.signalListener),c.cow&&!v?(c.cow=!1,c.listeners=c.listeners.filter(((c,v)=>v!==y)),!1):(c.listeners.splice(y,1),!0)}Ie.set(Object.prototype,EventWrapper),void 0!==C&&void 0!==C.Event&&Ie.set(C.Event.prototype,EventWrapper);class EventTarget{constructor(){Ue.set(this,function createListenerListMap(){return Object.create(null)}())}addEventListener(c,y,v){const w=$$2(this),{callback:C,capture:b,once:S,passive:T,signal:I,type:P}=function normalizeAddOptions(c,y,v){var w;return assertCallback(y),"object"==typeof v&&null!==v?{type:String(c),callback:null!=y?y:void 0,capture:Boolean(v.capture),passive:Boolean(v.passive),once:Boolean(v.once),signal:null!==(w=v.signal)&&void 0!==w?w:void 0}:{type:String(c),callback:null!=y?y:void 0,capture:Boolean(v),passive:!1,once:!1,signal:void 0}}(c,y,v);if(null==C||(null==I?void 0:I.aborted))return;const K=function ensureListenerList(c,y){var v;return null!==(v=c[y])&&void 0!==v?v:c[y]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}(w,P),te=findIndexOfListener(K,C,b);-1===te?function addListener(c,y,v,w,C,b){let S;b&&(S=removeListener.bind(null,c,y,v),b.addEventListener("abort",S));const T=function createListener(c,y,v,w,C,b){return{callback:c,flags:(y?1:0)|(v?2:0)|(w?4:0),signal:C,signalListener:b}}(y,v,w,C,b,S);return c.cow?(c.cow=!1,c.listeners=[...c.listeners,T]):c.listeners.push(T),T}(K,C,b,T,S,I):function warnDuplicate(c,y,v,w){Q.warn(isCapture(c)?"capture":"bubble",c.callback),isPassive(c)!==y&&X.warn("passive"),isOnce(c)!==v&&X.warn("once"),c.signal!==w&&X.warn("signal")}(K.listeners[te],T,S,I)}removeEventListener(c,y,v){const w=$$2(this),{callback:C,capture:b,type:S}=function normalizeOptions(c,y,v){return assertCallback(y),"object"==typeof v&&null!==v?{type:String(c),callback:null!=y?y:void 0,capture:Boolean(v.capture)}:{type:String(c),callback:null!=y?y:void 0,capture:Boolean(v)}}(c,y,v),T=w[S];null!=C&&T&&removeListener(T,C,b)}dispatchEvent(c){const y=$$2(this)[String(c.type)];if(null==y)return!0;const v=c instanceof Event?c:EventWrapper.wrap(c),w=$(v,"event");if(w.dispatchFlag)throw function createInvalidStateError(c){return C.DOMException?new C.DOMException(c,"InvalidStateError"):(null==de&&(de=class DOMException extends Error{constructor(c){super(c),Error.captureStackTrace&&Error.captureStackTrace(this,DOMException)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(de.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),defineErrorCodeProperties(de),defineErrorCodeProperties(de.prototype)),new de(c))}("This event has been in dispatching.");if(w.dispatchFlag=!0,w.target=w.currentTarget=this,!w.stopPropagationFlag){const{cow:c,listeners:C}=y;y.cow=!0;for(let b=0;b<C.length;++b){const S=C[b];if(!isRemoved(S)&&(isOnce(S)&&removeListenerAt(y,b,!c)&&(b-=1),w.inPassiveListenerFlag=isPassive(S),invokeCallback(S,this,v),w.inPassiveListenerFlag=!1,w.stopImmediatePropagationFlag))break}c||(y.cow=!1)}return w.target=null,w.currentTarget=null,w.stopImmediatePropagationFlag=!1,w.stopPropagationFlag=!1,w.dispatchFlag=!1,!w.canceledFlag}}const Ue=new WeakMap;function $$2(c,y="this"){const v=Ue.get(c);return assertType(null!=v,"'%s' must be an object that EventTarget constructor created, but got another one: %o",y,c),v}function assertCallback(c){if("function"!=typeof c&&("object"!=typeof c||null===c||"function"!=typeof c.handleEvent)){if(null!=c&&"object"!=typeof c)throw new TypeError(format(te.message,[c]));te.warn(c)}}const Ke=Object.getOwnPropertyNames(EventTarget.prototype);for(let c=0;c<Ke.length;++c)"constructor"!==Ke[c]&&Object.defineProperty(EventTarget.prototype,Ke[c],{enumerable:!0});void 0!==C&&void 0!==C.EventTarget&&Object.setPrototypeOf(EventTarget.prototype,C.EventTarget.prototype)},8593:c=>{"use strict";c.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},w={};function __nested_webpack_require_275828__(c){var v=w[c];if(void 0!==v)return v.exports;var C=w[c]={id:c,loaded:!1,exports:{}};return y[c].call(C.exports,C,C.exports,__nested_webpack_require_275828__),C.loaded=!0,C.exports}return __nested_webpack_require_275828__.n=c=>{var y=c&&c.__esModule?()=>c.default:()=>c;return __nested_webpack_require_275828__.d(y,{a:y}),y},__nested_webpack_require_275828__.d=(c,y)=>{for(var v in y)__nested_webpack_require_275828__.o(y,v)&&!__nested_webpack_require_275828__.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:y[v]})},__nested_webpack_require_275828__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(c){if("object"==typeof window)return window}}(),__nested_webpack_require_275828__.o=(c,y)=>Object.prototype.hasOwnProperty.call(c,y),__nested_webpack_require_275828__.r=c=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},__nested_webpack_require_275828__.nmd=c=>(c.paths=[],c.children||(c.children=[]),c),__nested_webpack_require_275828__(6091)})()))},91:(c,y,v)=>{"use strict";v.d(y,{MICROSOFT_STATIC_SERVICE:()=>w});v(12);const w="@aptero/axolotis-module-teams/MicrosoftStaticService"},742:(c,y)=>{"use strict";y.byteLength=function byteLength(c){var y=getLens(c),v=y[0],w=y[1];return 3*(v+w)/4-w},y.toByteArray=function toByteArray(c){var y,v,b=getLens(c),S=b[0],T=b[1],I=new C(function _byteLength(c,y,v){return 3*(y+v)/4-v}(0,S,T)),P=0,K=T>0?S-4:S;for(v=0;v<K;v+=4)y=w[c.charCodeAt(v)]<<18|w[c.charCodeAt(v+1)]<<12|w[c.charCodeAt(v+2)]<<6|w[c.charCodeAt(v+3)],I[P++]=y>>16&255,I[P++]=y>>8&255,I[P++]=255&y;2===T&&(y=w[c.charCodeAt(v)]<<2|w[c.charCodeAt(v+1)]>>4,I[P++]=255&y);1===T&&(y=w[c.charCodeAt(v)]<<10|w[c.charCodeAt(v+1)]<<4|w[c.charCodeAt(v+2)]>>2,I[P++]=y>>8&255,I[P++]=255&y);return I},y.fromByteArray=function fromByteArray(c){for(var y,w=c.length,C=w%3,b=[],S=16383,T=0,I=w-C;T<I;T+=S)b.push(encodeChunk(c,T,T+S>I?I:T+S));1===C?(y=c[w-1],b.push(v[y>>2]+v[y<<4&63]+"==")):2===C&&(y=(c[w-2]<<8)+c[w-1],b.push(v[y>>10]+v[y>>4&63]+v[y<<2&63]+"="));return b.join("")};for(var v=[],w=[],C="undefined"!=typeof Uint8Array?Uint8Array:Array,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=0,T=b.length;S<T;++S)v[S]=b[S],w[b.charCodeAt(S)]=S;function getLens(c){var y=c.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=c.indexOf("=");return-1===v&&(v=y),[v,v===y?0:4-v%4]}function encodeChunk(c,y,w){for(var C,b,S=[],T=y;T<w;T+=3)C=(c[T]<<16&16711680)+(c[T+1]<<8&65280)+(255&c[T+2]),S.push(v[(b=C)>>18&63]+v[b>>12&63]+v[b>>6&63]+v[63&b]);return S.join("")}w["-".charCodeAt(0)]=62,w["_".charCodeAt(0)]=63},764:(c,y,v)=>{"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
const w=v(742),C=v(645),b="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;y.lW=Buffer,y.h2=50;const S=2147483647;function createBuffer(c){if(c>S)throw new RangeError('The value "'+c+'" is invalid for option "size"');const y=new Uint8Array(c);return Object.setPrototypeOf(y,Buffer.prototype),y}function Buffer(c,y,v){if("number"==typeof c){if("string"==typeof y)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(c)}return from(c,y,v)}function from(c,y,v){if("string"==typeof c)return function fromString(c,y){"string"==typeof y&&""!==y||(y="utf8");if(!Buffer.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const v=0|byteLength(c,y);let w=createBuffer(v);const C=w.write(c,y);C!==v&&(w=w.slice(0,C));return w}(c,y);if(ArrayBuffer.isView(c))return function fromArrayView(c){if(isInstance(c,Uint8Array)){const y=new Uint8Array(c);return fromArrayBuffer(y.buffer,y.byteOffset,y.byteLength)}return fromArrayLike(c)}(c);if(null==c)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(isInstance(c,ArrayBuffer)||c&&isInstance(c.buffer,ArrayBuffer))return fromArrayBuffer(c,y,v);if("undefined"!=typeof SharedArrayBuffer&&(isInstance(c,SharedArrayBuffer)||c&&isInstance(c.buffer,SharedArrayBuffer)))return fromArrayBuffer(c,y,v);if("number"==typeof c)throw new TypeError('The "value" argument must not be of type number. Received type number');const w=c.valueOf&&c.valueOf();if(null!=w&&w!==c)return Buffer.from(w,y,v);const C=function fromObject(c){if(Buffer.isBuffer(c)){const y=0|checked(c.length),v=createBuffer(y);return 0===v.length||c.copy(v,0,0,y),v}if(void 0!==c.length)return"number"!=typeof c.length||numberIsNaN(c.length)?createBuffer(0):fromArrayLike(c);if("Buffer"===c.type&&Array.isArray(c.data))return fromArrayLike(c.data)}(c);if(C)return C;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof c[Symbol.toPrimitive])return Buffer.from(c[Symbol.toPrimitive]("string"),y,v);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}function assertSize(c){if("number"!=typeof c)throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function allocUnsafe(c){return assertSize(c),createBuffer(c<0?0:0|checked(c))}function fromArrayLike(c){const y=c.length<0?0:0|checked(c.length),v=createBuffer(y);for(let w=0;w<y;w+=1)v[w]=255&c[w];return v}function fromArrayBuffer(c,y,v){if(y<0||c.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<y+(v||0))throw new RangeError('"length" is outside of buffer bounds');let w;return w=void 0===y&&void 0===v?new Uint8Array(c):void 0===v?new Uint8Array(c,y):new Uint8Array(c,y,v),Object.setPrototypeOf(w,Buffer.prototype),w}function checked(c){if(c>=S)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+S.toString(16)+" bytes");return 0|c}function byteLength(c,y){if(Buffer.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||isInstance(c,ArrayBuffer))return c.byteLength;if("string"!=typeof c)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);const v=c.length,w=arguments.length>2&&!0===arguments[2];if(!w&&0===v)return 0;let C=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":return utf8ToBytes(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*v;case"hex":return v>>>1;case"base64":return base64ToBytes(c).length;default:if(C)return w?-1:utf8ToBytes(c).length;y=(""+y).toLowerCase(),C=!0}}function slowToString(c,y,v){let w=!1;if((void 0===y||y<0)&&(y=0),y>this.length)return"";if((void 0===v||v>this.length)&&(v=this.length),v<=0)return"";if((v>>>=0)<=(y>>>=0))return"";for(c||(c="utf8");;)switch(c){case"hex":return hexSlice(this,y,v);case"utf8":case"utf-8":return utf8Slice(this,y,v);case"ascii":return asciiSlice(this,y,v);case"latin1":case"binary":return latin1Slice(this,y,v);case"base64":return base64Slice(this,y,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,y,v);default:if(w)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),w=!0}}function swap(c,y,v){const w=c[y];c[y]=c[v],c[v]=w}function bidirectionalIndexOf(c,y,v,w,C){if(0===c.length)return-1;if("string"==typeof v?(w=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),numberIsNaN(v=+v)&&(v=C?0:c.length-1),v<0&&(v=c.length+v),v>=c.length){if(C)return-1;v=c.length-1}else if(v<0){if(!C)return-1;v=0}if("string"==typeof y&&(y=Buffer.from(y,w)),Buffer.isBuffer(y))return 0===y.length?-1:arrayIndexOf(c,y,v,w,C);if("number"==typeof y)return y&=255,"function"==typeof Uint8Array.prototype.indexOf?C?Uint8Array.prototype.indexOf.call(c,y,v):Uint8Array.prototype.lastIndexOf.call(c,y,v):arrayIndexOf(c,[y],v,w,C);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(c,y,v,w,C){let b,S=1,T=c.length,I=y.length;if(void 0!==w&&("ucs2"===(w=String(w).toLowerCase())||"ucs-2"===w||"utf16le"===w||"utf-16le"===w)){if(c.length<2||y.length<2)return-1;S=2,T/=2,I/=2,v/=2}function read(c,y){return 1===S?c[y]:c.readUInt16BE(y*S)}if(C){let w=-1;for(b=v;b<T;b++)if(read(c,b)===read(y,-1===w?0:b-w)){if(-1===w&&(w=b),b-w+1===I)return w*S}else-1!==w&&(b-=b-w),w=-1}else for(v+I>T&&(v=T-I),b=v;b>=0;b--){let v=!0;for(let w=0;w<I;w++)if(read(c,b+w)!==read(y,w)){v=!1;break}if(v)return b}return-1}function hexWrite(c,y,v,w){v=Number(v)||0;const C=c.length-v;w?(w=Number(w))>C&&(w=C):w=C;const b=y.length;let S;for(w>b/2&&(w=b/2),S=0;S<w;++S){const w=parseInt(y.substr(2*S,2),16);if(numberIsNaN(w))return S;c[v+S]=w}return S}function utf8Write(c,y,v,w){return blitBuffer(utf8ToBytes(y,c.length-v),c,v,w)}function asciiWrite(c,y,v,w){return blitBuffer(function asciiToBytes(c){const y=[];for(let v=0;v<c.length;++v)y.push(255&c.charCodeAt(v));return y}(y),c,v,w)}function base64Write(c,y,v,w){return blitBuffer(base64ToBytes(y),c,v,w)}function ucs2Write(c,y,v,w){return blitBuffer(function utf16leToBytes(c,y){let v,w,C;const b=[];for(let S=0;S<c.length&&!((y-=2)<0);++S)v=c.charCodeAt(S),w=v>>8,C=v%256,b.push(C),b.push(w);return b}(y,c.length-v),c,v,w)}function base64Slice(c,y,v){return 0===y&&v===c.length?w.fromByteArray(c):w.fromByteArray(c.slice(y,v))}function utf8Slice(c,y,v){v=Math.min(c.length,v);const w=[];let C=y;for(;C<v;){const y=c[C];let b=null,S=y>239?4:y>223?3:y>191?2:1;if(C+S<=v){let v,w,T,I;switch(S){case 1:y<128&&(b=y);break;case 2:v=c[C+1],128==(192&v)&&(I=(31&y)<<6|63&v,I>127&&(b=I));break;case 3:v=c[C+1],w=c[C+2],128==(192&v)&&128==(192&w)&&(I=(15&y)<<12|(63&v)<<6|63&w,I>2047&&(I<55296||I>57343)&&(b=I));break;case 4:v=c[C+1],w=c[C+2],T=c[C+3],128==(192&v)&&128==(192&w)&&128==(192&T)&&(I=(15&y)<<18|(63&v)<<12|(63&w)<<6|63&T,I>65535&&I<1114112&&(b=I))}}null===b?(b=65533,S=1):b>65535&&(b-=65536,w.push(b>>>10&1023|55296),b=56320|1023&b),w.push(b),C+=S}return function decodeCodePointsArray(c){const y=c.length;if(y<=T)return String.fromCharCode.apply(String,c);let v="",w=0;for(;w<y;)v+=String.fromCharCode.apply(String,c.slice(w,w+=T));return v}(w)}Buffer.TYPED_ARRAY_SUPPORT=function typedArraySupport(){try{const c=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(c,y),42===c.foo()}catch(c){return!1}}(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(c,y,v){return from(c,y,v)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(c,y,v){return function alloc(c,y,v){return assertSize(c),c<=0?createBuffer(c):void 0!==y?"string"==typeof v?createBuffer(c).fill(y,v):createBuffer(c).fill(y):createBuffer(c)}(c,y,v)},Buffer.allocUnsafe=function(c){return allocUnsafe(c)},Buffer.allocUnsafeSlow=function(c){return allocUnsafe(c)},Buffer.isBuffer=function isBuffer(c){return null!=c&&!0===c._isBuffer&&c!==Buffer.prototype},Buffer.compare=function compare(c,y){if(isInstance(c,Uint8Array)&&(c=Buffer.from(c,c.offset,c.byteLength)),isInstance(y,Uint8Array)&&(y=Buffer.from(y,y.offset,y.byteLength)),!Buffer.isBuffer(c)||!Buffer.isBuffer(y))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===y)return 0;let v=c.length,w=y.length;for(let C=0,b=Math.min(v,w);C<b;++C)if(c[C]!==y[C]){v=c[C],w=y[C];break}return v<w?-1:w<v?1:0},Buffer.isEncoding=function isEncoding(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function concat(c,y){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(0===c.length)return Buffer.alloc(0);let v;if(void 0===y)for(y=0,v=0;v<c.length;++v)y+=c[v].length;const w=Buffer.allocUnsafe(y);let C=0;for(v=0;v<c.length;++v){let y=c[v];if(isInstance(y,Uint8Array))C+y.length>w.length?(Buffer.isBuffer(y)||(y=Buffer.from(y)),y.copy(w,C)):Uint8Array.prototype.set.call(w,y,C);else{if(!Buffer.isBuffer(y))throw new TypeError('"list" argument must be an Array of Buffers');y.copy(w,C)}C+=y.length}return w},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function swap16(){const c=this.length;if(c%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let y=0;y<c;y+=2)swap(this,y,y+1);return this},Buffer.prototype.swap32=function swap32(){const c=this.length;if(c%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let y=0;y<c;y+=4)swap(this,y,y+3),swap(this,y+1,y+2);return this},Buffer.prototype.swap64=function swap64(){const c=this.length;if(c%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let y=0;y<c;y+=8)swap(this,y,y+7),swap(this,y+1,y+6),swap(this,y+2,y+5),swap(this,y+3,y+4);return this},Buffer.prototype.toString=function toString(){const c=this.length;return 0===c?"":0===arguments.length?utf8Slice(this,0,c):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function equals(c){if(!Buffer.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c||0===Buffer.compare(this,c)},Buffer.prototype.inspect=function inspect(){let c="";const v=y.h2;return c=this.toString("hex",0,v).replace(/(.{2})/g,"$1 ").trim(),this.length>v&&(c+=" ... "),"<Buffer "+c+">"},b&&(Buffer.prototype[b]=Buffer.prototype.inspect),Buffer.prototype.compare=function compare(c,y,v,w,C){if(isInstance(c,Uint8Array)&&(c=Buffer.from(c,c.offset,c.byteLength)),!Buffer.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(void 0===y&&(y=0),void 0===v&&(v=c?c.length:0),void 0===w&&(w=0),void 0===C&&(C=this.length),y<0||v>c.length||w<0||C>this.length)throw new RangeError("out of range index");if(w>=C&&y>=v)return 0;if(w>=C)return-1;if(y>=v)return 1;if(this===c)return 0;let b=(C>>>=0)-(w>>>=0),S=(v>>>=0)-(y>>>=0);const T=Math.min(b,S),I=this.slice(w,C),P=c.slice(y,v);for(let c=0;c<T;++c)if(I[c]!==P[c]){b=I[c],S=P[c];break}return b<S?-1:S<b?1:0},Buffer.prototype.includes=function includes(c,y,v){return-1!==this.indexOf(c,y,v)},Buffer.prototype.indexOf=function indexOf(c,y,v){return bidirectionalIndexOf(this,c,y,v,!0)},Buffer.prototype.lastIndexOf=function lastIndexOf(c,y,v){return bidirectionalIndexOf(this,c,y,v,!1)},Buffer.prototype.write=function write(c,y,v,w){if(void 0===y)w="utf8",v=this.length,y=0;else if(void 0===v&&"string"==typeof y)w=y,v=this.length,y=0;else{if(!isFinite(y))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");y>>>=0,isFinite(v)?(v>>>=0,void 0===w&&(w="utf8")):(w=v,v=void 0)}const C=this.length-y;if((void 0===v||v>C)&&(v=C),c.length>0&&(v<0||y<0)||y>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");let b=!1;for(;;)switch(w){case"hex":return hexWrite(this,c,y,v);case"utf8":case"utf-8":return utf8Write(this,c,y,v);case"ascii":case"latin1":case"binary":return asciiWrite(this,c,y,v);case"base64":return base64Write(this,c,y,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,c,y,v);default:if(b)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),b=!0}},Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function asciiSlice(c,y,v){let w="";v=Math.min(c.length,v);for(let C=y;C<v;++C)w+=String.fromCharCode(127&c[C]);return w}function latin1Slice(c,y,v){let w="";v=Math.min(c.length,v);for(let C=y;C<v;++C)w+=String.fromCharCode(c[C]);return w}function hexSlice(c,y,v){const w=c.length;(!y||y<0)&&(y=0),(!v||v<0||v>w)&&(v=w);let C="";for(let w=y;w<v;++w)C+=K[c[w]];return C}function utf16leSlice(c,y,v){const w=c.slice(y,v);let C="";for(let c=0;c<w.length-1;c+=2)C+=String.fromCharCode(w[c]+256*w[c+1]);return C}function checkOffset(c,y,v){if(c%1!=0||c<0)throw new RangeError("offset is not uint");if(c+y>v)throw new RangeError("Trying to access beyond buffer length")}function checkInt(c,y,v,w,C,b){if(!Buffer.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>C||y<b)throw new RangeError('"value" argument is out of bounds');if(v+w>c.length)throw new RangeError("Index out of range")}function wrtBigUInt64LE(c,y,v,w,C){checkIntBI(y,w,C,c,v,7);let b=Number(y&BigInt(4294967295));c[v++]=b,b>>=8,c[v++]=b,b>>=8,c[v++]=b,b>>=8,c[v++]=b;let S=Number(y>>BigInt(32)&BigInt(4294967295));return c[v++]=S,S>>=8,c[v++]=S,S>>=8,c[v++]=S,S>>=8,c[v++]=S,v}function wrtBigUInt64BE(c,y,v,w,C){checkIntBI(y,w,C,c,v,7);let b=Number(y&BigInt(4294967295));c[v+7]=b,b>>=8,c[v+6]=b,b>>=8,c[v+5]=b,b>>=8,c[v+4]=b;let S=Number(y>>BigInt(32)&BigInt(4294967295));return c[v+3]=S,S>>=8,c[v+2]=S,S>>=8,c[v+1]=S,S>>=8,c[v]=S,v+8}function checkIEEE754(c,y,v,w,C,b){if(v+w>c.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function writeFloat(c,y,v,w,b){return y=+y,v>>>=0,b||checkIEEE754(c,0,v,4),C.write(c,y,v,w,23,4),v+4}function writeDouble(c,y,v,w,b){return y=+y,v>>>=0,b||checkIEEE754(c,0,v,8),C.write(c,y,v,w,52,8),v+8}Buffer.prototype.slice=function slice(c,y){const v=this.length;(c=~~c)<0?(c+=v)<0&&(c=0):c>v&&(c=v),(y=void 0===y?v:~~y)<0?(y+=v)<0&&(y=0):y>v&&(y=v),y<c&&(y=c);const w=this.subarray(c,y);return Object.setPrototypeOf(w,Buffer.prototype),w},Buffer.prototype.readUintLE=Buffer.prototype.readUIntLE=function readUIntLE(c,y,v){c>>>=0,y>>>=0,v||checkOffset(c,y,this.length);let w=this[c],C=1,b=0;for(;++b<y&&(C*=256);)w+=this[c+b]*C;return w},Buffer.prototype.readUintBE=Buffer.prototype.readUIntBE=function readUIntBE(c,y,v){c>>>=0,y>>>=0,v||checkOffset(c,y,this.length);let w=this[c+--y],C=1;for(;y>0&&(C*=256);)w+=this[c+--y]*C;return w},Buffer.prototype.readUint8=Buffer.prototype.readUInt8=function readUInt8(c,y){return c>>>=0,y||checkOffset(c,1,this.length),this[c]},Buffer.prototype.readUint16LE=Buffer.prototype.readUInt16LE=function readUInt16LE(c,y){return c>>>=0,y||checkOffset(c,2,this.length),this[c]|this[c+1]<<8},Buffer.prototype.readUint16BE=Buffer.prototype.readUInt16BE=function readUInt16BE(c,y){return c>>>=0,y||checkOffset(c,2,this.length),this[c]<<8|this[c+1]},Buffer.prototype.readUint32LE=Buffer.prototype.readUInt32LE=function readUInt32LE(c,y){return c>>>=0,y||checkOffset(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]},Buffer.prototype.readUint32BE=Buffer.prototype.readUInt32BE=function readUInt32BE(c,y){return c>>>=0,y||checkOffset(c,4,this.length),16777216*this[c]+(this[c+1]<<16|this[c+2]<<8|this[c+3])},Buffer.prototype.readBigUInt64LE=defineBigIntMethod((function readBigUInt64LE(c){validateNumber(c>>>=0,"offset");const y=this[c],v=this[c+7];void 0!==y&&void 0!==v||boundsError(c,this.length-8);const w=y+256*this[++c]+65536*this[++c]+this[++c]*2**24,C=this[++c]+256*this[++c]+65536*this[++c]+v*2**24;return BigInt(w)+(BigInt(C)<<BigInt(32))})),Buffer.prototype.readBigUInt64BE=defineBigIntMethod((function readBigUInt64BE(c){validateNumber(c>>>=0,"offset");const y=this[c],v=this[c+7];void 0!==y&&void 0!==v||boundsError(c,this.length-8);const w=y*2**24+65536*this[++c]+256*this[++c]+this[++c],C=this[++c]*2**24+65536*this[++c]+256*this[++c]+v;return(BigInt(w)<<BigInt(32))+BigInt(C)})),Buffer.prototype.readIntLE=function readIntLE(c,y,v){c>>>=0,y>>>=0,v||checkOffset(c,y,this.length);let w=this[c],C=1,b=0;for(;++b<y&&(C*=256);)w+=this[c+b]*C;return C*=128,w>=C&&(w-=Math.pow(2,8*y)),w},Buffer.prototype.readIntBE=function readIntBE(c,y,v){c>>>=0,y>>>=0,v||checkOffset(c,y,this.length);let w=y,C=1,b=this[c+--w];for(;w>0&&(C*=256);)b+=this[c+--w]*C;return C*=128,b>=C&&(b-=Math.pow(2,8*y)),b},Buffer.prototype.readInt8=function readInt8(c,y){return c>>>=0,y||checkOffset(c,1,this.length),128&this[c]?-1*(255-this[c]+1):this[c]},Buffer.prototype.readInt16LE=function readInt16LE(c,y){c>>>=0,y||checkOffset(c,2,this.length);const v=this[c]|this[c+1]<<8;return 32768&v?4294901760|v:v},Buffer.prototype.readInt16BE=function readInt16BE(c,y){c>>>=0,y||checkOffset(c,2,this.length);const v=this[c+1]|this[c]<<8;return 32768&v?4294901760|v:v},Buffer.prototype.readInt32LE=function readInt32LE(c,y){return c>>>=0,y||checkOffset(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},Buffer.prototype.readInt32BE=function readInt32BE(c,y){return c>>>=0,y||checkOffset(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},Buffer.prototype.readBigInt64LE=defineBigIntMethod((function readBigInt64LE(c){validateNumber(c>>>=0,"offset");const y=this[c],v=this[c+7];void 0!==y&&void 0!==v||boundsError(c,this.length-8);const w=this[c+4]+256*this[c+5]+65536*this[c+6]+(v<<24);return(BigInt(w)<<BigInt(32))+BigInt(y+256*this[++c]+65536*this[++c]+this[++c]*2**24)})),Buffer.prototype.readBigInt64BE=defineBigIntMethod((function readBigInt64BE(c){validateNumber(c>>>=0,"offset");const y=this[c],v=this[c+7];void 0!==y&&void 0!==v||boundsError(c,this.length-8);const w=(y<<24)+65536*this[++c]+256*this[++c]+this[++c];return(BigInt(w)<<BigInt(32))+BigInt(this[++c]*2**24+65536*this[++c]+256*this[++c]+v)})),Buffer.prototype.readFloatLE=function readFloatLE(c,y){return c>>>=0,y||checkOffset(c,4,this.length),C.read(this,c,!0,23,4)},Buffer.prototype.readFloatBE=function readFloatBE(c,y){return c>>>=0,y||checkOffset(c,4,this.length),C.read(this,c,!1,23,4)},Buffer.prototype.readDoubleLE=function readDoubleLE(c,y){return c>>>=0,y||checkOffset(c,8,this.length),C.read(this,c,!0,52,8)},Buffer.prototype.readDoubleBE=function readDoubleBE(c,y){return c>>>=0,y||checkOffset(c,8,this.length),C.read(this,c,!1,52,8)},Buffer.prototype.writeUintLE=Buffer.prototype.writeUIntLE=function writeUIntLE(c,y,v,w){if(c=+c,y>>>=0,v>>>=0,!w){checkInt(this,c,y,v,Math.pow(2,8*v)-1,0)}let C=1,b=0;for(this[y]=255&c;++b<v&&(C*=256);)this[y+b]=c/C&255;return y+v},Buffer.prototype.writeUintBE=Buffer.prototype.writeUIntBE=function writeUIntBE(c,y,v,w){if(c=+c,y>>>=0,v>>>=0,!w){checkInt(this,c,y,v,Math.pow(2,8*v)-1,0)}let C=v-1,b=1;for(this[y+C]=255&c;--C>=0&&(b*=256);)this[y+C]=c/b&255;return y+v},Buffer.prototype.writeUint8=Buffer.prototype.writeUInt8=function writeUInt8(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,1,255,0),this[y]=255&c,y+1},Buffer.prototype.writeUint16LE=Buffer.prototype.writeUInt16LE=function writeUInt16LE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,2,65535,0),this[y]=255&c,this[y+1]=c>>>8,y+2},Buffer.prototype.writeUint16BE=Buffer.prototype.writeUInt16BE=function writeUInt16BE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,2,65535,0),this[y]=c>>>8,this[y+1]=255&c,y+2},Buffer.prototype.writeUint32LE=Buffer.prototype.writeUInt32LE=function writeUInt32LE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,4,4294967295,0),this[y+3]=c>>>24,this[y+2]=c>>>16,this[y+1]=c>>>8,this[y]=255&c,y+4},Buffer.prototype.writeUint32BE=Buffer.prototype.writeUInt32BE=function writeUInt32BE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,4,4294967295,0),this[y]=c>>>24,this[y+1]=c>>>16,this[y+2]=c>>>8,this[y+3]=255&c,y+4},Buffer.prototype.writeBigUInt64LE=defineBigIntMethod((function writeBigUInt64LE(c,y=0){return wrtBigUInt64LE(this,c,y,BigInt(0),BigInt("0xffffffffffffffff"))})),Buffer.prototype.writeBigUInt64BE=defineBigIntMethod((function writeBigUInt64BE(c,y=0){return wrtBigUInt64BE(this,c,y,BigInt(0),BigInt("0xffffffffffffffff"))})),Buffer.prototype.writeIntLE=function writeIntLE(c,y,v,w){if(c=+c,y>>>=0,!w){const w=Math.pow(2,8*v-1);checkInt(this,c,y,v,w-1,-w)}let C=0,b=1,S=0;for(this[y]=255&c;++C<v&&(b*=256);)c<0&&0===S&&0!==this[y+C-1]&&(S=1),this[y+C]=(c/b>>0)-S&255;return y+v},Buffer.prototype.writeIntBE=function writeIntBE(c,y,v,w){if(c=+c,y>>>=0,!w){const w=Math.pow(2,8*v-1);checkInt(this,c,y,v,w-1,-w)}let C=v-1,b=1,S=0;for(this[y+C]=255&c;--C>=0&&(b*=256);)c<0&&0===S&&0!==this[y+C+1]&&(S=1),this[y+C]=(c/b>>0)-S&255;return y+v},Buffer.prototype.writeInt8=function writeInt8(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,1,127,-128),c<0&&(c=255+c+1),this[y]=255&c,y+1},Buffer.prototype.writeInt16LE=function writeInt16LE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,2,32767,-32768),this[y]=255&c,this[y+1]=c>>>8,y+2},Buffer.prototype.writeInt16BE=function writeInt16BE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,2,32767,-32768),this[y]=c>>>8,this[y+1]=255&c,y+2},Buffer.prototype.writeInt32LE=function writeInt32LE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,4,2147483647,-2147483648),this[y]=255&c,this[y+1]=c>>>8,this[y+2]=c>>>16,this[y+3]=c>>>24,y+4},Buffer.prototype.writeInt32BE=function writeInt32BE(c,y,v){return c=+c,y>>>=0,v||checkInt(this,c,y,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[y]=c>>>24,this[y+1]=c>>>16,this[y+2]=c>>>8,this[y+3]=255&c,y+4},Buffer.prototype.writeBigInt64LE=defineBigIntMethod((function writeBigInt64LE(c,y=0){return wrtBigUInt64LE(this,c,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),Buffer.prototype.writeBigInt64BE=defineBigIntMethod((function writeBigInt64BE(c,y=0){return wrtBigUInt64BE(this,c,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),Buffer.prototype.writeFloatLE=function writeFloatLE(c,y,v){return writeFloat(this,c,y,!0,v)},Buffer.prototype.writeFloatBE=function writeFloatBE(c,y,v){return writeFloat(this,c,y,!1,v)},Buffer.prototype.writeDoubleLE=function writeDoubleLE(c,y,v){return writeDouble(this,c,y,!0,v)},Buffer.prototype.writeDoubleBE=function writeDoubleBE(c,y,v){return writeDouble(this,c,y,!1,v)},Buffer.prototype.copy=function copy(c,y,v,w){if(!Buffer.isBuffer(c))throw new TypeError("argument should be a Buffer");if(v||(v=0),w||0===w||(w=this.length),y>=c.length&&(y=c.length),y||(y=0),w>0&&w<v&&(w=v),w===v)return 0;if(0===c.length||0===this.length)return 0;if(y<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),c.length-y<w-v&&(w=c.length-y+v);const C=w-v;return this===c&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(y,v,w):Uint8Array.prototype.set.call(c,this.subarray(v,w),y),C},Buffer.prototype.fill=function fill(c,y,v,w){if("string"==typeof c){if("string"==typeof y?(w=y,y=0,v=this.length):"string"==typeof v&&(w=v,v=this.length),void 0!==w&&"string"!=typeof w)throw new TypeError("encoding must be a string");if("string"==typeof w&&!Buffer.isEncoding(w))throw new TypeError("Unknown encoding: "+w);if(1===c.length){const y=c.charCodeAt(0);("utf8"===w&&y<128||"latin1"===w)&&(c=y)}}else"number"==typeof c?c&=255:"boolean"==typeof c&&(c=Number(c));if(y<0||this.length<y||this.length<v)throw new RangeError("Out of range index");if(v<=y)return this;let C;if(y>>>=0,v=void 0===v?this.length:v>>>0,c||(c=0),"number"==typeof c)for(C=y;C<v;++C)this[C]=c;else{const b=Buffer.isBuffer(c)?c:Buffer.from(c,w),S=b.length;if(0===S)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(C=0;C<v-y;++C)this[C+y]=b[C%S]}return this};const I={};function E(c,y,v){I[c]=class NodeError extends v{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${c}]`,this.stack,delete this.name}get code(){return c}set code(c){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:c,writable:!0})}toString(){return`${this.name} [${c}]: ${this.message}`}}}function addNumericalSeparator(c){let y="",v=c.length;const w="-"===c[0]?1:0;for(;v>=w+4;v-=3)y=`_${c.slice(v-3,v)}${y}`;return`${c.slice(0,v)}${y}`}function checkIntBI(c,y,v,w,C,b){if(c>v||c<y){const w="bigint"==typeof y?"n":"";let C;throw C=b>3?0===y||y===BigInt(0)?`>= 0${w} and < 2${w} ** ${8*(b+1)}${w}`:`>= -(2${w} ** ${8*(b+1)-1}${w}) and < 2 ** ${8*(b+1)-1}${w}`:`>= ${y}${w} and <= ${v}${w}`,new I.ERR_OUT_OF_RANGE("value",C,c)}!function checkBounds(c,y,v){validateNumber(y,"offset"),void 0!==c[y]&&void 0!==c[y+v]||boundsError(y,c.length-(v+1))}(w,C,b)}function validateNumber(c,y){if("number"!=typeof c)throw new I.ERR_INVALID_ARG_TYPE(y,"number",c)}function boundsError(c,y,v){if(Math.floor(c)!==c)throw validateNumber(c,v),new I.ERR_OUT_OF_RANGE(v||"offset","an integer",c);if(y<0)throw new I.ERR_BUFFER_OUT_OF_BOUNDS;throw new I.ERR_OUT_OF_RANGE(v||"offset",`>= ${v?1:0} and <= ${y}`,c)}E("ERR_BUFFER_OUT_OF_BOUNDS",(function(c){return c?`${c} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),E("ERR_INVALID_ARG_TYPE",(function(c,y){return`The "${c}" argument must be of type number. Received type ${typeof y}`}),TypeError),E("ERR_OUT_OF_RANGE",(function(c,y,v){let w=`The value of "${c}" is out of range.`,C=v;return Number.isInteger(v)&&Math.abs(v)>2**32?C=addNumericalSeparator(String(v)):"bigint"==typeof v&&(C=String(v),(v>BigInt(2)**BigInt(32)||v<-(BigInt(2)**BigInt(32)))&&(C=addNumericalSeparator(C)),C+="n"),w+=` It must be ${y}. Received ${C}`,w}),RangeError);const P=/[^+/0-9A-Za-z-_]/g;function utf8ToBytes(c,y){let v;y=y||1/0;const w=c.length;let C=null;const b=[];for(let S=0;S<w;++S){if(v=c.charCodeAt(S),v>55295&&v<57344){if(!C){if(v>56319){(y-=3)>-1&&b.push(239,191,189);continue}if(S+1===w){(y-=3)>-1&&b.push(239,191,189);continue}C=v;continue}if(v<56320){(y-=3)>-1&&b.push(239,191,189),C=v;continue}v=65536+(C-55296<<10|v-56320)}else C&&(y-=3)>-1&&b.push(239,191,189);if(C=null,v<128){if((y-=1)<0)break;b.push(v)}else if(v<2048){if((y-=2)<0)break;b.push(v>>6|192,63&v|128)}else if(v<65536){if((y-=3)<0)break;b.push(v>>12|224,v>>6&63|128,63&v|128)}else{if(!(v<1114112))throw new Error("Invalid code point");if((y-=4)<0)break;b.push(v>>18|240,v>>12&63|128,v>>6&63|128,63&v|128)}}return b}function base64ToBytes(c){return w.toByteArray(function base64clean(c){if((c=(c=c.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;c.length%4!=0;)c+="=";return c}(c))}function blitBuffer(c,y,v,w){let C;for(C=0;C<w&&!(C+v>=y.length||C>=c.length);++C)y[C+v]=c[C];return C}function isInstance(c,y){return c instanceof y||null!=c&&null!=c.constructor&&null!=c.constructor.name&&c.constructor.name===y.name}function numberIsNaN(c){return c!=c}const K=function(){const c="0123456789abcdef",y=new Array(256);for(let v=0;v<16;++v){const w=16*v;for(let C=0;C<16;++C)y[w+C]=c[v]+c[C]}return y}();function defineBigIntMethod(c){return"undefined"==typeof BigInt?BufferBigIntNotDefined:c}function BufferBigIntNotDefined(){throw new Error("BigInt not supported")}},729:c=>{"use strict";var y=Object.prototype.hasOwnProperty,v="~";function Events(){}function EE(c,y,v){this.fn=c,this.context=y,this.once=v||!1}function addListener(c,y,w,C,b){if("function"!=typeof w)throw new TypeError("The listener must be a function");var S=new EE(w,C||c,b),T=v?v+y:y;return c._events[T]?c._events[T].fn?c._events[T]=[c._events[T],S]:c._events[T].push(S):(c._events[T]=S,c._eventsCount++),c}function clearEvent(c,y){0==--c._eventsCount?c._events=new Events:delete c._events[y]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(v=!1)),EventEmitter.prototype.eventNames=function eventNames(){var c,w,C=[];if(0===this._eventsCount)return C;for(w in c=this._events)y.call(c,w)&&C.push(v?w.slice(1):w);return Object.getOwnPropertySymbols?C.concat(Object.getOwnPropertySymbols(c)):C},EventEmitter.prototype.listeners=function listeners(c){var y=v?v+c:c,w=this._events[y];if(!w)return[];if(w.fn)return[w.fn];for(var C=0,b=w.length,S=new Array(b);C<b;C++)S[C]=w[C].fn;return S},EventEmitter.prototype.listenerCount=function listenerCount(c){var y=v?v+c:c,w=this._events[y];return w?w.fn?1:w.length:0},EventEmitter.prototype.emit=function emit(c,y,w,C,b,S){var T=v?v+c:c;if(!this._events[T])return!1;var I,P,K=this._events[T],Q=arguments.length;if(K.fn){switch(K.once&&this.removeListener(c,K.fn,void 0,!0),Q){case 1:return K.fn.call(K.context),!0;case 2:return K.fn.call(K.context,y),!0;case 3:return K.fn.call(K.context,y,w),!0;case 4:return K.fn.call(K.context,y,w,C),!0;case 5:return K.fn.call(K.context,y,w,C,b),!0;case 6:return K.fn.call(K.context,y,w,C,b,S),!0}for(P=1,I=new Array(Q-1);P<Q;P++)I[P-1]=arguments[P];K.fn.apply(K.context,I)}else{var X,te=K.length;for(P=0;P<te;P++)switch(K[P].once&&this.removeListener(c,K[P].fn,void 0,!0),Q){case 1:K[P].fn.call(K[P].context);break;case 2:K[P].fn.call(K[P].context,y);break;case 3:K[P].fn.call(K[P].context,y,w);break;case 4:K[P].fn.call(K[P].context,y,w,C);break;default:if(!I)for(X=1,I=new Array(Q-1);X<Q;X++)I[X-1]=arguments[X];K[P].fn.apply(K[P].context,I)}}return!0},EventEmitter.prototype.on=function on(c,y,v){return addListener(this,c,y,v,!1)},EventEmitter.prototype.once=function once(c,y,v){return addListener(this,c,y,v,!0)},EventEmitter.prototype.removeListener=function removeListener(c,y,w,C){var b=v?v+c:c;if(!this._events[b])return this;if(!y)return clearEvent(this,b),this;var S=this._events[b];if(S.fn)S.fn!==y||C&&!S.once||w&&S.context!==w||clearEvent(this,b);else{for(var T=0,I=[],P=S.length;T<P;T++)(S[T].fn!==y||C&&!S[T].once||w&&S[T].context!==w)&&I.push(S[T]);I.length?this._events[b]=1===I.length?I[0]:I:clearEvent(this,b)}return this},EventEmitter.prototype.removeAllListeners=function removeAllListeners(c){var y;return c?(y=v?v+c:c,this._events[y]&&clearEvent(this,y)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=v,EventEmitter.EventEmitter=EventEmitter,c.exports=EventEmitter},645:(c,y)=>{
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
y.read=function(c,y,v,w,C){var b,S,T=8*C-w-1,I=(1<<T)-1,P=I>>1,K=-7,Q=v?C-1:0,X=v?-1:1,te=c[y+Q];for(Q+=X,b=te&(1<<-K)-1,te>>=-K,K+=T;K>0;b=256*b+c[y+Q],Q+=X,K-=8);for(S=b&(1<<-K)-1,b>>=-K,K+=w;K>0;S=256*S+c[y+Q],Q+=X,K-=8);if(0===b)b=1-P;else{if(b===I)return S?NaN:1/0*(te?-1:1);S+=Math.pow(2,w),b-=P}return(te?-1:1)*S*Math.pow(2,b-w)},y.write=function(c,y,v,w,C,b){var S,T,I,P=8*b-C-1,K=(1<<P)-1,Q=K>>1,X=23===C?Math.pow(2,-24)-Math.pow(2,-77):0,te=w?0:b-1,re=w?1:-1,ne=y<0||0===y&&1/y<0?1:0;for(y=Math.abs(y),isNaN(y)||y===1/0?(T=isNaN(y)?1:0,S=K):(S=Math.floor(Math.log(y)/Math.LN2),y*(I=Math.pow(2,-S))<1&&(S--,I*=2),(y+=S+Q>=1?X/I:X*Math.pow(2,1-Q))*I>=2&&(S++,I/=2),S+Q>=K?(T=0,S=K):S+Q>=1?(T=(y*I-1)*Math.pow(2,C),S+=Q):(T=y*Math.pow(2,Q-1)*Math.pow(2,C),S=0));C>=8;c[v+te]=255&T,te+=re,T/=256,C-=8);for(S=S<<C|T,P+=C;P>0;c[v+te]=255&S,te+=re,S/=256,P-=8);c[v+te-re]|=128*ne}},12:y=>{"use strict";y.exports=c}},v={};function __webpack_require__(c){var w=v[c];if(void 0!==w)return w.exports;var C=v[c]={exports:{}};return y[c](C,C.exports,__webpack_require__),C.exports}__webpack_require__.n=c=>{var y=c&&c.__esModule?()=>c.default:()=>c;return __webpack_require__.d(y,{a:y}),y},__webpack_require__.d=(c,y)=>{for(var v in y)__webpack_require__.o(y,v)&&!__webpack_require__.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:y[v]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(c){if("object"==typeof window)return window}}(),__webpack_require__.o=(c,y)=>Object.prototype.hasOwnProperty.call(c,y),__webpack_require__.r=c=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var w={};return(()=>{"use strict";__webpack_require__.r(w),__webpack_require__.d(w,{CHANGE_SETTINGS_URL:()=>c,MICROSOFT_STATIC_SERVICE:()=>es,MicrosoftLoginService:()=>MicrosoftLoginService,MsTeamsAPI:()=>MsTeamsAPI,MsTeamsAPIFactory:()=>MsTeamsAPIFactory,PROCESS_DEEPLINK:()=>y,PROPERTIES_SERVICE:()=>ts});const c="ms-teams-change-settings-url",y="ms-teams-deep-link";var v=__webpack_require__(12),C=__webpack_require__(91),b=__webpack_require__(303);let S=new(__webpack_require__(729));function sendEvent(c,y){S.emit(c,y)}function getMSEvents(){return S}function msTeamsUtils(){return(0,v.getServiceSync)(C.MICROSOFT_STATIC_SERVICE).msTeams()}async function getContext(c){try{try{await b.app.initialize()}catch(y){return c(null),void console.warn("microsoftTeams.initialize failed (probably not in teams so we skip it)",y)}c(await b.app.getContext())}catch(c){console.error(c)}}var T=__webpack_require__(764);T.lW.from("anything","base64");class MicrosoftGraphService{constructor(){!function _defineProperty(c,y,v){return y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v,c}(this,"client",void 0)}init(c){this.client=c}isInitialized(){return this.client}async getUserDetails(){return await this.client.api("/me").get()}async getUserDetailsBetaV(){return await this.client.api("/me/profile").version("beta").get()}async getUserOrganization(){try{return(await this.client.api("/organization").get()).value[0].displayName}catch(c){return null}}blobToBase64(c){return new Promise(((y,v)=>{const w=new FileReader;w.onloadend=()=>y(w.result),w.readAsDataURL(c)}))}async getUserPhotoAsBase64(){try{let c=await this.client.api("https://graph.microsoft.com/v1.0/me/photo/$value").get();return await this.blobToBase64(c)}catch(c){console.log("profile photo not found")}return null}}
/*! @azure/msal-browser v2.28.1 2022-08-01 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var extendStatics=function(c,y){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,y){c.__proto__=y}||function(c,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(c[v]=y[v])},extendStatics(c,y)};function __extends(c,y){function __(){this.constructor=c}extendStatics(c,y),c.prototype=null===y?Object.create(y):(__.prototype=y.prototype,new __)}var I,P,__assign=function(){return __assign=Object.assign||function __assign(c){for(var y,v=1,w=arguments.length;v<w;v++)for(var C in y=arguments[v])Object.prototype.hasOwnProperty.call(y,C)&&(c[C]=y[C]);return c},__assign.apply(this,arguments)};function __awaiter(c,y,v,w){return new(v||(v=Promise))((function(C,b){function fulfilled(c){try{step(w.next(c))}catch(c){b(c)}}function rejected(c){try{step(w.throw(c))}catch(c){b(c)}}function step(c){c.done?C(c.value):function adopt(c){return c instanceof v?c:new v((function(y){y(c)}))}(c.value).then(fulfilled,rejected)}step((w=w.apply(c,y||[])).next())}))}function __generator(c,y){var v,w,C,b,S={label:0,sent:function(){if(1&C[0])throw C[1];return C[1]},trys:[],ops:[]};return b={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function verb(b){return function(T){return function step(b){if(v)throw new TypeError("Generator is already executing.");for(;S;)try{if(v=1,w&&(C=2&b[0]?w.return:b[0]?w.throw||((C=w.return)&&C.call(w),0):w.next)&&!(C=C.call(w,b[1])).done)return C;switch(w=0,C&&(b=[2&b[0],C.value]),b[0]){case 0:case 1:C=b;break;case 4:return S.label++,{value:b[1],done:!1};case 5:S.label++,w=b[1],b=[0];continue;case 7:b=S.ops.pop(),S.trys.pop();continue;default:if(!(C=S.trys,(C=C.length>0&&C[C.length-1])||6!==b[0]&&2!==b[0])){S=0;continue}if(3===b[0]&&(!C||b[1]>C[0]&&b[1]<C[3])){S.label=b[1];break}if(6===b[0]&&S.label<C[1]){S.label=C[1],C=b;break}if(C&&S.label<C[2]){S.label=C[2],S.ops.push(b);break}C[2]&&S.ops.pop(),S.trys.pop();continue}b=y.call(c,S)}catch(c){b=[6,c],w=0}finally{v=C=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,T])}}}function __read(c,y){var v="function"==typeof Symbol&&c[Symbol.iterator];if(!v)return c;var w,C,b=v.call(c),S=[];try{for(;(void 0===y||y-- >0)&&!(w=b.next()).done;)S.push(w.value)}catch(c){C={error:c}}finally{try{w&&!w.done&&(v=b.return)&&v.call(b)}finally{if(C)throw C.error}}return S}function __spread(){for(var c=[],y=0;y<arguments.length;y++)c=c.concat(__read(arguments[y]));return c}!function(c){c.AcquireTokenByCode="acquireTokenByCode",c.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",c.AcquireTokenSilent="acquireTokenSilent",c.AcquireTokenSilentAsync="acquireTokenSilentAsync",c.AcquireTokenPopup="acquireTokenPopup",c.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",c.CryptoOptsSignJwt="cryptoOptsSignJwt",c.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",c.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",c.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",c.SsoSilent="ssoSilent",c.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",c.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",c.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",c.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",c.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",c.BrokerHandhshake="brokerHandshake",c.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",c.AcquireTokenByBroker="acquireTokenByBroker"}(I||(I={})),function(c){c[c.NotStarted=0]="NotStarted",c[c.InProgress=1]="InProgress",c[c.Completed=2]="Completed"}(P||(P={}));
/*! @azure/msal-common v7.3.0 2022-08-01 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var _tslib_extendStatics=function(c,y){return _tslib_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,y){c.__proto__=y}||function(c,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(c[v]=y[v])},_tslib_extendStatics(c,y)};function _tslib_extends(c,y){function __(){this.constructor=c}_tslib_extendStatics(c,y),c.prototype=null===y?Object.create(y):(__.prototype=y.prototype,new __)}var _tslib_assign=function(){return _tslib_assign=Object.assign||function __assign(c){for(var y,v=1,w=arguments.length;v<w;v++)for(var C in y=arguments[v])Object.prototype.hasOwnProperty.call(y,C)&&(c[C]=y[C]);return c},_tslib_assign.apply(this,arguments)};function _tslib_awaiter(c,y,v,w){return new(v||(v=Promise))((function(C,b){function fulfilled(c){try{step(w.next(c))}catch(c){b(c)}}function rejected(c){try{step(w.throw(c))}catch(c){b(c)}}function step(c){c.done?C(c.value):function adopt(c){return c instanceof v?c:new v((function(y){y(c)}))}(c.value).then(fulfilled,rejected)}step((w=w.apply(c,y||[])).next())}))}function _tslib_generator(c,y){var v,w,C,b,S={label:0,sent:function(){if(1&C[0])throw C[1];return C[1]},trys:[],ops:[]};return b={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function verb(b){return function(T){return function step(b){if(v)throw new TypeError("Generator is already executing.");for(;S;)try{if(v=1,w&&(C=2&b[0]?w.return:b[0]?w.throw||((C=w.return)&&C.call(w),0):w.next)&&!(C=C.call(w,b[1])).done)return C;switch(w=0,C&&(b=[2&b[0],C.value]),b[0]){case 0:case 1:C=b;break;case 4:return S.label++,{value:b[1],done:!1};case 5:S.label++,w=b[1],b=[0];continue;case 7:b=S.ops.pop(),S.trys.pop();continue;default:if(!(C=S.trys,(C=C.length>0&&C[C.length-1])||6!==b[0]&&2!==b[0])){S=0;continue}if(3===b[0]&&(!C||b[1]>C[0]&&b[1]<C[3])){S.label=b[1];break}if(6===b[0]&&S.label<C[1]){S.label=C[1],C=b;break}if(C&&S.label<C[2]){S.label=C[2],S.ops.push(b);break}C[2]&&S.ops.pop(),S.trys.pop();continue}b=y.call(c,S)}catch(c){b=[6,c],w=0}finally{v=C=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,T])}}}function __spreadArrays(){for(var c=0,y=0,v=arguments.length;y<v;y++)c+=arguments[y].length;var w=Array(c),C=0;for(y=0;y<v;y++)for(var b=arguments[y],S=0,T=b.length;S<T;S++,C++)w[C]=b[S];return w}
/*! @azure/msal-common v7.3.0 2022-08-01 */
var K,Q,X,te,re,ne={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240},oe=[ne.OPENID_SCOPE,ne.PROFILE_SCOPE,ne.OFFLINE_ACCESS_SCOPE],ie=__spreadArrays(oe,[ne.EMAIL_SCOPE]);!function(c){c.CONTENT_TYPE="Content-Type",c.RETRY_AFTER="Retry-After",c.CCS_HEADER="X-AnchorMailbox",c.WWWAuthenticate="WWW-Authenticate",c.AuthenticationInfo="Authentication-Info"}(K||(K={})),function(c){c.ID_TOKEN="idtoken",c.CLIENT_INFO="client.info",c.ADAL_ID_TOKEN="adal.idtoken",c.ERROR="error",c.ERROR_DESC="error.description",c.ACTIVE_ACCOUNT="active-account",c.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(Q||(Q={})),function(c){c.COMMON="common",c.ORGANIZATIONS="organizations",c.CONSUMERS="consumers"}(X||(X={})),function(c){c.CLIENT_ID="client_id",c.REDIRECT_URI="redirect_uri",c.RESPONSE_TYPE="response_type",c.RESPONSE_MODE="response_mode",c.GRANT_TYPE="grant_type",c.CLAIMS="claims",c.SCOPE="scope",c.ERROR="error",c.ERROR_DESCRIPTION="error_description",c.ACCESS_TOKEN="access_token",c.ID_TOKEN="id_token",c.REFRESH_TOKEN="refresh_token",c.EXPIRES_IN="expires_in",c.STATE="state",c.NONCE="nonce",c.PROMPT="prompt",c.SESSION_STATE="session_state",c.CLIENT_INFO="client_info",c.CODE="code",c.CODE_CHALLENGE="code_challenge",c.CODE_CHALLENGE_METHOD="code_challenge_method",c.CODE_VERIFIER="code_verifier",c.CLIENT_REQUEST_ID="client-request-id",c.X_CLIENT_SKU="x-client-SKU",c.X_CLIENT_VER="x-client-VER",c.X_CLIENT_OS="x-client-OS",c.X_CLIENT_CPU="x-client-CPU",c.X_CLIENT_CURR_TELEM="x-client-current-telemetry",c.X_CLIENT_LAST_TELEM="x-client-last-telemetry",c.X_MS_LIB_CAPABILITY="x-ms-lib-capability",c.X_APP_NAME="x-app-name",c.X_APP_VER="x-app-ver",c.POST_LOGOUT_URI="post_logout_redirect_uri",c.ID_TOKEN_HINT="id_token_hint",c.DEVICE_CODE="device_code",c.CLIENT_SECRET="client_secret",c.CLIENT_ASSERTION="client_assertion",c.CLIENT_ASSERTION_TYPE="client_assertion_type",c.TOKEN_TYPE="token_type",c.REQ_CNF="req_cnf",c.OBO_ASSERTION="assertion",c.REQUESTED_TOKEN_USE="requested_token_use",c.ON_BEHALF_OF="on_behalf_of",c.FOCI="foci",c.CCS_HEADER="X-AnchorMailbox",c.RETURN_SPA_CODE="return_spa_code",c.NATIVE_BROKER="nativebroker",c.LOGOUT_HINT="logout_hint"}(te||(te={})),function(c){c.ACCESS_TOKEN="access_token",c.XMS_CC="xms_cc"}(re||(re={}));var se,ue={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};!function(c){c.ACCOUNT="account",c.SID="sid",c.LOGIN_HINT="login_hint",c.ID_TOKEN="id_token",c.DOMAIN_HINT="domain_hint",c.ORGANIZATIONS="organizations",c.CONSUMERS="consumers",c.ACCOUNT_ID="accountIdentifier",c.HOMEACCOUNT_ID="homeAccountIdentifier"}(se||(se={}));var de,pe,Ee,Ie,Ue,Ke,Ve,$e={PLAIN:"plain",S256:"S256"};!function(c){c.QUERY="query",c.FRAGMENT="fragment",c.FORM_POST="form_post"}(de||(de={})),function(c){c.IMPLICIT_GRANT="implicit",c.AUTHORIZATION_CODE_GRANT="authorization_code",c.CLIENT_CREDENTIALS_GRANT="client_credentials",c.RESOURCE_OWNER_PASSWORD_GRANT="password",c.REFRESH_TOKEN_GRANT="refresh_token",c.DEVICE_CODE_GRANT="device_code",c.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(pe||(pe={})),function(c){c.MSSTS_ACCOUNT_TYPE="MSSTS",c.ADFS_ACCOUNT_TYPE="ADFS",c.MSAV1_ACCOUNT_TYPE="MSA",c.GENERIC_ACCOUNT_TYPE="Generic"}(Ee||(Ee={})),function(c){c.CACHE_KEY_SEPARATOR="-",c.CLIENT_INFO_SEPARATOR="."}(Ie||(Ie={})),function(c){c.ID_TOKEN="IdToken",c.ACCESS_TOKEN="AccessToken",c.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",c.REFRESH_TOKEN="RefreshToken"}(Ue||(Ue={})),function(c){c.ACCOUNT="Account",c.CREDENTIAL="Credential",c.ID_TOKEN="IdToken",c.ACCESS_TOKEN="AccessToken",c.REFRESH_TOKEN="RefreshToken",c.APP_METADATA="AppMetadata",c.TEMPORARY="TempCache",c.TELEMETRY="Telemetry",c.UNDEFINED="Undefined",c.THROTTLING="Throttling"}(Ke||(Ke={})),function(c){c[c.ADFS=1001]="ADFS",c[c.MSA=1002]="MSA",c[c.MSSTS=1003]="MSSTS",c[c.GENERIC=1004]="GENERIC",c[c.ACCESS_TOKEN=2001]="ACCESS_TOKEN",c[c.REFRESH_TOKEN=2002]="REFRESH_TOKEN",c[c.ID_TOKEN=2003]="ID_TOKEN",c[c.APP_METADATA=3001]="APP_METADATA",c[c.UNDEFINED=9999]="UNDEFINED"}(Ve||(Ve={}));var Je,Qe="appmetadata",Ze="1",Xe="authority-metadata",yt=86400;!function(c){c.CONFIG="config",c.CACHE="cache",c.NETWORK="network",c.HARDCODED_VALUES="hardcoded_values"}(Je||(Je={}));var vt,wt={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(c){c.BEARER="Bearer",c.POP="pop",c.SSH="ssh-cert"}(vt||(vt={}));var Et,_t,bt,St,Tt,At,It=60,Rt=3600,kt="throttling",Ot="retry-after, h429",Nt="invalid_grant",Mt="client_mismatch";!function(c){c.username="username",c.password="password"}(Et||(Et={})),function(c){c[c.httpSuccess=200]="httpSuccess",c[c.httpBadRequest=400]="httpBadRequest"}(_t||(_t={})),function(c){c.FAILED_AUTO_DETECTION="1",c.INTERNAL_CACHE="2",c.ENVIRONMENT_VARIABLE="3",c.IMDS="4"}(bt||(bt={})),function(c){c.CONFIGURED_MATCHES_DETECTED="1",c.CONFIGURED_NO_AUTO_DETECTION="2",c.CONFIGURED_NOT_DETECTED="3",c.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",c.AUTO_DETECTION_REQUESTED_FAILED="5"}(St||(St={})),function(c){c.NO_CACHE_HIT="0",c.FORCE_REFRESH="1",c.NO_CACHED_ACCESS_TOKEN="2",c.CACHED_ACCESS_TOKEN_EXPIRED="3",c.REFRESH_CACHED_ACCESS_TOKEN="4"}(Tt||(Tt={})),function(c){c.Jwt="JWT",c.Jwk="JWK"}(At||(At={}));
/*! @azure/msal-browser v2.28.1 2022-08-01 */
var xt,Ut,Lt,Ft,Ht,Bt,Dt,qt,jt="invalid_grant",Gt=483,zt=600,Wt="msal",Kt=50,Vt="msal.js.browser",$t="53ee284d-920a-4b59-9d30-a60315b26836",Yt="ppnbnpeolgkicgegkbkbjmhlideopiji",Jt="MATS";!function(c){c.HandshakeRequest="Handshake",c.HandshakeResponse="HandshakeResponse",c.GetToken="GetToken",c.Response="Response"}(xt||(xt={})),function(c){c.LocalStorage="localStorage",c.SessionStorage="sessionStorage",c.MemoryStorage="memoryStorage"}(Ut||(Ut={})),function(c){c.GET="GET",c.POST="POST"}(Lt||(Lt={})),function(c){c.AUTHORITY="authority",c.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",c.SESSION_STATE="session.state",c.REQUEST_STATE="request.state",c.NONCE_IDTOKEN="nonce.id_token",c.ORIGIN_URI="request.origin",c.RENEW_STATUS="token.renew.status",c.URL_HASH="urlHash",c.REQUEST_PARAMS="request.params",c.SCOPES="scopes",c.INTERACTION_STATUS_KEY="interaction.status",c.CCS_CREDENTIAL="ccs.credential",c.CORRELATION_ID="request.correlationId",c.NATIVE_REQUEST="request.native"}(Ft||(Ft={})),function(c){c.WRAPPER_SKU="wrapper.sku",c.WRAPPER_VER="wrapper.version"}(Ht||(Ht={})),function(c){c[c.acquireTokenRedirect=861]="acquireTokenRedirect",c[c.acquireTokenPopup=862]="acquireTokenPopup",c[c.ssoSilent=863]="ssoSilent",c[c.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",c[c.handleRedirectPromise=865]="handleRedirectPromise",c[c.acquireTokenByCode=866]="acquireTokenByCode",c[c.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",c[c.logout=961]="logout",c[c.logoutPopup=962]="logoutPopup"}(Bt||(Bt={})),function(c){c.Redirect="redirect",c.Popup="popup",c.Silent="silent",c.None="none"}(Dt||(Dt={})),function(c){c.Startup="startup",c.Login="login",c.Logout="logout",c.AcquireToken="acquireToken",c.SsoSilent="ssoSilent",c.HandleRedirect="handleRedirect",c.None="none"}(qt||(qt={}));var Qt,Zt={scopes:oe},Xt="jwk";!function(c){c.React="@azure/msal-react",c.Angular="@azure/msal-angular"}(Qt||(Qt={}));var er,tr="msal.db",rr={code:"unexpected_error",desc:"Unexpected error in authentication."},nr={code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},or=function(c){function AuthError(y,v,w){var C=this,b=v?y+": "+v:y;return C=c.call(this,b)||this,Object.setPrototypeOf(C,AuthError.prototype),C.errorCode=y||ne.EMPTY_STRING,C.errorMessage=v||ne.EMPTY_STRING,C.subError=w||ne.EMPTY_STRING,C.name="AuthError",C}return _tslib_extends(AuthError,c),AuthError.prototype.setCorrelationId=function(c){this.correlationId=c},AuthError.createUnexpectedError=function(c){return new AuthError(rr.code,rr.desc+": "+c)},AuthError.createPostRequestFailed=function(c){return new AuthError(nr.code,nr.desc+": "+c)},AuthError}(Error),ir={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},ar={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},sr=function(c){function JoseHeaderError(y,v){var w=c.call(this,y,v)||this;return w.name="JoseHeaderError",Object.setPrototypeOf(w,JoseHeaderError.prototype),w}return _tslib_extends(JoseHeaderError,c),JoseHeaderError.createMissingKidError=function(){return new JoseHeaderError(ir.code,ir.desc)},JoseHeaderError.createMissingAlgError=function(){return new JoseHeaderError(ar.code,ar.desc)},JoseHeaderError}(or),cr=function(){function JoseHeader(c){this.typ=c.typ,this.alg=c.alg,this.kid=c.kid}return JoseHeader.getShrHeaderString=function(c){if(!c.kid)throw sr.createMissingKidError();if(!c.alg)throw sr.createMissingAlgError();var y=new JoseHeader({typ:c.typ||At.Jwt,kid:c.kid,alg:c.alg});return JSON.stringify(y)},JoseHeader}(),ur=function(){function MathUtils(){}return MathUtils.decimalToHex=function(c){for(var y=c.toString(16);y.length<2;)y="0"+y;return y},MathUtils}(),lr=function(){function GuidGenerator(c){this.cryptoObj=c}return GuidGenerator.prototype.generateGuid=function(){try{var c=new Uint8Array(16);return this.cryptoObj.getRandomValues(c),c[6]|=64,c[6]&=79,c[8]|=128,c[8]&=191,ur.decimalToHex(c[0])+ur.decimalToHex(c[1])+ur.decimalToHex(c[2])+ur.decimalToHex(c[3])+"-"+ur.decimalToHex(c[4])+ur.decimalToHex(c[5])+"-"+ur.decimalToHex(c[6])+ur.decimalToHex(c[7])+"-"+ur.decimalToHex(c[8])+ur.decimalToHex(c[9])+"-"+ur.decimalToHex(c[10])+ur.decimalToHex(c[11])+ur.decimalToHex(c[12])+ur.decimalToHex(c[13])+ur.decimalToHex(c[14])+ur.decimalToHex(c[15])}catch(c){for(var y="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",v="0123456789abcdef",w=0,C=ne.EMPTY_STRING,b=0;b<36;b++)"-"!==y[b]&&"4"!==y[b]&&(w=16*Math.random()|0),"x"===y[b]?C+=v[w]:"y"===y[b]?(w&=3,C+=v[w|=8]):C+=y[b];return C}},GuidGenerator.prototype.isGuid=function(c){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},GuidGenerator}(),dr=function(){function BrowserStringUtils(){}return BrowserStringUtils.stringToUtf8Arr=function(c){for(var y,v=0,w=c.length,C=0;C<w;C++)v+=(y=c.charCodeAt(C))<128?1:y<2048?2:y<65536?3:y<2097152?4:y<67108864?5:6;for(var b=new Uint8Array(v),S=0,T=0;S<v;T++)(y=c.charCodeAt(T))<128?b[S++]=y:y<2048?(b[S++]=192+(y>>>6),b[S++]=128+(63&y)):y<65536?(b[S++]=224+(y>>>12),b[S++]=128+(y>>>6&63),b[S++]=128+(63&y)):y<2097152?(b[S++]=240+(y>>>18),b[S++]=128+(y>>>12&63),b[S++]=128+(y>>>6&63),b[S++]=128+(63&y)):y<67108864?(b[S++]=248+(y>>>24),b[S++]=128+(y>>>18&63),b[S++]=128+(y>>>12&63),b[S++]=128+(y>>>6&63),b[S++]=128+(63&y)):(b[S++]=252+(y>>>30),b[S++]=128+(y>>>24&63),b[S++]=128+(y>>>18&63),b[S++]=128+(y>>>12&63),b[S++]=128+(y>>>6&63),b[S++]=128+(63&y));return b},BrowserStringUtils.stringToArrayBuffer=function(c){for(var y=new ArrayBuffer(c.length),v=new Uint8Array(y),w=0;w<c.length;w++)v[w]=c.charCodeAt(w);return y},BrowserStringUtils.utf8ArrToString=function(c){for(var y=ne.EMPTY_STRING,v=void 0,w=c.length,C=0;C<w;C++)v=c[C],y+=String.fromCharCode(v>251&&v<254&&C+5<w?1073741824*(v-252)+(c[++C]-128<<24)+(c[++C]-128<<18)+(c[++C]-128<<12)+(c[++C]-128<<6)+c[++C]-128:v>247&&v<252&&C+4<w?(v-248<<24)+(c[++C]-128<<18)+(c[++C]-128<<12)+(c[++C]-128<<6)+c[++C]-128:v>239&&v<248&&C+3<w?(v-240<<18)+(c[++C]-128<<12)+(c[++C]-128<<6)+c[++C]-128:v>223&&v<240&&C+2<w?(v-224<<12)+(c[++C]-128<<6)+c[++C]-128:v>191&&v<224&&C+1<w?(v-192<<6)+c[++C]-128:v);return y},BrowserStringUtils}(),hr=function(){function Base64Encode(){}return Base64Encode.prototype.urlEncode=function(c){return encodeURIComponent(this.encode(c).replace(/=/g,ne.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},Base64Encode.prototype.urlEncodeArr=function(c){return this.base64EncArr(c).replace(/=/g,ne.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},Base64Encode.prototype.encode=function(c){var y=dr.stringToUtf8Arr(c);return this.base64EncArr(y)},Base64Encode.prototype.base64EncArr=function(c){for(var y=(3-c.length%3)%3,v=ne.EMPTY_STRING,w=void 0,C=c.length,b=0,S=0;S<C;S++)w=S%3,b|=c[S]<<(16>>>w&24),2!==w&&c.length-S!=1||(v+=String.fromCharCode(this.uint6ToB64(b>>>18&63),this.uint6ToB64(b>>>12&63),this.uint6ToB64(b>>>6&63),this.uint6ToB64(63&b)),b=0);return 0===y?v:v.substring(0,v.length-y)+(1===y?"=":"==")},Base64Encode.prototype.uint6ToB64=function(c){return c<26?c+65:c<52?c+71:c<62?c-4:62===c?43:63===c?47:65},Base64Encode}(),pr=function(){function Base64Decode(){}return Base64Decode.prototype.decode=function(c){var y=c.replace(/-/g,"+").replace(/_/g,"/");switch(y.length%4){case 0:break;case 2:y+="==";break;case 3:y+="=";break;default:throw new Error("Invalid base64 string")}var v=this.base64DecToArr(y);return dr.utf8ArrToString(v)},Base64Decode.prototype.base64DecToArr=function(c,y){for(var v=c.replace(/[^A-Za-z0-9\+\/]/g,ne.EMPTY_STRING),w=v.length,C=y?Math.ceil((3*w+1>>>2)/y)*y:3*w+1>>>2,b=new Uint8Array(C),S=void 0,T=void 0,I=0,P=0,K=0;K<w;K++)if(T=3&K,I|=this.b64ToUint6(v.charCodeAt(K))<<18-6*T,3===T||w-K==1){for(S=0;S<3&&P<C;S++,P++)b[P]=I>>>(16>>>S&24)&255;I=0}return b},Base64Decode.prototype.b64ToUint6=function(c){return c>64&&c<91?c-65:c>96&&c<123?c-71:c>47&&c<58?c+4:43===c?62:47===c?63:0},Base64Decode}(),fr={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},gr={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},mr={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},yr={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},vr={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},wr={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},Er={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},Cr={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},_r={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},br={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},Sr={code:"state_not_found",desc:"State not found"},Tr={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},Ar={code:"nonce_not_found",desc:"nonce not found"},Ir={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},Rr={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},kr={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},Pr={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},Or={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},Nr={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},Mr={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},xr={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},Ur={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},Lr={code:"device_code_expired",desc:"Device code is expired."},Fr={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},Hr={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},Br={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},Dr={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},qr={code:"no_account_found",desc:"No account found in cache for given key."},jr={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},Gr={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},zr={code:"invalid_cache_type",desc:"Invalid cache type"},Wr={code:"unexpected_account_type",desc:"Unexpected account type."},Kr={code:"unexpected_credential_type",desc:"Unexpected credential type."},Vr={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},$r={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},Yr={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},Jr={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},Qr={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},Zr={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},Xr={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},sn={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},hn={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},pn=function(c){function ClientAuthError(y,v){var w=c.call(this,y,v)||this;return w.name="ClientAuthError",Object.setPrototypeOf(w,ClientAuthError.prototype),w}return _tslib_extends(ClientAuthError,c),ClientAuthError.createClientInfoDecodingError=function(c){return new ClientAuthError(fr.code,fr.desc+" Failed with error: "+c)},ClientAuthError.createClientInfoEmptyError=function(){return new ClientAuthError(gr.code,""+gr.desc)},ClientAuthError.createTokenParsingError=function(c){return new ClientAuthError(mr.code,mr.desc+" Failed with error: "+c)},ClientAuthError.createTokenNullOrEmptyError=function(c){return new ClientAuthError(yr.code,yr.desc+" Raw Token Value: "+c)},ClientAuthError.createEndpointDiscoveryIncompleteError=function(c){return new ClientAuthError(vr.code,vr.desc+" Detail: "+c)},ClientAuthError.createNetworkError=function(c,y){return new ClientAuthError(wr.code,wr.desc+" | Fetch client threw: "+y+" | Attempted to reach: "+c.split("?")[0])},ClientAuthError.createUnableToGetOpenidConfigError=function(c){return new ClientAuthError(Er.code,Er.desc+" Attempted to retrieve endpoints from: "+c)},ClientAuthError.createHashNotDeserializedError=function(c){return new ClientAuthError(Cr.code,Cr.desc+" Given Object: "+c)},ClientAuthError.createInvalidStateError=function(c,y){return new ClientAuthError(_r.code,_r.desc+" Invalid State: "+c+", Root Err: "+y)},ClientAuthError.createStateMismatchError=function(){return new ClientAuthError(br.code,br.desc)},ClientAuthError.createStateNotFoundError=function(c){return new ClientAuthError(Sr.code,Sr.desc+":  "+c)},ClientAuthError.createNonceMismatchError=function(){return new ClientAuthError(Tr.code,Tr.desc)},ClientAuthError.createNonceNotFoundError=function(c){return new ClientAuthError(Ar.code,Ar.desc+":  "+c)},ClientAuthError.createMultipleMatchingTokensInCacheError=function(){return new ClientAuthError(Ir.code,Ir.desc+".")},ClientAuthError.createMultipleMatchingAccountsInCacheError=function(){return new ClientAuthError(Rr.code,Rr.desc)},ClientAuthError.createMultipleMatchingAppMetadataInCacheError=function(){return new ClientAuthError(kr.code,kr.desc)},ClientAuthError.createTokenRequestCannotBeMadeError=function(){return new ClientAuthError(Pr.code,Pr.desc)},ClientAuthError.createAppendEmptyScopeToSetError=function(c){return new ClientAuthError(Or.code,Or.desc+" Given Scope: "+c)},ClientAuthError.createRemoveEmptyScopeFromSetError=function(c){return new ClientAuthError(Nr.code,Nr.desc+" Given Scope: "+c)},ClientAuthError.createAppendScopeSetError=function(c){return new ClientAuthError(Mr.code,Mr.desc+" Detail Error: "+c)},ClientAuthError.createEmptyInputScopeSetError=function(){return new ClientAuthError(xr.code,""+xr.desc)},ClientAuthError.createDeviceCodeCancelledError=function(){return new ClientAuthError(Ur.code,""+Ur.desc)},ClientAuthError.createDeviceCodeExpiredError=function(){return new ClientAuthError(Lr.code,""+Lr.desc)},ClientAuthError.createDeviceCodeUnknownError=function(){return new ClientAuthError(Fr.code,""+Fr.desc)},ClientAuthError.createNoAccountInSilentRequestError=function(){return new ClientAuthError(Hr.code,""+Hr.desc)},ClientAuthError.createNullOrUndefinedCacheRecord=function(){return new ClientAuthError(Br.code,Br.desc)},ClientAuthError.createInvalidCacheEnvironmentError=function(){return new ClientAuthError(Dr.code,Dr.desc)},ClientAuthError.createNoAccountFoundError=function(){return new ClientAuthError(qr.code,qr.desc)},ClientAuthError.createCachePluginError=function(){return new ClientAuthError(jr.code,""+jr.desc)},ClientAuthError.createNoCryptoObjectError=function(c){return new ClientAuthError(Gr.code,""+Gr.desc+c)},ClientAuthError.createInvalidCacheTypeError=function(){return new ClientAuthError(zr.code,""+zr.desc)},ClientAuthError.createUnexpectedAccountTypeError=function(){return new ClientAuthError(Wr.code,""+Wr.desc)},ClientAuthError.createUnexpectedCredentialTypeError=function(){return new ClientAuthError(Kr.code,""+Kr.desc)},ClientAuthError.createInvalidAssertionError=function(){return new ClientAuthError(Vr.code,""+Vr.desc)},ClientAuthError.createInvalidCredentialError=function(){return new ClientAuthError($r.code,""+$r.desc)},ClientAuthError.createRefreshRequiredError=function(){return new ClientAuthError(Yr.code,Yr.desc)},ClientAuthError.createUserTimeoutReachedError=function(){return new ClientAuthError(Jr.code,Jr.desc)},ClientAuthError.createTokenClaimsRequiredError=function(){return new ClientAuthError(Qr.code,Qr.desc)},ClientAuthError.createNoAuthCodeInServerResponseError=function(){return new ClientAuthError(Zr.code,Zr.desc)},ClientAuthError.createBindingKeyNotRemovedError=function(){return new ClientAuthError(Xr.code,Xr.desc)},ClientAuthError.createLogoutNotSupportedError=function(){return new ClientAuthError(sn.code,sn.desc)},ClientAuthError.createKeyIdMissingError=function(){return new ClientAuthError(hn.code,hn.desc)},ClientAuthError}(or),fn=function(){function StringUtils(){}return StringUtils.decodeAuthToken=function(c){if(StringUtils.isEmpty(c))throw pn.createTokenNullOrEmptyError(c);var y=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(c);if(!y||y.length<4)throw pn.createTokenParsingError("Given token is malformed: "+JSON.stringify(c));return{header:y[1],JWSPayload:y[2],JWSSig:y[3]}},StringUtils.isEmpty=function(c){return void 0===c||!c||0===c.length},StringUtils.isEmptyObj=function(c){if(c&&!StringUtils.isEmpty(c))try{var y=JSON.parse(c);return 0===Object.keys(y).length}catch(c){}return!0},StringUtils.startsWith=function(c,y){return 0===c.indexOf(y)},StringUtils.endsWith=function(c,y){return c.length>=y.length&&c.lastIndexOf(y)===c.length-y.length},StringUtils.queryStringToObject=function(c){var y={},v=c.split("&"),decode=function(c){return decodeURIComponent(c.replace(/\+/g," "))};return v.forEach((function(c){if(c.trim()){var v=c.split(/=(.+)/g,2),w=v[0],C=v[1];w&&C&&(y[decode(w)]=decode(C))}})),y},StringUtils.trimArrayEntries=function(c){return c.map((function(c){return c.trim()}))},StringUtils.removeEmptyStringsFromArray=function(c){return c.filter((function(c){return!StringUtils.isEmpty(c)}))},StringUtils.jsonParseHelper=function(c){try{return JSON.parse(c)}catch(c){return null}},StringUtils.matchPattern=function(c,y){return new RegExp(c.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(y)},StringUtils}(),gn={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},mn={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},_n={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},An={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},Rn={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},On={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},Nn={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},Mn={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},xn={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},Un={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},Ln={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},Hn={code:"empty_window_error",desc:"window.open returned null or undefined window object."},Bn={code:"user_cancelled",desc:"User cancelled the flow."},Dn={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},jn={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},zn={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},Wn={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},Vn={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},eo={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},to={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},ro={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},no={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},oo={code:"no_token_request_cache_error",desc:"No token request found in cache."},io={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},ao={code:"no_cached_authority_error",desc:"No cached authority found."},so={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},co={code:"invalid_cache_type",desc:"Invalid cache type"},uo={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},lo={code:"database_not_open",desc:"Database is not open!"},ho={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},po={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},fo={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},go={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},mo={code:"unable_to_load_token",desc:"Error loading token to cache."},yo={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},vo={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},wo={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},Eo={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},Co={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},_o={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},bo={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},So={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},To={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},Ao={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},Io=function(c){function BrowserAuthError(y,v){var w=c.call(this,y,v)||this;return Object.setPrototypeOf(w,BrowserAuthError.prototype),w.name="BrowserAuthError",w}return __extends(BrowserAuthError,c),BrowserAuthError.createPkceNotGeneratedError=function(c){return new BrowserAuthError(gn.code,gn.desc+" Detail:"+c)},BrowserAuthError.createCryptoNotAvailableError=function(c){return new BrowserAuthError(mn.code,mn.desc+" Detail:"+c)},BrowserAuthError.createHttpMethodNotImplementedError=function(c){return new BrowserAuthError(_n.code,_n.desc+" Given Method: "+c)},BrowserAuthError.createEmptyNavigationUriError=function(){return new BrowserAuthError(An.code,An.desc)},BrowserAuthError.createEmptyHashError=function(c){return new BrowserAuthError(Rn.code,Rn.desc+" Given Url: "+c)},BrowserAuthError.createHashDoesNotContainStateError=function(){return new BrowserAuthError(On.code,On.desc)},BrowserAuthError.createHashDoesNotContainKnownPropertiesError=function(){return new BrowserAuthError(Nn.code,Nn.desc)},BrowserAuthError.createUnableToParseStateError=function(){return new BrowserAuthError(Mn.code,Mn.desc)},BrowserAuthError.createStateInteractionTypeMismatchError=function(){return new BrowserAuthError(xn.code,xn.desc)},BrowserAuthError.createInteractionInProgressError=function(){return new BrowserAuthError(Un.code,Un.desc)},BrowserAuthError.createPopupWindowError=function(c){var y=Ln.desc;return y=fn.isEmpty(c)?y:y+" Details: "+c,new BrowserAuthError(Ln.code,y)},BrowserAuthError.createEmptyWindowCreatedError=function(){return new BrowserAuthError(Hn.code,Hn.desc)},BrowserAuthError.createUserCancelledError=function(){return new BrowserAuthError(Bn.code,Bn.desc)},BrowserAuthError.createMonitorPopupTimeoutError=function(){return new BrowserAuthError(Dn.code,Dn.desc)},BrowserAuthError.createMonitorIframeTimeoutError=function(){return new BrowserAuthError(jn.code,jn.desc)},BrowserAuthError.createRedirectInIframeError=function(c){return new BrowserAuthError(zn.code,zn.desc+" (window.parent !== window) => "+c)},BrowserAuthError.createBlockReloadInHiddenIframeError=function(){return new BrowserAuthError(Wn.code,Wn.desc)},BrowserAuthError.createBlockAcquireTokenInPopupsError=function(){return new BrowserAuthError(Vn.code,Vn.desc)},BrowserAuthError.createIframeClosedPrematurelyError=function(){return new BrowserAuthError(eo.code,eo.desc)},BrowserAuthError.createSilentLogoutUnsupportedError=function(){return new BrowserAuthError(to.code,to.desc)},BrowserAuthError.createNoAccountError=function(){return new BrowserAuthError(ro.code,ro.desc)},BrowserAuthError.createSilentPromptValueError=function(c){return new BrowserAuthError(no.code,no.desc+" Given value: "+c)},BrowserAuthError.createUnableToParseTokenRequestCacheError=function(){return new BrowserAuthError(io.code,io.desc)},BrowserAuthError.createNoTokenRequestCacheError=function(){return new BrowserAuthError(oo.code,oo.desc)},BrowserAuthError.createAuthRequestNotSetError=function(){return new BrowserAuthError(so.code,so.desc)},BrowserAuthError.createNoCachedAuthorityError=function(){return new BrowserAuthError(ao.code,ao.desc)},BrowserAuthError.createInvalidCacheTypeError=function(){return new BrowserAuthError(co.code,""+co.desc)},BrowserAuthError.createNonBrowserEnvironmentError=function(){return new BrowserAuthError(uo.code,uo.desc)},BrowserAuthError.createDatabaseNotOpenError=function(){return new BrowserAuthError(lo.code,lo.desc)},BrowserAuthError.createNoNetworkConnectivityError=function(){return new BrowserAuthError(ho.code,ho.desc)},BrowserAuthError.createPostRequestFailedError=function(c,y){return new BrowserAuthError(po.code,po.desc+" | Network client threw: "+c+" | Attempted to reach: "+y.split("?")[0])},BrowserAuthError.createGetRequestFailedError=function(c,y){return new BrowserAuthError(fo.code,fo.desc+" | Network client threw: "+c+" | Attempted to reach: "+y.split("?")[0])},BrowserAuthError.createFailedToParseNetworkResponseError=function(c){return new BrowserAuthError(go.code,go.desc+" | Attempted to reach: "+c.split("?")[0])},BrowserAuthError.createUnableToLoadTokenError=function(c){return new BrowserAuthError(mo.code,mo.desc+" | "+c)},BrowserAuthError.createSigningKeyNotFoundInStorageError=function(c){return new BrowserAuthError(yo.code,yo.desc+" | No match found for KeyId: "+c)},BrowserAuthError.createAuthCodeRequiredError=function(){return new BrowserAuthError(vo.code,vo.desc)},BrowserAuthError.createAuthCodeOrNativeAccountIdRequiredError=function(){return new BrowserAuthError(wo.code,wo.desc)},BrowserAuthError.createDatabaseUnavailableError=function(){return new BrowserAuthError(Eo.code,Eo.desc)},BrowserAuthError.createUnableToAcquireTokenFromNativePlatformError=function(){return new BrowserAuthError(Co.code,Co.desc)},BrowserAuthError.createNativeHandshakeTimeoutError=function(){return new BrowserAuthError(_o.code,_o.desc)},BrowserAuthError.createNativeExtensionNotInstalledError=function(){return new BrowserAuthError(bo.code,bo.desc)},BrowserAuthError.createNativeConnectionNotEstablishedError=function(){return new BrowserAuthError(So.code,So.desc)},BrowserAuthError.createNativeBrokerCalledBeforeInitialize=function(){return new BrowserAuthError(To.code,To.desc)},BrowserAuthError.createNativePromptParameterNotSupportedError=function(){return new BrowserAuthError(Ao.code,Ao.desc)},BrowserAuthError}(or),Ro=function(){function PkceGenerator(c){this.base64Encode=new hr,this.cryptoObj=c}return PkceGenerator.prototype.generateCodes=function(){return __awaiter(this,void 0,void 0,(function(){var c,y;return __generator(this,(function(v){switch(v.label){case 0:return c=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(c)];case 1:return y=v.sent(),[2,{verifier:c,challenge:y}]}}))}))},PkceGenerator.prototype.generateCodeVerifier=function(){try{var c=new Uint8Array(32);return this.cryptoObj.getRandomValues(c),this.base64Encode.urlEncodeArr(c)}catch(c){throw Io.createPkceNotGeneratedError(c)}},PkceGenerator.prototype.generateCodeChallengeFromVerifier=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v;return __generator(this,(function(w){switch(w.label){case 0:return w.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(c)];case 1:return y=w.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(y))];case 2:throw v=w.sent(),Io.createPkceNotGeneratedError(v);case 3:return[2]}}))}))},PkceGenerator}(),ko="SHA-256",Po=new Uint8Array([1,0,1]),Oo=function(){function BrowserCrypto(c){if(this.logger=c,!this.hasCryptoAPI())throw Io.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:ko,modulusLength:2048,publicExponent:Po}}return BrowserCrypto.prototype.sha256Digest=function(c){return __awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){return y=dr.stringToUtf8Arr(c),[2,this.hasIECrypto()?this.getMSCryptoDigest(ko,y):this.getSubtleCryptoDigest(ko,y)]}))}))},BrowserCrypto.prototype.getRandomValues=function(c){var y=window.msCrypto||window.crypto;if(!y.getRandomValues)throw Io.createCryptoNotAvailableError("getRandomValues does not exist.");y.getRandomValues(c)},BrowserCrypto.prototype.generateKeyPair=function(c,y){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(v){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(c,y):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,c,y)]}))}))},BrowserCrypto.prototype.exportJwk=function(c){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){return[2,this.hasIECrypto()?this.msCryptoExportJwk(c):window.crypto.subtle.exportKey(Xt,c)]}))}))},BrowserCrypto.prototype.importJwk=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w,C;return __generator(this,(function(b){return w=BrowserCrypto.getJwkString(c),C=dr.stringToArrayBuffer(w),[2,this.hasIECrypto()?this.msCryptoImportKey(C,y,v):window.crypto.subtle.importKey(Xt,c,this._keygenAlgorithmOptions,y,v)]}))}))},BrowserCrypto.prototype.sign=function(c,y){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(v){return[2,this.hasIECrypto()?this.msCryptoSign(c,y):window.crypto.subtle.sign(this._keygenAlgorithmOptions,c,y)]}))}))},BrowserCrypto.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},BrowserCrypto.prototype.hasIECrypto=function(){return"msCrypto"in window},BrowserCrypto.prototype.hasBrowserCrypto=function(){return"crypto"in window},BrowserCrypto.prototype.getSubtleCryptoDigest=function(c,y){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(v){return[2,window.crypto.subtle.digest(c,y)]}))}))},BrowserCrypto.prototype.getMSCryptoDigest=function(c,y){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(v){return[2,new Promise((function(v,w){var C=window.msCrypto.subtle.digest(c,y.buffer);C.addEventListener("complete",(function(c){v(c.target.result)})),C.addEventListener("error",(function(c){w(c)}))}))]}))}))},BrowserCrypto.prototype.msCryptoGenerateKey=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v=this;return __generator(this,(function(w){return[2,new Promise((function(w,C){var b=window.msCrypto.subtle.generateKey(v._keygenAlgorithmOptions,c,y);b.addEventListener("complete",(function(c){w(c.target.result)})),b.addEventListener("error",(function(c){C(c)}))}))]}))}))},BrowserCrypto.prototype.msCryptoExportJwk=function(c){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){return[2,new Promise((function(y,v){var w=window.msCrypto.subtle.exportKey(Xt,c);w.addEventListener("complete",(function(c){var w=c.target.result,C=dr.utf8ArrToString(new Uint8Array(w)).replace(/\r/g,ne.EMPTY_STRING).replace(/\n/g,ne.EMPTY_STRING).replace(/\t/g,ne.EMPTY_STRING).split(" ").join(ne.EMPTY_STRING).replace("\0",ne.EMPTY_STRING);try{y(JSON.parse(C))}catch(c){v(c)}})),w.addEventListener("error",(function(c){v(c)}))}))]}))}))},BrowserCrypto.prototype.msCryptoImportKey=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w=this;return __generator(this,(function(C){return[2,new Promise((function(C,b){var S=window.msCrypto.subtle.importKey(Xt,c,w._keygenAlgorithmOptions,y,v);S.addEventListener("complete",(function(c){C(c.target.result)})),S.addEventListener("error",(function(c){b(c)}))}))]}))}))},BrowserCrypto.prototype.msCryptoSign=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v=this;return __generator(this,(function(w){return[2,new Promise((function(w,C){var b=window.msCrypto.subtle.sign(v._keygenAlgorithmOptions,c,y);b.addEventListener("complete",(function(c){w(c.target.result)})),b.addEventListener("error",(function(c){C(c)}))}))]}))}))},BrowserCrypto.getJwkString=function(c){return JSON.stringify(c,Object.keys(c).sort())},BrowserCrypto}(),No=function(){function DatabaseStorage(){this.dbName=tr,this.version=1,this.tableName="msal.db.keys",this.dbOpen=!1}return DatabaseStorage.prototype.open=function(){return __awaiter(this,void 0,void 0,(function(){var c=this;return __generator(this,(function(y){return[2,new Promise((function(y,v){var w=window.indexedDB.open(c.dbName,c.version);w.addEventListener("upgradeneeded",(function(y){y.target.result.createObjectStore(c.tableName)})),w.addEventListener("success",(function(v){var w=v;c.db=w.target.result,c.dbOpen=!0,y()})),w.addEventListener("error",(function(){return v(Io.createDatabaseUnavailableError())}))}))]}))}))},DatabaseStorage.prototype.closeConnection=function(){var c=this.db;c&&this.dbOpen&&(c.close(),this.dbOpen=!1)},DatabaseStorage.prototype.validateDbIsOpen=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(c){switch(c.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,c.sent()];case 2:return[2]}}))}))},DatabaseStorage.prototype.getItem=function(c){return __awaiter(this,void 0,void 0,(function(){var y=this;return __generator(this,(function(v){switch(v.label){case 0:return[4,this.validateDbIsOpen()];case 1:return v.sent(),[2,new Promise((function(v,w){if(!y.db)return w(Io.createDatabaseNotOpenError());var C=y.db.transaction([y.tableName],"readonly").objectStore(y.tableName).get(c);C.addEventListener("success",(function(c){var w=c;y.closeConnection(),v(w.target.result)})),C.addEventListener("error",(function(c){y.closeConnection(),w(c)}))}))]}}))}))},DatabaseStorage.prototype.setItem=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v=this;return __generator(this,(function(w){switch(w.label){case 0:return[4,this.validateDbIsOpen()];case 1:return w.sent(),[2,new Promise((function(w,C){if(!v.db)return C(Io.createDatabaseNotOpenError());var b=v.db.transaction([v.tableName],"readwrite").objectStore(v.tableName).put(y,c);b.addEventListener("success",(function(){v.closeConnection(),w()})),b.addEventListener("error",(function(c){v.closeConnection(),C(c)}))}))]}}))}))},DatabaseStorage.prototype.removeItem=function(c){return __awaiter(this,void 0,void 0,(function(){var y=this;return __generator(this,(function(v){switch(v.label){case 0:return[4,this.validateDbIsOpen()];case 1:return v.sent(),[2,new Promise((function(v,w){if(!y.db)return w(Io.createDatabaseNotOpenError());var C=y.db.transaction([y.tableName],"readwrite").objectStore(y.tableName).delete(c);C.addEventListener("success",(function(){y.closeConnection(),v()})),C.addEventListener("error",(function(c){y.closeConnection(),w(c)}))}))]}}))}))},DatabaseStorage.prototype.getKeys=function(){return __awaiter(this,void 0,void 0,(function(){var c=this;return __generator(this,(function(y){switch(y.label){case 0:return[4,this.validateDbIsOpen()];case 1:return y.sent(),[2,new Promise((function(y,v){if(!c.db)return v(Io.createDatabaseNotOpenError());var w=c.db.transaction([c.tableName],"readonly").objectStore(c.tableName).getAllKeys();w.addEventListener("success",(function(v){var w=v;c.closeConnection(),y(w.target.result)})),w.addEventListener("error",(function(y){c.closeConnection(),v(y)}))}))]}}))}))},DatabaseStorage.prototype.containsKey=function(c){return __awaiter(this,void 0,void 0,(function(){var y=this;return __generator(this,(function(v){switch(v.label){case 0:return[4,this.validateDbIsOpen()];case 1:return v.sent(),[2,new Promise((function(v,w){if(!y.db)return w(Io.createDatabaseNotOpenError());var C=y.db.transaction([y.tableName],"readonly").objectStore(y.tableName).count(c);C.addEventListener("success",(function(c){var w=c;y.closeConnection(),v(1===w.target.result)})),C.addEventListener("error",(function(c){y.closeConnection(),w(c)}))}))]}}))}))},DatabaseStorage.prototype.deleteDatabase=function(){return __awaiter(this,void 0,void 0,(function(){var c;return __generator(this,(function(y){switch(y.label){case 0:return this.db&&this.dbOpen&&this.closeConnection(),[4,window.indexedDB.databases()];case 1:return c=y.sent(),c.find((function(c){return c.name===tr}))?[2,new Promise((function(c,y){var v=window.indexedDB.deleteDatabase(tr);v.addEventListener("success",(function(){return c(!0)})),v.addEventListener("error",(function(){return y(!1)}))}))]:[2,!0]}}))}))},DatabaseStorage}(),Mo=function(){function MemoryStorage(){this.cache=new Map}return MemoryStorage.prototype.getItem=function(c){return this.cache.get(c)||null},MemoryStorage.prototype.setItem=function(c,y){this.cache.set(c,y)},MemoryStorage.prototype.removeItem=function(c){this.cache.delete(c)},MemoryStorage.prototype.getKeys=function(){var c=[];return this.cache.forEach((function(y,v){c.push(v)})),c},MemoryStorage.prototype.containsKey=function(c){return this.cache.has(c)},MemoryStorage.prototype.clear=function(){this.cache.clear()},MemoryStorage}(),xo=function(){function AsyncMemoryStorage(c,y){this.inMemoryCache=new Mo,this.indexedDBCache=new No,this.logger=c,this.storeName=y}return AsyncMemoryStorage.prototype.handleDatabaseAccessError=function(c){if(!(c instanceof Io&&c.errorCode===Eo.code))throw c;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},AsyncMemoryStorage.prototype.getItem=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v;return __generator(this,(function(w){switch(w.label){case 0:if(y=this.inMemoryCache.getItem(c))return[3,4];w.label=1;case 1:return w.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(c)];case 2:return[2,w.sent()];case 3:return v=w.sent(),this.handleDatabaseAccessError(v),[3,4];case 4:return[2,y]}}))}))},AsyncMemoryStorage.prototype.setItem=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v;return __generator(this,(function(w){switch(w.label){case 0:this.inMemoryCache.setItem(c,y),w.label=1;case 1:return w.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(c,y)];case 2:return w.sent(),[3,4];case 3:return v=w.sent(),this.handleDatabaseAccessError(v),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.removeItem=function(c){return __awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){switch(v.label){case 0:this.inMemoryCache.removeItem(c),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(c)];case 2:return v.sent(),[3,4];case 3:return y=v.sent(),this.handleDatabaseAccessError(y),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.getKeys=function(){return __awaiter(this,void 0,void 0,(function(){var c,y;return __generator(this,(function(v){switch(v.label){case 0:if(0!==(c=this.inMemoryCache.getKeys()).length)return[3,4];v.label=1;case 1:return v.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,v.sent()];case 3:return y=v.sent(),this.handleDatabaseAccessError(y),[3,4];case 4:return[2,c]}}))}))},AsyncMemoryStorage.prototype.containsKey=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v;return __generator(this,(function(w){switch(w.label){case 0:if(y=this.inMemoryCache.containsKey(c))return[3,4];w.label=1;case 1:return w.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(c)];case 2:return[2,w.sent()];case 3:return v=w.sent(),this.handleDatabaseAccessError(v),[3,4];case 4:return[2,y]}}))}))},AsyncMemoryStorage.prototype.clear=function(){return __awaiter(this,void 0,void 0,(function(){var c,y;return __generator(this,(function(v){switch(v.label){case 0:this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted"),this.logger.verbose("Deleting persistent keystore "+this.storeName),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return(c=v.sent())&&this.logger.verbose("Persistent keystore "+this.storeName+" deleted"),[2,c];case 3:return y=v.sent(),this.handleDatabaseAccessError(y),[2,!1];case 4:return[2]}}))}))},AsyncMemoryStorage}();!function(c){c.asymmetricKeys="asymmetricKeys",c.symmetricKeys="symmetricKeys"}(er||(er={}));var Uo,Lo=function(){function CryptoOps(c,y){this.logger=c,this.browserCrypto=new Oo(this.logger),this.b64Encode=new hr,this.b64Decode=new pr,this.guidGenerator=new lr(this.browserCrypto),this.pkceGenerator=new Ro(this.browserCrypto),this.cache={asymmetricKeys:new xo(this.logger,er.asymmetricKeys),symmetricKeys:new xo(this.logger,er.symmetricKeys)},this.performanceClient=y}return CryptoOps.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},CryptoOps.prototype.base64Encode=function(c){return this.b64Encode.encode(c)},CryptoOps.prototype.base64Decode=function(c){return this.b64Decode.decode(c)},CryptoOps.prototype.generatePkceCodes=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(c){return[2,this.pkceGenerator.generateCodes()]}))}))},CryptoOps.prototype.getPublicKeyThumbprint=function(c){var y;return __awaiter(this,void 0,void 0,(function(){var v,w,C,b,S,T,P,K;return __generator(this,(function(Q){switch(Q.label){case 0:return v=null===(y=this.performanceClient)||void 0===y?void 0:y.startMeasurement(I.CryptoOptsGetPublicKeyThumbprint,c.correlationId),[4,this.browserCrypto.generateKeyPair(CryptoOps.EXTRACTABLE,CryptoOps.POP_KEY_USAGES)];case 1:return w=Q.sent(),[4,this.browserCrypto.exportJwk(w.publicKey)];case 2:return C=Q.sent(),b={e:C.e,kty:C.kty,n:C.n},S=Oo.getJwkString(b),[4,this.hashString(S)];case 3:return T=Q.sent(),[4,this.browserCrypto.exportJwk(w.privateKey)];case 4:return P=Q.sent(),[4,this.browserCrypto.importJwk(P,!1,["sign"])];case 5:return K=Q.sent(),[4,this.cache.asymmetricKeys.setItem(T,{privateKey:K,publicKey:w.publicKey,requestMethod:c.resourceRequestMethod,requestUri:c.resourceRequestUri})];case 6:return Q.sent(),v&&v.endMeasurement({success:!0}),[2,T]}}))}))},CryptoOps.prototype.removeTokenBindingKey=function(c){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(c)];case 1:return y.sent(),[4,this.cache.asymmetricKeys.containsKey(c)];case 2:return[2,!y.sent()]}}))}))},CryptoOps.prototype.clearKeystore=function(){return __awaiter(this,void 0,void 0,(function(){var c;return __generator(this,(function(y){switch(y.label){case 0:return y.trys.push([0,3,,4]),this.logger.verbose("Deleting in-memory and persistent asymmetric key stores"),[4,this.cache.asymmetricKeys.clear()];case 1:return y.sent(),this.logger.verbose("Successfully deleted asymmetric key stores"),this.logger.verbose("Deleting in-memory and persistent symmetric key stores"),[4,this.cache.symmetricKeys.clear()];case 2:return y.sent(),this.logger.verbose("Successfully deleted symmetric key stores"),[2,!0];case 3:return(c=y.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+c.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},CryptoOps.prototype.signJwt=function(c,y,v){var w;return __awaiter(this,void 0,void 0,(function(){var C,b,S,T,P,K,Q,X,te,re,ne,oe,ie;return __generator(this,(function(se){switch(se.label){case 0:return C=null===(w=this.performanceClient)||void 0===w?void 0:w.startMeasurement(I.CryptoOptsSignJwt,v),[4,this.cache.asymmetricKeys.getItem(y)];case 1:if(!(b=se.sent()))throw Io.createSigningKeyNotFoundInStorageError(y);return[4,this.browserCrypto.exportJwk(b.publicKey)];case 2:return S=se.sent(),T=Oo.getJwkString(S),P=this.b64Encode.urlEncode(JSON.stringify({kid:y})),K=cr.getShrHeaderString({kid:P,alg:S.alg}),Q=this.b64Encode.urlEncode(K),c.cnf={jwk:JSON.parse(T)},X=this.b64Encode.urlEncode(JSON.stringify(c)),te=Q+"."+X,re=dr.stringToArrayBuffer(te),[4,this.browserCrypto.sign(b.privateKey,re)];case 3:return ne=se.sent(),oe=this.b64Encode.urlEncodeArr(new Uint8Array(ne)),ie=te+"."+oe,C&&C.endMeasurement({success:!0}),[2,ie]}}))}))},CryptoOps.prototype.hashString=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v;return __generator(this,(function(w){switch(w.label){case 0:return[4,this.browserCrypto.sha256Digest(c)];case 1:return y=w.sent(),v=new Uint8Array(y),[2,this.b64Encode.urlEncodeArr(v)]}}))}))},CryptoOps.POP_KEY_USAGES=["sign","verify"],CryptoOps.EXTRACTABLE=!0,CryptoOps}();!function(c){c[c.Error=0]="Error",c[c.Warning=1]="Warning",c[c.Info=2]="Info",c[c.Verbose=3]="Verbose",c[c.Trace=4]="Trace"}(Uo||(Uo={}));var Fo,Ho=function(){function Logger(c,y,v){this.level=Uo.Info;this.localCallback=c.loggerCallback||function(){},this.piiLoggingEnabled=c.piiLoggingEnabled||!1,this.level="number"==typeof c.logLevel?c.logLevel:Uo.Info,this.correlationId=c.correlationId||ne.EMPTY_STRING,this.packageName=y||ne.EMPTY_STRING,this.packageVersion=v||ne.EMPTY_STRING}return Logger.prototype.clone=function(c,y,v){return new Logger({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:v||this.correlationId},c,y)},Logger.prototype.logMessage=function(c,y){if(!(y.logLevel>this.level||!this.piiLoggingEnabled&&y.containsPii)){var v=(new Date).toUTCString(),w=(fn.isEmpty(y.correlationId)?fn.isEmpty(this.correlationId)?"["+v+"]":"["+v+"] : ["+this.correlationId+"]":"["+v+"] : ["+y.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+Uo[y.logLevel]+" - "+c;this.executeCallback(y.logLevel,w,y.containsPii||!1)}},Logger.prototype.executeCallback=function(c,y,v){this.localCallback&&this.localCallback(c,y,v)},Logger.prototype.error=function(c,y){this.logMessage(c,{logLevel:Uo.Error,containsPii:!1,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.errorPii=function(c,y){this.logMessage(c,{logLevel:Uo.Error,containsPii:!0,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.warning=function(c,y){this.logMessage(c,{logLevel:Uo.Warning,containsPii:!1,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.warningPii=function(c,y){this.logMessage(c,{logLevel:Uo.Warning,containsPii:!0,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.info=function(c,y){this.logMessage(c,{logLevel:Uo.Info,containsPii:!1,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.infoPii=function(c,y){this.logMessage(c,{logLevel:Uo.Info,containsPii:!0,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.verbose=function(c,y){this.logMessage(c,{logLevel:Uo.Verbose,containsPii:!1,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.verbosePii=function(c,y){this.logMessage(c,{logLevel:Uo.Verbose,containsPii:!0,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.trace=function(c,y){this.logMessage(c,{logLevel:Uo.Trace,containsPii:!1,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.tracePii=function(c,y){this.logMessage(c,{logLevel:Uo.Trace,containsPii:!0,correlationId:y||ne.EMPTY_STRING})},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Logger}(),Bo=function(){function PerformanceClient(c,y,v,w,C,b){this.authority=y,this.libraryName=w,this.libraryVersion=C,this.applicationTelemetry=b,this.clientId=c,this.logger=v,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.measurementsById=new Map}return PerformanceClient.prototype.startMeasurement=function(c,y){var v,w,C=this,b=y||this.generateId();y||this.logger.info("PerformanceClient: No correlation id provided for "+c+", generating",b),this.logger.trace("PerformanceClient: Performance measurement started for "+c,b);var S=this.startPerformanceMeasuremeant(c,b);S.startMeasurement();var T={eventId:this.generateId(),status:P.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,appName:null===(v=this.applicationTelemetry)||void 0===v?void 0:v.appName,appVersion:null===(w=this.applicationTelemetry)||void 0===w?void 0:w.appVersion,clientId:this.clientId,name:c,startTimeMs:Date.now(),correlationId:b};return this.cacheEventByCorrelationId(T),this.cacheMeasurement(T,S),{endMeasurement:function(c){var y=C.endMeasurement(_tslib_assign(_tslib_assign({},T),c));return y&&C.cacheEventByCorrelationId(y),y},flushMeasurement:function(){return C.flushMeasurements(T.name,T.correlationId)},discardMeasurement:function(){return C.discardMeasurements(T.correlationId)},measurement:S,event:T}},PerformanceClient.prototype.endMeasurement=function(c){var y=this.measurementsById.get(c.eventId);if(y){this.measurementsById.delete(c.eventId),y.endMeasurement();var v=y.flushMeasurement();if(null!==v)return this.logger.trace("PerformanceClient: Performance measurement ended for "+c.name+": "+v+" ms",c.correlationId),_tslib_assign(_tslib_assign({durationMs:Math.round(v)},c),{status:P.Completed});this.logger.trace("PerformanceClient: Performance measurement not taken",c.correlationId)}else this.logger.trace("PerformanceClient: Measurement not found for "+c.eventId,c.correlationId);return null},PerformanceClient.prototype.cacheEventByCorrelationId=function(c){var y=this.eventsByCorrelationId.get(c.correlationId);y?(this.logger.trace("PerformanceClient: Performance measurement for "+c.name+" added/updated",c.correlationId),y.set(c.eventId,c)):(this.logger.trace("PerformanceClient: Performance measurement for "+c.name+" started",c.correlationId),this.eventsByCorrelationId.set(c.correlationId,(new Map).set(c.eventId,c)))},PerformanceClient.prototype.cacheMeasurement=function(c,y){this.measurementsById.set(c.eventId,y)},PerformanceClient.prototype.flushMeasurements=function(c,y){var v=this;this.logger.trace("PerformanceClient: Performance measurements flushed for "+c,y);var w=this.eventsByCorrelationId.get(y);if(w){this.discardMeasurements(y);var C=[];w.forEach((function(w){if(w.name!==c&&w.status!==P.Completed){v.logger.trace("PerformanceClient: Incomplete submeasurement "+w.name+" found for "+c,y);var b=v.endMeasurement(w);b&&C.push(b)}C.push(w)}));var b=C.sort((function(c,y){return c.startTimeMs-y.startTimeMs})),S=b.filter((function(y){return y.name===c&&y.status===P.Completed}));if(S.length>0){S.length>1&&this.logger.verbose("PerformanceClient: Multiple distinct top-level performance events found, using the first",y);var T=S[0];this.logger.verbose("PerformanceClient: Measurement found for "+c,y);var I=b.reduce((function(w,C){if(C.name!==c){v.logger.trace("PerformanceClient: Complete submeasurement found for "+C.name,y);var b=C.name+"DurationMs";w[b]?v.logger.verbose("PerformanceClient: Submeasurement for "+c+" already exists for "+C.name+", ignoring",y):w[b]=C.durationMs,C.accessTokenSize&&(w.accessTokenSize=C.accessTokenSize),C.idTokenSize&&(w.idTokenSize=C.idTokenSize)}return w}),T);this.emitEvents([I],I.correlationId)}else this.logger.verbose("PerformanceClient: No completed top-level measurements found for "+c,y)}else this.logger.verbose("PerformanceClient: No measurements found",y)},PerformanceClient.prototype.discardMeasurements=function(c){this.logger.trace("PerformanceClient: Performance measurements discarded",c),this.eventsByCorrelationId.delete(c)},PerformanceClient.prototype.addPerformanceCallback=function(c){var y=this.generateId();return this.callbacks.set(y,c),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+y),y},PerformanceClient.prototype.removePerformanceCallback=function(c){var y=this.callbacks.delete(c);return y?this.logger.verbose("PerformanceClient: Performance callback "+c+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+c+" not removed."),y},PerformanceClient.prototype.emitEvents=function(c,y){var v=this;this.logger.verbose("PerformanceClient: Emitting performance events",y),this.callbacks.forEach((function(w,C){v.logger.trace("PerformanceClient: Emitting event to callback "+C,y),w.apply(null,[c])}))},PerformanceClient}(),Do=function(){function StubPerformanceMeasurement(){}return StubPerformanceMeasurement.prototype.startMeasurement=function(){},StubPerformanceMeasurement.prototype.endMeasurement=function(){},StubPerformanceMeasurement.prototype.flushMeasurement=function(){return null},StubPerformanceMeasurement}(),qo=function(c){function StubPerformanceClient(){return null!==c&&c.apply(this,arguments)||this}return _tslib_extends(StubPerformanceClient,c),StubPerformanceClient.prototype.generateId=function(){return"callback-id"},StubPerformanceClient.prototype.startPerformanceMeasuremeant=function(){return new Do},StubPerformanceClient}(Bo),jo={createNewGuid:function(){throw or.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw or.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw or.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Crypto interface - generatePkceCodes() has not been implemented",or.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",or.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Crypto interface - removeTokenBindingKey() has not been implemented",or.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Crypto interface - clearKeystore() has not been implemented",or.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Crypto interface - signJwt() has not been implemented",or.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Crypto interface - hashString() has not been implemented",or.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},Go=["interaction_required","consent_required","login_required"],zo=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Wo={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},Ko={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},Vo=function(c){function InteractionRequiredAuthError(y,v,w){var C=c.call(this,y,v,w)||this;return C.name="InteractionRequiredAuthError",Object.setPrototypeOf(C,InteractionRequiredAuthError.prototype),C}return _tslib_extends(InteractionRequiredAuthError,c),InteractionRequiredAuthError.isInteractionRequiredError=function(c,y,v){var w=!!c&&Go.indexOf(c)>-1,C=!!v&&zo.indexOf(v)>-1,b=!!y&&Go.some((function(c){return y.indexOf(c)>-1}));return w||b||C},InteractionRequiredAuthError.createNoTokensFoundError=function(){return new InteractionRequiredAuthError(Wo.code,Wo.desc)},InteractionRequiredAuthError.createNativeAccountUnavailableError=function(){return new InteractionRequiredAuthError(Ko.code,Ko.desc)},InteractionRequiredAuthError}(or),$o=function(c){function ServerError(y,v,w){var C=c.call(this,y,v,w)||this;return C.name="ServerError",Object.setPrototypeOf(C,ServerError.prototype),C}return _tslib_extends(ServerError,c),ServerError}(or);
/*! @azure/msal-common v7.3.0 2022-08-01 */
function buildClientInfo(c,y){if(fn.isEmpty(c))throw pn.createClientInfoEmptyError();try{var v=y.base64Decode(c);return JSON.parse(v)}catch(c){throw pn.createClientInfoDecodingError(c)}}function buildClientInfoFromHomeAccountId(c){if(fn.isEmpty(c))throw pn.createClientInfoDecodingError("Home account ID was empty.");var y=c.split(Ie.CLIENT_INFO_SEPARATOR,2);return{uid:y[0],utid:y.length<2?ne.EMPTY_STRING:y[1]}}!function(c){c[c.Default=0]="Default",c[c.Adfs=1]="Adfs"}(Fo||(Fo={}));
/*! @azure/msal-common v7.3.0 2022-08-01 */
var Yo,Jo=function(){function AccountEntity(){}return AccountEntity.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ie.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.prototype.generateAccountKey=function(){return AccountEntity.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},AccountEntity.prototype.generateType=function(){switch(this.authorityType){case Ee.ADFS_ACCOUNT_TYPE:return Ve.ADFS;case Ee.MSAV1_ACCOUNT_TYPE:return Ve.MSA;case Ee.MSSTS_ACCOUNT_TYPE:return Ve.MSSTS;case Ee.GENERIC_ACCOUNT_TYPE:return Ve.GENERIC;default:throw pn.createUnexpectedAccountTypeError()}},AccountEntity.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},AccountEntity.generateAccountCacheKey=function(c){return[c.homeAccountId,c.environment||ne.EMPTY_STRING,c.tenantId||ne.EMPTY_STRING].join(Ie.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.createAccount=function(c,y,v,w,C,b,S,T){var I,P,K,Q,X,te,re=new AccountEntity;re.authorityType=Ee.MSSTS_ACCOUNT_TYPE,re.clientInfo=c,re.homeAccountId=y,re.nativeAccountId=T;var oe=S||w&&w.getPreferredCache();if(!oe)throw pn.createInvalidCacheEnvironmentError();return re.environment=oe,re.realm=(null===(I=null==v?void 0:v.claims)||void 0===I?void 0:I.tid)||ne.EMPTY_STRING,v&&(re.idTokenClaims=v.claims,re.localAccountId=(null===(P=null==v?void 0:v.claims)||void 0===P?void 0:P.oid)||(null===(K=null==v?void 0:v.claims)||void 0===K?void 0:K.sub)||ne.EMPTY_STRING,re.username=(null===(Q=null==v?void 0:v.claims)||void 0===Q?void 0:Q.preferred_username)||((null===(X=null==v?void 0:v.claims)||void 0===X?void 0:X.emails)?v.claims.emails[0]:ne.EMPTY_STRING),re.name=null===(te=null==v?void 0:v.claims)||void 0===te?void 0:te.name),re.cloudGraphHostName=C,re.msGraphHost=b,re},AccountEntity.createGenericAccount=function(c,y,v,w,C,b){var S,T,I,P,K=new AccountEntity;K.authorityType=v&&v.authorityType===Fo.Adfs?Ee.ADFS_ACCOUNT_TYPE:Ee.GENERIC_ACCOUNT_TYPE,K.homeAccountId=c,K.realm=ne.EMPTY_STRING;var Q=b||v&&v.getPreferredCache();if(!Q)throw pn.createInvalidCacheEnvironmentError();return y&&(K.localAccountId=(null===(S=null==y?void 0:y.claims)||void 0===S?void 0:S.oid)||(null===(T=null==y?void 0:y.claims)||void 0===T?void 0:T.sub)||ne.EMPTY_STRING,K.username=(null===(I=null==y?void 0:y.claims)||void 0===I?void 0:I.upn)||ne.EMPTY_STRING,K.name=(null===(P=null==y?void 0:y.claims)||void 0===P?void 0:P.name)||ne.EMPTY_STRING,K.idTokenClaims=null==y?void 0:y.claims),K.environment=Q,K.cloudGraphHostName=w,K.msGraphHost=C,K},AccountEntity.generateHomeAccountId=function(c,y,v,w,C){var b,S=(null===(b=null==C?void 0:C.claims)||void 0===b?void 0:b.sub)?C.claims.sub:ne.EMPTY_STRING;if(y===Fo.Adfs)return S;if(c)try{var T=buildClientInfo(c,w);if(!fn.isEmpty(T.uid)&&!fn.isEmpty(T.utid))return""+T.uid+Ie.CLIENT_INFO_SEPARATOR+T.utid}catch(c){}return v.verbose("No client info in response"),S},AccountEntity.isAccountEntity=function(c){return!!c&&(c.hasOwnProperty("homeAccountId")&&c.hasOwnProperty("environment")&&c.hasOwnProperty("realm")&&c.hasOwnProperty("localAccountId")&&c.hasOwnProperty("username")&&c.hasOwnProperty("authorityType"))},AccountEntity.accountInfoIsEqual=function(c,y,v){if(!c||!y)return!1;var w=!0;if(v){var C=c.idTokenClaims||{},b=y.idTokenClaims||{};w=C.iat===b.iat&&C.nonce===b.nonce}return c.homeAccountId===y.homeAccountId&&c.localAccountId===y.localAccountId&&c.username===y.username&&c.tenantId===y.tenantId&&c.environment===y.environment&&c.nativeAccountId===y.nativeAccountId&&w},AccountEntity}(),Qo=function(){function CredentialEntity(){}return CredentialEntity.prototype.generateAccountId=function(){return CredentialEntity.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},CredentialEntity.prototype.generateCredentialId=function(){return CredentialEntity.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},CredentialEntity.prototype.generateTarget=function(){return CredentialEntity.generateTargetForCacheKey(this.target)},CredentialEntity.prototype.generateCredentialKey=function(){return CredentialEntity.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},CredentialEntity.prototype.generateType=function(){switch(this.credentialType){case Ue.ID_TOKEN:return Ve.ID_TOKEN;case Ue.ACCESS_TOKEN:case Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Ve.ACCESS_TOKEN;case Ue.REFRESH_TOKEN:return Ve.REFRESH_TOKEN;default:throw pn.createUnexpectedCredentialTypeError()}},CredentialEntity.getCredentialType=function(c){return-1!==c.indexOf(Ue.ACCESS_TOKEN.toLowerCase())?-1!==c.indexOf(Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ue.ACCESS_TOKEN:-1!==c.indexOf(Ue.ID_TOKEN.toLowerCase())?Ue.ID_TOKEN:-1!==c.indexOf(Ue.REFRESH_TOKEN.toLowerCase())?Ue.REFRESH_TOKEN:ne.NOT_DEFINED},CredentialEntity.generateCredentialCacheKey=function(c,y,v,w,C,b,S,T,I){return[this.generateAccountIdForCacheKey(c,y),this.generateCredentialIdForCacheKey(v,w,C,S),this.generateTargetForCacheKey(b),this.generateClaimsHashForCacheKey(I),this.generateSchemeForCacheKey(T)].join(Ie.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateAccountIdForCacheKey=function(c,y){return[c,y].join(Ie.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateCredentialIdForCacheKey=function(c,y,v,w){return[c,c===Ue.REFRESH_TOKEN&&w||y,v||ne.EMPTY_STRING].join(Ie.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateTargetForCacheKey=function(c){return(c||ne.EMPTY_STRING).toLowerCase()},CredentialEntity.generateClaimsHashForCacheKey=function(c){return(c||ne.EMPTY_STRING).toLowerCase()},CredentialEntity.generateSchemeForCacheKey=function(c){return c&&c.toLowerCase()!==vt.BEARER.toLowerCase()?c.toLowerCase():ne.EMPTY_STRING},CredentialEntity}(),Zo={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Xo={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},ei={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},ti={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},ri={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},ni={code:"empty_url_error",desc:"URL was empty or null."},oi={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},ii={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},ai={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},si={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},ci={code:"token_request_empty",desc:"Token request was empty and not found in cache."},ui={code:"logout_request_empty",desc:"The logout request was null or undefined."},li={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},di={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},hi={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},pi={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},fi={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},gi={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},mi={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},yi={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},vi={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},wi={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},Ei=function(c){function ClientConfigurationError(y,v){var w=c.call(this,y,v)||this;return w.name="ClientConfigurationError",Object.setPrototypeOf(w,ClientConfigurationError.prototype),w}return _tslib_extends(ClientConfigurationError,c),ClientConfigurationError.createRedirectUriEmptyError=function(){return new ClientConfigurationError(Zo.code,Zo.desc)},ClientConfigurationError.createPostLogoutRedirectUriEmptyError=function(){return new ClientConfigurationError(Xo.code,Xo.desc)},ClientConfigurationError.createClaimsRequestParsingError=function(c){return new ClientConfigurationError(ei.code,ei.desc+" Given value: "+c)},ClientConfigurationError.createInsecureAuthorityUriError=function(c){return new ClientConfigurationError(ti.code,ti.desc+" Given URI: "+c)},ClientConfigurationError.createUrlParseError=function(c){return new ClientConfigurationError(ri.code,ri.desc+" Given Error: "+c)},ClientConfigurationError.createUrlEmptyError=function(){return new ClientConfigurationError(ni.code,ni.desc)},ClientConfigurationError.createEmptyScopesArrayError=function(){return new ClientConfigurationError(oi.code,""+oi.desc)},ClientConfigurationError.createClientIdSingleScopeError=function(c){return new ClientConfigurationError(ii.code,ii.desc+" Given Scopes: "+c)},ClientConfigurationError.createInvalidPromptError=function(c){return new ClientConfigurationError(ai.code,ai.desc+" Given value: "+c)},ClientConfigurationError.createInvalidClaimsRequestError=function(){return new ClientConfigurationError(si.code,si.desc)},ClientConfigurationError.createEmptyLogoutRequestError=function(){return new ClientConfigurationError(ui.code,ui.desc)},ClientConfigurationError.createEmptyTokenRequestError=function(){return new ClientConfigurationError(ci.code,ci.desc)},ClientConfigurationError.createInvalidCodeChallengeMethodError=function(){return new ClientConfigurationError(li.code,li.desc)},ClientConfigurationError.createInvalidCodeChallengeParamsError=function(){return new ClientConfigurationError(di.code,di.desc)},ClientConfigurationError.createInvalidCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(hi.code,hi.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(pi.code,pi.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(){return new ClientConfigurationError(fi.code,fi.desc)},ClientConfigurationError.createInvalidAzureCloudInstanceError=function(){return new ClientConfigurationError(gi.code,gi.desc)},ClientConfigurationError.createMissingSshJwkError=function(){return new ClientConfigurationError(mi.code,mi.desc)},ClientConfigurationError.createMissingSshKidError=function(){return new ClientConfigurationError(yi.code,yi.desc)},ClientConfigurationError.createMissingNonceAuthenticationHeadersError=function(){return new ClientConfigurationError(vi.code,vi.desc)},ClientConfigurationError.createInvalidAuthenticationHeaderError=function(c,y){return new ClientConfigurationError(wi.code,wi.desc+". Invalid header: "+c+". Details: "+y)},ClientConfigurationError}(pn),Ci=function(){function ScopeSet(c){var y=this,v=c?fn.trimArrayEntries(__spreadArrays(c)):[],w=v?fn.removeEmptyStringsFromArray(v):[];this.validateInputScopes(w),this.scopes=new Set,w.forEach((function(c){return y.scopes.add(c)}))}return ScopeSet.fromString=function(c){return new ScopeSet((c||ne.EMPTY_STRING).split(" "))},ScopeSet.prototype.validateInputScopes=function(c){if(!c||c.length<1)throw Ei.createEmptyScopesArrayError()},ScopeSet.prototype.containsScope=function(c){var y=new ScopeSet(this.printScopesLowerCase().split(" "));return!fn.isEmpty(c)&&y.scopes.has(c.toLowerCase())},ScopeSet.prototype.containsScopeSet=function(c){var y=this;return!(!c||c.scopes.size<=0)&&(this.scopes.size>=c.scopes.size&&c.asArray().every((function(c){return y.containsScope(c)})))},ScopeSet.prototype.containsOnlyOIDCScopes=function(){var c=this,y=0;return ie.forEach((function(v){c.containsScope(v)&&(y+=1)})),this.scopes.size===y},ScopeSet.prototype.appendScope=function(c){fn.isEmpty(c)||this.scopes.add(c.trim())},ScopeSet.prototype.appendScopes=function(c){var y=this;try{c.forEach((function(c){return y.appendScope(c)}))}catch(c){throw pn.createAppendScopeSetError(c)}},ScopeSet.prototype.removeScope=function(c){if(fn.isEmpty(c))throw pn.createRemoveEmptyScopeFromSetError(c);this.scopes.delete(c.trim())},ScopeSet.prototype.removeOIDCScopes=function(){var c=this;ie.forEach((function(y){c.scopes.delete(y)}))},ScopeSet.prototype.unionScopeSets=function(c){if(!c)throw pn.createEmptyInputScopeSetError();var y=new Set;return c.scopes.forEach((function(c){return y.add(c.toLowerCase())})),this.scopes.forEach((function(c){return y.add(c.toLowerCase())})),y},ScopeSet.prototype.intersectingScopeSets=function(c){if(!c)throw pn.createEmptyInputScopeSetError();c.containsOnlyOIDCScopes()||c.removeOIDCScopes();var y=this.unionScopeSets(c),v=c.getScopeCount(),w=this.getScopeCount();return y.size<w+v},ScopeSet.prototype.getScopeCount=function(){return this.scopes.size},ScopeSet.prototype.asArray=function(){var c=[];return this.scopes.forEach((function(y){return c.push(y)})),c},ScopeSet.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):ne.EMPTY_STRING},ScopeSet.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},ScopeSet}(),_i=function(){function AuthToken(c,y){if(fn.isEmpty(c))throw pn.createTokenNullOrEmptyError(c);this.rawToken=c,this.claims=AuthToken.extractTokenClaims(c,y)}return AuthToken.extractTokenClaims=function(c,y){var v=fn.decodeAuthToken(c);try{var w=v.JWSPayload,C=y.base64Decode(w);return JSON.parse(C)}catch(c){throw pn.createTokenParsingError(c)}},AuthToken}(),bi=function(){function CacheManager(c,y){this.clientId=c,this.cryptoImpl=y}return CacheManager.prototype.getAllAccounts=function(){var c=this,y=this.getAccountsFilteredBy(),v=Object.keys(y).map((function(c){return y[c]}));return v.length<1?[]:v.map((function(y){var v=CacheManager.toObject(new Jo,y).getAccountInfo(),w=c.readIdTokenFromCache(c.clientId,v);return w&&!v.idTokenClaims&&(v.idTokenClaims=new _i(w.secret,c.cryptoImpl).claims),v}))},CacheManager.prototype.saveCacheRecord=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(y){switch(y.label){case 0:if(!c)throw pn.createNullOrUndefinedCacheRecord();return c.account&&this.setAccount(c.account),c.idToken&&this.setIdTokenCredential(c.idToken),c.accessToken?[4,this.saveAccessToken(c.accessToken)]:[3,2];case 1:y.sent(),y.label=2;case 2:return c.refreshToken&&this.setRefreshTokenCredential(c.refreshToken),c.appMetadata&&this.setAppMetadata(c.appMetadata),[2]}}))}))},CacheManager.prototype.saveAccessToken=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v,w,C,b=this;return _tslib_generator(this,(function(S){switch(S.label){case 0:return y=this.getCredentialsFilteredBy({clientId:c.clientId,credentialType:c.credentialType,environment:c.environment,homeAccountId:c.homeAccountId,realm:c.realm,tokenType:c.tokenType,requestedClaimsHash:c.requestedClaimsHash}),v=Ci.fromString(c.target),(w=Object.keys(y.accessTokens).map((function(c){return y.accessTokens[c]})))?(C=[],w.forEach((function(c){Ci.fromString(c.target).intersectingScopeSets(v)&&C.push(b.removeCredential(c))})),[4,Promise.all(C)]):[3,2];case 1:S.sent(),S.label=2;case 2:return this.setAccessTokenCredential(c),[2]}}))}))},CacheManager.prototype.getAccountsFilteredBy=function(c){return this.getAccountsFilteredByInternal(c?c.homeAccountId:ne.EMPTY_STRING,c?c.environment:ne.EMPTY_STRING,c?c.realm:ne.EMPTY_STRING,c?c.nativeAccountId:ne.EMPTY_STRING)},CacheManager.prototype.getAccountsFilteredByInternal=function(c,y,v,w){var C=this,b=this.getKeys(),S={};return b.forEach((function(b){var T=C.getAccount(b);T&&(c&&!C.matchHomeAccountId(T,c)||y&&!C.matchEnvironment(T,y)||v&&!C.matchRealm(T,v)||w&&!C.matchNativeAccountId(T,w)||(S[b]=T))})),S},CacheManager.prototype.getCredentialsFilteredBy=function(c){return this.getCredentialsFilteredByInternal(c.homeAccountId,c.environment,c.credentialType,c.clientId,c.familyId,c.realm,c.target,c.userAssertionHash,c.tokenType,c.keyId,c.requestedClaimsHash)},CacheManager.prototype.getCredentialsFilteredByInternal=function(c,y,v,w,C,b,S,T,I,P,K){var Q=this,X=this.getKeys(),te={idTokens:{},accessTokens:{},refreshTokens:{}};return X.forEach((function(X){var re=Qo.getCredentialType(X);if(re!==ne.NOT_DEFINED){var oe=Q.getSpecificCredential(X,re);if(oe&&(!T||Q.matchUserAssertionHash(oe,T))&&(!c||Q.matchHomeAccountId(oe,c))&&(!y||Q.matchEnvironment(oe,y))&&(!b||Q.matchRealm(oe,b))&&(!v||Q.matchCredentialType(oe,v))&&(!w||Q.matchClientId(oe,w))&&(!C||Q.matchFamilyId(oe,C))&&(!S||Q.matchTarget(oe,S))&&(!K&&!oe.requestedClaimsHash||oe.requestedClaimsHash===K)){if(v===Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(I&&!Q.matchTokenType(oe,I))return;if(I===vt.SSH&&P&&!Q.matchKeyId(oe,P))return}var ie=Q.updateCredentialCacheKey(X,oe);switch(re){case Ue.ID_TOKEN:te.idTokens[ie]=oe;break;case Ue.ACCESS_TOKEN:case Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:te.accessTokens[ie]=oe;break;case Ue.REFRESH_TOKEN:te.refreshTokens[ie]=oe}}}})),te},CacheManager.prototype.getAppMetadataFilteredBy=function(c){return this.getAppMetadataFilteredByInternal(c.environment,c.clientId)},CacheManager.prototype.getAppMetadataFilteredByInternal=function(c,y){var v=this,w=this.getKeys(),C={};return w.forEach((function(w){if(v.isAppMetadata(w)){var b=v.getAppMetadata(w);b&&(c&&!v.matchEnvironment(b,c)||y&&!v.matchClientId(b,y)||(C[w]=b))}})),C},CacheManager.prototype.getAuthorityMetadataByAlias=function(c){var y=this,v=this.getAuthorityMetadataKeys(),w=null;return v.forEach((function(v){if(y.isAuthorityMetadata(v)&&-1!==v.indexOf(y.clientId)){var C=y.getAuthorityMetadata(v);C&&-1!==C.aliases.indexOf(c)&&(w=C)}})),w},CacheManager.prototype.removeAllAccounts=function(){return _tslib_awaiter(this,void 0,void 0,(function(){var c,y,v=this;return _tslib_generator(this,(function(w){switch(w.label){case 0:return c=this.getKeys(),y=[],c.forEach((function(c){v.getAccount(c)&&y.push(v.removeAccount(c))})),[4,Promise.all(y)];case 1:return w.sent(),[2,!0]}}))}))},CacheManager.prototype.removeAccount=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y;return _tslib_generator(this,(function(v){switch(v.label){case 0:if(!(y=this.getAccount(c)))throw pn.createNoAccountFoundError();return[4,this.removeAccountContext(y)];case 1:return[2,v.sent()&&this.removeItem(c,Ke.ACCOUNT)]}}))}))},CacheManager.prototype.removeAccountContext=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v,w,C=this;return _tslib_generator(this,(function(b){switch(b.label){case 0:return y=this.getKeys(),v=c.generateAccountId(),w=[],y.forEach((function(c){var y=Qo.getCredentialType(c);if(y!==ne.NOT_DEFINED){var b=C.getSpecificCredential(c,y);b&&v===b.generateAccountId()&&w.push(C.removeCredential(b))}})),[4,Promise.all(w)];case 1:return b.sent(),[2,!0]}}))}))},CacheManager.prototype.removeCredential=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v;return _tslib_generator(this,(function(w){switch(w.label){case 0:if(y=c.generateCredentialKey(),c.credentialType.toLowerCase()!==Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(c.tokenType!==vt.POP)return[3,4];if(!(v=c.keyId))return[3,4];w.label=1;case 1:return w.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(v)];case 2:return w.sent(),[3,4];case 3:throw w.sent(),pn.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(y,Ke.CREDENTIAL)]}}))}))},CacheManager.prototype.removeAppMetadata=function(){var c=this;return this.getKeys().forEach((function(y){c.isAppMetadata(y)&&c.removeItem(y,Ke.APP_METADATA)})),!0},CacheManager.prototype.readCacheRecord=function(c,y,v,w){var C=this.readAccountFromCache(c),b=this.readIdTokenFromCache(y,c),S=this.readAccessTokenFromCache(y,c,v),T=this.readRefreshTokenFromCache(y,c,!1),I=this.readAppMetadataFromCache(w,y);return C&&b&&(C.idTokenClaims=new _i(b.secret,this.cryptoImpl).claims),{account:C,idToken:b,accessToken:S,refreshToken:T,appMetadata:I}},CacheManager.prototype.readAccountFromCache=function(c){var y=Jo.generateAccountCacheKey(c);return this.getAccount(y)},CacheManager.prototype.readAccountFromCacheWithNativeAccountId=function(c){var y={nativeAccountId:c},v=this.getAccountsFilteredBy(y),w=Object.keys(v).map((function(c){return v[c]}));if(w.length<1)return null;if(w.length>1)throw pn.createMultipleMatchingAccountsInCacheError();return v[0]},CacheManager.prototype.readIdTokenFromCache=function(c,y){var v={homeAccountId:y.homeAccountId,environment:y.environment,credentialType:Ue.ID_TOKEN,clientId:c,realm:y.tenantId},w=this.getCredentialsFilteredBy(v),C=Object.keys(w.idTokens).map((function(c){return w.idTokens[c]})),b=C.length;if(b<1)return null;if(b>1)throw pn.createMultipleMatchingTokensInCacheError();return C[0]},CacheManager.prototype.readAccessTokenFromCache=function(c,y,v){var w=new Ci(v.scopes||[]),C=v.authenticationScheme||vt.BEARER,b=C&&C.toLowerCase()!==vt.BEARER.toLowerCase()?Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ue.ACCESS_TOKEN,S={homeAccountId:y.homeAccountId,environment:y.environment,credentialType:b,clientId:c,realm:y.tenantId,target:w.printScopesLowerCase(),tokenType:C,keyId:v.sshKid,requestedClaimsHash:v.requestedClaimsHash},T=this.getCredentialsFilteredBy(S),I=Object.keys(T.accessTokens).map((function(c){return T.accessTokens[c]})),P=I.length;if(P<1)return null;if(P>1)throw pn.createMultipleMatchingTokensInCacheError();return I[0]},CacheManager.prototype.readRefreshTokenFromCache=function(c,y,v){var w=v?Ze:void 0,C={homeAccountId:y.homeAccountId,environment:y.environment,credentialType:Ue.REFRESH_TOKEN,clientId:c,familyId:w},b=this.getCredentialsFilteredBy(C),S=Object.keys(b.refreshTokens).map((function(c){return b.refreshTokens[c]}));return S.length<1?null:S[0]},CacheManager.prototype.readAppMetadataFromCache=function(c,y){var v={environment:c,clientId:y},w=this.getAppMetadataFilteredBy(v),C=Object.keys(w).map((function(c){return w[c]})),b=C.length;if(b<1)return null;if(b>1)throw pn.createMultipleMatchingAppMetadataInCacheError();return C[0]},CacheManager.prototype.isAppMetadataFOCI=function(c,y){var v=this.readAppMetadataFromCache(c,y);return!(!v||v.familyId!==Ze)},CacheManager.prototype.matchHomeAccountId=function(c,y){return!(!c.homeAccountId||y!==c.homeAccountId)},CacheManager.prototype.matchUserAssertionHash=function(c,y){return!(!c.userAssertionHash||y!==c.userAssertionHash)},CacheManager.prototype.matchEnvironment=function(c,y){var v=this.getAuthorityMetadataByAlias(y);return!!(v&&v.aliases.indexOf(c.environment)>-1)},CacheManager.prototype.matchCredentialType=function(c,y){return c.credentialType&&y.toLowerCase()===c.credentialType.toLowerCase()},CacheManager.prototype.matchClientId=function(c,y){return!(!c.clientId||y!==c.clientId)},CacheManager.prototype.matchFamilyId=function(c,y){return!(!c.familyId||y!==c.familyId)},CacheManager.prototype.matchRealm=function(c,y){return!(!c.realm||y!==c.realm)},CacheManager.prototype.matchNativeAccountId=function(c,y){return!(!c.nativeAccountId||y!==c.nativeAccountId)},CacheManager.prototype.matchTarget=function(c,y){if(c.credentialType!==Ue.ACCESS_TOKEN&&c.credentialType!==Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME||!c.target)return!1;var v=Ci.fromString(c.target),w=Ci.fromString(y);return w.containsOnlyOIDCScopes()?w.removeScope(ne.OFFLINE_ACCESS_SCOPE):w.removeOIDCScopes(),v.containsScopeSet(w)},CacheManager.prototype.matchTokenType=function(c,y){return!(!c.tokenType||c.tokenType!==y)},CacheManager.prototype.matchKeyId=function(c,y){return!(!c.keyId||c.keyId!==y)},CacheManager.prototype.isAppMetadata=function(c){return-1!==c.indexOf(Qe)},CacheManager.prototype.isAuthorityMetadata=function(c){return-1!==c.indexOf(Xe)},CacheManager.prototype.generateAuthorityMetadataCacheKey=function(c){return Xe+"-"+this.clientId+"-"+c},CacheManager.prototype.getSpecificCredential=function(c,y){switch(y){case Ue.ID_TOKEN:return this.getIdTokenCredential(c);case Ue.ACCESS_TOKEN:case Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(c);case Ue.REFRESH_TOKEN:return this.getRefreshTokenCredential(c);default:return null}},CacheManager.toObject=function(c,y){for(var v in y)c[v]=y[v];return c},CacheManager}(),Si=function(c){function DefaultStorageClass(){return null!==c&&c.apply(this,arguments)||this}return _tslib_extends(DefaultStorageClass,c),DefaultStorageClass.prototype.setAccount=function(){throw or.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccount=function(){throw or.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setIdTokenCredential=function(){throw or.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getIdTokenCredential=function(){throw or.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAccessTokenCredential=function(){throw or.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccessTokenCredential=function(){throw or.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setRefreshTokenCredential=function(){throw or.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getRefreshTokenCredential=function(){throw or.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAppMetadata=function(){throw or.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAppMetadata=function(){throw or.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setServerTelemetry=function(){throw or.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getServerTelemetry=function(){throw or.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAuthorityMetadata=function(){throw or.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadata=function(){throw or.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadataKeys=function(){throw or.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setThrottlingCache=function(){throw or.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getThrottlingCache=function(){throw or.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.removeItem=function(){throw or.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.containsKey=function(){throw or.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getKeys=function(){throw or.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.clear=function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",or.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},DefaultStorageClass.prototype.updateCredentialCacheKey=function(){throw or.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass}(bi),Ti=function(c){function IdTokenEntity(){return null!==c&&c.apply(this,arguments)||this}return _tslib_extends(IdTokenEntity,c),IdTokenEntity.createIdTokenEntity=function(c,y,v,w,C){var b=new IdTokenEntity;return b.credentialType=Ue.ID_TOKEN,b.homeAccountId=c,b.environment=y,b.clientId=w,b.secret=v,b.realm=C,b},IdTokenEntity.isIdTokenEntity=function(c){return!!c&&(c.hasOwnProperty("homeAccountId")&&c.hasOwnProperty("environment")&&c.hasOwnProperty("credentialType")&&c.hasOwnProperty("realm")&&c.hasOwnProperty("clientId")&&c.hasOwnProperty("secret")&&c.credentialType===Ue.ID_TOKEN)},IdTokenEntity}(Qo),Ai=function(){function TimeUtils(){}return TimeUtils.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.isTokenExpired=function(c,y){var v=Number(c)||0;return TimeUtils.nowSeconds()+y>v},TimeUtils.wasClockTurnedBack=function(c){return Number(c)>TimeUtils.nowSeconds()},TimeUtils.delay=function(c,y){return new Promise((function(v){return setTimeout((function(){return v(y)}),c)}))},TimeUtils}(),Ii=function(c){function AccessTokenEntity(){return null!==c&&c.apply(this,arguments)||this}return _tslib_extends(AccessTokenEntity,c),AccessTokenEntity.createAccessTokenEntity=function(c,y,v,w,C,b,S,T,I,P,K,Q,X,te,re){var ne,oe,ie=new AccessTokenEntity;ie.homeAccountId=c,ie.credentialType=Ue.ACCESS_TOKEN,ie.secret=v;var se=Ai.nowSeconds();if(ie.cachedAt=se.toString(),ie.expiresOn=S.toString(),ie.extendedExpiresOn=T.toString(),P&&(ie.refreshOn=P.toString()),ie.environment=y,ie.clientId=w,ie.realm=C,ie.target=b,ie.userAssertionHash=Q,ie.tokenType=fn.isEmpty(K)?vt.BEARER:K,te&&(ie.requestedClaims=te,ie.requestedClaimsHash=re),(null===(ne=ie.tokenType)||void 0===ne?void 0:ne.toLowerCase())!==vt.BEARER.toLowerCase())switch(ie.credentialType=Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME,ie.tokenType){case vt.POP:var ue=_i.extractTokenClaims(v,I);if(!(null===(oe=null==ue?void 0:ue.cnf)||void 0===oe?void 0:oe.kid))throw pn.createTokenClaimsRequiredError();ie.keyId=ue.cnf.kid;break;case vt.SSH:ie.keyId=X}return ie},AccessTokenEntity.isAccessTokenEntity=function(c){return!!c&&(c.hasOwnProperty("homeAccountId")&&c.hasOwnProperty("environment")&&c.hasOwnProperty("credentialType")&&c.hasOwnProperty("realm")&&c.hasOwnProperty("clientId")&&c.hasOwnProperty("secret")&&c.hasOwnProperty("target")&&(c.credentialType===Ue.ACCESS_TOKEN||c.credentialType===Ue.ACCESS_TOKEN_WITH_AUTH_SCHEME))},AccessTokenEntity}(Qo),Ri=function(c){function RefreshTokenEntity(){return null!==c&&c.apply(this,arguments)||this}return _tslib_extends(RefreshTokenEntity,c),RefreshTokenEntity.createRefreshTokenEntity=function(c,y,v,w,C,b){var S=new RefreshTokenEntity;return S.clientId=w,S.credentialType=Ue.REFRESH_TOKEN,S.environment=y,S.homeAccountId=c,S.secret=v,S.userAssertionHash=b,C&&(S.familyId=C),S},RefreshTokenEntity.isRefreshTokenEntity=function(c){return!!c&&(c.hasOwnProperty("homeAccountId")&&c.hasOwnProperty("environment")&&c.hasOwnProperty("credentialType")&&c.hasOwnProperty("clientId")&&c.hasOwnProperty("secret")&&c.credentialType===Ue.REFRESH_TOKEN)},RefreshTokenEntity}(Qo),ki=function(){function AppMetadataEntity(){}return AppMetadataEntity.prototype.generateAppMetadataKey=function(){return AppMetadataEntity.generateAppMetadataCacheKey(this.environment,this.clientId)},AppMetadataEntity.generateAppMetadataCacheKey=function(c,y){return[Qe,c,y].join(Ie.CACHE_KEY_SEPARATOR).toLowerCase()},AppMetadataEntity.createAppMetadataEntity=function(c,y,v){var w=new AppMetadataEntity;return w.clientId=c,w.environment=y,v&&(w.familyId=v),w},AppMetadataEntity.isAppMetadataEntity=function(c,y){return!!y&&(0===c.indexOf(Qe)&&y.hasOwnProperty("clientId")&&y.hasOwnProperty("environment"))},AppMetadataEntity}(),Pi=function(){function ServerTelemetryEntity(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return ServerTelemetryEntity.isServerTelemetryEntity=function(c,y){var v=0===c.indexOf(wt.CACHE_KEY),w=!0;return y&&(w=y.hasOwnProperty("failedRequests")&&y.hasOwnProperty("errors")&&y.hasOwnProperty("cacheHits")),v&&w},ServerTelemetryEntity}(),Oi=function(){function AuthorityMetadataEntity(){this.expiresAt=Ai.nowSeconds()+yt}return AuthorityMetadataEntity.prototype.updateCloudDiscoveryMetadata=function(c,y){this.aliases=c.aliases,this.preferred_cache=c.preferred_cache,this.preferred_network=c.preferred_network,this.aliasesFromNetwork=y},AuthorityMetadataEntity.prototype.updateEndpointMetadata=function(c,y){this.authorization_endpoint=c.authorization_endpoint,this.token_endpoint=c.token_endpoint,this.end_session_endpoint=c.end_session_endpoint,this.issuer=c.issuer,this.endpointsFromNetwork=y,this.jwks_uri=c.jwks_uri},AuthorityMetadataEntity.prototype.updateCanonicalAuthority=function(c){this.canonical_authority=c},AuthorityMetadataEntity.prototype.resetExpiresAt=function(){this.expiresAt=Ai.nowSeconds()+yt},AuthorityMetadataEntity.prototype.isExpired=function(){return this.expiresAt<=Ai.nowSeconds()},AuthorityMetadataEntity.isAuthorityMetadataEntity=function(c,y){return!!y&&(0===c.indexOf(Xe)&&y.hasOwnProperty("aliases")&&y.hasOwnProperty("preferred_cache")&&y.hasOwnProperty("preferred_network")&&y.hasOwnProperty("canonical_authority")&&y.hasOwnProperty("authorization_endpoint")&&y.hasOwnProperty("token_endpoint")&&y.hasOwnProperty("issuer")&&y.hasOwnProperty("aliasesFromNetwork")&&y.hasOwnProperty("endpointsFromNetwork")&&y.hasOwnProperty("expiresAt")&&y.hasOwnProperty("jwks_uri"))},AuthorityMetadataEntity}(),Ni=function(){function ThrottlingEntity(){}return ThrottlingEntity.isThrottlingEntity=function(c,y){var v=!1;c&&(v=0===c.indexOf(kt));var w=!0;return y&&(w=y.hasOwnProperty("throttleTime")),v&&w},ThrottlingEntity}(),Mi=function(){function ProtocolUtils(){}return ProtocolUtils.setRequestState=function(c,y,v){var w=ProtocolUtils.generateLibraryState(c,v);return fn.isEmpty(y)?w:""+w+ne.RESOURCE_DELIM+y},ProtocolUtils.generateLibraryState=function(c,y){if(!c)throw pn.createNoCryptoObjectError("generateLibraryState");var v={id:c.createNewGuid()};y&&(v.meta=y);var w=JSON.stringify(v);return c.base64Encode(w)},ProtocolUtils.parseRequestState=function(c,y){if(!c)throw pn.createNoCryptoObjectError("parseRequestState");if(fn.isEmpty(y))throw pn.createInvalidStateError(y,"Null, undefined or empty state");try{var v=y.split(ne.RESOURCE_DELIM),w=v[0],C=v.length>1?v.slice(1).join(ne.RESOURCE_DELIM):ne.EMPTY_STRING,b=c.base64Decode(w),S=JSON.parse(b);return{userRequestState:fn.isEmpty(C)?ne.EMPTY_STRING:C,libraryState:S}}catch(c){throw pn.createInvalidStateError(y,c)}},ProtocolUtils}();!function(c){c.HOME_ACCOUNT_ID="home_account_id",c.UPN="UPN"}(Yo||(Yo={}));
/*! @azure/msal-browser v2.28.1 2022-08-01 */
var xi,Ui,Li={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Fi={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Hi={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},Bi={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Di={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},qi={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},ji=function(c){function BrowserConfigurationAuthError(y,v){var w=c.call(this,y,v)||this;return w.name="BrowserConfigurationAuthError",Object.setPrototypeOf(w,BrowserConfigurationAuthError.prototype),w}return __extends(BrowserConfigurationAuthError,c),BrowserConfigurationAuthError.createRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Li.code,Li.desc)},BrowserConfigurationAuthError.createPostLogoutRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Fi.code,Fi.desc)},BrowserConfigurationAuthError.createStorageNotSupportedError=function(c){return new BrowserConfigurationAuthError(Hi.code,Hi.desc+" Given Location: "+c)},BrowserConfigurationAuthError.createRedirectCallbacksNotSetError=function(){return new BrowserConfigurationAuthError(Bi.code,Bi.desc)},BrowserConfigurationAuthError.createStubPcaInstanceCalledError=function(){return new BrowserConfigurationAuthError(Di.code,Di.desc)},BrowserConfigurationAuthError.createInMemoryRedirectUnavailableError=function(){return new BrowserConfigurationAuthError(qi.code,qi.desc)},BrowserConfigurationAuthError}(or),Gi=function(){function BrowserStorage(c){this.validateWindowStorage(c),this.windowStorage=window[c]}return BrowserStorage.prototype.validateWindowStorage=function(c){if(c!==Ut.LocalStorage&&c!==Ut.SessionStorage)throw ji.createStorageNotSupportedError(c);if(!!!window[c])throw ji.createStorageNotSupportedError(c)},BrowserStorage.prototype.getItem=function(c){return this.windowStorage.getItem(c)},BrowserStorage.prototype.setItem=function(c,y){this.windowStorage.setItem(c,y)},BrowserStorage.prototype.removeItem=function(c){this.windowStorage.removeItem(c)},BrowserStorage.prototype.getKeys=function(){return Object.keys(this.windowStorage)},BrowserStorage.prototype.containsKey=function(c){return this.windowStorage.hasOwnProperty(c)},BrowserStorage}(),zi=function(){function UrlString(c){if(this._urlString=c,fn.isEmpty(this._urlString))throw Ei.createUrlEmptyError();fn.isEmpty(this.getHash())&&(this._urlString=UrlString.canonicalizeUri(c))}return Object.defineProperty(UrlString.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),UrlString.canonicalizeUri=function(c){if(c){var y=c.toLowerCase();return fn.endsWith(y,"?")?y=y.slice(0,-1):fn.endsWith(y,"?/")&&(y=y.slice(0,-2)),fn.endsWith(y,"/")||(y+="/"),y}return c},UrlString.prototype.validateAsUri=function(){var c;try{c=this.getUrlComponents()}catch(c){throw Ei.createUrlParseError(c)}if(!c.HostNameAndPort||!c.PathSegments)throw Ei.createUrlParseError("Given url string: "+this.urlString);if(!c.Protocol||"https:"!==c.Protocol.toLowerCase())throw Ei.createInsecureAuthorityUriError(this.urlString)},UrlString.appendQueryString=function(c,y){return fn.isEmpty(y)?c:c.indexOf("?")<0?c+"?"+y:c+"&"+y},UrlString.removeHashFromUrl=function(c){return UrlString.canonicalizeUri(c.split("#")[0])},UrlString.prototype.replaceTenantPath=function(c){var y=this.getUrlComponents(),v=y.PathSegments;return!c||0===v.length||v[0]!==X.COMMON&&v[0]!==X.ORGANIZATIONS||(v[0]=c),UrlString.constructAuthorityUriFromObject(y)},UrlString.prototype.getHash=function(){return UrlString.parseHash(this.urlString)},UrlString.prototype.getUrlComponents=function(){var c=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),y=this.urlString.match(c);if(!y)throw Ei.createUrlParseError("Given url string: "+this.urlString);var v={Protocol:y[1],HostNameAndPort:y[4],AbsolutePath:y[5],QueryString:y[7]},w=v.AbsolutePath.split("/");return w=w.filter((function(c){return c&&c.length>0})),v.PathSegments=w,!fn.isEmpty(v.QueryString)&&v.QueryString.endsWith("/")&&(v.QueryString=v.QueryString.substring(0,v.QueryString.length-1)),v},UrlString.getDomainFromUrl=function(c){var y=RegExp("^([^:/?#]+://)?([^/?#]*)"),v=c.match(y);if(!v)throw Ei.createUrlParseError("Given url string: "+c);return v[2]},UrlString.getAbsoluteUrl=function(c,y){if(c[0]===ne.FORWARD_SLASH){var v=new UrlString(y).getUrlComponents();return v.Protocol+"//"+v.HostNameAndPort+c}return c},UrlString.parseHash=function(c){var y=c.indexOf("#"),v=c.indexOf("#/");return v>-1?c.substring(v+2):y>-1?c.substring(y+1):ne.EMPTY_STRING},UrlString.constructAuthorityUriFromObject=function(c){return new UrlString(c.Protocol+"//"+c.HostNameAndPort+"/"+c.PathSegments.join("/"))},UrlString.getDeserializedHash=function(c){if(fn.isEmpty(c))return{};var y=UrlString.parseHash(c),v=fn.queryStringToObject(fn.isEmpty(y)?c:y);if(!v)throw pn.createHashNotDeserializedError(JSON.stringify(v));return v},UrlString.hashContainsKnownProperties=function(c){if(fn.isEmpty(c)||c.indexOf("=")<0)return!1;var y=UrlString.getDeserializedHash(c);return!!(y.code||y.error_description||y.error||y.state)},UrlString}(),Wi=function(){function BrowserProtocolUtils(){}return BrowserProtocolUtils.extractBrowserRequestState=function(c,y){if(fn.isEmpty(y))return null;try{return Mi.parseRequestState(c,y).libraryState.meta}catch(c){throw pn.createInvalidStateError(y,c)}},BrowserProtocolUtils.parseServerResponseFromHash=function(c){if(!c)return{};var y=new zi(c);return zi.getDeserializedHash(y.getHash())},BrowserProtocolUtils}(),Ki=function(c){function BrowserCacheManager(y,v,w,C){var b=c.call(this,y,w)||this;return b.COOKIE_LIFE_MULTIPLIER=864e5,b.cacheConfig=v,b.logger=C,b.internalStorage=new Mo,b.browserStorage=b.setupBrowserStorage(b.cacheConfig.cacheLocation),b.temporaryCacheStorage=b.setupTemporaryCacheStorage(b.cacheConfig.cacheLocation),b.migrateCacheEntries(),b}return __extends(BrowserCacheManager,c),BrowserCacheManager.prototype.setupBrowserStorage=function(c){switch(c){case Ut.LocalStorage:case Ut.SessionStorage:try{return new Gi(c)}catch(c){this.logger.verbose(c);break}}return this.cacheConfig.cacheLocation=Ut.MemoryStorage,new Mo},BrowserCacheManager.prototype.setupTemporaryCacheStorage=function(c){switch(c){case Ut.LocalStorage:case Ut.SessionStorage:try{return new Gi(Ut.SessionStorage)}catch(c){return this.logger.verbose(c),this.internalStorage}case Ut.MemoryStorage:default:return this.internalStorage}},BrowserCacheManager.prototype.migrateCacheEntries=function(){var c=this,y=ne.CACHE_PREFIX+"."+Q.ID_TOKEN,v=ne.CACHE_PREFIX+"."+Q.CLIENT_INFO,w=ne.CACHE_PREFIX+"."+Q.ERROR,C=ne.CACHE_PREFIX+"."+Q.ERROR_DESC,b=[this.browserStorage.getItem(y),this.browserStorage.getItem(v),this.browserStorage.getItem(w),this.browserStorage.getItem(C)];[Q.ID_TOKEN,Q.CLIENT_INFO,Q.ERROR,Q.ERROR_DESC].forEach((function(y,v){return c.migrateCacheEntry(y,b[v])}))},BrowserCacheManager.prototype.migrateCacheEntry=function(c,y){y&&this.setTemporaryCache(c,y,!0)},BrowserCacheManager.prototype.validateAndParseJson=function(c){try{var y=JSON.parse(c);return y&&"object"==typeof y?y:null}catch(c){return null}},BrowserCacheManager.prototype.getItem=function(c){return this.browserStorage.getItem(c)},BrowserCacheManager.prototype.setItem=function(c,y){this.browserStorage.setItem(c,y)},BrowserCacheManager.prototype.getAccount=function(c){var y=this.getItem(c);if(!y)return null;var v=this.validateAndParseJson(y);return v&&Jo.isAccountEntity(v)?bi.toObject(new Jo,v):null},BrowserCacheManager.prototype.setAccount=function(c){this.logger.trace("BrowserCacheManager.setAccount called");var y=c.generateAccountKey();this.setItem(y,JSON.stringify(c))},BrowserCacheManager.prototype.getIdTokenCredential=function(c){var y=this.getItem(c);if(!y)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var v=this.validateAndParseJson(y);return v&&Ti.isIdTokenEntity(v)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),bi.toObject(new Ti,v)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setIdTokenCredential=function(c){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var y=c.generateCredentialKey();this.setItem(y,JSON.stringify(c))},BrowserCacheManager.prototype.getAccessTokenCredential=function(c){var y=this.getItem(c);if(!y)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var v=this.validateAndParseJson(y);return v&&Ii.isAccessTokenEntity(v)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),bi.toObject(new Ii,v)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setAccessTokenCredential=function(c){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var y=c.generateCredentialKey();this.setItem(y,JSON.stringify(c))},BrowserCacheManager.prototype.getRefreshTokenCredential=function(c){var y=this.getItem(c);if(!y)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var v=this.validateAndParseJson(y);return v&&Ri.isRefreshTokenEntity(v)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),bi.toObject(new Ri,v)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setRefreshTokenCredential=function(c){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var y=c.generateCredentialKey();this.setItem(y,JSON.stringify(c))},BrowserCacheManager.prototype.getAppMetadata=function(c){var y=this.getItem(c);if(!y)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var v=this.validateAndParseJson(y);return v&&ki.isAppMetadataEntity(c,v)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),bi.toObject(new ki,v)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},BrowserCacheManager.prototype.setAppMetadata=function(c){this.logger.trace("BrowserCacheManager.setAppMetadata called");var y=c.generateAppMetadataKey();this.setItem(y,JSON.stringify(c))},BrowserCacheManager.prototype.getServerTelemetry=function(c){var y=this.getItem(c);if(!y)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var v=this.validateAndParseJson(y);return v&&Pi.isServerTelemetryEntity(c,v)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),bi.toObject(new Pi,v)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},BrowserCacheManager.prototype.setServerTelemetry=function(c,y){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(c,JSON.stringify(y))},BrowserCacheManager.prototype.getAuthorityMetadata=function(c){var y=this.internalStorage.getItem(c);if(!y)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var v=this.validateAndParseJson(y);return v&&Oi.isAuthorityMetadataEntity(c,v)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),bi.toObject(new Oi,v)):null},BrowserCacheManager.prototype.getAuthorityMetadataKeys=function(){var c=this;return this.internalStorage.getKeys().filter((function(y){return c.isAuthorityMetadata(y)}))},BrowserCacheManager.prototype.setWrapperMetadata=function(c,y){this.internalStorage.setItem(Ht.WRAPPER_SKU,c),this.internalStorage.setItem(Ht.WRAPPER_VER,y)},BrowserCacheManager.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Ht.WRAPPER_SKU)||ne.EMPTY_STRING,this.internalStorage.getItem(Ht.WRAPPER_VER)||ne.EMPTY_STRING]},BrowserCacheManager.prototype.setAuthorityMetadata=function(c,y){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(c,JSON.stringify(y))},BrowserCacheManager.prototype.getActiveAccount=function(){var c=this.generateCacheKey(Q.ACTIVE_ACCOUNT_FILTERS),y=this.getItem(c);if(!y){this.logger.trace("No active account filters cache schema found, looking for legacy schema");var v=this.generateCacheKey(Q.ACTIVE_ACCOUNT),w=this.getItem(v);if(!w)return this.logger.trace("No active account found"),null;var C=this.getAccountInfoByFilter({localAccountId:w})[0]||null;return C?(this.logger.trace("Legacy active account cache schema found"),this.logger.trace("Adding active account filters cache schema"),this.setActiveAccount(C),C):null}var b=this.validateAndParseJson(y);return b?(this.logger.trace("Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:b.homeAccountId,localAccountId:b.localAccountId})[0]||null):(this.logger.trace("No active account found"),null)},BrowserCacheManager.prototype.setActiveAccount=function(c){var y=this.generateCacheKey(Q.ACTIVE_ACCOUNT_FILTERS),v=this.generateCacheKey(Q.ACTIVE_ACCOUNT);if(c){this.logger.verbose("setActiveAccount: Active account set");var w={homeAccountId:c.homeAccountId,localAccountId:c.localAccountId};this.browserStorage.setItem(y,JSON.stringify(w)),this.browserStorage.setItem(v,c.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(y),this.browserStorage.removeItem(v)},BrowserCacheManager.prototype.getAccountInfoByFilter=function(c){return this.getAllAccounts().filter((function(y){return(!c.username||c.username.toLowerCase()===y.username.toLowerCase())&&((!c.homeAccountId||c.homeAccountId===y.homeAccountId)&&((!c.localAccountId||c.localAccountId===y.localAccountId)&&((!c.tenantId||c.tenantId===y.tenantId)&&(!c.environment||c.environment===y.environment))))}))},BrowserCacheManager.prototype.getAccountInfoByHints=function(c,y){var v=this.getAllAccounts().filter((function(v){if(y){var w=v.idTokenClaims&&v.idTokenClaims.sid;return y===w}return!!c&&c===v.username}));if(1===v.length)return v[0];if(v.length>1)throw pn.createMultipleMatchingAccountsInCacheError();return null},BrowserCacheManager.prototype.getThrottlingCache=function(c){var y=this.getItem(c);if(!y)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var v=this.validateAndParseJson(y);return v&&Ni.isThrottlingEntity(c,v)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),bi.toObject(new Ni,v)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},BrowserCacheManager.prototype.setThrottlingCache=function(c,y){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(c,JSON.stringify(y))},BrowserCacheManager.prototype.getTemporaryCache=function(c,y){var v=y?this.generateCacheKey(c):c;if(this.cacheConfig.storeAuthStateInCookie){var w=this.getItemCookie(v);if(w)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),w}var C=this.temporaryCacheStorage.getItem(v);if(!C){if(this.cacheConfig.cacheLocation===Ut.LocalStorage){var b=this.browserStorage.getItem(v);if(b)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),b}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),C},BrowserCacheManager.prototype.setTemporaryCache=function(c,y,v){var w=v?this.generateCacheKey(c):c;this.temporaryCacheStorage.setItem(w,y),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(w,y))},BrowserCacheManager.prototype.removeItem=function(c){return this.browserStorage.removeItem(c),this.temporaryCacheStorage.removeItem(c),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(c)),!0},BrowserCacheManager.prototype.containsKey=function(c){return this.browserStorage.containsKey(c)||this.temporaryCacheStorage.containsKey(c)},BrowserCacheManager.prototype.getKeys=function(){return __spread(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},BrowserCacheManager.prototype.clear=function(){return __awaiter(this,void 0,void 0,(function(){var c=this;return __generator(this,(function(y){switch(y.label){case 0:return[4,this.removeAllAccounts()];case 1:return y.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(y){!c.browserStorage.containsKey(y)&&!c.temporaryCacheStorage.containsKey(y)||-1===y.indexOf(ne.CACHE_PREFIX)&&-1===y.indexOf(c.clientId)||c.removeItem(y)})),this.internalStorage.clear(),[2]}}))}))},BrowserCacheManager.prototype.setItemCookie=function(c,y,v){var w=encodeURIComponent(c)+"="+encodeURIComponent(y)+";path=/;SameSite=Lax;";v&&(w+="expires="+this.getCookieExpirationTime(v)+";");this.cacheConfig.secureCookies&&(w+="Secure;"),document.cookie=w},BrowserCacheManager.prototype.getItemCookie=function(c){for(var y=encodeURIComponent(c)+"=",v=document.cookie.split(";"),w=0;w<v.length;w++){for(var C=v[w];" "===C.charAt(0);)C=C.substring(1);if(0===C.indexOf(y))return decodeURIComponent(C.substring(y.length,C.length))}return ne.EMPTY_STRING},BrowserCacheManager.prototype.clearMsalCookies=function(){var c=this,y=ne.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(v){for(;" "===v.charAt(0);)v=v.substring(1);if(0===v.indexOf(y)){var w=v.split("=")[0];c.clearItemCookie(w)}}))},BrowserCacheManager.prototype.clearItemCookie=function(c){this.setItemCookie(c,ne.EMPTY_STRING,-1)},BrowserCacheManager.prototype.getCookieExpirationTime=function(c){var y=new Date;return new Date(y.getTime()+c*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},BrowserCacheManager.prototype.getCache=function(){return this.browserStorage},BrowserCacheManager.prototype.setCache=function(){},BrowserCacheManager.prototype.generateCacheKey=function(c){return this.validateAndParseJson(c)?JSON.stringify(c):fn.startsWith(c,ne.CACHE_PREFIX)||fn.startsWith(c,Q.ADAL_ID_TOKEN)?c:ne.CACHE_PREFIX+"."+this.clientId+"."+c},BrowserCacheManager.prototype.generateAuthorityKey=function(c){var y=Mi.parseRequestState(this.cryptoImpl,c).libraryState.id;return this.generateCacheKey(Ft.AUTHORITY+"."+y)},BrowserCacheManager.prototype.generateNonceKey=function(c){var y=Mi.parseRequestState(this.cryptoImpl,c).libraryState.id;return this.generateCacheKey(Ft.NONCE_IDTOKEN+"."+y)},BrowserCacheManager.prototype.generateStateKey=function(c){var y=Mi.parseRequestState(this.cryptoImpl,c).libraryState.id;return this.generateCacheKey(Ft.REQUEST_STATE+"."+y)},BrowserCacheManager.prototype.getCachedAuthority=function(c){var y=this.generateStateKey(c),v=this.getTemporaryCache(y);if(!v)return null;var w=this.generateAuthorityKey(v);return this.getTemporaryCache(w)},BrowserCacheManager.prototype.updateCacheEntries=function(c,y,v,w,C){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var b=this.generateStateKey(c);this.setTemporaryCache(b,c,!1);var S=this.generateNonceKey(c);this.setTemporaryCache(S,y,!1);var T=this.generateAuthorityKey(c);if(this.setTemporaryCache(T,v,!1),C){var I={credential:C.homeAccountId,type:Yo.HOME_ACCOUNT_ID};this.setTemporaryCache(Ft.CCS_CREDENTIAL,JSON.stringify(I),!0)}else if(!fn.isEmpty(w)){I={credential:w,type:Yo.UPN};this.setTemporaryCache(Ft.CCS_CREDENTIAL,JSON.stringify(I),!0)}},BrowserCacheManager.prototype.resetRequestCache=function(c){var y=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),fn.isEmpty(c)||this.getKeys().forEach((function(v){-1!==v.indexOf(c)&&y.removeItem(v)})),c&&(this.removeItem(this.generateStateKey(c)),this.removeItem(this.generateNonceKey(c)),this.removeItem(this.generateAuthorityKey(c))),this.removeItem(this.generateCacheKey(Ft.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Ft.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Ft.URL_HASH)),this.removeItem(this.generateCacheKey(Ft.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Ft.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(Ft.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cleanRequestByState=function(c){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),c){var y=this.generateStateKey(c),v=this.temporaryCacheStorage.getItem(y);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+v),this.resetRequestCache(v||ne.EMPTY_STRING)}this.clearMsalCookies()},BrowserCacheManager.prototype.cleanRequestByInteractionType=function(c){var y=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(v){if(-1!==v.indexOf(Ft.REQUEST_STATE)){var w=y.temporaryCacheStorage.getItem(v);if(w){var C=Wi.extractBrowserRequestState(y.cryptoImpl,w);C&&C.interactionType===c&&(y.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+w),y.resetRequestCache(w))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cacheCodeRequest=function(c,y){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var v=y.base64Encode(JSON.stringify(c));this.setTemporaryCache(Ft.REQUEST_PARAMS,v,!0)},BrowserCacheManager.prototype.getCachedRequest=function(c,y){this.logger.trace("BrowserCacheManager.getCachedRequest called");var v=this.getTemporaryCache(Ft.REQUEST_PARAMS,!0);if(!v)throw Io.createNoTokenRequestCacheError();var w=this.validateAndParseJson(y.base64Decode(v));if(!w)throw Io.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Ft.REQUEST_PARAMS)),fn.isEmpty(w.authority)){var C=this.generateAuthorityKey(c),b=this.getTemporaryCache(C);if(!b)throw Io.createNoCachedAuthorityError();w.authority=b}return w},BrowserCacheManager.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var c=this.getTemporaryCache(Ft.NATIVE_REQUEST,!0);if(!c)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var y=this.validateAndParseJson(c);return y||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},BrowserCacheManager.prototype.isInteractionInProgress=function(c){var y=this.getInteractionInProgress();return c?y===this.clientId:!!y},BrowserCacheManager.prototype.getInteractionInProgress=function(){var c=ne.CACHE_PREFIX+"."+Ft.INTERACTION_STATUS_KEY;return this.getTemporaryCache(c,!1)},BrowserCacheManager.prototype.setInteractionInProgress=function(c){var y=ne.CACHE_PREFIX+"."+Ft.INTERACTION_STATUS_KEY;if(c){if(this.getInteractionInProgress())throw Io.createInteractionInProgressError();this.setTemporaryCache(y,this.clientId,!1)}else c||this.getInteractionInProgress()!==this.clientId||this.removeItem(y)},BrowserCacheManager.prototype.getLegacyLoginHint=function(){var c=this.getTemporaryCache(Q.ADAL_ID_TOKEN);c&&(this.browserStorage.removeItem(Q.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var y=this.getTemporaryCache(Q.ID_TOKEN,!0);y&&(this.removeItem(this.generateCacheKey(Q.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var v=y||c;if(v){var w=new _i(v,this.cryptoImpl);if(w.claims&&w.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),w.claims.preferred_username;if(w.claims&&w.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),w.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},BrowserCacheManager.prototype.updateCredentialCacheKey=function(c,y){var v=y.generateCredentialKey();if(c!==v){var w=this.getItem(c);if(w)return this.removeItem(c),this.setItem(v,w),this.logger.verbose("Updated an outdated "+y.credentialType+" cache key"),v;this.logger.error("Attempted to update an outdated "+y.credentialType+" cache key but no item matching the outdated key was found in storage")}return c},BrowserCacheManager}(bi);!function(c){c.AAD="AAD",c.OIDC="OIDC"}(xi||(xi={})),function(c){c[c.None=0]="None",c.AzurePublic="https://login.microsoftonline.com",c.AzurePpe="https://login.windows-ppe.net",c.AzureChina="https://login.chinacloudapi.cn",c.AzureGermany="https://login.microsoftonline.de",c.AzureUsGovernment="https://login.microsoftonline.us"}(Ui||(Ui={}));
/*! @azure/msal-common v7.3.0 2022-08-01 */
var Vi="7.3.0",$i={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1,proxyUrl:ne.EMPTY_STRING},Yi={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Uo.Info,correlationId:ne.EMPTY_STRING},Ji={sendGetRequestAsync:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Network interface - sendGetRequestAsync() has not been implemented",or.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(c){throw"Network interface - sendPostRequestAsync() has not been implemented",or.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Qi={sku:ne.SKU,version:Vi,cpu:ne.EMPTY_STRING,os:ne.EMPTY_STRING},Zi={clientSecret:ne.EMPTY_STRING,clientAssertion:void 0},Xi={azureCloudInstance:Ui.None,tenant:""+ne.DEFAULT_COMMON_TENANT},ea={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v7.3.0 2022-08-01 */
var ta={sendGetRequestAsync:function(){return Promise.reject(or.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(or.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},ra=function(){function FetchClient(){}return FetchClient.prototype.sendGetRequestAsync=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w,C;return __generator(this,(function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,fetch(c,{method:Lt.GET,headers:this.getFetchHeaders(y)})];case 1:return v=b.sent(),[3,3];case 2:throw w=b.sent(),window.navigator.onLine?Io.createGetRequestFailedError(w,c):Io.createNoNetworkConnectivityError();case 3:return b.trys.push([3,5,,6]),C={headers:this.getHeaderDict(v.headers)},[4,v.json()];case 4:return[2,(C.body=b.sent(),C.status=v.status,C)];case 5:throw b.sent(),Io.createFailedToParseNetworkResponseError(c);case 6:return[2]}}))}))},FetchClient.prototype.sendPostRequestAsync=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w,C,b;return __generator(this,(function(S){switch(S.label){case 0:v=y&&y.body||ne.EMPTY_STRING,S.label=1;case 1:return S.trys.push([1,3,,4]),[4,fetch(c,{method:Lt.POST,headers:this.getFetchHeaders(y),body:v})];case 2:return w=S.sent(),[3,4];case 3:throw C=S.sent(),window.navigator.onLine?Io.createPostRequestFailedError(C,c):Io.createNoNetworkConnectivityError();case 4:return S.trys.push([4,6,,7]),b={headers:this.getHeaderDict(w.headers)},[4,w.json()];case 5:return[2,(b.body=S.sent(),b.status=w.status,b)];case 6:throw S.sent(),Io.createFailedToParseNetworkResponseError(c);case 7:return[2]}}))}))},FetchClient.prototype.getFetchHeaders=function(c){var y=new Headers;if(!c||!c.headers)return y;var v=c.headers;return Object.keys(v).forEach((function(c){y.append(c,v[c])})),y},FetchClient.prototype.getHeaderDict=function(c){var y={};return c.forEach((function(c,v){y[v]=c})),y},FetchClient}(),na=function(){function XhrClient(){}return XhrClient.prototype.sendGetRequestAsync=function(c,y){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(v){return[2,this.sendRequestAsync(c,Lt.GET,y)]}))}))},XhrClient.prototype.sendPostRequestAsync=function(c,y){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(v){return[2,this.sendRequestAsync(c,Lt.POST,y)]}))}))},XhrClient.prototype.sendRequestAsync=function(c,y,v){var w=this;return new Promise((function(C,b){var S=new XMLHttpRequest;if(S.open(y,c,!0),w.setXhrHeaders(S,v),S.onload=function(){(S.status<200||S.status>=300)&&(y===Lt.POST?b(Io.createPostRequestFailedError("Failed with status "+S.status,c)):b(Io.createGetRequestFailedError("Failed with status "+S.status,c)));try{var v=JSON.parse(S.responseText),T={headers:w.getHeaderDict(S),body:v,status:S.status};C(T)}catch(y){b(Io.createFailedToParseNetworkResponseError(c))}},S.onerror=function(){window.navigator.onLine?y===Lt.POST?b(Io.createPostRequestFailedError("Failed with status "+S.status,c)):b(Io.createGetRequestFailedError("Failed with status "+S.status,c)):b(Io.createNoNetworkConnectivityError())},y===Lt.POST&&v&&v.body)S.send(v.body);else{if(y!==Lt.GET)throw Io.createHttpMethodNotImplementedError(y);S.send()}}))},XhrClient.prototype.setXhrHeaders=function(c,y){if(y&&y.headers){var v=y.headers;Object.keys(v).forEach((function(y){c.setRequestHeader(y,v[y])}))}},XhrClient.prototype.getHeaderDict=function(c){var y=c.getAllResponseHeaders().trim().split(/[\r\n]+/),v={};return y.forEach((function(c){var y=c.split(": "),w=y.shift(),C=y.join(": ");w&&C&&(v[w]=C)})),v},XhrClient}(),oa=function(){function BrowserUtils(){}return BrowserUtils.clearHash=function(c){c.location.hash=ne.EMPTY_STRING,"function"==typeof c.history.replaceState&&c.history.replaceState(null,ne.EMPTY_STRING,""+c.location.origin+c.location.pathname+c.location.search)},BrowserUtils.replaceHash=function(c){var y=c.split("#");y.shift(),window.location.hash=y.length>0?y.join("#"):ne.EMPTY_STRING},BrowserUtils.isInIframe=function(){return window.parent!==window},BrowserUtils.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(Wt+".")},BrowserUtils.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},BrowserUtils.getHomepage=function(){var c=new zi(window.location.href).getUrlComponents();return c.Protocol+"//"+c.HostNameAndPort+"/"},BrowserUtils.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new ra:new na},BrowserUtils.blockReloadInHiddenIframes=function(){if(zi.hashContainsKnownProperties(window.location.hash)&&BrowserUtils.isInIframe())throw Io.createBlockReloadInHiddenIframeError()},BrowserUtils.blockRedirectInIframe=function(c,y){var v=BrowserUtils.isInIframe();if(c===Dt.Redirect&&v&&!y)throw Io.createRedirectInIframeError(v)},BrowserUtils.blockAcquireTokenInPopups=function(){if(BrowserUtils.isInPopup())throw Io.createBlockAcquireTokenInPopupsError()},BrowserUtils.blockNonBrowserEnvironment=function(c){if(!c)throw Io.createNonBrowserEnvironmentError()},BrowserUtils.blockNativeBrokerCalledBeforeInitialized=function(c,y){if(c&&!y)throw Io.createNativeBrokerCalledBeforeInitialize()},BrowserUtils.detectIEOrEdge=function(){var c=window.navigator.userAgent,y=c.indexOf("MSIE "),v=c.indexOf("Trident/"),w=c.indexOf("Edge/");return y>0||v>0||w>0},BrowserUtils}(),ia=function(){function NavigationClient(){}return NavigationClient.prototype.navigateInternal=function(c,y){return NavigationClient.defaultNavigateWindow(c,y)},NavigationClient.prototype.navigateExternal=function(c,y){return NavigationClient.defaultNavigateWindow(c,y)},NavigationClient.defaultNavigateWindow=function(c,y){return y.noHistory?window.location.replace(c):window.location.assign(c),new Promise((function(c){setTimeout((function(){c(!0)}),y.timeout)}))},NavigationClient}(),aa=6e3;
/*! @azure/msal-browser v2.28.1 2022-08-01 */
var sa,ca="@azure/msal-browser",ua="2.28.1";!function(c){c.INITIALIZE_START="msal:initializeStart",c.INITIALIZE_END="msal:initializeEnd",c.ACCOUNT_ADDED="msal:accountAdded",c.ACCOUNT_REMOVED="msal:accountRemoved",c.LOGIN_START="msal:loginStart",c.LOGIN_SUCCESS="msal:loginSuccess",c.LOGIN_FAILURE="msal:loginFailure",c.ACQUIRE_TOKEN_START="msal:acquireTokenStart",c.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",c.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",c.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",c.SSO_SILENT_START="msal:ssoSilentStart",c.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",c.SSO_SILENT_FAILURE="msal:ssoSilentFailure",c.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",c.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",c.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",c.HANDLE_REDIRECT_START="msal:handleRedirectStart",c.HANDLE_REDIRECT_END="msal:handleRedirectEnd",c.POPUP_OPENED="msal:popupOpened",c.LOGOUT_START="msal:logoutStart",c.LOGOUT_SUCCESS="msal:logoutSuccess",c.LOGOUT_FAILURE="msal:logoutFailure",c.LOGOUT_END="msal:logoutEnd"}(sa||(sa={}));
/*! @azure/msal-browser v2.28.1 2022-08-01 */
var la,da=function(){function EventHandler(c,y){this.eventCallbacks=new Map,this.logger=c,this.browserCrypto=y,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return EventHandler.prototype.addEventCallback=function(c){if("undefined"!=typeof window){var y=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(y,c),this.logger.verbose("Event callback registered with id: "+y),y}return null},EventHandler.prototype.removeEventCallback=function(c){this.eventCallbacks.delete(c),this.logger.verbose("Event callback "+c+" removed.")},EventHandler.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},EventHandler.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},EventHandler.prototype.emitEvent=function(c,y,v,w){var C=this;if("undefined"!=typeof window){var b={eventType:c,interactionType:y||null,payload:v||null,error:w||null,timestamp:Date.now()};this.logger.info("Emitting event: "+c),this.eventCallbacks.forEach((function(y,v){C.logger.verbose("Emitting event to callback "+v+": "+c),y.apply(null,[b])}))}},EventHandler.prototype.handleAccountCacheChange=function(c){try{var y=c.newValue||c.oldValue;if(!y)return;var v=JSON.parse(y);if("object"!=typeof v||!Jo.isAccountEntity(v))return;var w=bi.toObject(new Jo,v).getAccountInfo();!c.oldValue&&c.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(sa.ACCOUNT_ADDED,void 0,w)):!c.newValue&&c.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(sa.ACCOUNT_REMOVED,void 0,w))}catch(c){return}},EventHandler}(),ha=function(){function ThrottlingUtils(){}return ThrottlingUtils.generateThrottlingStorageKey=function(c){return kt+"."+JSON.stringify(c)},ThrottlingUtils.preProcess=function(c,y){var v,w=ThrottlingUtils.generateThrottlingStorageKey(y),C=c.getThrottlingCache(w);if(C){if(C.throttleTime<Date.now())return void c.removeItem(w,Ke.THROTTLING);throw new $o((null===(v=C.errorCodes)||void 0===v?void 0:v.join(" "))||ne.EMPTY_STRING,C.errorMessage,C.subError)}},ThrottlingUtils.postProcess=function(c,y,v){if(ThrottlingUtils.checkResponseStatus(v)||ThrottlingUtils.checkResponseForRetryAfter(v)){var w={throttleTime:ThrottlingUtils.calculateThrottleTime(parseInt(v.headers[K.RETRY_AFTER])),error:v.body.error,errorCodes:v.body.error_codes,errorMessage:v.body.error_description,subError:v.body.suberror};c.setThrottlingCache(ThrottlingUtils.generateThrottlingStorageKey(y),w)}},ThrottlingUtils.checkResponseStatus=function(c){return 429===c.status||c.status>=500&&c.status<600},ThrottlingUtils.checkResponseForRetryAfter=function(c){return!!c.headers&&(c.headers.hasOwnProperty(K.RETRY_AFTER)&&(c.status<200||c.status>=300))},ThrottlingUtils.calculateThrottleTime=function(c){var y=c<=0?0:c,v=Date.now()/1e3;return Math.floor(1e3*Math.min(v+(y||It),v+Rt))},ThrottlingUtils.removeThrottle=function(c,y,v,w){var C={clientId:y,authority:v.authority,scopes:v.scopes,homeAccountIdentifier:w,claims:v.claims,authenticationScheme:v.authenticationScheme,resourceRequestMethod:v.resourceRequestMethod,resourceRequestUri:v.resourceRequestUri,shrClaims:v.shrClaims,sshKid:v.sshKid},b=this.generateThrottlingStorageKey(C);return c.removeItem(b,Ke.THROTTLING)},ThrottlingUtils}(),pa=function(){function NetworkManager(c,y){this.networkClient=c,this.cacheManager=y}return NetworkManager.prototype.sendPostRequest=function(c,y,v){return _tslib_awaiter(this,void 0,void 0,(function(){var w,C;return _tslib_generator(this,(function(b){switch(b.label){case 0:ha.preProcess(this.cacheManager,c),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(y,v)];case 2:return w=b.sent(),[3,4];case 3:throw(C=b.sent())instanceof or?C:pn.createNetworkError(y,C);case 4:return ha.postProcess(this.cacheManager,c,w),[2,w]}}))}))},NetworkManager}(),fa=function(){function BaseClient(c,y){this.config=function buildClientConfiguration(c){var y,v=c.authOptions,w=c.systemOptions,C=c.loggerOptions,b=c.storageInterface,S=c.networkInterface,T=c.cryptoInterface,I=c.clientCredentials,P=c.libraryInfo,K=c.telemetry,Q=c.serverTelemetryManager,X=c.persistencePlugin,te=c.serializableCache,re=_tslib_assign(_tslib_assign({},Yi),C);return{authOptions:(y=v,_tslib_assign({clientCapabilities:[],azureCloudOptions:Xi,skipAuthorityMetadataCache:!1},y)),systemOptions:_tslib_assign(_tslib_assign({},$i),w),loggerOptions:re,storageInterface:b||new Si(v.clientId,jo),networkInterface:S||Ji,cryptoInterface:T||jo,clientCredentials:I||Zi,libraryInfo:_tslib_assign(_tslib_assign({},Qi),P),telemetry:_tslib_assign(_tslib_assign({},ea),K),serverTelemetryManager:Q||null,persistencePlugin:X||null,serializableCache:te||null}}(c),this.logger=new Ho(this.config.loggerOptions,"@azure/msal-common",Vi),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new pa(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=y}return BaseClient.prototype.createTokenRequestHeaders=function(c){var y={};if(y[K.CONTENT_TYPE]=ne.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case Yo.HOME_ACCOUNT_ID:try{var v=buildClientInfoFromHomeAccountId(c.credential);y[K.CCS_HEADER]="Oid:"+v.uid+"@"+v.utid}catch(c){this.logger.verbose("Could not parse home account ID for CCS Header: "+c)}break;case Yo.UPN:y[K.CCS_HEADER]="UPN: "+c.credential}return y},BaseClient.prototype.executePostToTokenEndpoint=function(c,y,v,w){return _tslib_awaiter(this,void 0,void 0,(function(){var C;return _tslib_generator(this,(function(b){switch(b.label){case 0:return[4,this.networkManager.sendPostRequest(w,c,{body:y,headers:v,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:return C=b.sent(),this.config.serverTelemetryManager&&C.status<500&&429!==C.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,C]}}))}))},BaseClient.prototype.updateAuthority=function(c){if(!c.discoveryComplete())throw pn.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=c},BaseClient}(),ga=function(){function RequestValidator(){}return RequestValidator.validateRedirectUri=function(c){if(fn.isEmpty(c))throw Ei.createRedirectUriEmptyError()},RequestValidator.validatePrompt=function(c){var y=[];for(var v in ue)y.push(ue[v]);if(y.indexOf(c)<0)throw Ei.createInvalidPromptError(c)},RequestValidator.validateClaims=function(c){try{JSON.parse(c)}catch(c){throw Ei.createInvalidClaimsRequestError()}},RequestValidator.validateCodeChallengeParams=function(c,y){if(fn.isEmpty(c)||fn.isEmpty(y))throw Ei.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(y)},RequestValidator.validateCodeChallengeMethod=function(c){if([$e.PLAIN,$e.S256].indexOf(c)<0)throw Ei.createInvalidCodeChallengeMethodError()},RequestValidator.sanitizeEQParams=function(c,y){return c?(y.forEach((function(y,v){c[v]&&delete c[v]})),c):{}},RequestValidator}(),ma=function(){function RequestParameterBuilder(){this.parameters=new Map}return RequestParameterBuilder.prototype.addResponseTypeCode=function(){this.parameters.set(te.RESPONSE_TYPE,encodeURIComponent(ne.CODE_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(te.RESPONSE_TYPE,encodeURIComponent(ne.TOKEN_RESPONSE_TYPE+" "+ne.ID_TOKEN_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseMode=function(c){this.parameters.set(te.RESPONSE_MODE,encodeURIComponent(c||de.QUERY))},RequestParameterBuilder.prototype.addNativeBroker=function(){this.parameters.set(te.NATIVE_BROKER,encodeURIComponent("1"))},RequestParameterBuilder.prototype.addScopes=function(c,y){void 0===y&&(y=!0);var v=y?__spreadArrays(c||[],oe):c||[],w=new Ci(v);this.parameters.set(te.SCOPE,encodeURIComponent(w.printScopes()))},RequestParameterBuilder.prototype.addClientId=function(c){this.parameters.set(te.CLIENT_ID,encodeURIComponent(c))},RequestParameterBuilder.prototype.addRedirectUri=function(c){ga.validateRedirectUri(c),this.parameters.set(te.REDIRECT_URI,encodeURIComponent(c))},RequestParameterBuilder.prototype.addPostLogoutRedirectUri=function(c){ga.validateRedirectUri(c),this.parameters.set(te.POST_LOGOUT_URI,encodeURIComponent(c))},RequestParameterBuilder.prototype.addIdTokenHint=function(c){this.parameters.set(te.ID_TOKEN_HINT,encodeURIComponent(c))},RequestParameterBuilder.prototype.addDomainHint=function(c){this.parameters.set(se.DOMAIN_HINT,encodeURIComponent(c))},RequestParameterBuilder.prototype.addLoginHint=function(c){this.parameters.set(se.LOGIN_HINT,encodeURIComponent(c))},RequestParameterBuilder.prototype.addCcsUpn=function(c){this.parameters.set(K.CCS_HEADER,encodeURIComponent("UPN:"+c))},RequestParameterBuilder.prototype.addCcsOid=function(c){this.parameters.set(K.CCS_HEADER,encodeURIComponent("Oid:"+c.uid+"@"+c.utid))},RequestParameterBuilder.prototype.addSid=function(c){this.parameters.set(se.SID,encodeURIComponent(c))},RequestParameterBuilder.prototype.addClaims=function(c,y){var v=this.addClientCapabilitiesToClaims(c,y);ga.validateClaims(v),this.parameters.set(te.CLAIMS,encodeURIComponent(v))},RequestParameterBuilder.prototype.addCorrelationId=function(c){this.parameters.set(te.CLIENT_REQUEST_ID,encodeURIComponent(c))},RequestParameterBuilder.prototype.addLibraryInfo=function(c){this.parameters.set(te.X_CLIENT_SKU,c.sku),this.parameters.set(te.X_CLIENT_VER,c.version),c.os&&this.parameters.set(te.X_CLIENT_OS,c.os),c.cpu&&this.parameters.set(te.X_CLIENT_CPU,c.cpu)},RequestParameterBuilder.prototype.addApplicationTelemetry=function(c){(null==c?void 0:c.appName)&&this.parameters.set(te.X_APP_NAME,c.appName),(null==c?void 0:c.appVersion)&&this.parameters.set(te.X_APP_VER,c.appVersion)},RequestParameterBuilder.prototype.addPrompt=function(c){ga.validatePrompt(c),this.parameters.set(""+te.PROMPT,encodeURIComponent(c))},RequestParameterBuilder.prototype.addState=function(c){fn.isEmpty(c)||this.parameters.set(te.STATE,encodeURIComponent(c))},RequestParameterBuilder.prototype.addNonce=function(c){this.parameters.set(te.NONCE,encodeURIComponent(c))},RequestParameterBuilder.prototype.addCodeChallengeParams=function(c,y){if(ga.validateCodeChallengeParams(c,y),!c||!y)throw Ei.createInvalidCodeChallengeParamsError();this.parameters.set(te.CODE_CHALLENGE,encodeURIComponent(c)),this.parameters.set(te.CODE_CHALLENGE_METHOD,encodeURIComponent(y))},RequestParameterBuilder.prototype.addAuthorizationCode=function(c){this.parameters.set(te.CODE,encodeURIComponent(c))},RequestParameterBuilder.prototype.addDeviceCode=function(c){this.parameters.set(te.DEVICE_CODE,encodeURIComponent(c))},RequestParameterBuilder.prototype.addRefreshToken=function(c){this.parameters.set(te.REFRESH_TOKEN,encodeURIComponent(c))},RequestParameterBuilder.prototype.addCodeVerifier=function(c){this.parameters.set(te.CODE_VERIFIER,encodeURIComponent(c))},RequestParameterBuilder.prototype.addClientSecret=function(c){this.parameters.set(te.CLIENT_SECRET,encodeURIComponent(c))},RequestParameterBuilder.prototype.addClientAssertion=function(c){fn.isEmpty(c)||this.parameters.set(te.CLIENT_ASSERTION,encodeURIComponent(c))},RequestParameterBuilder.prototype.addClientAssertionType=function(c){fn.isEmpty(c)||this.parameters.set(te.CLIENT_ASSERTION_TYPE,encodeURIComponent(c))},RequestParameterBuilder.prototype.addOboAssertion=function(c){this.parameters.set(te.OBO_ASSERTION,encodeURIComponent(c))},RequestParameterBuilder.prototype.addRequestTokenUse=function(c){this.parameters.set(te.REQUESTED_TOKEN_USE,encodeURIComponent(c))},RequestParameterBuilder.prototype.addGrantType=function(c){this.parameters.set(te.GRANT_TYPE,encodeURIComponent(c))},RequestParameterBuilder.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},RequestParameterBuilder.prototype.addExtraQueryParameters=function(c){var y=this;ga.sanitizeEQParams(c,this.parameters),Object.keys(c).forEach((function(v){y.parameters.set(v,c[v])}))},RequestParameterBuilder.prototype.addClientCapabilitiesToClaims=function(c,y){var v;if(c)try{v=JSON.parse(c)}catch(c){throw Ei.createInvalidClaimsRequestError()}else v={};return y&&y.length>0&&(v.hasOwnProperty(re.ACCESS_TOKEN)||(v[re.ACCESS_TOKEN]={}),v[re.ACCESS_TOKEN][re.XMS_CC]={values:y}),JSON.stringify(v)},RequestParameterBuilder.prototype.addUsername=function(c){this.parameters.set(Et.username,encodeURIComponent(c))},RequestParameterBuilder.prototype.addPassword=function(c){this.parameters.set(Et.password,encodeURIComponent(c))},RequestParameterBuilder.prototype.addPopToken=function(c){fn.isEmpty(c)||(this.parameters.set(te.TOKEN_TYPE,vt.POP),this.parameters.set(te.REQ_CNF,encodeURIComponent(c)))},RequestParameterBuilder.prototype.addSshJwk=function(c){fn.isEmpty(c)||(this.parameters.set(te.TOKEN_TYPE,vt.SSH),this.parameters.set(te.REQ_CNF,encodeURIComponent(c)))},RequestParameterBuilder.prototype.addServerTelemetry=function(c){this.parameters.set(te.X_CLIENT_CURR_TELEM,c.generateCurrentRequestHeaderValue()),this.parameters.set(te.X_CLIENT_LAST_TELEM,c.generateLastRequestHeaderValue())},RequestParameterBuilder.prototype.addThrottling=function(){this.parameters.set(te.X_MS_LIB_CAPABILITY,Ot)},RequestParameterBuilder.prototype.addLogoutHint=function(c){this.parameters.set(te.LOGOUT_HINT,encodeURIComponent(c))},RequestParameterBuilder.prototype.createQueryString=function(){var c=new Array;return this.parameters.forEach((function(y,v){c.push(v+"="+y)})),c.join("&")},RequestParameterBuilder}(),ya=function ya(c,y,v,w,C){this.account=c||null,this.idToken=y||null,this.accessToken=v||null,this.refreshToken=w||null,this.appMetadata=C||null};!function(c){c.SW="sw",c.UHW="uhw"}(la||(la={}));var va=function(){function PopTokenGenerator(c){this.cryptoUtils=c}return PopTokenGenerator.prototype.generateCnf=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v,w;return _tslib_generator(this,(function(C){switch(C.label){case 0:return[4,this.generateKid(c)];case 1:return y=C.sent(),v=this.cryptoUtils.base64Encode(JSON.stringify(y)),w={kid:y.kid,reqCnfString:v},[4,this.cryptoUtils.hashString(v)];case 2:return[2,(w.reqCnfHash=C.sent(),w)]}}))}))},PopTokenGenerator.prototype.generateKid=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(y){switch(y.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(c)];case 1:return[2,{kid:y.sent(),xms_ksl:la.SW}]}}))}))},PopTokenGenerator.prototype.signPopToken=function(c,y,v){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(w){return[2,this.signPayload(c,y,v)]}))}))},PopTokenGenerator.prototype.signPayload=function(c,y,v,w){return _tslib_awaiter(this,void 0,void 0,(function(){var C,b,S,T,I,P;return _tslib_generator(this,(function(K){switch(K.label){case 0:return C=v.resourceRequestMethod,b=v.resourceRequestUri,S=v.shrClaims,T=v.shrNonce,I=b?new zi(b):void 0,P=null==I?void 0:I.getUrlComponents(),[4,this.cryptoUtils.signJwt(_tslib_assign({at:c,ts:Ai.nowSeconds(),m:null==C?void 0:C.toUpperCase(),u:null==P?void 0:P.HostNameAndPort,nonce:T||this.cryptoUtils.createNewGuid(),p:null==P?void 0:P.AbsolutePath,q:(null==P?void 0:P.QueryString)?[[],P.QueryString]:void 0,client_claims:S||void 0},w),y,v.correlationId)];case 1:return[2,K.sent()]}}))}))},PopTokenGenerator}(),wa=function(){function TokenCacheContext(c,y){this.cache=c,this.hasChanged=y}return Object.defineProperty(TokenCacheContext.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(TokenCacheContext.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),TokenCacheContext}(),Ea=function(){function ResponseHandler(c,y,v,w,C,b){this.clientId=c,this.cacheStorage=y,this.cryptoObj=v,this.logger=w,this.serializableCache=C,this.persistencePlugin=b}return ResponseHandler.prototype.validateServerAuthorizationCodeResponse=function(c,y,v){if(!c.state||!y)throw c.state?pn.createStateNotFoundError("Cached State"):pn.createStateNotFoundError("Server State");if(decodeURIComponent(c.state)!==decodeURIComponent(y))throw pn.createStateMismatchError();if(c.error||c.error_description||c.suberror){if(Vo.isInteractionRequiredError(c.error,c.error_description,c.suberror))throw new Vo(c.error||ne.EMPTY_STRING,c.error_description,c.suberror);throw new $o(c.error||ne.EMPTY_STRING,c.error_description,c.suberror)}c.client_info&&buildClientInfo(c.client_info,v)},ResponseHandler.prototype.validateTokenResponse=function(c){if(c.error||c.error_description||c.suberror){if(Vo.isInteractionRequiredError(c.error,c.error_description,c.suberror))throw new Vo(c.error,c.error_description,c.suberror);var y=c.error_codes+" - ["+c.timestamp+"]: "+c.error_description+" - Correlation ID: "+c.correlation_id+" - Trace ID: "+c.trace_id;throw new $o(c.error,y,c.suberror)}},ResponseHandler.prototype.handleServerTokenResponse=function(c,y,v,w,C,b,S,T){return _tslib_awaiter(this,void 0,void 0,(function(){var I,P,K,Q,X;return _tslib_generator(this,(function(te){switch(te.label){case 0:if(c.id_token&&(I=new _i(c.id_token||ne.EMPTY_STRING,this.cryptoObj),C&&!fn.isEmpty(C.nonce)&&I.claims.nonce!==C.nonce))throw pn.createNonceMismatchError();this.homeAccountIdentifier=Jo.generateHomeAccountId(c.client_info||ne.EMPTY_STRING,y.authorityType,this.logger,this.cryptoObj,I),C&&C.state&&(P=Mi.parseRequestState(this.cryptoObj,C.state)),c.key_id=c.key_id||w.sshKid||void 0,K=this.generateCacheRecord(c,y,v,w,I,b,C),te.label=1;case 1:return te.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),Q=new wa(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(Q)]):[3,3];case 2:te.sent(),te.label=3;case 3:return!S||T||!K.account||(X=K.account.generateAccountKey(),this.cacheStorage.getAccount(X))?[4,this.cacheStorage.saveCacheRecord(K)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,y,K,!1,w,I,P,void 0)]);case 4:return te.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&Q?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(Q)]):[3,7];case 6:te.sent(),te.label=7;case 7:return[7];case 8:return[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,y,K,!1,w,I,P,c.spa_code)]}}))}))},ResponseHandler.prototype.generateCacheRecord=function(c,y,v,w,C,b,S){var T,I,P=y.getPreferredCache();if(fn.isEmpty(P))throw pn.createInvalidCacheEnvironmentError();!fn.isEmpty(c.id_token)&&C&&(T=Ti.createIdTokenEntity(this.homeAccountIdentifier,P,c.id_token||ne.EMPTY_STRING,this.clientId,C.claims.tid||ne.EMPTY_STRING),I=this.generateAccountEntity(c,C,y,S));var K=null;if(!fn.isEmpty(c.access_token)){var Q=c.scope?Ci.fromString(c.scope):new Ci(w.scopes||[]),X=("string"==typeof c.expires_in?parseInt(c.expires_in,10):c.expires_in)||0,te=("string"==typeof c.ext_expires_in?parseInt(c.ext_expires_in,10):c.ext_expires_in)||0,re=("string"==typeof c.refresh_in?parseInt(c.refresh_in,10):c.refresh_in)||void 0,oe=v+X,ie=oe+te,se=re&&re>0?v+re:void 0;K=Ii.createAccessTokenEntity(this.homeAccountIdentifier,P,c.access_token||ne.EMPTY_STRING,this.clientId,C?C.claims.tid||ne.EMPTY_STRING:y.tenant,Q.printScopes(),oe,ie,this.cryptoObj,se,c.token_type,b,c.key_id,w.claims,w.requestedClaimsHash)}var ue=null;fn.isEmpty(c.refresh_token)||(ue=Ri.createRefreshTokenEntity(this.homeAccountIdentifier,P,c.refresh_token||ne.EMPTY_STRING,this.clientId,c.foci,b));var de=null;return fn.isEmpty(c.foci)||(de=ki.createAppMetadataEntity(this.clientId,P,c.foci)),new ya(I,T,K,ue,de)},ResponseHandler.prototype.generateAccountEntity=function(c,y,v,w){var C=v.authorityType,b=w?w.cloud_graph_host_name:ne.EMPTY_STRING,S=w?w.msgraph_host:ne.EMPTY_STRING;if(C===Fo.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Jo.createGenericAccount(this.homeAccountIdentifier,y,v,b,S);if(fn.isEmpty(c.client_info)&&"AAD"===v.protocolMode)throw pn.createClientInfoEmptyError();return c.client_info?Jo.createAccount(c.client_info,this.homeAccountIdentifier,y,v,b,S):Jo.createGenericAccount(this.homeAccountIdentifier,y,v,b,S)},ResponseHandler.generateAuthenticationResult=function(c,y,v,w,C,b,S,T){var I,P,K;return _tslib_awaiter(this,void 0,void 0,(function(){var Q,X,te,re,oe,ie,se,ue,de,pe,Ee;return _tslib_generator(this,(function(Ie){switch(Ie.label){case 0:if(Q=ne.EMPTY_STRING,X=[],te=null,oe=ne.EMPTY_STRING,!v.accessToken)return[3,4];if(v.accessToken.tokenType!==vt.POP)return[3,2];if(ie=new va(c),se=v.accessToken,ue=se.secret,!(de=se.keyId))throw pn.createKeyIdMissingError();return[4,ie.signPopToken(ue,de,C)];case 1:return Q=Ie.sent(),[3,3];case 2:Q=v.accessToken.secret,Ie.label=3;case 3:X=Ci.fromString(v.accessToken.target).asArray(),te=new Date(1e3*Number(v.accessToken.expiresOn)),re=new Date(1e3*Number(v.accessToken.extendedExpiresOn)),Ie.label=4;case 4:return v.appMetadata&&(oe=v.appMetadata.familyId===Ze?Ze:ne.EMPTY_STRING),pe=(null==b?void 0:b.claims.oid)||(null==b?void 0:b.claims.sub)||ne.EMPTY_STRING,Ee=(null==b?void 0:b.claims.tid)||ne.EMPTY_STRING,[2,{authority:y.canonicalAuthority,uniqueId:pe,tenantId:Ee,scopes:X,account:v.account?v.account.getAccountInfo():null,idToken:b?b.rawToken:ne.EMPTY_STRING,idTokenClaims:b?b.claims:{},accessToken:Q,fromCache:w,expiresOn:te,correlationId:C.correlationId,extExpiresOn:re,familyId:oe,tokenType:(null===(I=v.accessToken)||void 0===I?void 0:I.tokenType)||ne.EMPTY_STRING,state:S?S.userRequestState:ne.EMPTY_STRING,cloudGraphHostName:(null===(P=v.account)||void 0===P?void 0:P.cloudGraphHostName)||ne.EMPTY_STRING,msGraphHost:(null===(K=v.account)||void 0===K?void 0:K.msGraphHost)||ne.EMPTY_STRING,code:T,fromNativeBroker:!1}]}}))}))},ResponseHandler}(),Ca=function(c){function AuthorizationCodeClient(y){var v=c.call(this,y)||this;return v.includeRedirectUri=!0,v}return _tslib_extends(AuthorizationCodeClient,c),AuthorizationCodeClient.prototype.getAuthCodeUrl=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y;return _tslib_generator(this,(function(v){switch(v.label){case 0:return[4,this.createAuthCodeUrlQueryString(c)];case 1:return y=v.sent(),[2,zi.appendQueryString(this.authority.authorizationEndpoint,y)]}}))}))},AuthorizationCodeClient.prototype.acquireToken=function(c,y){return _tslib_awaiter(this,void 0,void 0,(function(){var v,w,C;return _tslib_generator(this,(function(b){switch(b.label){case 0:if(this.logger.info("in acquireToken call"),!c||fn.isEmpty(c.code))throw pn.createTokenRequestCannotBeMadeError();return v=Ai.nowSeconds(),[4,this.executeTokenRequest(this.authority,c)];case 1:return w=b.sent(),(C=new Ea(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(w.body),[4,C.handleServerTokenResponse(w.body,this.authority,v,c,y)];case 2:return[2,b.sent()]}}))}))},AuthorizationCodeClient.prototype.handleFragmentResponse=function(c,y){var v=new Ea(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),w=new zi(c),C=zi.getDeserializedHash(w.getHash());if(v.validateServerAuthorizationCodeResponse(C,y,this.cryptoUtils),!C.code)throw pn.createNoAuthCodeInServerResponseError();return _tslib_assign(_tslib_assign({},C),{code:C.code})},AuthorizationCodeClient.prototype.getLogoutUri=function(c){if(!c)throw Ei.createEmptyLogoutRequestError();var y=this.createLogoutUrlQueryString(c);return zi.appendQueryString(this.authority.endSessionEndpoint,y)},AuthorizationCodeClient.prototype.executeTokenRequest=function(c,y){return _tslib_awaiter(this,void 0,void 0,(function(){var v,w,C,b,S,T,I;return _tslib_generator(this,(function(P){switch(P.label){case 0:return v={clientId:this.config.authOptions.clientId,authority:c.canonicalAuthority,scopes:y.scopes,claims:y.claims,authenticationScheme:y.authenticationScheme,resourceRequestMethod:y.resourceRequestMethod,resourceRequestUri:y.resourceRequestUri,shrClaims:y.shrClaims,sshKid:y.sshKid},[4,this.createTokenRequestBody(y)];case 1:if(w=P.sent(),C=this.createTokenQueryParameters(y),b=void 0,y.clientInfo)try{S=buildClientInfo(y.clientInfo,this.cryptoUtils),b={credential:""+S.uid+Ie.CLIENT_INFO_SEPARATOR+S.utid,type:Yo.HOME_ACCOUNT_ID}}catch(c){this.logger.verbose("Could not parse client info for CCS Header: "+c)}return T=this.createTokenRequestHeaders(b||y.ccsCredential),I=fn.isEmpty(C)?c.tokenEndpoint:c.tokenEndpoint+"?"+C,[2,this.executePostToTokenEndpoint(I,w,T,v)]}}))}))},AuthorizationCodeClient.prototype.createTokenQueryParameters=function(c){var y=new ma;return c.tokenQueryParameters&&y.addExtraQueryParameters(c.tokenQueryParameters),y.createQueryString()},AuthorizationCodeClient.prototype.createTokenRequestBody=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T;return _tslib_generator(this,(function(I){switch(I.label){case 0:return(y=new ma).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?y.addRedirectUri(c.redirectUri):ga.validateRedirectUri(c.redirectUri),y.addScopes(c.scopes),y.addAuthorizationCode(c.code),y.addLibraryInfo(this.config.libraryInfo),y.addApplicationTelemetry(this.config.telemetry.application),y.addThrottling(),this.serverTelemetryManager&&y.addServerTelemetry(this.serverTelemetryManager),c.codeVerifier&&y.addCodeVerifier(c.codeVerifier),this.config.clientCredentials.clientSecret&&y.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(v=this.config.clientCredentials.clientAssertion,y.addClientAssertion(v.assertion),y.addClientAssertionType(v.assertionType)),y.addGrantType(pe.AUTHORIZATION_CODE_GRANT),y.addClientInfo(),c.authenticationScheme!==vt.POP?[3,2]:[4,new va(this.cryptoUtils).generateCnf(c)];case 1:return w=I.sent(),y.addPopToken(w.reqCnfString),[3,3];case 2:if(c.authenticationScheme===vt.SSH){if(!c.sshJwk)throw Ei.createMissingSshJwkError();y.addSshJwk(c.sshJwk)}I.label=3;case 3:if(C=c.correlationId||this.config.cryptoInterface.createNewGuid(),y.addCorrelationId(C),(!fn.isEmptyObj(c.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&y.addClaims(c.claims,this.config.authOptions.clientCapabilities),b=void 0,c.clientInfo)try{S=buildClientInfo(c.clientInfo,this.cryptoUtils),b={credential:""+S.uid+Ie.CLIENT_INFO_SEPARATOR+S.utid,type:Yo.HOME_ACCOUNT_ID}}catch(c){this.logger.verbose("Could not parse client info for CCS Header: "+c)}else b=c.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&b)switch(b.type){case Yo.HOME_ACCOUNT_ID:try{S=buildClientInfoFromHomeAccountId(b.credential),y.addCcsOid(S)}catch(c){this.logger.verbose("Could not parse home account ID for CCS Header: "+c)}break;case Yo.UPN:y.addCcsUpn(b.credential)}return c.tokenBodyParameters&&y.addExtraQueryParameters(c.tokenBodyParameters),!c.enableSpaAuthorizationCode||c.tokenBodyParameters&&c.tokenBodyParameters[te.RETURN_SPA_CODE]||y.addExtraQueryParameters(((T={})[te.RETURN_SPA_CODE]="1",T)),[2,y.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createAuthCodeUrlQueryString=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T;return _tslib_generator(this,(function(I){switch(I.label){case 0:if((y=new ma).addClientId(this.config.authOptions.clientId),v=__spreadArrays(c.scopes||[],c.extraScopesToConsent||[]),y.addScopes(v),y.addRedirectUri(c.redirectUri),w=c.correlationId||this.config.cryptoInterface.createNewGuid(),y.addCorrelationId(w),y.addResponseMode(c.responseMode),y.addResponseTypeCode(),y.addLibraryInfo(this.config.libraryInfo),y.addApplicationTelemetry(this.config.telemetry.application),y.addClientInfo(),c.codeChallenge&&c.codeChallengeMethod&&y.addCodeChallengeParams(c.codeChallenge,c.codeChallengeMethod),c.prompt&&y.addPrompt(c.prompt),c.domainHint&&y.addDomainHint(c.domainHint),c.prompt!==ue.SELECT_ACCOUNT)if(c.sid&&c.prompt===ue.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),y.addSid(c.sid);else if(c.account){if(C=this.extractAccountSid(c.account),b=this.extractLoginHint(c.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),y.addLoginHint(b);try{S=buildClientInfoFromHomeAccountId(c.account.homeAccountId),y.addCcsOid(S)}catch(c){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(C&&c.prompt===ue.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),y.addSid(C);try{S=buildClientInfoFromHomeAccountId(c.account.homeAccountId),y.addCcsOid(S)}catch(c){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(c.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),y.addLoginHint(c.loginHint),y.addCcsUpn(c.loginHint);else if(c.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),y.addLoginHint(c.account.username);try{S=buildClientInfoFromHomeAccountId(c.account.homeAccountId),y.addCcsOid(S)}catch(c){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else c.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),y.addLoginHint(c.loginHint),y.addCcsUpn(c.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return c.nonce&&y.addNonce(c.nonce),c.state&&y.addState(c.state),(!fn.isEmpty(c.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&y.addClaims(c.claims,this.config.authOptions.clientCapabilities),c.extraQueryParameters&&y.addExtraQueryParameters(c.extraQueryParameters),c.nativeBroker?(y.addNativeBroker(),c.authenticationScheme!==vt.POP?[3,2]:[4,new va(this.cryptoUtils).generateCnf(c)]):[3,2];case 1:T=I.sent(),y.addPopToken(T.reqCnfHash),I.label=2;case 2:return[2,y.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createLogoutUrlQueryString=function(c){var y=new ma;return c.postLogoutRedirectUri&&y.addPostLogoutRedirectUri(c.postLogoutRedirectUri),c.correlationId&&y.addCorrelationId(c.correlationId),c.idTokenHint&&y.addIdTokenHint(c.idTokenHint),c.state&&y.addState(c.state),c.logoutHint&&y.addLogoutHint(c.logoutHint),c.extraQueryParameters&&y.addExtraQueryParameters(c.extraQueryParameters),y.createQueryString()},AuthorizationCodeClient.prototype.extractAccountSid=function(c){var y;return(null===(y=c.idTokenClaims)||void 0===y?void 0:y.sid)||null},AuthorizationCodeClient.prototype.extractLoginHint=function(c){var y;return(null===(y=c.idTokenClaims)||void 0===y?void 0:y.login_hint)||null},AuthorizationCodeClient}(fa);
/*! @azure/msal-common v7.3.0 2022-08-01 */
function isOpenIdConfigResponse(c){return c.hasOwnProperty("authorization_endpoint")&&c.hasOwnProperty("token_endpoint")&&c.hasOwnProperty("issuer")&&c.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v7.3.0 2022-08-01 */
var _a={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},ba={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};
/*! @azure/msal-common v7.3.0 2022-08-01 */
var Sa,Ta=function(){function RegionDiscovery(c){this.networkInterface=c}return RegionDiscovery.prototype.detectRegion=function(c,y,v){return _tslib_awaiter(this,void 0,void 0,(function(){var w,C,b,S,T;return _tslib_generator(this,(function(I){switch(I.label){case 0:if(w=c)return[3,8];C=RegionDiscovery.IMDS_OPTIONS,v&&(C.proxyUrl=v),I.label=1;case 1:return I.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(ne.IMDS_VERSION,C)];case 2:return(b=I.sent()).status===_t.httpSuccess&&(w=b.body,y.region_source=bt.IMDS),b.status!==_t.httpBadRequest?[3,5]:[4,this.getCurrentVersion(C)];case 3:return(S=I.sent())?[4,this.getRegionFromIMDS(S,C)]:(y.region_source=bt.FAILED_AUTO_DETECTION,[2,null]);case 4:(T=I.sent()).status===_t.httpSuccess&&(w=T.body,y.region_source=bt.IMDS),I.label=5;case 5:return[3,7];case 6:return I.sent(),y.region_source=bt.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:y.region_source=bt.ENVIRONMENT_VARIABLE,I.label=9;case 9:return w||(y.region_source=bt.FAILED_AUTO_DETECTION),[2,w||null]}}))}))},RegionDiscovery.prototype.getRegionFromIMDS=function(c,y){return _tslib_awaiter(this,void 0,void 0,(function(){return _tslib_generator(this,(function(v){return[2,this.networkInterface.sendGetRequestAsync(ne.IMDS_ENDPOINT+"?api-version="+c+"&format=text",y,ne.IMDS_TIMEOUT)]}))}))},RegionDiscovery.prototype.getCurrentVersion=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y;return _tslib_generator(this,(function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(ne.IMDS_ENDPOINT+"?format=json",c)];case 1:return(y=v.sent()).status===_t.httpBadRequest&&y.body&&y.body["newest-versions"]&&y.body["newest-versions"].length>0?[2,y.body["newest-versions"][0]]:[2,null];case 2:return v.sent(),[2,null];case 3:return[2]}}))}))},RegionDiscovery.IMDS_OPTIONS={headers:{Metadata:"true"}},RegionDiscovery}(),Aa=function(){function Authority(c,y,v,w,C){this.canonicalAuthority=c,this._canonicalAuthority.validateAsUri(),this.networkInterface=y,this.cacheManager=v,this.authorityOptions=w,this.regionDiscovery=new Ta(y),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.proxyUrl=C||ne.EMPTY_STRING}return Object.defineProperty(Authority.prototype,"authorityType",{get:function(){var c=this.canonicalAuthorityUrlComponents.PathSegments;return c.length&&c[0].toLowerCase()===ne.ADFS?Fo.Adfs:Fo.Default},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(c){this._canonicalAuthority=new zi(c),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var c=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(c)}throw pn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var c=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(c)}throw pn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var c=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(c)}throw pn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw pn.createLogoutNotSupportedError();var c=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(c)}throw pn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var c=this.replacePath(this.metadata.issuer);return this.replaceTenant(c)}throw pn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var c=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(c)}throw pn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Authority.prototype.replaceTenant=function(c){return c.replace(/{tenant}|{tenantid}/g,this.tenant)},Authority.prototype.replacePath=function(c){var y=c,v=new zi(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(c,w){var C=v[w];c!==C&&(y=y.replace("/"+C+"/","/"+c+"/"))})),y},Object.defineProperty(Authority.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===Fo.Adfs||this.protocolMode===xi.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),Authority.prototype.discoveryComplete=function(){return!!this.metadata},Authority.prototype.resolveEndpointsAsync=function(){return _tslib_awaiter(this,void 0,void 0,(function(){var c,y,v,w;return _tslib_generator(this,(function(C){switch(C.label){case 0:return(c=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(c=new Oi).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(c)];case 1:return y=C.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,c.preferred_network),[4,this.updateEndpointMetadata(c)];case 2:return v=C.sent(),y!==Je.CACHE&&v!==Je.CACHE&&(c.resetExpiresAt(),c.updateCanonicalAuthority(this.canonicalAuthority)),w=this.cacheManager.generateAuthorityMetadataCacheKey(c.preferred_cache),this.cacheManager.setAuthorityMetadata(w,c),this.metadata=c,[2]}}))}))},Authority.prototype.updateEndpointMetadata=function(c){var y,v;return _tslib_awaiter(this,void 0,void 0,(function(){var w,C;return _tslib_generator(this,(function(b){switch(b.label){case 0:return(w=this.getEndpointMetadataFromConfig())?(c.updateEndpointMetadata(w,!1),[2,Je.CONFIG]):this.isAuthoritySameType(c)&&c.endpointsFromNetwork&&!c.isExpired()?[2,Je.CACHE]:(C=this.getEndpointMetadataFromHardcodedValues(),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(w=b.sent())?(null===(y=this.authorityOptions.azureRegionConfiguration)||void 0===y?void 0:y.azureRegion)?[4,this.updateMetadataWithRegionalInformation(w)]:[3,3]:[3,4];case 2:w=b.sent(),b.label=3;case 3:return c.updateEndpointMetadata(w,!0),[2,Je.NETWORK];case 4:return!C||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(v=this.authorityOptions.azureRegionConfiguration)||void 0===v?void 0:v.azureRegion)?[4,this.updateMetadataWithRegionalInformation(C)]:[3,6];case 5:C=b.sent(),b.label=6;case 6:return c.updateEndpointMetadata(C,!1),[2,Je.HARDCODED_VALUES];case 7:throw pn.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},Authority.prototype.isAuthoritySameType=function(c){return new zi(c.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},Authority.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(c){throw Ei.createInvalidAuthorityMetadataError()}return null},Authority.prototype.getEndpointMetadataFromNetwork=function(){return _tslib_awaiter(this,void 0,void 0,(function(){var c,y;return _tslib_generator(this,(function(v){switch(v.label){case 0:c={},this.proxyUrl&&(c.proxyUrl=this.proxyUrl),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,c)];case 2:return[2,isOpenIdConfigResponse((y=v.sent()).body)?y.body:null];case 3:return v.sent(),[2,null];case 4:return[2]}}))}))},Authority.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in _a?_a[this.canonicalAuthority]:null},Authority.prototype.updateMetadataWithRegionalInformation=function(c){var y,v,w,C,b;return _tslib_awaiter(this,void 0,void 0,(function(){var S,T;return _tslib_generator(this,(function(I){switch(I.label){case 0:return[4,this.regionDiscovery.detectRegion(null===(y=this.authorityOptions.azureRegionConfiguration)||void 0===y?void 0:y.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)];case 1:return S=I.sent(),T=(null===(v=this.authorityOptions.azureRegionConfiguration)||void 0===v?void 0:v.azureRegion)===ne.AZURE_REGION_AUTO_DISCOVER_FLAG?S:null===(w=this.authorityOptions.azureRegionConfiguration)||void 0===w?void 0:w.azureRegion,(null===(C=this.authorityOptions.azureRegionConfiguration)||void 0===C?void 0:C.azureRegion)===ne.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=S?St.AUTO_DETECTION_REQUESTED_SUCCESSFUL:St.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=S?(null===(b=this.authorityOptions.azureRegionConfiguration)||void 0===b?void 0:b.azureRegion)===S?St.CONFIGURED_MATCHES_DETECTED:St.CONFIGURED_NOT_DETECTED:St.CONFIGURED_NO_AUTO_DETECTION,T?(this.regionDiscoveryMetadata.region_used=T,[2,Authority.replaceWithRegionalInformation(c,T)]):[2,c]}}))}))},Authority.prototype.updateCloudDiscoveryMetadata=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v;return _tslib_generator(this,(function(w){switch(w.label){case 0:return(y=this.getCloudDiscoveryMetadataFromConfig())?(c.updateCloudDiscoveryMetadata(y,!1),[2,Je.CONFIG]):this.isAuthoritySameType(c)&&c.aliasesFromNetwork&&!c.isExpired()?[2,Je.CACHE]:(v=this.getCloudDiscoveryMetadataFromHarcodedValues(),[4,this.getCloudDiscoveryMetadataFromNetwork()]);case 1:if(y=w.sent())return c.updateCloudDiscoveryMetadata(y,!0),[2,Je.NETWORK];if(v&&!this.options.skipAuthorityMetadataCache)return c.updateCloudDiscoveryMetadata(v,!1),[2,Je.HARDCODED_VALUES];throw Ei.createUntrustedAuthorityError()}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var c=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),y=Authority.getCloudDiscoveryMetadataFromNetworkResponse(c.metadata,this.hostnameAndPort);if(y)return y}catch(c){throw Ei.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},Authority.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return _tslib_awaiter(this,void 0,void 0,(function(){var c,y,v,w,C;return _tslib_generator(this,(function(b){switch(b.label){case 0:c=""+ne.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",y={},this.proxyUrl&&(y.proxyUrl=this.proxyUrl),v=null,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(c,y)];case 2:return w=b.sent(),C=
/*! @azure/msal-common v7.3.0 2022-08-01 */
function isCloudInstanceDiscoveryResponse(c){return c.hasOwnProperty("tenant_discovery_endpoint")&&c.hasOwnProperty("metadata")}(w.body)?w.body.metadata:[],0===C.length?[2,null]:(v=Authority.getCloudDiscoveryMetadataFromNetworkResponse(C,this.hostnameAndPort),[3,4]);case 3:return b.sent(),[2,null];case 4:return v||(v=Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,v]}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in ba?ba[this.canonicalAuthority]:null},Authority.prototype.isInKnownAuthorities=function(){var c=this;return this.authorityOptions.knownAuthorities.filter((function(y){return zi.getDomainFromUrl(y).toLowerCase()===c.hostnameAndPort})).length>0},Authority.generateAuthority=function(c,y){var v;if(y&&y.azureCloudInstance!==Ui.None){var w=y.tenant?y.tenant:ne.DEFAULT_COMMON_TENANT;v=y.azureCloudInstance+"/"+w+"/"}return v||c},Authority.createCloudDiscoveryMetadataFromHost=function(c){return{preferred_network:c,preferred_cache:c,aliases:[c]}},Authority.getCloudDiscoveryMetadataFromNetworkResponse=function(c,y){for(var v=0;v<c.length;v++){var w=c[v];if(w.aliases.indexOf(y)>-1)return w}return null},Authority.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw pn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},Authority.prototype.isAlias=function(c){return this.metadata.aliases.indexOf(c)>-1},Authority.isPublicCloudAuthority=function(c){return ne.KNOWN_PUBLIC_CLOUDS.indexOf(c)>=0},Authority.buildRegionalAuthorityString=function(c,y,v){var w=new zi(c);w.validateAsUri();var C=w.getUrlComponents(),b=y+"."+C.HostNameAndPort;this.isPublicCloudAuthority(C.HostNameAndPort)&&(b=y+"."+ne.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var S=zi.constructAuthorityUriFromObject(_tslib_assign(_tslib_assign({},w.getUrlComponents()),{HostNameAndPort:b})).urlString;return v?S+"?"+v:S},Authority.replaceWithRegionalInformation=function(c,y){return c.authorization_endpoint=Authority.buildRegionalAuthorityString(c.authorization_endpoint,y),c.token_endpoint=Authority.buildRegionalAuthorityString(c.token_endpoint,y,"allowestsrnonmsi=true"),c.end_session_endpoint&&(c.end_session_endpoint=Authority.buildRegionalAuthorityString(c.end_session_endpoint,y)),c},Authority}(),Ia=function(){function AuthorityFactory(){}return AuthorityFactory.createDiscoveredInstance=function(c,y,v,w,C){return _tslib_awaiter(this,void 0,void 0,(function(){var b,S;return _tslib_generator(this,(function(T){switch(T.label){case 0:b=AuthorityFactory.createInstance(c,y,v,w,C),T.label=1;case 1:return T.trys.push([1,3,,4]),[4,b.resolveEndpointsAsync()];case 2:return T.sent(),[2,b];case 3:throw S=T.sent(),pn.createEndpointDiscoveryIncompleteError(S);case 4:return[2]}}))}))},AuthorityFactory.createInstance=function(c,y,v,w,C){if(fn.isEmpty(c))throw Ei.createUrlEmptyError();return new Aa(c,y,v,w,C)},AuthorityFactory}(),Ra=function(){function ServerTelemetryManager(c,y){this.cacheOutcome=Tt.NO_CACHE_HIT,this.cacheManager=y,this.apiId=c.apiId,this.correlationId=c.correlationId,this.wrapperSKU=c.wrapperSKU||ne.EMPTY_STRING,this.wrapperVer=c.wrapperVer||ne.EMPTY_STRING,this.telemetryCacheKey=wt.CACHE_KEY+Ie.CACHE_KEY_SEPARATOR+c.clientId}return ServerTelemetryManager.prototype.generateCurrentRequestHeaderValue=function(){var c=""+this.apiId+wt.VALUE_SEPARATOR+this.cacheOutcome,y=[this.wrapperSKU,this.wrapperVer].join(wt.VALUE_SEPARATOR),v=[c,this.getRegionDiscoveryFields()].join(wt.VALUE_SEPARATOR);return[wt.SCHEMA_VERSION,v,y].join(wt.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.generateLastRequestHeaderValue=function(){var c=this.getLastRequests(),y=ServerTelemetryManager.maxErrorsToSend(c),v=c.failedRequests.slice(0,2*y).join(wt.VALUE_SEPARATOR),w=c.errors.slice(0,y).join(wt.VALUE_SEPARATOR),C=c.errors.length,b=[C,y<C?wt.OVERFLOW_TRUE:wt.OVERFLOW_FALSE].join(wt.VALUE_SEPARATOR);return[wt.SCHEMA_VERSION,c.cacheHits,v,w,b].join(wt.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.cacheFailedRequest=function(c){var y=this.getLastRequests();y.errors.length>=wt.MAX_CACHED_ERRORS&&(y.failedRequests.shift(),y.failedRequests.shift(),y.errors.shift()),y.failedRequests.push(this.apiId,this.correlationId),fn.isEmpty(c.subError)?fn.isEmpty(c.errorCode)?c&&c.toString()?y.errors.push(c.toString()):y.errors.push(wt.UNKNOWN_ERROR):y.errors.push(c.errorCode):y.errors.push(c.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,y)},ServerTelemetryManager.prototype.incrementCacheHits=function(){var c=this.getLastRequests();return c.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,c),c.cacheHits},ServerTelemetryManager.prototype.getLastRequests=function(){var c=new Pi;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||c},ServerTelemetryManager.prototype.clearTelemetryCache=function(){var c=this.getLastRequests(),y=ServerTelemetryManager.maxErrorsToSend(c);if(y===c.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var v=new Pi;v.failedRequests=c.failedRequests.slice(2*y),v.errors=c.errors.slice(y),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,v)}},ServerTelemetryManager.maxErrorsToSend=function(c){var y,v=0,w=0,C=c.errors.length;for(y=0;y<C;y++){var b=c.failedRequests[2*y]||ne.EMPTY_STRING,S=c.failedRequests[2*y+1]||ne.EMPTY_STRING,T=c.errors[y]||ne.EMPTY_STRING;if(!((w+=b.toString().length+S.toString().length+T.length+3)<wt.MAX_LAST_HEADER_BYTES))break;v+=1}return v},ServerTelemetryManager.prototype.getRegionDiscoveryFields=function(){var c=[];return c.push(this.regionUsed||ne.EMPTY_STRING),c.push(this.regionSource||ne.EMPTY_STRING),c.push(this.regionOutcome||ne.EMPTY_STRING),c.join(",")},ServerTelemetryManager.prototype.updateRegionDiscoveryMetadata=function(c){this.regionUsed=c.region_used,this.regionSource=c.region_source,this.regionOutcome=c.region_outcome},ServerTelemetryManager.prototype.setCacheOutcome=function(c){this.cacheOutcome=c},ServerTelemetryManager}(),ka=function(){function BaseInteractionClient(c,y,v,w,C,b,S,T,I){this.config=c,this.browserStorage=y,this.browserCrypto=v,this.networkClient=this.config.system.networkClient,this.eventHandler=C,this.navigationClient=b,this.nativeMessageHandler=T,this.correlationId=I||this.browserCrypto.createNewGuid(),this.logger=w.clone(Vt,ua,this.correlationId),this.performanceClient=S}return BaseInteractionClient.prototype.clearCacheOnLogout=function(c){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:if(!c)return[3,5];Jo.accountInfoIsEqual(c,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Jo.generateAccountCacheKey(c))];case 2:return y.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return y.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return y.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return y.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return y.sent(),[3,9];case 8:return y.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},BaseInteractionClient.prototype.initializeBaseRequest=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C;return __generator(this,(function(b){switch(b.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),y=c.authority||this.config.auth.authority,v=__spread(c&&c.scopes||[]),(w=__assign(__assign({},c),{correlationId:this.correlationId,authority:y,scopes:v})).authenticationScheme){if(w.authenticationScheme===vt.SSH){if(!c.sshJwk)throw Ei.createMissingSshJwkError();if(!c.sshKid)throw Ei.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+w.authenticationScheme+'" as configured in Auth request')}else w.authenticationScheme=vt.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!c.claims||fn.isEmpty(c.claims)?[3,2]:(C=w,[4,this.browserCrypto.hashString(c.claims)]);case 1:C.requestedClaimsHash=b.sent(),b.label=2;case 2:return[2,w]}}))}))},BaseInteractionClient.prototype.getRedirectUri=function(c){this.logger.verbose("getRedirectUri called");var y=c||this.config.auth.redirectUri||oa.getCurrentUri();return zi.getAbsoluteUrl(y,oa.getCurrentUri())},BaseInteractionClient.prototype.initializeServerTelemetryManager=function(c,y){this.logger.verbose("initializeServerTelemetryManager called");var v={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:c,forceRefresh:y||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Ra(v,this.browserStorage)},BaseInteractionClient.prototype.getDiscoveredAuthority=function(c){return __awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){switch(v.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),y={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},c?(this.logger.verbose("Creating discovered authority with request authority"),[4,Ia.createDiscoveredInstance(c,this.config.system.networkClient,this.browserStorage,y)]):[3,2];case 1:case 3:return[2,v.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,Ia.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,y)]}}))}))},BaseInteractionClient}(),Pa=function(c){function StandardInteractionClient(){return null!==c&&c.apply(this,arguments)||this}return __extends(StandardInteractionClient,c),StandardInteractionClient.prototype.initializeAuthorizationCodeRequest=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v;return __generator(this,(function(w){switch(w.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",c.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return y=w.sent(),v=__assign(__assign({},c),{redirectUri:c.redirectUri,code:ne.EMPTY_STRING,codeVerifier:y.verifier}),c.codeChallenge=y.challenge,c.codeChallengeMethod=ne.S256_CODE_CHALLENGE_METHOD,[2,v]}}))}))},StandardInteractionClient.prototype.initializeLogoutRequest=function(c){this.logger.verbose("initializeLogoutRequest called",null==c?void 0:c.correlationId);var y=__assign({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},c);if(c)if(c.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(c.account){var v=this.getLogoutHintFromIdTokenClaims(c.account);v&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),y.logoutHint=v)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return c&&null===c.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",y.correlationId):c&&c.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",y.correlationId),y.postLogoutRedirectUri=zi.getAbsoluteUrl(c.postLogoutRedirectUri,oa.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",y.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",y.correlationId),y.postLogoutRedirectUri=zi.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,oa.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",y.correlationId),y.postLogoutRedirectUri=zi.getAbsoluteUrl(oa.getCurrentUri(),oa.getCurrentUri())),y},StandardInteractionClient.prototype.getLogoutHintFromIdTokenClaims=function(c){var y=c.idTokenClaims;if(y){if(y.login_hint)return y.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},StandardInteractionClient.prototype.createAuthCodeClient=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w;return __generator(this,(function(C){switch(C.label){case 0:return[4,this.getClientConfiguration(c,y,v)];case 1:return w=C.sent(),[2,new Ca(w)]}}))}))},StandardInteractionClient.prototype.getClientConfiguration=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w;return __generator(this,(function(C){switch(C.label){case 0:return this.logger.verbose("getClientConfiguration called",this.correlationId),[4,this.getDiscoveredAuthority(y,v)];case 1:return w=C.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:w,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:c,libraryInfo:{sku:Vt,version:ua,cpu:ne.EMPTY_STRING,os:ne.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},StandardInteractionClient.prototype.validateAndExtractStateFromHash=function(c,y,v){if(this.logger.verbose("validateAndExtractStateFromHash called",v),!c.state)throw Io.createHashDoesNotContainStateError();var w=Wi.extractBrowserRequestState(this.browserCrypto,c.state);if(!w)throw Io.createUnableToParseStateError();if(w.interactionType!==y)throw Io.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",v),c.state},StandardInteractionClient.prototype.getDiscoveredAuthority=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w,C,b;return __generator(this,(function(S){switch(S.label){case 0:return this.logger.verbose("getDiscoveredAuthority called",this.correlationId),v=this.performanceClient.startMeasurement(I.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),w={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},C=c||this.config.auth.authority,b=Aa.generateAuthority(C,y||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),[4,Ia.createDiscoveredInstance(b,this.config.system.networkClient,this.browserStorage,w).then((function(c){return v.endMeasurement({success:!0}),c})).catch((function(c){throw v.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),c}))];case 1:return[2,S.sent()]}}))}))},StandardInteractionClient.prototype.initializeAuthorizationRequest=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w,C,b,S,T,I;return __generator(this,(function(P){switch(P.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),v=this.getRedirectUri(c.redirectUri),w={interactionType:y},C=Mi.setRequestState(this.browserCrypto,c&&c.state||ne.EMPTY_STRING,w),S=[{}],[4,this.initializeBaseRequest(c)];case 1:return b=__assign.apply(void 0,[__assign.apply(void 0,S.concat([P.sent()])),{redirectUri:v,state:C,nonce:c.nonce||this.browserCrypto.createNewGuid(),responseMode:de.FRAGMENT}]),(T=c.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+T.homeAccountId,this.correlationId),b.account=T),fn.isEmpty(b.loginHint)&&!T&&(I=this.browserStorage.getLegacyLoginHint())&&(b.loginHint=I),[2,b]}}))}))},StandardInteractionClient}(ka);!function(c){c.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",c.USER_CANCEL="USER_CANCEL",c.NO_NETWORK="NO_NETWORK",c.TRANSIENT_ERROR="TRANSIENT_ERROR",c.PERSISTENT_ERROR="PERSISTENT_ERROR",c.DISABLED="DISABLED",c.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(Sa||(Sa={}));var Oa={code:"ContentError"},Na={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Ma={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},xa=function(c){function NativeAuthError(y,v,w){var C=c.call(this,y,v)||this;return Object.setPrototypeOf(C,NativeAuthError.prototype),C.name="NativeAuthError",C.ext=w,C}return __extends(NativeAuthError,c),NativeAuthError.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==Sa.PERSISTENT_ERROR&&this.ext.status!==Sa.DISABLED)||this.errorCode===Oa.code},NativeAuthError.createError=function(c,y,v){if(v&&v.status)switch(v.status){case Sa.ACCOUNT_UNAVAILABLE:return Vo.createNativeAccountUnavailableError();case Sa.USER_INTERACTION_REQUIRED:return new Vo(c,y);case Sa.USER_CANCEL:return Io.createUserCancelledError();case Sa.NO_NETWORK:return Io.createNoNetworkConnectivityError()}return new NativeAuthError(c,y,v)},NativeAuthError.createUserSwitchError=function(){return new NativeAuthError(Na.code,Na.desc)},NativeAuthError.createTokensNotFoundInCacheError=function(){return new NativeAuthError(Ma.code,Ma.desc)},NativeAuthError}(or),Ua=function(c){function RefreshTokenClient(y,v){return c.call(this,y,v)||this}return _tslib_extends(RefreshTokenClient,c),RefreshTokenClient.prototype.acquireToken=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v,w;return _tslib_generator(this,(function(C){switch(C.label){case 0:return y=Ai.nowSeconds(),[4,this.executeTokenRequest(c,this.authority)];case 1:return v=C.sent(),(w=new Ea(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(v.body),[2,w.handleServerTokenResponse(v.body,this.authority,y,c,void 0,void 0,!0,c.forceCache)]}}))}))},RefreshTokenClient.prototype.acquireTokenByRefreshToken=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y,v;return _tslib_generator(this,(function(w){if(!c)throw Ei.createEmptyTokenRequestError();if(!c.account)throw pn.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(c.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(c,!0)]}catch(w){if(y=w instanceof Vo&&w.errorCode===Wo.code,v=w instanceof $o&&w.errorCode===Nt&&w.subError===Mt,y||v)return[2,this.acquireTokenWithCachedRefreshToken(c,!1)];throw w}return[2,this.acquireTokenWithCachedRefreshToken(c,!1)]}))}))},RefreshTokenClient.prototype.acquireTokenWithCachedRefreshToken=function(c,y){return _tslib_awaiter(this,void 0,void 0,(function(){var v,w;return _tslib_generator(this,(function(C){if(!(v=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,c.account,y)))throw Vo.createNoTokensFoundError();return w=_tslib_assign(_tslib_assign({},c),{refreshToken:v.secret,authenticationScheme:c.authenticationScheme||vt.BEARER,ccsCredential:{credential:c.account.homeAccountId,type:Yo.HOME_ACCOUNT_ID}}),[2,this.acquireToken(w)]}))}))},RefreshTokenClient.prototype.executeTokenRequest=function(c,y){var v;return _tslib_awaiter(this,void 0,void 0,(function(){var w,C,b,S,T,P;return _tslib_generator(this,(function(K){switch(K.label){case 0:return w=null===(v=this.performanceClient)||void 0===v?void 0:v.startMeasurement(I.RefreshTokenClientExecuteTokenRequest,c.correlationId),[4,this.createTokenRequestBody(c)];case 1:return C=K.sent(),b=this.createTokenQueryParameters(c),S=this.createTokenRequestHeaders(c.ccsCredential),T={clientId:this.config.authOptions.clientId,authority:y.canonicalAuthority,scopes:c.scopes,claims:c.claims,authenticationScheme:c.authenticationScheme,resourceRequestMethod:c.resourceRequestMethod,resourceRequestUri:c.resourceRequestUri,shrClaims:c.shrClaims,sshKid:c.sshKid},P=zi.appendQueryString(y.tokenEndpoint,b),[2,this.executePostToTokenEndpoint(P,C,S,T).then((function(c){return null==w||w.endMeasurement({success:!0}),c})).catch((function(c){throw null==w||w.endMeasurement({success:!1}),c}))]}}))}))},RefreshTokenClient.prototype.createTokenQueryParameters=function(c){var y=new ma;return c.tokenQueryParameters&&y.addExtraQueryParameters(c.tokenQueryParameters),y.createQueryString()},RefreshTokenClient.prototype.createTokenRequestBody=function(c){var y;return _tslib_awaiter(this,void 0,void 0,(function(){var v,w,C,b,S,T;return _tslib_generator(this,(function(P){switch(P.label){case 0:return v=c.correlationId,w=null===(y=this.performanceClient)||void 0===y?void 0:y.startMeasurement(I.BaseClientCreateTokenRequestHeaders,v),(C=new ma).addClientId(this.config.authOptions.clientId),C.addScopes(c.scopes),C.addGrantType(pe.REFRESH_TOKEN_GRANT),C.addClientInfo(),C.addLibraryInfo(this.config.libraryInfo),C.addApplicationTelemetry(this.config.telemetry.application),C.addThrottling(),this.serverTelemetryManager&&C.addServerTelemetry(this.serverTelemetryManager),C.addCorrelationId(v),C.addRefreshToken(c.refreshToken),this.config.clientCredentials.clientSecret&&C.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(b=this.config.clientCredentials.clientAssertion,C.addClientAssertion(b.assertion),C.addClientAssertionType(b.assertionType)),c.authenticationScheme!==vt.POP?[3,2]:[4,new va(this.cryptoUtils).generateCnf(c)];case 1:return S=P.sent(),C.addPopToken(S.reqCnfString),[3,3];case 2:if(c.authenticationScheme===vt.SSH){if(!c.sshJwk)throw null==w||w.endMeasurement({success:!1}),Ei.createMissingSshJwkError();C.addSshJwk(c.sshJwk)}P.label=3;case 3:if((!fn.isEmptyObj(c.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&C.addClaims(c.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&c.ccsCredential)switch(c.ccsCredential.type){case Yo.HOME_ACCOUNT_ID:try{T=buildClientInfoFromHomeAccountId(c.ccsCredential.credential),C.addCcsOid(T)}catch(c){this.logger.verbose("Could not parse home account ID for CCS Header: "+c)}break;case Yo.UPN:C.addCcsUpn(c.ccsCredential.credential)}return null==w||w.endMeasurement({success:!0}),[2,C.createQueryString()]}}))}))},RefreshTokenClient}(fa),La=function(c){function SilentFlowClient(y,v){return c.call(this,y,v)||this}return _tslib_extends(SilentFlowClient,c),SilentFlowClient.prototype.acquireToken=function(c){return _tslib_awaiter(this,void 0,void 0,(function(){var y;return _tslib_generator(this,(function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,this.acquireCachedToken(c)];case 1:return[2,v.sent()];case 2:if((y=v.sent())instanceof pn&&y.errorCode===Yr.code)return[2,new Ua(this.config,this.performanceClient).acquireTokenByRefreshToken(c)];throw y;case 3:return[2]}}))}))},SilentFlowClient.prototype.acquireCachedToken=function(c){var y,v,w,C;return _tslib_awaiter(this,void 0,void 0,(function(){var b,S;return _tslib_generator(this,(function(T){switch(T.label){case 0:if(!c)throw Ei.createEmptyTokenRequestError();if(c.forceRefresh)throw null===(y=this.serverTelemetryManager)||void 0===y||y.setCacheOutcome(Tt.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),pn.createRefreshRequiredError();if(!c.account)throw pn.createNoAccountInSilentRequestError();if(b=c.authority||this.authority.getPreferredCache(),!(S=this.cacheManager.readCacheRecord(c.account,this.config.authOptions.clientId,c,b)).accessToken)throw null===(v=this.serverTelemetryManager)||void 0===v||v.setCacheOutcome(Tt.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),pn.createRefreshRequiredError();if(Ai.wasClockTurnedBack(S.accessToken.cachedAt)||Ai.isTokenExpired(S.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(w=this.serverTelemetryManager)||void 0===w||w.setCacheOutcome(Tt.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),pn.createRefreshRequiredError();if(S.accessToken.refreshOn&&Ai.isTokenExpired(S.accessToken.refreshOn,0))throw null===(C=this.serverTelemetryManager)||void 0===C||C.setCacheOutcome(Tt.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),pn.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(S,c)];case 1:return[2,T.sent()]}}))}))},SilentFlowClient.prototype.generateResultFromCacheRecord=function(c,y){return _tslib_awaiter(this,void 0,void 0,(function(){var v;return _tslib_generator(this,(function(w){switch(w.label){case 0:return c.idToken&&(v=new _i(c.idToken.secret,this.config.cryptoInterface)),[4,Ea.generateAuthenticationResult(this.cryptoUtils,this.authority,c,!0,y,v)];case 1:return[2,w.sent()]}}))}))},SilentFlowClient}(fa),Fa=function(c){function SilentCacheClient(){return null!==c&&c.apply(this,arguments)||this}return __extends(SilentCacheClient,c),SilentCacheClient.prototype.acquireToken=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b;return __generator(this,(function(S){switch(S.label){case 0:return y=this.performanceClient.startMeasurement(I.SilentCacheClientAcquireToken,c.correlationId),v=this.initializeServerTelemetryManager(Bt.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(v,c.authority,c.azureCloudOptions)];case 1:w=S.sent(),this.logger.verbose("Silent auth client created"),S.label=2;case 2:return S.trys.push([2,4,,5]),[4,w.acquireCachedToken(c)];case 3:return C=S.sent(),y.endMeasurement({success:!0,fromCache:!0}),[2,C];case 4:throw(b=S.sent())instanceof Io&&b.errorCode===yo.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),y.endMeasurement({errorCode:b instanceof or&&b.errorCode||void 0,subErrorCode:b instanceof or&&b.subError||void 0,success:!1}),b;case 5:return[2]}}))}))},SilentCacheClient.prototype.logout=function(){return Promise.reject(Io.createSilentLogoutUnsupportedError())},SilentCacheClient.prototype.createSilentFlowClient=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w;return __generator(this,(function(C){switch(C.label){case 0:return[4,this.getClientConfiguration(c,y,v)];case 1:return w=C.sent(),[2,new La(w,this.performanceClient)]}}))}))},SilentCacheClient.prototype.initializeSilentRequest=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v;return __generator(this,(function(w){switch(w.label){case 0:return v=[__assign({},c)],[4,this.initializeBaseRequest(c)];case 1:return[2,__assign.apply(void 0,[__assign.apply(void 0,v.concat([w.sent()])),{account:y,forceRefresh:c.forceRefresh||!1}])]}}))}))},SilentCacheClient}(Pa),Ha=function(c){function NativeInteractionClient(y,v,w,C,b,S,T,I,P,K,Q,X){var te=c.call(this,y,v,w,C,b,S,I,P,X)||this;return te.apiId=T,te.accountId=K,te.nativeMessageHandler=P,te.nativeStorageManager=Q,te.silentCacheClient=new Fa(y,te.nativeStorageManager,w,C,b,S,I,P,X),te}return __extends(NativeInteractionClient,c),NativeInteractionClient.prototype.acquireToken=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T;return __generator(this,(function(P){switch(P.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),y=this.performanceClient.startMeasurement(I.NativeInteractionClientAcquireToken,c.correlationId),v=Ai.nowSeconds(),[4,this.initializeNativeRequest(c)];case 1:w=P.sent(),P.label=2;case 2:return P.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,w)];case 3:return C=P.sent(),y.endMeasurement({success:!0,isNativeBroker:!0,fromCache:!0}),[2,C];case 4:return P.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return b={method:xt.GetToken,request:w},[4,this.nativeMessageHandler.sendMessage(b)];case 6:return S=P.sent(),T=this.validateNativeResponse(S),[2,this.handleNativeResponse(T,w,v).then((function(c){return y.endMeasurement({success:!0,isNativeBroker:!0}),c})).catch((function(c){throw y.endMeasurement({success:!1,errorCode:c.errorCode,subErrorCode:c.subError,isNativeBroker:!0}),c}))]}}))}))},NativeInteractionClient.prototype.createSilentCacheRequest=function(c,y){return{authority:c.authority,correlationId:this.correlationId,scopes:Ci.fromString(c.scope).asArray(),account:y,forceRefresh:!1}},NativeInteractionClient.prototype.acquireTokensFromCache=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w,C;return __generator(this,(function(b){switch(b.label){case 0:if(!(v=this.browserStorage.readAccountFromCacheWithNativeAccountId(c)))throw pn.createNoAccountFoundError();w=v.getAccountInfo(),b.label=1;case 1:return b.trys.push([1,3,,4]),C=this.createSilentCacheRequest(y,w),[4,this.silentCacheClient.acquireToken(C)];case 2:return[2,b.sent()];case 3:throw b.sent();case 4:return[2]}}))}))},NativeInteractionClient.prototype.acquireTokenRedirect=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S;return __generator(this,(function(T){switch(T.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(c)];case 1:y=T.sent(),v={method:xt.GetToken,request:y},T.label=2;case 2:return T.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(v)];case 3:return w=T.sent(),this.validateNativeResponse(w),[3,5];case 4:if((C=T.sent())instanceof xa&&C.isFatal())throw C;return[3,5];case 5:return this.browserStorage.setTemporaryCache(Ft.NATIVE_REQUEST,JSON.stringify(y),!0),b={apiId:Bt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},S=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(c.redirectUri),[4,this.navigationClient.navigateExternal(S,b)];case 6:return T.sent(),[2]}}))}))},NativeInteractionClient.prototype.handleRedirectPromise=function(){return __awaiter(this,void 0,void 0,(function(){var c,y,v,w,C,b;return __generator(this,(function(S){switch(S.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(c=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ft.NATIVE_REQUEST)),y={method:xt.GetToken,request:c},v=Ai.nowSeconds(),S.label=1;case 1:return S.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(y)];case 2:return w=S.sent(),this.validateNativeResponse(w),C=this.handleNativeResponse(w,c,v),this.browserStorage.setInteractionInProgress(!1),[2,C];case 3:throw b=S.sent(),this.browserStorage.setInteractionInProgress(!1),b;case 4:return[2]}}))}))},NativeInteractionClient.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},NativeInteractionClient.prototype.handleNativeResponse=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w,C,b,S,T,I,P,K,Q,X,te,re,oe,ie,se,ue,de,pe,Ee,Ie=this;return __generator(this,(function(Ue){switch(Ue.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),c.account.id!==y.accountId)throw xa.createUserSwitchError();return w=new _i(c.id_token||ne.EMPTY_STRING,this.browserCrypto),[4,this.getDiscoveredAuthority(y.authority)];case 1:return C=Ue.sent(),b=C.getPreferredCache(),S=Jo.generateHomeAccountId(c.client_info||ne.EMPTY_STRING,Fo.Default,this.logger,this.browserCrypto,w),T=Jo.createAccount(c.client_info,S,w,void 0,void 0,void 0,b,c.account.id),this.browserStorage.setAccount(T),I=c.scope?Ci.fromString(c.scope):Ci.fromString(y.scope),P=c.account.properties||{},K=P.UID||w.claims.oid||w.claims.sub||ne.EMPTY_STRING,Q=P.TenantId||w.claims.tid||ne.EMPTY_STRING,te=vt.BEARER,y.tokenType===vt.POP?[3,2]:[3,4];case 2:if(te=vt.POP,c.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),X=c.shr,[3,5];if(re=new va(this.browserCrypto),oe={resourceRequestMethod:y.resourceRequestMethod,resourceRequestUri:y.resourceRequestUri,shrClaims:y.shrClaims,shrNonce:y.shrNonce},!y.keyId)throw pn.createKeyIdMissingError();return[4,re.signPopToken(c.access_token,y.keyId,oe)];case 3:return X=Ue.sent(),[3,5];case 4:X=c.access_token,Ue.label=5;case 5:return ie=this.getMATSFromResponse(c),se={authority:C.canonicalAuthority,uniqueId:K,tenantId:Q,scopes:I.asArray(),account:T.getAccountInfo(),idToken:c.id_token,idTokenClaims:w.claims,accessToken:X,fromCache:!!ie&&this.isResponseFromCache(ie),expiresOn:new Date(1e3*Number(v+c.expires_in)),tokenType:te,correlationId:this.correlationId,state:c.state,fromNativeBroker:!0},ue=Ti.createIdTokenEntity(S,y.authority,c.id_token||ne.EMPTY_STRING,y.clientId,w.claims.tid||ne.EMPTY_STRING),this.nativeStorageManager.setIdTokenCredential(ue),de=te===vt.POP?ne.SHR_NONCE_VALIDITY:("string"==typeof c.expires_in?parseInt(c.expires_in,10):c.expires_in)||0,pe=v+de,Ee=Ii.createAccessTokenEntity(S,y.authority,X,y.clientId,Q,I.printScopes(),pe,0,this.browserCrypto),this.nativeStorageManager.setAccessTokenCredential(Ee),this.browserStorage.removeAccountContext(T).catch((function(c){Ie.logger.error("Error occurred while removing account context from browser storage. "+c)})),[2,se]}}))}))},NativeInteractionClient.prototype.validateNativeResponse=function(c){if(c.hasOwnProperty("access_token")&&c.hasOwnProperty("id_token")&&c.hasOwnProperty("client_info")&&c.hasOwnProperty("account")&&c.hasOwnProperty("scope")&&c.hasOwnProperty("expires_in"))return c;throw xa.createUnexpectedError("Response missing expected properties.")},NativeInteractionClient.prototype.getMATSFromResponse=function(c){if(c.properties.MATS)try{return JSON.parse(c.properties.MATS)}catch(c){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},NativeInteractionClient.prototype.isResponseFromCache=function(c){return void 0===c.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!c.is_cached},NativeInteractionClient.prototype.initializeNativeRequest=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T,I,P,K=this;return __generator(this,(function(Q){switch(Q.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),y=c.authority||this.config.auth.authority,(v=new zi(y)).validateAsUri(),w=c.scopes,C=function __rest(c,y){var v={};for(var w in c)Object.prototype.hasOwnProperty.call(c,w)&&y.indexOf(w)<0&&(v[w]=c[w]);if(null!=c&&"function"==typeof Object.getOwnPropertySymbols){var C=0;for(w=Object.getOwnPropertySymbols(c);C<w.length;C++)y.indexOf(w[C])<0&&Object.prototype.propertyIsEnumerable.call(c,w[C])&&(v[w[C]]=c[w[C]])}return v}(c,["scopes"]),(b=new Ci(w||[])).appendScopes(oe),S=function(){switch(K.apiId){case Bt.ssoSilent:case Bt.acquireTokenSilent_silentFlow:return K.logger.trace("initializeNativeRequest: silent request sets prompt to none"),ue.NONE}if(c.prompt)switch(c.prompt){case ue.NONE:case ue.CONSENT:case ue.LOGIN:return K.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),c.prompt;default:throw K.logger.trace("initializeNativeRequest: prompt = "+c.prompt+" is not compatible with native flow"),Io.createNativePromptParameterNotSupportedError()}else K.logger.trace("initializeNativeRequest: prompt was not provided")},T=__assign(__assign({},C),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:v.urlString,scope:b.printScopes(),redirectUri:this.getRedirectUri(c.redirectUri),prompt:S(),correlationId:this.correlationId,tokenType:c.authenticationScheme,windowTitleSubstring:document.title,extraParameters:__assign(__assign(__assign({},c.extraQueryParameters),c.tokenQueryParameters),{telemetry:Jt}),extendedExpiryToken:!1}),c.authenticationScheme!==vt.POP?[3,2]:(I={resourceRequestUri:c.resourceRequestUri,resourceRequestMethod:c.resourceRequestMethod,shrClaims:c.shrClaims,shrNonce:c.shrNonce},[4,new va(this.browserCrypto).generateCnf(I)]);case 1:P=Q.sent(),T.reqCnf=P.reqCnfHash,T.keyId=P.kid,Q.label=2;case 2:return[2,T]}}))}))},NativeInteractionClient}(ka),Ba=function(){function NativeMessageHandler(c,y,v){this.logger=c,this.handshakeTimeoutMs=y,this.extensionId=v,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this)}return NativeMessageHandler.prototype.sendMessage=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v=this;return __generator(this,(function(w){return this.logger.trace("NativeMessageHandler - sendMessage called."),y={channel:$t,extensionId:this.extensionId,responseId:this.responseId++,body:c},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(y)),this.messageChannel.port1.postMessage(y),[2,new Promise((function(c,w){v.resolvers.set(y.responseId,{resolve:c,reject:w})}))]}))}))},NativeMessageHandler.createProvider=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w;return __generator(this,(function(C){switch(C.label){case 0:c.trace("NativeMessageHandler - createProvider called."),C.label=1;case 1:return C.trys.push([1,3,,5]),[4,(v=new NativeMessageHandler(c,y,Yt)).sendHandshakeRequest()];case 2:return C.sent(),[2,v];case 3:return C.sent(),[4,(w=new NativeMessageHandler(c,y)).sendHandshakeRequest()];case 4:return C.sent(),[2,w];case 5:return[2]}}))}))},NativeMessageHandler.prototype.sendHandshakeRequest=function(){return __awaiter(this,void 0,void 0,(function(){var c,y=this;return __generator(this,(function(v){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),c={channel:$t,extensionId:this.extensionId,responseId:this.responseId++,body:{method:xt.HandshakeRequest}},this.messageChannel.port1.onmessage=function(c){y.onChannelMessage(c)},window.postMessage(c,window.origin,[this.messageChannel.port2]),[2,new Promise((function(v,w){y.handshakeResolvers.set(c.responseId,{resolve:v,reject:w}),y.timeoutId=window.setTimeout((function(){window.removeEventListener("message",y.windowListener,!1),y.messageChannel.port1.close(),y.messageChannel.port2.close(),w(Io.createNativeHandshakeTimeoutError()),y.handshakeResolvers.delete(c.responseId)}),y.handshakeTimeoutMs)}))]}))}))},NativeMessageHandler.prototype.onWindowMessage=function(c){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),c.source===window){var y=c.data;if(y.channel&&y.channel===$t&&(!y.extensionId||y.extensionId===this.extensionId)&&y.body.method===xt.HandshakeRequest){this.logger.verbose(y.extensionId?"Extension with id: "+y.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var v=this.handshakeResolvers.get(y.responseId);v&&v.reject(Io.createNativeExtensionNotInstalledError())}}},NativeMessageHandler.prototype.onChannelMessage=function(c){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var y=c.data,v=this.resolvers.get(y.responseId),w=this.handshakeResolvers.get(y.responseId);try{var C=y.body.method;if(C===xt.Response){if(!v)return;var b=y.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(b)),"Success"!==b.status)v.reject(xa.createError(b.code,b.description,b.ext));else{if(!b.result)throw or.createUnexpectedError("Event does not contain result.");b.result.code&&b.result.description?v.reject(xa.createError(b.result.code,b.result.description,b.result.ext)):v.resolve(b.result)}this.resolvers.delete(y.responseId)}else if(C===xt.HandshakeResponse){if(!w)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=y.extensionId,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),w.resolve(),this.handshakeResolvers.delete(y.responseId)}}catch(y){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+y.toString()),this.logger.errorPii("Unable to parse "+c),v?v.reject(y):w&&w.reject(y)}},NativeMessageHandler.isNativeAvailable=function(c,y,v,w){if(y.trace("isNativeAvailable called"),!c.system.allowNativeBroker)return y.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!v)return y.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(w)switch(w){case vt.BEARER:case vt.POP:return y.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return y.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},NativeMessageHandler}(),Da=function(){function InteractionHandler(c,y,v,w){this.authModule=c,this.browserStorage=y,this.authCodeRequest=v,this.logger=w}return InteractionHandler.prototype.handleCodeResponseFromHash=function(c,y,v,w){return __awaiter(this,void 0,void 0,(function(){var C,b,S;return __generator(this,(function(T){if(this.logger.verbose("InteractionHandler.handleCodeResponse called"),fn.isEmpty(c))throw Io.createEmptyHashError(c);if(C=this.browserStorage.generateStateKey(y),!(b=this.browserStorage.getTemporaryCache(C)))throw pn.createStateNotFoundError("Cached State");try{S=this.authModule.handleFragmentResponse(c,b)}catch(c){throw c instanceof $o&&c.subError===Bn.code?Io.createUserCancelledError():c}return[2,this.handleCodeResponseFromServer(S,y,v,w)]}))}))},InteractionHandler.prototype.handleCodeResponseFromServer=function(c,y,v,w,C){return void 0===C&&(C=!0),__awaiter(this,void 0,void 0,(function(){var b,S,T,I,P,K;return __generator(this,(function(Q){switch(Q.label){case 0:if(this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),b=this.browserStorage.generateStateKey(y),!(S=this.browserStorage.getTemporaryCache(b)))throw pn.createStateNotFoundError("Cached State");return T=this.browserStorage.generateNonceKey(S),I=this.browserStorage.getTemporaryCache(T),this.authCodeRequest.code=c.code,c.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(c.cloud_instance_host_name,v,w)]:[3,2];case 1:Q.sent(),Q.label=2;case 2:return C&&(c.nonce=I||void 0),c.state=S,c.client_info?this.authCodeRequest.clientInfo=c.client_info:(P=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=P),[4,this.authModule.acquireToken(this.authCodeRequest,c)];case 3:return K=Q.sent(),this.browserStorage.cleanRequestByState(y),[2,K]}}))}))},InteractionHandler.prototype.updateTokenEndpointAuthority=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w,C;return __generator(this,(function(b){switch(b.label){case 0:return w="https://"+c+"/"+y.tenant+"/",[4,Ia.createDiscoveredInstance(w,v,this.browserStorage,y.options)];case 1:return C=b.sent(),this.authModule.updateAuthority(C),[2]}}))}))},InteractionHandler.prototype.checkCcsCredentials=function(){var c=this.browserStorage.getTemporaryCache(Ft.CCS_CREDENTIAL,!0);if(c)try{return JSON.parse(c)}catch(y){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+c)}return null},InteractionHandler}(),qa=function(c){function PopupClient(y,v,w,C,b,S,T,I,P,K){var Q=c.call(this,y,v,w,C,b,S,T,P,K)||this;return Q.unloadWindow=Q.unloadWindow.bind(Q),Q.nativeStorage=I,Q}return __extends(PopupClient,c),PopupClient.prototype.acquireToken=function(c){try{var y=this.generatePopupName(c.scopes||oe,c.authority||this.config.auth.authority),v=c.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(c,y,v);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var w=this.openSizedPopup("about:blank",y,v);return this.acquireTokenPopupAsync(c,y,v,w)}catch(c){return Promise.reject(c)}},PopupClient.prototype.logout=function(c){try{this.logger.verbose("logoutPopup called");var y=this.initializeLogoutRequest(c),v=this.generateLogoutPopupName(y),w=c&&c.authority,C=c&&c.mainWindowRedirectUri,b=(null==c?void 0:c.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(y,v,b,w,void 0,C);this.logger.verbose("asyncPopup set to false, opening popup");var S=this.openSizedPopup("about:blank",v,b);return this.logoutPopupAsync(y,v,b,w,S,C)}catch(c){return Promise.reject(c)}},PopupClient.prototype.acquireTokenPopupAsync=function(c,y,v,w){return __awaiter(this,void 0,void 0,(function(){var C,b,S,T,P,K,Q,X,te,re,oe,ie,se,ue,de,pe,Ee=this;return __generator(this,(function(Ie){switch(Ie.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),C=this.initializeServerTelemetryManager(Bt.acquireTokenPopup),[4,this.initializeAuthorizationRequest(c,Dt.Popup)];case 1:b=Ie.sent(),this.browserStorage.updateCacheEntries(b.state,b.nonce,b.authority,b.loginHint||ne.EMPTY_STRING,b.account||null),Ie.label=2;case 2:return Ie.trys.push([2,8,,9]),[4,this.initializeAuthorizationCodeRequest(b)];case 3:return S=Ie.sent(),[4,this.createAuthCodeClient(C,b.authority,b.azureCloudOptions)];case 4:return T=Ie.sent(),this.logger.verbose("Auth code client created"),P=Ba.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,c.authenticationScheme),K=void 0,P&&(K=this.performanceClient.startMeasurement(I.FetchAccountIdWithNativeBroker,c.correlationId)),[4,T.getAuthCodeUrl(__assign(__assign({},b),{nativeBroker:P}))];case 5:return Q=Ie.sent(),X=new Da(T,this.browserStorage,S,this.logger),te={popup:w,popupName:y,popupWindowAttributes:v},re=this.initiateAuthRequest(Q,te),this.eventHandler.emitEvent(sa.POPUP_OPENED,Dt.Popup,{popupWindow:re},null),[4,this.monitorPopupForHash(re)];case 6:if(oe=Ie.sent(),ie=zi.getDeserializedHash(oe),se=this.validateAndExtractStateFromHash(ie,Dt.Popup,b.correlationId),ha.removeThrottle(this.browserStorage,this.config.auth.clientId,S),ie.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),K&&K.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Io.createNativeConnectionNotEstablishedError();return ue=new Ha(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Bt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,ie.accountId,this.nativeStorage,b.correlationId),de=Mi.parseRequestState(this.browserCrypto,se).userRequestState,[2,ue.acquireToken(__assign(__assign({},b),{state:de,prompt:void 0})).finally((function(){Ee.browserStorage.cleanRequestByState(se)}))]}return[4,X.handleCodeResponseFromHash(oe,se,T.authority,this.networkClient)];case 7:return[2,Ie.sent()];case 8:throw pe=Ie.sent(),w&&w.close(),pe instanceof or&&pe.setCorrelationId(this.correlationId),C.cacheFailedRequest(pe),this.browserStorage.cleanRequestByState(b.state),pe;case 9:return[2]}}))}))},PopupClient.prototype.logoutPopupAsync=function(c,y,v,w,C,b){return __awaiter(this,void 0,void 0,(function(){var S,T,I,P,K,Q,X;return __generator(this,(function(te){switch(te.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(sa.LOGOUT_START,Dt.Popup,c),S=this.initializeServerTelemetryManager(Bt.logoutPopup),te.label=1;case 1:return te.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(c.account)];case 2:return te.sent(),[4,this.createAuthCodeClient(S,w)];case 3:return T=te.sent(),this.logger.verbose("Auth code client created"),I=T.getLogoutUri(c),this.eventHandler.emitEvent(sa.LOGOUT_SUCCESS,Dt.Popup,c),P=this.openPopup(I,{popupName:y,popupWindowAttributes:v,popup:C}),this.eventHandler.emitEvent(sa.POPUP_OPENED,Dt.Popup,{popupWindow:P},null),[4,this.waitForLogoutPopup(P)];case 4:return te.sent(),b?(K={apiId:Bt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},Q=zi.getAbsoluteUrl(b,oa.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+Q),this.navigationClient.navigateInternal(Q,K)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw X=te.sent(),C&&C.close(),X instanceof or&&X.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(sa.LOGOUT_FAILURE,Dt.Popup,null,X),this.eventHandler.emitEvent(sa.LOGOUT_END,Dt.Popup),S.cacheFailedRequest(X),X;case 6:return this.eventHandler.emitEvent(sa.LOGOUT_END,Dt.Popup),[2]}}))}))},PopupClient.prototype.initiateAuthRequest=function(c,y){if(fn.isEmpty(c))throw this.logger.error("Navigate url is empty"),Io.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+c),this.openPopup(c,y)},PopupClient.prototype.monitorPopupForHash=function(c){var y=this;return new Promise((function(v,w){var C=y.config.system.windowHashTimeout/Kt,b=0;y.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var S=setInterval((function(){if(c.closed)return y.logger.error("PopupHandler.monitorPopupForHash - window closed"),y.cleanPopup(),clearInterval(S),void w(Io.createUserCancelledError());var T=ne.EMPTY_STRING,I=ne.EMPTY_STRING;try{T=c.location.href,I=c.location.hash}catch(c){}fn.isEmpty(T)||"about:blank"===T||(y.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),b++,I?(y.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(S),y.cleanPopup(c),zi.hashContainsKnownProperties(I)?(y.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),v(I)):(y.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),y.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+I),w(Io.createHashDoesNotContainKnownPropertiesError()))):b>C&&(y.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(S),w(Io.createMonitorPopupTimeoutError())))}),Kt)}))},PopupClient.prototype.waitForLogoutPopup=function(c){var y=this;return new Promise((function(v){y.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var w=setInterval((function(){c.closed&&(y.logger.error("PopupHandler.waitForLogoutPopup - window closed"),y.cleanPopup(),clearInterval(w),v());var C=ne.EMPTY_STRING;try{C=c.location.href}catch(c){}fn.isEmpty(C)||"about:blank"===C||(y.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(w),y.cleanPopup(c),v())}),Kt)}))},PopupClient.prototype.openPopup=function(c,y){try{var v=void 0;if(y.popup?(v=y.popup,this.logger.verbosePii("Navigating popup window to: "+c),v.location.assign(c)):void 0===y.popup&&(this.logger.verbosePii("Opening popup window to: "+c),v=this.openSizedPopup(c,y.popupName,y.popupWindowAttributes)),!v)throw Io.createEmptyWindowCreatedError();return v.focus&&v.focus(),this.currentWindow=v,window.addEventListener("beforeunload",this.unloadWindow),v}catch(c){throw this.logger.error("error opening popup "+c.message),this.browserStorage.setInteractionInProgress(!1),Io.createPopupWindowError(c.toString())}},PopupClient.prototype.openSizedPopup=function(c,y,v){var w,C,b,S,T=window.screenLeft?window.screenLeft:window.screenX,I=window.screenTop?window.screenTop:window.screenY,P=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,K=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,Q=null===(w=v.popupSize)||void 0===w?void 0:w.width,X=null===(C=v.popupSize)||void 0===C?void 0:C.height,te=null===(b=v.popupPosition)||void 0===b?void 0:b.top,re=null===(S=v.popupPosition)||void 0===S?void 0:S.left;return(!Q||Q<0||Q>P)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),Q=Gt),(!X||X<0||X>K)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),X=zt),(!te||te<0||te>K)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),te=Math.max(0,K/2-zt/2+I)),(!re||re<0||re>P)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),re=Math.max(0,P/2-Gt/2+T)),window.open(c,y,"width="+Q+", height="+X+", top="+te+", left="+re+", scrollbars=yes")},PopupClient.prototype.unloadWindow=function(c){this.browserStorage.cleanRequestByInteractionType(Dt.Popup),this.currentWindow&&this.currentWindow.close(),c.preventDefault()},PopupClient.prototype.cleanPopup=function(c){c&&c.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},PopupClient.prototype.generatePopupName=function(c,y){return Wt+"."+this.config.auth.clientId+"."+c.join("-")+"."+y+"."+this.correlationId},PopupClient.prototype.generateLogoutPopupName=function(c){var y=c.account&&c.account.homeAccountId;return Wt+"."+this.config.auth.clientId+"."+y+"."+this.correlationId},PopupClient}(Pa),ja=function(c){function RedirectHandler(y,v,w,C,b){var S=c.call(this,y,v,w,C)||this;return S.browserCrypto=b,S}return __extends(RedirectHandler,c),RedirectHandler.prototype.initiateAuthRequest=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v;return __generator(this,(function(w){switch(w.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),fn.isEmpty(c)?[3,7]:(y.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Ft.ORIGIN_URI,y.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Ft.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+c),v={apiId:Bt.acquireTokenRedirect,timeout:y.redirectTimeout,noHistory:!1},"function"!=typeof y.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===y.onRedirectNavigate(c)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,y.navigationClient.navigateExternal(c,v)])));case 1:case 5:return w.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,y.navigationClient.navigateExternal(c,v)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Io.createEmptyNavigationUriError();case 8:return[2]}}))}))},RedirectHandler.prototype.handleCodeResponseFromHash=function(c,y,v,w){return __awaiter(this,void 0,void 0,(function(){var C,b,S,T,I,P,K;return __generator(this,(function(Q){switch(Q.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),fn.isEmpty(c))throw Io.createEmptyHashError(c);if(this.browserStorage.setInteractionInProgress(!1),C=this.browserStorage.generateStateKey(y),!(b=this.browserStorage.getTemporaryCache(C)))throw pn.createStateNotFoundError("Cached State");try{S=this.authModule.handleFragmentResponse(c,b)}catch(c){throw c instanceof $o&&c.subError===Bn.code?Io.createUserCancelledError():c}return T=this.browserStorage.generateNonceKey(b),I=this.browserStorage.getTemporaryCache(T),this.authCodeRequest.code=S.code,S.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(S.cloud_instance_host_name,v,w)]:[3,2];case 1:Q.sent(),Q.label=2;case 2:return S.nonce=I||void 0,S.state=b,S.client_info?this.authCodeRequest.clientInfo=S.client_info:(P=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=P),[4,this.authModule.acquireToken(this.authCodeRequest,S)];case 3:return K=Q.sent(),this.browserStorage.cleanRequestByState(y),[2,K]}}))}))},RedirectHandler}(Da),Ga=function(c){function RedirectClient(y,v,w,C,b,S,T,I,P,K){var Q=c.call(this,y,v,w,C,b,S,T,P,K)||this;return Q.nativeStorage=I,Q}return __extends(RedirectClient,c),RedirectClient.prototype.acquireToken=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T,I,P,K=this;return __generator(this,(function(Q){switch(Q.label){case 0:return[4,this.initializeAuthorizationRequest(c,Dt.Redirect)];case 1:y=Q.sent(),this.browserStorage.updateCacheEntries(y.state,y.nonce,y.authority,y.loginHint||ne.EMPTY_STRING,y.account||null),v=this.initializeServerTelemetryManager(Bt.acquireTokenRedirect),w=function(c){c.persisted&&(K.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),K.browserStorage.cleanRequestByState(y.state))},Q.label=2;case 2:return Q.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(y)];case 3:return C=Q.sent(),[4,this.createAuthCodeClient(v,y.authority,y.azureCloudOptions)];case 4:return b=Q.sent(),this.logger.verbose("Auth code client created"),S=new ja(b,this.browserStorage,C,this.logger,this.browserCrypto),[4,b.getAuthCodeUrl(__assign(__assign({},y),{nativeBroker:Ba.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,c.authenticationScheme)}))];case 5:return T=Q.sent(),I=this.getRedirectStartPage(c.redirectStartPage),this.logger.verbosePii("Redirect start page: "+I),window.addEventListener("pageshow",w),[4,S.initiateAuthRequest(T,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:I,onRedirectNavigate:c.onRedirectNavigate})];case 6:return[2,Q.sent()];case 7:throw(P=Q.sent())instanceof or&&P.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",w),v.cacheFailedRequest(P),this.browserStorage.cleanRequestByState(y.state),P;case 8:return[2]}}))}))},RedirectClient.prototype.handleRedirectPromise=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T,I,P,K,Q,X;return __generator(this,(function(te){switch(te.label){case 0:y=this.initializeServerTelemetryManager(Bt.handleRedirectPromise),te.label=1;case 1:if(te.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(v=this.getRedirectResponseHash(c||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Dt.Redirect),[2,null];w=void 0;try{C=zi.getDeserializedHash(v),w=this.validateAndExtractStateFromHash(C,Dt.Redirect),this.logger.verbose("State extracted from hash")}catch(c){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+c),this.browserStorage.cleanRequestByInteractionType(Dt.Redirect),[2,null]}return b=this.browserStorage.getTemporaryCache(Ft.ORIGIN_URI,!0)||ne.EMPTY_STRING,S=zi.removeHashFromUrl(b),T=zi.removeHashFromUrl(window.location.href),S===T&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(v,w,y)]):[3,3];case 2:return I=te.sent(),b.indexOf("#")>-1&&oa.replaceHash(b),[2,I];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(v,w,y)]);case 4:return oa.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(Ft.URL_HASH,v,!0),P={apiId:Bt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},K=!0,b&&"null"!==b?[3,6]:(Q=oa.getHomepage(),this.browserStorage.setTemporaryCache(Ft.ORIGIN_URI,Q,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(Q,P)]));case 5:return K=te.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+b),[4,this.navigationClient.navigateInternal(b,P)];case 7:K=te.sent(),te.label=8;case 8:if(!K)return[2,this.handleHash(v,w,y)];te.label=9;case 9:return[2,null];case 10:throw(X=te.sent())instanceof or&&X.setCorrelationId(this.correlationId),y.cacheFailedRequest(X),this.browserStorage.cleanRequestByInteractionType(Dt.Redirect),X;case 11:return[2]}}))}))},RedirectClient.prototype.getRedirectResponseHash=function(c){if(this.logger.verbose("getRedirectResponseHash called"),zi.hashContainsKnownProperties(c))return oa.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),c;var y=this.browserStorage.getTemporaryCache(Ft.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ft.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),y},RedirectClient.prototype.handleHash=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w,C,b,S,T,I,P=this;return __generator(this,(function(K){switch(K.label){case 0:if(w=this.browserStorage.getCachedRequest(y,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(C=zi.getDeserializedHash(c)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Io.createNativeConnectionNotEstablishedError();return b=new Ha(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Bt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,C.accountId,this.browserStorage,w.correlationId),S=Mi.parseRequestState(this.browserCrypto,y).userRequestState,[2,b.acquireToken(__assign(__assign({},w),{state:S,prompt:void 0})).finally((function(){P.browserStorage.cleanRequestByState(y)}))]}if(!(T=this.browserStorage.getCachedAuthority(y)))throw Io.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(v,T)];case 1:return I=K.sent(),this.logger.verbose("Auth code client created"),ha.removeThrottle(this.browserStorage,this.config.auth.clientId,w),[4,new ja(I,this.browserStorage,w,this.logger,this.browserCrypto).handleCodeResponseFromHash(c,y,I.authority,this.networkClient)];case 2:return[2,K.sent()]}}))}))},RedirectClient.prototype.logout=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S;return __generator(this,(function(T){switch(T.label){case 0:this.logger.verbose("logoutRedirect called"),y=this.initializeLogoutRequest(c),v=this.initializeServerTelemetryManager(Bt.logout),T.label=1;case 1:return T.trys.push([1,10,,11]),this.eventHandler.emitEvent(sa.LOGOUT_START,Dt.Redirect,c),[4,this.clearCacheOnLogout(y.account)];case 2:return T.sent(),w={apiId:Bt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(v,c&&c.authority)];case 3:return C=T.sent(),this.logger.verbose("Auth code client created"),b=C.getLogoutUri(y),this.eventHandler.emitEvent(sa.LOGOUT_SUCCESS,Dt.Redirect,y),c&&"function"==typeof c.onRedirectNavigate?!1===c.onRedirectNavigate(b)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(b,w)]):[3,7];case 4:return T.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),T.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(b,w)];case 8:return T.sent(),[2];case 9:return[3,11];case 10:throw(S=T.sent())instanceof or&&S.setCorrelationId(this.correlationId),v.cacheFailedRequest(S),this.eventHandler.emitEvent(sa.LOGOUT_FAILURE,Dt.Redirect,null,S),this.eventHandler.emitEvent(sa.LOGOUT_END,Dt.Redirect),S;case 11:return this.eventHandler.emitEvent(sa.LOGOUT_END,Dt.Redirect),[2]}}))}))},RedirectClient.prototype.getRedirectStartPage=function(c){var y=c||window.location.href;return zi.getAbsoluteUrl(y,oa.getCurrentUri())},RedirectClient}(Pa),za=function(c){function SilentHandler(y,v,w,C,b){var S=c.call(this,y,v,w,C)||this;return S.navigateFrameWait=b,S}return __extends(SilentHandler,c),SilentHandler.prototype.initiateAuthRequest=function(c){return __awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){switch(v.label){case 0:if(fn.isEmpty(c))throw this.logger.info("Navigate url is empty"),Io.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(c)]:[3,2];case 1:return y=v.sent(),[3,3];case 2:y=this.loadFrameSync(c),v.label=3;case 3:return[2,y]}}))}))},SilentHandler.prototype.monitorIframeForHash=function(c,y){var v=this;return new Promise((function(w,C){y<aa&&v.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+y+"ms) than the default ("+"6000ms). This may result in timeouts.");var b=window.performance.now()+y,S=setInterval((function(){if(window.performance.now()>b)return v.removeHiddenIframe(c),clearInterval(S),void C(Io.createMonitorIframeTimeoutError());var y=ne.EMPTY_STRING,T=c.contentWindow;try{y=T?T.location.href:ne.EMPTY_STRING}catch(c){}if(!fn.isEmpty(y)){var I=T?T.location.hash:ne.EMPTY_STRING;return zi.hashContainsKnownProperties(I)?(v.removeHiddenIframe(c),clearInterval(S),void w(I)):void 0}}),Kt)}))},SilentHandler.prototype.loadFrame=function(c){var y=this;return new Promise((function(v,w){var C=y.createHiddenIframe();setTimeout((function(){C?(C.src=c,v(C)):w("Unable to load iframe")}),y.navigateFrameWait)}))},SilentHandler.prototype.loadFrameSync=function(c){var y=this.createHiddenIframe();return y.src=c,y},SilentHandler.prototype.createHiddenIframe=function(){var c=document.createElement("iframe");return c.style.visibility="hidden",c.style.position="absolute",c.style.width=c.style.height="0",c.style.border="0",c.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(c),c},SilentHandler.prototype.removeHiddenIframe=function(c){document.body===c.parentNode&&document.body.removeChild(c)},SilentHandler}(Da),Wa=function(c){function SilentIframeClient(y,v,w,C,b,S,T,I,P,K,Q){var X=c.call(this,y,v,w,C,b,S,I,K,Q)||this;return X.apiId=T,X.nativeStorage=P,X}return __extends(SilentIframeClient,c),SilentIframeClient.prototype.acquireToken=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b;return __generator(this,(function(S){switch(S.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),y=this.performanceClient.startMeasurement(I.SilentIframeClientAcquireToken,c.correlationId),fn.isEmpty(c.loginHint)&&fn.isEmpty(c.sid)&&(!c.account||fn.isEmpty(c.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),c.prompt&&c.prompt!==ue.NONE)throw y.endMeasurement({success:!1}),Io.createSilentPromptValueError(c.prompt);return[4,this.initializeAuthorizationRequest(__assign(__assign({},c),{prompt:ue.NONE}),Dt.Silent)];case 1:v=S.sent(),this.browserStorage.updateCacheEntries(v.state,v.nonce,v.authority,v.loginHint||ne.EMPTY_STRING,v.account||null),w=this.initializeServerTelemetryManager(this.apiId),S.label=2;case 2:return S.trys.push([2,5,,6]),[4,this.createAuthCodeClient(w,v.authority,v.azureCloudOptions)];case 3:return C=S.sent(),this.logger.verbose("Auth code client created"),[4,this.silentTokenHelper(C,v).then((function(c){return y.endMeasurement({success:!0,fromCache:!1}),c}))];case 4:return[2,S.sent()];case 5:throw(b=S.sent())instanceof or&&b.setCorrelationId(this.correlationId),w.cacheFailedRequest(b),this.browserStorage.cleanRequestByState(v.state),y.endMeasurement({errorCode:b instanceof or&&b.errorCode||void 0,subErrorCode:b instanceof or&&b.subError||void 0,success:!1}),b;case 6:return[2]}}))}))},SilentIframeClient.prototype.logout=function(){return Promise.reject(Io.createSilentLogoutUnsupportedError())},SilentIframeClient.prototype.silentTokenHelper=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w,C,b,S,T,I,P,K,Q=this;return __generator(this,(function(X){switch(X.label){case 0:return[4,this.initializeAuthorizationCodeRequest(y)];case 1:return v=X.sent(),[4,c.getAuthCodeUrl(__assign(__assign({},y),{nativeBroker:Ba.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,y.authenticationScheme)}))];case 2:return w=X.sent(),[4,(C=new za(c,this.browserStorage,v,this.logger,this.config.system.navigateFrameWait)).initiateAuthRequest(w)];case 3:return b=X.sent(),[4,C.monitorIframeForHash(b,this.config.system.iframeHashTimeout)];case 4:if(S=X.sent(),T=zi.getDeserializedHash(S),I=this.validateAndExtractStateFromHash(T,Dt.Silent,v.correlationId),T.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Io.createNativeConnectionNotEstablishedError();return P=new Ha(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,T.accountId,this.browserStorage,this.correlationId),K=Mi.parseRequestState(this.browserCrypto,I).userRequestState,[2,P.acquireToken(__assign(__assign({},y),{state:K,prompt:ue.NONE})).finally((function(){Q.browserStorage.cleanRequestByState(I)}))]}return[2,C.handleCodeResponseFromHash(S,I,c.authority,this.networkClient)]}}))}))},SilentIframeClient}(Pa),Ka=function(c){function SilentRefreshClient(){return null!==c&&c.apply(this,arguments)||this}return __extends(SilentRefreshClient,c),SilentRefreshClient.prototype.acquireToken=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S=this;return __generator(this,(function(T){switch(T.label){case 0:return v=[__assign({},c)],[4,this.initializeBaseRequest(c)];case 1:return y=__assign.apply(void 0,v.concat([T.sent()])),w=this.performanceClient.startMeasurement(I.SilentRefreshClientAcquireToken,y.correlationId),C=this.initializeServerTelemetryManager(Bt.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(C,y.authority,y.azureCloudOptions)];case 2:return b=T.sent(),this.logger.verbose("Refresh token client created"),[2,b.acquireTokenByRefreshToken(y).then((function(c){return w.endMeasurement({success:!0,fromCache:c.fromCache}),c})).catch((function(c){throw c instanceof or&&c.setCorrelationId(S.correlationId),C.cacheFailedRequest(c),w.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),c}))]}}))}))},SilentRefreshClient.prototype.logout=function(){return Promise.reject(Io.createSilentLogoutUnsupportedError())},SilentRefreshClient.prototype.createRefreshTokenClient=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){var w;return __generator(this,(function(C){switch(C.label){case 0:return[4,this.getClientConfiguration(c,y,v)];case 1:return w=C.sent(),[2,new Ua(w,this.performanceClient)]}}))}))},SilentRefreshClient}(Pa),Va=function(){function TokenCache(c,y,v,w){this.isBrowserEnvironment="undefined"!=typeof window,this.config=c,this.storage=y,this.logger=v,this.cryptoObj=w}return TokenCache.prototype.loadExternalTokens=function(c,y,v){if(this.logger.info("TokenCache - loadExternalTokens called"),!y.id_token)throw Io.createUnableToLoadTokenError("Please ensure server response includes id token.");if(c.account)this.loadIdToken(y.id_token,c.account.homeAccountId,c.account.environment,c.account.tenantId,v),this.loadAccessToken(c,y,c.account.homeAccountId,c.account.environment,c.account.tenantId,v);else{if(!c.authority)throw Io.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var w=Aa.generateAuthority(c.authority,c.azureCloudOptions),C={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},b=new Aa(w,this.config.system.networkClient,this.storage,C);if(v.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(y.id_token,v.clientInfo,b.hostnameAndPort,b.tenant,v),this.loadAccessToken(c,y,v.clientInfo,b.hostnameAndPort,b.tenant,v);else{if(!y.client_info)throw Io.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(y.id_token,y.client_info,b.hostnameAndPort,b.tenant,v),this.loadAccessToken(c,y,y.client_info,b.hostnameAndPort,b.tenant,v)}}},TokenCache.prototype.loadIdToken=function(c,y,v,w,C){var b=Ti.createIdTokenEntity(y,v,c,this.config.auth.clientId,w),S=new _i(c,this.cryptoObj),T=C.clientInfo?Jo.createAccount(C.clientInfo,y,S,void 0,void 0,void 0,v):Jo.createGenericAccount(y,S,void 0,void 0,void 0,v);if(!this.isBrowserEnvironment)throw Io.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(T),this.storage.setIdTokenCredential(b)},TokenCache.prototype.loadAccessToken=function(c,y,v,w,C,b){if(y.access_token){if(!y.expires_in)throw Io.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!b.extendedExpiresOn)throw Io.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var S=new Ci(c.scopes).printScopes(),T=b.expiresOn||y.expires_in+(new Date).getTime()/1e3,I=b.extendedExpiresOn,P=Ii.createAccessTokenEntity(v,w,y.access_token,this.config.auth.clientId,C,S,T,I,this.cryptoObj);if(!this.isBrowserEnvironment)throw Io.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(P)}else this.logger.verbose("TokenCache - No access token provided for caching")},TokenCache}(),$a=function(c){function HybridSpaAuthorizationCodeClient(y){var v=c.call(this,y)||this;return v.includeRedirectUri=!1,v}return __extends(HybridSpaAuthorizationCodeClient,c),HybridSpaAuthorizationCodeClient}(Ca),Ya=function(c){function SilentAuthCodeClient(y,v,w,C,b,S,T,I,P,K){var Q=c.call(this,y,v,w,C,b,S,I,P,K)||this;return Q.apiId=T,Q}return __extends(SilentAuthCodeClient,c),SilentAuthCodeClient.prototype.acquireToken=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S;return __generator(this,(function(T){switch(T.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!c.code)throw Io.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(c,Dt.Silent)];case 1:y=T.sent(),this.browserStorage.updateCacheEntries(y.state,y.nonce,y.authority,y.loginHint||ne.EMPTY_STRING,y.account||null),v=this.initializeServerTelemetryManager(this.apiId),T.label=2;case 2:return T.trys.push([2,4,,5]),w=__assign(__assign({},y),{code:c.code}),[4,this.getClientConfiguration(v,y.authority)];case 3:return C=T.sent(),b=new $a(C),this.logger.verbose("Auth code client created"),[2,new za(b,this.browserStorage,w,this.logger,this.config.system.navigateFrameWait).handleCodeResponseFromServer({code:c.code,msgraph_host:c.msGraphHost,cloud_graph_host_name:c.cloudGraphHostName,cloud_instance_host_name:c.cloudInstanceHostName},y.state,b.authority,this.networkClient,!1)];case 4:throw(S=T.sent())instanceof or&&S.setCorrelationId(this.correlationId),v.cacheFailedRequest(S),this.browserStorage.cleanRequestByState(y.state),S;case 5:return[2]}}))}))},SilentAuthCodeClient.prototype.logout=function(){return Promise.reject(Io.createSilentLogoutUnsupportedError())},SilentAuthCodeClient}(Pa),Ja=function(){function BrowserPerformanceMeasurement(c,y){this.correlationId=y,this.measureName="msal.measure."+c+"."+this.correlationId,this.startMark="msal.start."+c+"."+this.correlationId,this.endMark="msal.end."+c+"."+this.correlationId}return BrowserPerformanceMeasurement.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},BrowserPerformanceMeasurement.prototype.startMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(c){}},BrowserPerformanceMeasurement.prototype.endMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(c){}},BrowserPerformanceMeasurement.prototype.flushMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{var c=window.performance.getEntriesByName(this.measureName,"measure");if(c.length>0){var y=c[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),y}}catch(c){}return null},BrowserPerformanceMeasurement}(),Qa=function(c){function BrowserPerformanceClient(y,v,w,C,b,S){var T=c.call(this,y,v,w,C,b,S)||this;return T.browserCrypto=new Oo(T.logger),T.guidGenerator=new lr(T.browserCrypto),T}return __extends(BrowserPerformanceClient,c),BrowserPerformanceClient.prototype.startPerformanceMeasuremeant=function(c,y){return new Ja(c,y)},BrowserPerformanceClient.prototype.generateId=function(){return this.guidGenerator.generateGuid()},BrowserPerformanceClient.prototype.getPageVisibility=function(){var c;return(null===(c=document.visibilityState)||void 0===c?void 0:c.toString())||null},BrowserPerformanceClient.prototype.startMeasurement=function(y,v){var w=this,C=this.getPageVisibility(),b=c.prototype.startMeasurement.call(this,y,v);return __assign(__assign({},b),{endMeasurement:function(c){return b.endMeasurement(__assign({startPageVisibility:C,endPageVisibility:w.getPageVisibility()},c))}})},BrowserPerformanceClient}(Bo),Za=function(){function ClientApplication(c){var y,v,w;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function buildConfiguration(c,y){var v=c.auth,w=c.cache,C=c.system,b=c.telemetry,S={clientId:ne.EMPTY_STRING,authority:""+ne.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:ne.EMPTY_STRING,authorityMetadata:ne.EMPTY_STRING,redirectUri:ne.EMPTY_STRING,postLogoutRedirectUri:ne.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:xi.AAD,azureCloudOptions:{azureCloudInstance:Ui.None,tenant:ne.EMPTY_STRING},skipAuthorityMetadataCache:!1},T={cacheLocation:Ut.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},I={loggerCallback:function(){},logLevel:Uo.Info,piiLoggingEnabled:!1},P=__assign(__assign({},$i),{loggerOptions:I,networkClient:y?oa.getBrowserNetworkClient():ta,navigationClient:new ia,loadFrameTimeout:0,windowHashTimeout:(null==C?void 0:C.loadFrameTimeout)||6e4,iframeHashTimeout:(null==C?void 0:C.loadFrameTimeout)||aa,navigateFrameWait:y&&oa.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==C?void 0:C.nativeBrokerHandshakeTimeout)||2e3}),K={application:{appName:ne.EMPTY_STRING,appVersion:ne.EMPTY_STRING}};return{auth:__assign(__assign({},S),v),cache:__assign(__assign({},T),w),system:__assign(__assign({},P),C),telemetry:__assign(__assign({},K),b)}}(c,this.isBrowserEnvironment),this.initialized=!1,this.logger=new Ho(this.config.system.loggerOptions,ca,ua),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new Qa(this.config.auth.clientId,this.config.auth.authority,this.logger,ca,ua,this.config.telemetry.application):new qo(this.config.auth.clientId,this.config.auth.authority,this.logger,ca,ua,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Lo(this.logger,this.performanceClient):jo,this.eventHandler=new da(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Ki(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(y=this.config.auth.clientId,v=this.logger,w={cacheLocation:Ut.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},new Ki(y,w,jo,v));var C={cacheLocation:Ut.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};this.nativeInternalStorage=new Ki(this.config.auth.clientId,C,this.browserCrypto,this.logger),this.tokenCache=new Va(this.config,this.browserStorage,this.logger,this.browserCrypto)}return ClientApplication.prototype.initialize=function(){return __awaiter(this,void 0,void 0,(function(){var c,y;return __generator(this,(function(v){switch(v.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(this.eventHandler.emitEvent(sa.INITIALIZE_START),!this.config.system.allowNativeBroker)return[3,4];v.label=1;case 1:return v.trys.push([1,3,,4]),c=this,[4,Ba.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout)];case 2:return c.nativeExtensionProvider=v.sent(),[3,4];case 3:return y=v.sent(),this.logger.verbose(y),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(sa.INITIALIZE_END),[2]}}))}))},ClientApplication.prototype.handleRedirectPromise=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T,I,P=this;return __generator(this,(function(K){return this.logger.verbose("handleRedirectPromise called"),oa.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),y=this.getAllAccounts(),this.isBrowserEnvironment?(v=c||ne.EMPTY_STRING,void 0===(w=this.redirectResponse.get(v))?(this.eventHandler.emitEvent(sa.HANDLE_REDIRECT_START,Dt.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),C=this.browserStorage.getCachedNativeRequest(),b=void 0,C&&Ba.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!c?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),S=new Ha(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Bt.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,C.accountId,this.nativeInternalStorage,C.correlationId),b=S.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),T=this.browserStorage.getTemporaryCache(Ft.CORRELATION_ID,!0)||ne.EMPTY_STRING,I=this.createRedirectClient(T),b=I.handleRedirectPromise(c)),w=b.then((function(c){c&&(y.length<P.getAllAccounts().length?(P.eventHandler.emitEvent(sa.LOGIN_SUCCESS,Dt.Redirect,c),P.logger.verbose("handleRedirectResponse returned result, login success")):(P.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_SUCCESS,Dt.Redirect,c),P.logger.verbose("handleRedirectResponse returned result, acquire token success")));return P.eventHandler.emitEvent(sa.HANDLE_REDIRECT_END,Dt.Redirect),c})).catch((function(c){throw y.length>0?P.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_FAILURE,Dt.Redirect,null,c):P.eventHandler.emitEvent(sa.LOGIN_FAILURE,Dt.Redirect,null,c),P.eventHandler.emitEvent(sa.HANDLE_REDIRECT_END,Dt.Redirect),c})),this.redirectResponse.set(v,w)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,w]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},ClientApplication.prototype.acquireTokenRedirect=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S=this;return __generator(this,(function(T){return y=this.getRequestCorrelationId(c),this.logger.verbose("acquireTokenRedirect called",y),this.preflightBrowserEnvironmentCheck(Dt.Redirect),(v=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_START,Dt.Redirect,c):this.eventHandler.emitEvent(sa.LOGIN_START,Dt.Redirect,c),this.nativeExtensionProvider&&this.canUseNative(c)?(C=new Ha(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Bt.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(c),this.nativeInternalStorage,c.correlationId),w=C.acquireTokenRedirect(c).catch((function(y){if(y instanceof xa&&y.isFatal())return S.nativeExtensionProvider=void 0,S.createRedirectClient(c.correlationId).acquireToken(c);if(y instanceof Vo)return S.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),S.createRedirectClient(c.correlationId).acquireToken(c);throw S.browserStorage.setInteractionInProgress(!1),y}))):(b=this.createRedirectClient(c.correlationId),w=b.acquireToken(c)),[2,w.catch((function(c){throw v?S.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_FAILURE,Dt.Redirect,null,c):S.eventHandler.emitEvent(sa.LOGIN_FAILURE,Dt.Redirect,null,c),c}))]}))}))},ClientApplication.prototype.acquireTokenPopup=function(c){var y=this,v=this.getRequestCorrelationId(c),w=this.performanceClient.startMeasurement(I.AcquireTokenPopup,v);try{this.logger.verbose("acquireTokenPopup called",v),this.preflightBrowserEnvironmentCheck(Dt.Popup)}catch(c){return Promise.reject(c)}var C,b=this.getAllAccounts();(b.length>0?this.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_START,Dt.Popup,c):this.eventHandler.emitEvent(sa.LOGIN_START,Dt.Popup,c),this.canUseNative(c))?C=this.acquireTokenNative(c,Bt.acquireTokenPopup).then((function(c){return y.browserStorage.setInteractionInProgress(!1),w.endMeasurement({success:!0,isNativeBroker:!0,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),w.flushMeasurement(),c})).catch((function(v){if(v instanceof xa&&v.isFatal())return y.nativeExtensionProvider=void 0,y.createPopupClient(c.correlationId).acquireToken(c);if(v instanceof Vo)return y.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),y.createPopupClient(c.correlationId).acquireToken(c);throw y.browserStorage.setInteractionInProgress(!1),v})):C=this.createPopupClient(c.correlationId).acquireToken(c);return C.then((function(c){return b.length<y.getAllAccounts().length?y.eventHandler.emitEvent(sa.LOGIN_SUCCESS,Dt.Popup,c):y.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_SUCCESS,Dt.Popup,c),w.endMeasurement({success:!0,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),w.flushMeasurement(),c})).catch((function(c){return b.length>0?y.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_FAILURE,Dt.Popup,null,c):y.eventHandler.emitEvent(sa.LOGIN_FAILURE,Dt.Popup,null,c),w.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),w.flushMeasurement(),Promise.reject(c)}))},ClientApplication.prototype.ssoSilent=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S=this;return __generator(this,(function(T){return y=this.getRequestCorrelationId(c),v=__assign(__assign({},c),{prompt:ue.NONE,correlationId:y}),this.preflightBrowserEnvironmentCheck(Dt.Silent),w=this.performanceClient.startMeasurement(I.SsoSilent,y),this.logger.verbose("ssoSilent called",y),this.eventHandler.emitEvent(sa.SSO_SILENT_START,Dt.Silent,v),this.canUseNative(v)?C=this.acquireTokenNative(v,Bt.ssoSilent).catch((function(c){if(c instanceof xa&&c.isFatal())return S.nativeExtensionProvider=void 0,S.createSilentIframeClient(v.correlationId).acquireToken(v);throw c})):(b=this.createSilentIframeClient(v.correlationId),C=b.acquireToken(v)),[2,C.then((function(c){return S.eventHandler.emitEvent(sa.SSO_SILENT_SUCCESS,Dt.Silent,c),w.endMeasurement({success:!0,isNativeBroker:c.fromNativeBroker,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),w.flushMeasurement(),c})).catch((function(c){throw S.eventHandler.emitEvent(sa.SSO_SILENT_FAILURE,Dt.Silent,null,c),w.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),w.flushMeasurement(),c}))]}))}))},ClientApplication.prototype.acquireTokenByCode=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b=this;return __generator(this,(function(S){y=this.getRequestCorrelationId(c),this.preflightBrowserEnvironmentCheck(Dt.Silent),this.logger.trace("acquireTokenByCode called",y),this.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_BY_CODE_START,Dt.Silent,c),v=this.performanceClient.startMeasurement(I.AcquireTokenByCode,c.correlationId);try{if(c.code)return w=c.code,(C=this.hybridAuthCodeResponses.get(w))?(this.logger.verbose("Existing acquireTokenByCode request found",c.correlationId),v.endMeasurement({success:!0}),v.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",y),C=this.acquireTokenByCodeAsync(__assign(__assign({},c),{correlationId:y})).then((function(c){return b.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Dt.Silent,c),b.hybridAuthCodeResponses.delete(w),v.endMeasurement({success:!0,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,isNativeBroker:c.fromNativeBroker}),v.flushMeasurement(),c})).catch((function(c){throw b.hybridAuthCodeResponses.delete(w),b.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_BY_CODE_FAILURE,Dt.Silent,null,c),v.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),v.flushMeasurement(),c})),this.hybridAuthCodeResponses.set(w,C)),[2,C];if(c.nativeAccountId){if(this.canUseNative(c,c.nativeAccountId))return[2,this.acquireTokenNative(c,Bt.acquireTokenByCode,c.nativeAccountId).catch((function(c){throw c instanceof xa&&c.isFatal()&&(b.nativeExtensionProvider=void 0),c}))];throw Io.createUnableToAcquireTokenFromNativePlatformError()}throw Io.createAuthCodeOrNativeAccountIdRequiredError()}catch(c){throw this.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_BY_CODE_FAILURE,Dt.Silent,null,c),v.endMeasurement({errorCode:c instanceof or&&c.errorCode||void 0,subErrorCode:c instanceof or&&c.subError||void 0,success:!1}),c}return[2]}))}))},ClientApplication.prototype.acquireTokenByCodeAsync=function(c){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",c.correlationId),[4,this.createSilentAuthCodeClient(c.correlationId).acquireToken(c)];case 1:return[2,y.sent()]}}))}))},ClientApplication.prototype.acquireTokenByRefreshToken=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v=this;return __generator(this,(function(w){return oa.blockReloadInHiddenIframes(),y=this.performanceClient.startMeasurement(I.AcquireTokenByRefreshToken,c.correlationId),this.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_NETWORK_START,Dt.Silent,c),[2,this.createSilentRefreshClient(c.correlationId).acquireToken(c).then((function(c){return y.endMeasurement({success:!0,fromCache:c.fromCache,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c})).catch((function(w){var C=w instanceof $o,b=w instanceof Vo,S=w.errorCode===jt;if(C&&S&&!b)return v.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",c.correlationId),v.createSilentIframeClient(c.correlationId).acquireToken(c).then((function(c){return y.endMeasurement({success:!0,fromCache:c.fromCache,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c})).catch((function(c){throw y.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),c}));throw y.endMeasurement({success:!1}),w}))]}))}))},ClientApplication.prototype.logout=function(c){return __awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){return y=this.getRequestCorrelationId(c),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",y),[2,this.logoutRedirect(__assign({correlationId:y},c))]}))}))},ClientApplication.prototype.logoutRedirect=function(c){return __awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){return y=this.getRequestCorrelationId(c),this.preflightBrowserEnvironmentCheck(Dt.Redirect),[2,this.createRedirectClient(y).logout(c)]}))}))},ClientApplication.prototype.logoutPopup=function(c){try{var y=this.getRequestCorrelationId(c);return this.preflightBrowserEnvironmentCheck(Dt.Popup),this.createPopupClient(y).logout(c)}catch(c){return Promise.reject(c)}},ClientApplication.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},ClientApplication.prototype.getAccountByUsername=function(c){var y=this.getAllAccounts();return!fn.isEmpty(c)&&y&&y.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+c),y.filter((function(y){return y.username.toLowerCase()===c.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByHomeId=function(c){var y=this.getAllAccounts();return!fn.isEmpty(c)&&y&&y.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+c),y.filter((function(y){return y.homeAccountId===c}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByLocalId=function(c){var y=this.getAllAccounts();return!fn.isEmpty(c)&&y&&y.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+c),y.filter((function(y){return y.localAccountId===c}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},ClientApplication.prototype.setActiveAccount=function(c){this.browserStorage.setActiveAccount(c)},ClientApplication.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},ClientApplication.prototype.preflightBrowserEnvironmentCheck=function(c,y){if(void 0===y&&(y=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),oa.blockNonBrowserEnvironment(this.isBrowserEnvironment),oa.blockRedirectInIframe(c,this.config.system.allowRedirectInIframe),oa.blockReloadInHiddenIframes(),oa.blockAcquireTokenInPopups(),oa.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),c===Dt.Redirect&&this.config.cache.cacheLocation===Ut.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw ji.createInMemoryRedirectUnavailableError();c!==Dt.Redirect&&c!==Dt.Popup||this.preflightInteractiveRequest(y)},ClientApplication.prototype.preflightInteractiveRequest=function(c){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),oa.blockReloadInHiddenIframes(),c&&this.browserStorage.setInteractionInProgress(!0)},ClientApplication.prototype.acquireTokenNative=function(c,y,v){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(w){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Io.createNativeConnectionNotEstablishedError();return[2,new Ha(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,y,this.performanceClient,this.nativeExtensionProvider,v||this.getNativeAccountId(c),this.nativeInternalStorage,c.correlationId).acquireToken(c)]}))}))},ClientApplication.prototype.canUseNative=function(c,y){if(this.logger.trace("canUseNative called"),!Ba.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,c.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(c.prompt)switch(c.prompt){case ue.NONE:case ue.CONSENT:case ue.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+c.prompt+" is not compatible with native flow, returning false"),!1}return!(!y&&!this.getNativeAccountId(c))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},ClientApplication.prototype.getNativeAccountId=function(c){var y=c.account||this.browserStorage.getAccountInfoByHints(c.loginHint,c.sid)||this.getActiveAccount();return y&&y.nativeAccountId||""},ClientApplication.prototype.createPopupClient=function(c){return new qa(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c)},ClientApplication.prototype.createRedirectClient=function(c){return new Ga(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c)},ClientApplication.prototype.createSilentIframeClient=function(c){return new Wa(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Bt.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,c)},ClientApplication.prototype.createSilentCacheClient=function(c){return new Fa(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,c)},ClientApplication.prototype.createSilentRefreshClient=function(c){return new Ka(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,c)},ClientApplication.prototype.createSilentAuthCodeClient=function(c){return new Ya(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Bt.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,c)},ClientApplication.prototype.addEventCallback=function(c){return this.eventHandler.addEventCallback(c)},ClientApplication.prototype.removeEventCallback=function(c){this.eventHandler.removeEventCallback(c)},ClientApplication.prototype.addPerformanceCallback=function(c){return this.performanceClient.addPerformanceCallback(c)},ClientApplication.prototype.removePerformanceCallback=function(c){return this.performanceClient.removePerformanceCallback(c)},ClientApplication.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},ClientApplication.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},ClientApplication.prototype.getTokenCache=function(){return this.tokenCache},ClientApplication.prototype.getLogger=function(){return this.logger},ClientApplication.prototype.setLogger=function(c){this.logger=c},ClientApplication.prototype.initializeWrapperLibrary=function(c,y){this.browserStorage.setWrapperMetadata(c,y)},ClientApplication.prototype.setNavigationClient=function(c){this.navigationClient=c},ClientApplication.prototype.getConfiguration=function(){return this.config},ClientApplication.prototype.getRequestCorrelationId=function(c){return(null==c?void 0:c.correlationId)?c.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():ne.EMPTY_STRING},ClientApplication}(),Xa=function(c){function PublicClientApplication(y){var v=c.call(this,y)||this;return v.activeSilentTokenRequests=new Map,v}return __extends(PublicClientApplication,c),PublicClientApplication.prototype.loginRedirect=function(c){return __awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){return y=this.getRequestCorrelationId(c),this.logger.verbose("loginRedirect called",y),[2,this.acquireTokenRedirect(__assign({correlationId:y},c||Zt))]}))}))},PublicClientApplication.prototype.loginPopup=function(c){var y=this.getRequestCorrelationId(c);return this.logger.verbose("loginPopup called",y),this.acquireTokenPopup(__assign({correlationId:y},c||Zt))},PublicClientApplication.prototype.acquireTokenSilent=function(c){return __awaiter(this,void 0,void 0,(function(){var y,v,w,C,b,S,T,P=this;return __generator(this,(function(K){if(y=this.getRequestCorrelationId(c),v=this.performanceClient.startMeasurement(I.AcquireTokenSilent,y),this.preflightBrowserEnvironmentCheck(Dt.Silent),this.logger.verbose("acquireTokenSilent called",y),!(w=c.account||this.getActiveAccount()))throw Io.createNoAccountError();return C={clientId:this.config.auth.clientId,authority:c.authority||ne.EMPTY_STRING,scopes:c.scopes,homeAccountIdentifier:w.homeAccountId,claims:c.claims,authenticationScheme:c.authenticationScheme,resourceRequestMethod:c.resourceRequestMethod,resourceRequestUri:c.resourceRequestUri,shrClaims:c.shrClaims,sshKid:c.sshKid},b=JSON.stringify(C),void 0===(S=this.activeSilentTokenRequests.get(b))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",y),T=this.acquireTokenSilentAsync(__assign(__assign({},c),{correlationId:y}),w).then((function(c){return P.activeSilentTokenRequests.delete(b),v.endMeasurement({success:!0,fromCache:c.fromCache,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,isNativeBroker:c.fromNativeBroker}),v.flushMeasurement(),c})).catch((function(c){throw P.activeSilentTokenRequests.delete(b),v.endMeasurement({success:!1}),v.flushMeasurement(),c})),this.activeSilentTokenRequests.set(b,T),[2,T]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",y),v.endMeasurement({success:!0}),v.discardMeasurement(),[2,S])}))}))},PublicClientApplication.prototype.acquireTokenSilentAsync=function(c,y){return __awaiter(this,void 0,void 0,(function(){var v,w,C,b,S,T=this;return __generator(this,(function(P){switch(P.label){case 0:return this.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_START,Dt.Silent,c),v=this.performanceClient.startMeasurement(I.AcquireTokenSilentAsync,c.correlationId),Ba.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,c.authenticationScheme)&&y.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),C=__assign(__assign({},c),{account:y}),w=this.acquireTokenNative(C,Bt.acquireTokenSilent_silentFlow).catch((function(y){return __awaiter(T,void 0,void 0,(function(){return __generator(this,(function(v){if(y instanceof xa&&y.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(c.correlationId).acquireToken(c)];throw y}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),[4,(b=this.createSilentCacheClient(c.correlationId)).initializeSilentRequest(c,y)];case 2:S=P.sent(),w=b.acquireToken(S).catch((function(){return __awaiter(T,void 0,void 0,(function(){return __generator(this,(function(c){return[2,this.acquireTokenByRefreshToken(S)]}))}))})),P.label=3;case 3:return[2,w.then((function(c){return T.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_SUCCESS,Dt.Silent,c),v.endMeasurement({success:!0,fromCache:c.fromCache,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,isNativeBroker:c.fromNativeBroker}),c})).catch((function(c){throw T.eventHandler.emitEvent(sa.ACQUIRE_TOKEN_FAILURE,Dt.Silent,null,c),v.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),c}))]}}))}))},PublicClientApplication}(Za);const es="@aptero/axolotis-module-teams/MicrosoftStaticService",ts="@aptero/axolotis-module-properties/Properties";function getMsProperties(){return(0,v.getServiceSync)(ts).get("@aptero/axolotis-module-teams")}function MicrosoftOauthLoginService_defineProperty(c,y,v){return y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v,c}let rs=__webpack_require__(789);class MicrosoftOauthLoginService{constructor(c,y){this.microsoftGraphService=c,this.msToNativeLoginBridge=y,MicrosoftOauthLoginService_defineProperty(this,"accessToken",null),MicrosoftOauthLoginService_defineProperty(this,"publicClientApplication",void 0)}getPublicClientApplication(){return this.publicClientApplication||(this.publicClientApplication=new Xa({auth:{clientId:getMsProperties().MICROSOFT_APP_ID,redirectUri:window.location.origin+"/signin",authority:getMsProperties().MICROSOFT_APP_AUTHORITY||"https://login.microsoftonline.com/common"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}})),this.publicClientApplication}async passiveLogin(){if(window.APP.store.state.profile.microsoftUser&&!this.accessToken)try{const c={scopes:["User.Read"],account:this.getPublicClientApplication().getAllAccounts()[0]};let y=await this.getPublicClientApplication().acquireTokenSilent(c);console.log(y.accessToken),this.initWithToken(y.accessToken)}catch(c){console.error(c),this.accessToken=null,this.msToNativeLoginBridge.clearProfile()}}setNewToken(c){this.accessToken=c;const y=rs.Client.init({authProvider:c=>{c(null,this.accessToken)}},this.accessToken);this.microsoftGraphService.init(y)}async initWithToken(c){this.setNewToken(c);const y=await this.microsoftGraphService.getUserDetails();let v="",w="";try{v=await this.microsoftGraphService.getUserPhotoAsBase64(),w=await this.microsoftGraphService.getUserOrganization()}catch(c){console.error(c)}await this.msToNativeLoginBridge.setProfile({email:y.userPrincipalName||y.mail||y.email,displayName:y.displayName,phoneNumber:y.mobilePhone,jobTitle:y.jobTitle,companyName:w,microsoftUserprofilePicture:v,microsoftUser:y.id});const C=y.userPrincipalName||y.mail||y.email;await this.msToNativeLoginBridge.nativeLogin(C,c)}async login(){console.log("MicrosoftOauthLoginService : userInteractionAuth");try{const c={scopes:["User.Read"]};let y=await this.getPublicClientApplication().loginPopup(c);await this.initWithToken(y.accessToken)}catch(c){console.error("error",c)}}async logout(){if(window.APP.store.state.profile.microsoftUser&&(this.msToNativeLoginBridge.clearProfile(),this.publicClientApplication))return this.getPublicClientApplication().logoutPopup()}}function e(c){this.message=c}e.prototype=new Error,e.prototype.name="InvalidCharacterError";var ns="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(c){var y=String(c).replace(/=+$/,"");if(y.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var v,w,C=0,b=0,S="";w=y.charAt(b++);~w&&(v=C%4?64*v+w:w,C++%4)?S+=String.fromCharCode(255&v>>(-2*C&6)):0)w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(w);return S};function t(c){var y=c.replace(/-/g,"+").replace(/_/g,"/");switch(y.length%4){case 0:break;case 2:y+="==";break;case 3:y+="=";break;default:throw"Illegal base64url string!"}try{return function(c){return decodeURIComponent(ns(c).replace(/(.)/g,(function(c,y){var v=y.charCodeAt(0).toString(16).toUpperCase();return v.length<2&&(v="0"+v),"%"+v})))}(y)}catch(c){return ns(y)}}function n(c){this.message=c}n.prototype=new Error,n.prototype.name="InvalidTokenError";const os=function o(c,y){if("string"!=typeof c)throw new n("Invalid token specified");var v=!0===(y=y||{}).header?0:1;try{return JSON.parse(t(c.split(".")[v]))}catch(c){throw new n("Invalid token specified: "+c.message)}};var is,as,ss=__webpack_require__(789);__webpack_require__(917);!function(c){c.InvalidParameter="InvalidParameter",c.InvalidConfiguration="InvalidConfiguration",c.InvalidCertificate="InvalidCertificate",c.InternalError="InternalError",c.ChannelNotSupported="ChannelNotSupported",c.RuntimeNotSupported="RuntimeNotSupported",c.ConsentFailed="ConsentFailed",c.UiRequiredError="UiRequiredError",c.TokenExpiredError="TokenExpiredError",c.ServiceError="ServiceError",c.FailedOperation="FailedOperation",c.InvalidResponse="InvalidResponse",c.IdentityTypeNotSupported="IdentityTypeNotSupported",c.AuthorizationInfoAlreadyExists="AuthorizationInfoAlreadyExists"}(is||(is={}));class ErrorMessage{}ErrorMessage.InvalidConfiguration="{0} in configuration is invalid: {1}.",ErrorMessage.ConfigurationNotExists="Configuration does not exist. {0}",ErrorMessage.ResourceConfigurationNotExists="{0} resource configuration does not exist.",ErrorMessage.MissingResourceConfiguration="Missing resource configuration with type: {0}, name: {1}.",ErrorMessage.AuthenticationConfigurationNotExists="Authentication configuration does not exist.",ErrorMessage.BrowserRuntimeNotSupported="{0} is not supported in browser.",ErrorMessage.NodejsRuntimeNotSupported="{0} is not supported in Node.",ErrorMessage.FailToAcquireTokenOnBehalfOfUser="Failed to acquire access token on behalf of user: {0}",ErrorMessage.OnlyMSTeamsChannelSupported="{0} is only supported in MS Teams Channel",ErrorMessage.IdentityTypeNotSupported="{0} identity is not supported in {1}",ErrorMessage.AuthorizationHeaderAlreadyExists="Authorization header already exists!",ErrorMessage.BasicCredentialAlreadyExists="Basic credential already exists!",ErrorMessage.EmptyParameter="Parameter {0} is empty",ErrorMessage.DuplicateHttpsOptionProperty="Axios HTTPS agent already defined value for property {0}",ErrorMessage.DuplicateApiKeyInHeader="The request already defined api key in request header with name {0}.",ErrorMessage.DuplicateApiKeyInQueryParam="The request already defined api key in query parameter with name {0}.";class ErrorWithCode extends Error{constructor(c,y){if(!y)return super(c),this;super(c),Object.setPrototypeOf(this,ErrorWithCode.prototype),this.name=`${new.target.name}.${y}`,this.code=y}}!function(c){c[c.Verbose=0]="Verbose",c[c.Info=1]="Info",c[c.Warn=2]="Warn",c[c.Error=3]="Error"}(as||(as={}));const cs=new class InternalLogger{constructor(c,y){this.level=void 0,this.defaultLogger={verbose:console.debug,info:console.info,warn:console.warn,error:console.error},this.name=c,this.level=y}error(c){this.log(as.Error,(c=>c.error),c)}warn(c){this.log(as.Warn,(c=>c.warn),c)}info(c){this.log(as.Info,(c=>c.info),c)}verbose(c){this.log(as.Verbose,(c=>c.verbose),c)}log(c,y,v){if(""===v.trim())return;const w=(new Date).toUTCString();let C;C=this.name?`[${w}] : @microsoft/teamsfx - ${this.name} : ${as[c]} - `:`[${w}] : @microsoft/teamsfx : ${as[c]} - `;const b=`${C}${v}`;void 0!==this.level&&this.level<=c&&(this.customLogger?y(this.customLogger)(b):this.customLogFunction?this.customLogFunction(c,b):y(this.defaultLogger)(b))}};function parseJwt(c){try{const y=os(c);if(!y||!y.exp)throw new ErrorWithCode("Decoded token is null or exp claim does not exists.",is.InternalError);return y}catch(c){const y="Parse jwt token failed in node env with error: "+c.message;throw cs.error(y),new ErrorWithCode(y,is.InternalError)}}function formatString(c,...y){const v=y;return c.replace(/{(\d+)}/g,(function(c,y){return void 0!==v[y]?v[y]:c}))}function validateScopesType(c){if("string"==typeof c||c instanceof String)return;if(Array.isArray(c)&&0===c.length)return;if(Array.isArray(c)&&c.length>0&&c.every((c=>"string"==typeof c)))return;const y="The type of scopes is not valid, it must be string or string array";throw cs.error(y),new ErrorWithCode(y,is.InvalidParameter)}class TeamsUserCredential{constructor(c){cs.info("Create teams user credential"),this.config=this.loadAndValidateConfig(c),this.ssoToken=null,this.initialized=!1}async login(c){validateScopesType(c);const y="string"==typeof c?c:c.join(" ");return cs.info(`Popup login page to get user's access token with scopes: ${y}`),this.initialized||await this.init(),new Promise(((c,v)=>{b.initialize((()=>{b.authentication.authenticate({url:`${this.config.initiateLoginEndpoint}?clientId=${this.config.clientId}&scope=${encodeURI(y)}&loginHint=${this.loginHint}`,width:600,height:535,successCallback:async y=>{if(!y){const c="Get empty authentication result from MSAL";return cs.error(c),void v(new ErrorWithCode(c,is.InternalError))}let w={};try{w="string"==typeof y?JSON.parse(y):y}catch(c){const y="Failed to parse response to Json.";cs.error(y),v(new ErrorWithCode(y,is.InvalidResponse))}if(w.code){const c=`Found auth code in response. Auth code is not support for current version of SDK. Please refer to the help link for how to fix the issue: ${"https://aka.ms/teamsfx-auth-code-flow"}.`;cs.error(c),v(new ErrorWithCode(c,is.InvalidResponse))}w.sessionStorage&&this.setSessionStorage(w.sessionStorage),c()},failureCallback:c=>{const w=`Consent failed for the scope ${y} with error: ${c}`;cs.error(w),v(new ErrorWithCode(w,is.ConsentFailed))}})}))}))}async getToken(c,y){validateScopesType(c);const v=await this.getSSOToken(),w="string"==typeof c?c:c.join(" ");if(""===w)return cs.info("Get SSO token"),v;{let y;cs.info("Get access token with scopes: "+w),this.initialized||await this.init();const v="string"==typeof c?c.split(" "):c,C=window.location.origin;try{const c=this.msalInstance.getAccountByUsername(this.loginHint),w={scopes:v,account:null!=c?c:void 0,redirectUri:`${C}/blank-auth-end.html`};y=await this.msalInstance.acquireTokenSilent(w)}catch(c){const y=`Failed to call acquireTokenSilent. Reason: ${null==c?void 0:c.message}. `;cs.verbose(y)}if(!y)try{const c={scopes:v,loginHint:this.loginHint,redirectUri:`${C}/blank-auth-end.html`};y=await this.msalInstance.ssoSilent(c)}catch(c){const y=`Failed to call ssoSilent. Reason: ${null==c?void 0:c.message}. `;cs.verbose(y)}if(!y){const c="Failed to get access token cache silently, please login first: you need login first before get access token.";throw cs.error(c),new ErrorWithCode(c,is.UiRequiredError)}const b=function parseAccessTokenFromAuthCodeTokenResponse(c){try{const y="string"==typeof c?JSON.parse(c):c;if(!y||!y.accessToken){const c="Get empty access token from Auth Code token response.";throw cs.error(c),new Error(c)}const v=y.accessToken,w=parseJwt(v);if("1.0"!==w.ver&&"2.0"!==w.ver){const c="SSO token is not valid with an unknown version: "+w.ver;throw cs.error(c),new Error(c)}return{token:v,expiresOnTimestamp:1e3*w.exp}}catch(c){const y="Parse access token failed from Auth Code token response in node env with error: "+c.message;throw cs.error(y),new ErrorWithCode(y,is.InternalError)}}(y);return b}}async getUserInfo(){cs.info("Get basic user info from SSO token");return function getUserInfoFromSsoToken(c){if(!c){const c="SSO token is undefined.";throw cs.error(c),new ErrorWithCode(c,is.InvalidParameter)}const y=parseJwt(c),v={displayName:y.name,objectId:y.oid,tenantId:y.tid,preferredUserName:""};return"2.0"===y.ver?v.preferredUserName=y.preferred_username:"1.0"===y.ver&&(v.preferredUserName=y.upn),v}((await this.getSSOToken()).token)}async init(){const c=function getTenantIdAndLoginHintFromSsoToken(c){if(!c){const c="SSO token is undefined.";throw cs.error(c),new ErrorWithCode(c,is.InvalidParameter)}const y=parseJwt(c);return{tid:y.tid,loginHint:"2.0"===y.ver?y.preferred_username:y.upn}}((await this.getSSOToken()).token);this.loginHint=c.loginHint,this.tid=c.tid;const y={auth:{clientId:this.config.clientId,authority:`https://login.microsoftonline.com/${this.tid}`},cache:{cacheLocation:"sessionStorage"}};this.msalInstance=new Xa(y),this.initialized=!0}getSSOToken(){return new Promise(((c,y)=>{if(this.ssoToken&&this.ssoToken.expiresOnTimestamp-Date.now()>3e5)return cs.verbose("Get SSO token from memory cache"),void c(this.ssoToken);if(this.checkInTeams())b.initialize((()=>{b.authentication.getAuthToken({successCallback:v=>{if(!v){const c="Get empty SSO token from Teams";return cs.error(c),void y(new ErrorWithCode(c,is.InternalError))}const w=parseJwt(v);if("1.0"!==w.ver&&"2.0"!==w.ver){const c="SSO token is not valid with an unknown version: "+w.ver;return cs.error(c),void y(new ErrorWithCode(c,is.InternalError))}const C={token:v,expiresOnTimestamp:1e3*w.exp};this.ssoToken=C,c(C)},failureCallback:c=>{const v="Get SSO token failed with error: "+c;cs.error(v),y(new ErrorWithCode(v,is.InternalError))},resources:[]})}));else{const c="Initialize teams sdk failed due to not running inside Teams";cs.error(c),y(new ErrorWithCode(c,is.InternalError))}}))}loadAndValidateConfig(c){if(cs.verbose("Validate authentication configuration"),c.initiateLoginEndpoint&&c.clientId)return c;const y=[];c.initiateLoginEndpoint||y.push("initiateLoginEndpoint"),c.clientId||y.push("clientId");const v=formatString(ErrorMessage.InvalidConfiguration,y.join(", "),"undefined");throw cs.error(v),new ErrorWithCode(v,is.InvalidConfiguration)}setSessionStorage(c){try{Object.keys(c).forEach((y=>{sessionStorage.setItem(y,c[y])}))}catch(c){const y=`Failed to set values in session storage. Error: ${c.message}`;throw cs.error(y),new ErrorWithCode(y,is.InternalError)}}checkInTeams(){return!!(window.parent===window.self&&window.nativeInterface||window.navigator.userAgent.includes("Teams/")||"embedded-page-container"===window.name||"extension-tab-frame"===window.name)}}const us="https://graph.microsoft.com/.default";class MsGraphAuthProvider{constructor(c,y){this.teamsfx=c;let v=us;y&&(validateScopesType(y),v="string"==typeof y?y:y.join(" "),""===v&&(v=us)),cs.info(`Create Microsoft Graph Authentication Provider with scopes: '${v}'`),this.scopes=v}async getAccessToken(){cs.info(`Get Graph Access token with scopes: '${this.scopes}'`);const c=await this.teamsfx.getCredential().getToken(this.scopes);return new Promise(((y,v)=>{if(c)y(c.token);else{const c="Graph access token is undefined or empty";cs.error(c),v(new ErrorWithCode(c,is.InternalError))}}))}}var ls,ds,hs;!function(c){c[c.Header=0]="Header",c[c.QueryParams=1]="QueryParams"}(ls||(ls={}));!function(c){c.User="User",c.App="Application"}(ds||(ds={}));class TeamsFx{constructor(c,y){if(this.identityType=null!=c?c:ds.User,this.identityType!==ds.User){const c=formatString(ErrorMessage.IdentityTypeNotSupported,this.identityType.toString(),"TeamsFx");throw cs.error(c),new ErrorWithCode(c,is.IdentityTypeNotSupported)}if(this.configuration=new Map,this.loadFromEnv(),y)for(const c of Object.keys(y)){const v=y[c];v&&this.configuration.set(c,v)}0===this.configuration.size&&cs.warn("No configuration is loaded, please pass required configs to TeamsFx constructor")}loadFromEnv(){if(window&&window.__env__){const c=window.__env__;this.configuration.set("authorityHost",c.REACT_APP_AUTHORITY_HOST),this.configuration.set("tenantId",c.REACT_APP_TENANT_ID),this.configuration.set("clientId",c.REACT_APP_CLIENT_ID),this.configuration.set("initiateLoginEndpoint",c.REACT_APP_START_LOGIN_PAGE_URL),this.configuration.set("applicationIdUri",c.M365_APPLICATION_ID_URI),this.configuration.set("apiEndpoint",c.REACT_APP_FUNC_ENDPOINT),this.configuration.set("apiName",c.REACT_APP_FUNC_NAME)}else try{this.configuration.set("authorityHost",process.env.REACT_APP_AUTHORITY_HOST),this.configuration.set("tenantId",process.env.REACT_APP_TENANT_ID),this.configuration.set("clientId",process.env.REACT_APP_CLIENT_ID),this.configuration.set("initiateLoginEndpoint",process.env.REACT_APP_START_LOGIN_PAGE_URL),this.configuration.set("applicationIdUri",process.env.M365_APPLICATION_ID_URI),this.configuration.set("apiEndpoint",process.env.REACT_APP_FUNC_ENDPOINT),this.configuration.set("apiName",process.env.REACT_APP_FUNC_NAME)}catch(c){return void cs.warn("Cannot read process.env, please use webpack if you want to use environment variables.")}}getIdentityType(){return this.identityType}getCredential(){return this.teamsUserCredential||(this.teamsUserCredential=new TeamsUserCredential(Object.fromEntries(this.configuration))),this.teamsUserCredential}async getUserInfo(){return await this.getCredential().getUserInfo()}async login(c){await this.getCredential().login(c)}setSsoToken(c){return this}getConfig(c){const y=this.configuration.get(c);if(!y)throw new Error;return y}hasConfig(c){return!!this.configuration.get(c)}getConfigs(){const c={};for(const y of this.configuration.keys()){const v=this.configuration.get(y);v&&(c[y]=v)}return c}}!function(c){c.Channel="Channel",c.Group="Group",c.Person="Person"}(hs||(hs={}));var ps=__webpack_require__(729);const fs="ms-auth-service-initialized";let gs=new ps.EventEmitter;function getAuthEvents(){return gs}gs.on(fs,(()=>{console.log("AUTH_SERVICE_INITIALIZE")}));var ms=__webpack_require__(373);let ys=null;const vs=window.location.origin+"/auth-start.html";const ws="ms_force_stay_logout";class TeamsLoginService{constructor(c,y){this.microsoftGraphService=c,this.msToNativeLoginBridge=y}getCredential(){if(ys||function initTeamsFx(c){ys=new TeamsFx(ds.User,{authorityHost:c,initiateLoginEndpoint:vs,clientId:getMsProperties().MICROSOFT_APP_ID})}("common"),!ys)throw new Error("");return ys}async initBasicInfo(){const c=this.getCredential();return await c.getUserInfo(),getAuthEvents().emit("ms-auth-basic-info"),c}async initGraph(c){try{const y=function createMicrosoftGraphClient(c,y){cs.info("Create Microsoft Graph Client");const v=new MsGraphAuthProvider(c,y);return ss.Client.initWithMiddleware({authProvider:v})}(ys,c);if(!ys)throw new Error;this.microsoftGraphService.init(y)}catch(c){-1!==c.toString().indexOf("please login first")?console.info("app not authorized - no graph support"):console.error(c)}}async userInteractionAuth(){console.log("TeamsLoginService : userInteractionAuth"),(await(0,v.getService)(ms.COOKIE_STORE_SERVICE)).remove(ws);const c=await this.initBasicInfo(),y=await c.getUserInfo();return await this.initBasic(y,!0),await this.msToNativeLoginBridge.setProfile({displayName:y.displayName}),c}async upgrade(){console.log("upgrade");let c=["User.Read","User.ReadBasic.All","profile","openid","Files.Read","Files.Read.All"];const y=await this.initBasicInfo();await y.login(c),await this.initGraph(c);const v=await y.getUserInfo();return await this.initBasic(v,!0),y}async passiveLogin(){if(!msTeamsUtils())throw new Error("not in teams");try{await b.app.initialize()}catch(c){return void console.warn("microsoftTeams.initialize failed (probably not in teams so we skip it)",c)}//!this.msToNativeLoginBridge.isLogged()
if(!(await(0,v.getService)(ms.COOKIE_STORE_SERVICE)).get(ws))try{const c=await this.initBasicInfo(),y=await c.getUserInfo();console.log("passiveAuth (basic):",c),await this.initBasic(y,!1)}catch(c){console.warn("passive login failed",c),(await(0,v.getService)(ms.COOKIE_STORE_SERVICE)).remove(ws)}}isUserBasicLogged(){return this.msToNativeLoginBridge.getProfile().microsoftUser&&this.msToNativeLoginBridge.getProfile().displayName&&window.APP.store.state.credentials.token}isGraphDataFilled(){return this.msToNativeLoginBridge.getProfile().jobTitle||this.msToNativeLoginBridge.getProfile().phoneNumber||this.msToNativeLoginBridge.getProfile().companyName||this.msToNativeLoginBridge.getProfile().microsoftUserprofilePicture}async initBasic(c,y){if(this.microsoftGraphService.isInitialized()&&!this.isGraphDataFilled()&&(y=!0),this.isUserBasicLogged()&&!y)return;console.log("initBasic : ",c);const v={};v.email=c.preferredUserName,v.displayName=c.displayName,v.id=c.objectId;let w="",C="",b="",S="";if(this.microsoftGraphService.isInitialized()){const c=await this.microsoftGraphService.getUserDetails();b=c.mobilePhone,S=c.jobTitle,w=await this.microsoftGraphService.getUserPhotoAsBase64(),C=await this.microsoftGraphService.getUserOrganization()}await this.initBasicInfo();let T=v.id;await this.msToNativeLoginBridge.setProfile({email:v.email,displayName:v.displayName,phoneNumber:b,jobTitle:S,companyName:C,microsoftUserprofilePicture:w,microsoftUser:v.id}),await this.msToNativeLoginBridge.nativeLogin(v.email,T)}async logout(){(await(0,v.getService)(ms.COOKIE_STORE_SERVICE)).set(ws,"true"),await this.msToNativeLoginBridge.logout()}}function MicrosoftLoginService_defineProperty(c,y,v){return y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v,c}class MicrosoftLoginService{getTeamsLoginService(){return this.teamsLoginService}constructor(c){this.msToNativeLoginBridge=c,MicrosoftLoginService_defineProperty(this,"authInProgress",!1),MicrosoftLoginService_defineProperty(this,"msGraphService",new MicrosoftGraphService),MicrosoftLoginService_defineProperty(this,"microsoftOauthLoginService",void 0),MicrosoftLoginService_defineProperty(this,"teamsLoginService",void 0),MicrosoftLoginService_defineProperty(this,"initialized",!1),this.microsoftOauthLoginService=new MicrosoftOauthLoginService(this.msGraphService,this.msToNativeLoginBridge),this.teamsLoginService=new TeamsLoginService(this.msGraphService,this.msToNativeLoginBridge),this.onReady().then((()=>{this.initialized=!0}))}async onReady(){return this.initialized?Promise.resolve(!0):new Promise((c=>{const onInitialized=()=>{getAuthEvents().off(fs,onInitialized),c(!0)};getAuthEvents().on(fs,onInitialized)}))}async passiveLogin(){this.authInProgress||(this.authInProgress=!0,setTimeout((()=>{this.authInProgress=!1}),1e3),msTeamsUtils()?(await this.teamsLoginService.passiveLogin(),this.authInProgress=!1):(await this.microsoftOauthLoginService.passiveLogin(),this.authInProgress=!1),getAuthEvents().emit(fs))}async loginInternal(){this.authInProgress||(this.authInProgress=!0,setTimeout((()=>{this.authInProgress=!1}),1e3),msTeamsUtils()?(await this.teamsLoginService.userInteractionAuth(),this.authInProgress=!1):(await this.microsoftOauthLoginService.login(),this.authInProgress=!1))}async login(c=!0){if(!c)return await this.loginInternal();try{return await this.loginInternal()}catch(c){this.authInProgress=!1,console.error(c)}}getUserAccount(){return this.msToNativeLoginBridge.getUserAccount()}getName(){return this.msToNativeLoginBridge.getName()}async logout(){this.authInProgress||(this.authInProgress=!0,setTimeout((()=>{this.authInProgress=!1}),1e3),this.msToNativeLoginBridge.clearProfile(),msTeamsUtils()?(await this.teamsLoginService.logout(),this.authInProgress=!1):(await this.microsoftOauthLoginService.logout(),this.authInProgress=!1))}displayProfilePhoto(){return this.msToNativeLoginBridge.displayProfilePhoto()}isSignedIn(){return this.msToNativeLoginBridge.isLogged()}getAccount(){return{displayName:void 0,email:void 0,id:void 0}}passiveLogIn(){return this.passiveLogin()}signIn(){return this.login()}signOut(){return this.signOut()}}function sendIframeMessage(c,y){window.parent&&window.parent.postMessage&&window.parent.postMessage(JSON.stringify({type:c,data:y}),"*")}(new class DeepLinkService{start(){getMSEvents().on(y,(c=>{try{const y=c.link;b.app.openLink(y)}catch(c){console.error(c)}}))}}).start();class MicrosoftUrlService{constructor(c){this.microsoftLoginService=c,function MicrosoftUrlService_defineProperty(c,y,v){return y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v,c}(this,"preloaded",{})}urlToToSharingToken(c){return"u!"+function(c,y){y=y||" ";let v=c.length-1;for(;v>=0&&c.charAt(v)===y;)v--;return c.substring(0,v+1)}(T.lW.from(c).toString("base64"),"=").replace(/\//g,"_").replace(/\+/g,"-")}async preFetchConvertMicrosoftUrl(c){return this.convertMicrosoftUrl(c)}convertMicrosoftUrlSync(c){return this.preFetchConvertMicrosoftUrl(c),this.preloaded[c]||c}async convertMicrosoftUrl(c){if(-1===c.indexOf("sharepoint.com"))return c;if(console.log("convertMicrosoftUrl"),this.microsoftLoginService.getUserAccount()){let y=await this.convertSharingUrlToDownloadUrl(c);return this.preloaded[c]=y,y}if(console.log("passiveLoginWithTeams"),await this.microsoftLoginService.passiveLogin(),this.microsoftLoginService.getUserAccount()){let y=await this.convertSharingUrlToDownloadUrl(c);return this.preloaded[c]=y,y}console.log("loginWithRedirect"),await this.microsoftLoginService.login()}async convertSharingUrlToDownloadUrl(c){return new Promise((y=>{const v=this.urlToToSharingToken(c);this.microsoftLoginService.msGraphService.client.api("/shares/"+v+"/driveItem").get().then((c=>{y(c["@microsoft.graph.downloadUrl"])})).catch((c=>{console.warn(c),y("error_microsoft_not_authorized")}))}))}}function MsTeamsAPI_defineProperty(c,y,v){return y in c?Object.defineProperty(c,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):c[y]=v,c}class MsTeamsAPIFactory{async createService(c){console.log("MsTeamsAPIFactory");let y=await c.getService(ms.PHX_AUTH_SERVICE);return new MsTeamsAPI(y)}}class MsTeamsAPI{constructor(c){this.phxAuth=c,MsTeamsAPI_defineProperty(this,"microsoftLoginService",void 0),MsTeamsAPI_defineProperty(this,"microsoftUrlService",void 0),this.microsoftLoginService=new MicrosoftLoginService(c.getNativeInterface()),this.microsoftUrlService=new MicrosoftUrlService(this.microsoftLoginService)}getLoginService(){return this.microsoftLoginService}getTeamsApp(){return{app:b.app,pages:b.pages}}async redirectToTeamsSidePanel(){await async function redirectToTeamsSidePanel(){if((0,v.getServiceSync)(C.MICROSOFT_STATIC_SERVICE).msTeams()){if(new URL(window.location.href).searchParams.get("msForceHub"))return;await getContext((c=>{c&&"sidePanel"===c.page.frameContext&&window.location.replace(window.location.origin+"/microsoft-settings.html?msteams=true")}))}}()}getUrlService(){return this.microsoftUrlService}getMSEvents(){return getMSEvents()}getContext(c){return getContext(c)}async processDeepLink(c){return function processDeepLink(c){msTeamsUtils()?sendEvent(y,{link:c}):window.open(c,"_blank")}(c)}changeUrlSettings(y){return function changeUrlSettings(y){sendEvent(c,{url:y})}(y)}getType(){return MsTeamsAPI.name}registerTeamsTestHelper(){return function registerTeamsTestHelper(){const c=console.warn;console.warn=(y,...v)=>{try{sendIframeMessage("WARN_LOG_NOTIFICATION","console warn reporter")}catch(c){}return c(y,v)};const y=console.error;console.error=(c,...v)=>{try{sendIframeMessage("ERROR_LOG_NOTIFICATION","console error reporter")}catch(c){}return y(c,v)};const v=window.onerror;window.onerror=(c,y,w,C,b)=>{try{sendIframeMessage("THROW_NOTIFICATION","console error reporter")}catch(c){}if(v)return v(c,y,w,C,b)}}()}}MsTeamsAPI_defineProperty(MsTeamsAPI,"dependencies",[ms.PHX_AUTH_SERVICE])})(),w})()));
//# sourceMappingURL=dist-index-ms.js.map