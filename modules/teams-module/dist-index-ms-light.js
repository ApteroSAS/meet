/*!
 * 
 *   @aptero/axolotis-module-teams v1.0.0
 *
 *   Copyright (c) Aptero  and project contributors.
 *
 *   This source code is licensed under the undefined license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */
!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@aptero/axolotis-player")):"function"==typeof define&&define.amd?define("axolotis-module-teams",["@aptero/axolotis-player"],t):"object"==typeof exports?exports["axolotis-module-teams"]=t(require("@aptero/axolotis-player")):e["axolotis-module-teams"]=t(e["@aptero/axolotis-player"])}(self,(e=>(()=>{"use strict";var t={12:t=>{t.exports=e}},r={};function __webpack_require__(e){var o=r[e];if(void 0!==o)return o.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,__webpack_require__),s.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{__webpack_require__.r(o),__webpack_require__.d(o,{MICROSOFT_AUTH_ERROR:()=>t,MICROSOFT_SERVICE:()=>s,MSTEAMS_QUERY_PARAM:()=>r,MsTeamsAPILight:()=>MsTeamsAPILight,msTeamsAPI:()=>msTeamsAPI});var e=__webpack_require__(12);const t="error_microsoft_not_authorized",r="msteams",s="@aptero/axolotis-module-teams/MicrosoftService";async function msTeamsAPI(){return(0,e.getService)(s)}class MsTeamsAPILight{constructor(){!function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}(this,"msmode",void 0);const e=new URLSearchParams(location.search);this.msmode=!!e.get(r),this.msmode&&(window.location.host.startsWith("localhost")||window.location.host.startsWith("127.0.0.1"))&&(async()=>{(await msTeamsAPI()).registerTeamsTestHelper()})()}getType(){return MsTeamsAPILight.name}msTeams(){return this.msmode}redirectToTeamsSidePanel(){this.msTeams()&&msTeamsAPI().then((async e=>{await e.redirectToTeamsSidePanel()}))}msPassiveLoginCheckNeeded(){return window.APP.store.state.profile.microsoftUser||this.msTeams()}async preFetchConvertMicrosoftUrl(e){if(-1===e.indexOf("sharepoint.com")){let t=(await msTeamsAPI()).getUrlService();e=await t.preFetchConvertMicrosoftUrl(e)}return e}async conditionalPassiveLogIn(){if(this.msPassiveLoginCheckNeeded()){let e=await msTeamsAPI();return await e.getLoginService().passiveLogin(),!0}return!1}}})(),o})()));
//# sourceMappingURL=dist-index-ms-light.js.map